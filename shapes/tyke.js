/*
 howler.js v2.1.1 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com  Spatial Plugin  @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(I){var k=0;return function(){return k<I.length?{done:!1,value:I[k++]}:{done:!0}}};$jscomp.arrayIterator=function(I){return{next:$jscomp.arrayIteratorImpl(I)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(I,k,r){I!=Array.prototype&&I!=Object.prototype&&(I[k]=r.value)};$jscomp.getGlobal=function(I){I=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,I];for(var k=0;k<I.length;++k){var r=I[k];if(r&&r.Math==Math)return r}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(I,k){this.$jscomp$symbol$id_=I;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:k})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function I(r){if(this instanceof I)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(r||"")+"_"+k++,r)}var k=0;return I}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var I=$jscomp.global.Symbol.iterator;I||(I=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[I]&&$jscomp.defineProperty(Array.prototype,I,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var I=$jscomp.global.Symbol.asyncIterator;I||(I=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(I){$jscomp.initSymbolIterator();I={next:I};I[$jscomp.global.Symbol.iterator]=function(){return this};return I};
$jscomp.iteratorFromArray=function(I,k){$jscomp.initSymbolIterator();I instanceof String&&(I+="");var r=0,q={next:function(){if(r<I.length){var w=r++;return{value:k(w,I[w]),done:!1}}q.next=function(){return{done:!0,value:void 0}};return q.next()}};q[Symbol.iterator]=function(){return q};return q};
$jscomp.polyfill=function(I,k,r,q){if(k){r=$jscomp.global;I=I.split(".");for(q=0;q<I.length-1;q++){var w=I[q];w in r||(r[w]={});r=r[w]}I=I[I.length-1];q=r[I];k=k(q);k!=q&&null!=k&&$jscomp.defineProperty(r,I,{configurable:!0,writable:!0,value:k})}};$jscomp.polyfill("Array.prototype.values",function(I){return I?I:function(){return $jscomp.iteratorFromArray(this,function(k,r){return r})}},"es8","es3");
$jscomp.checkStringArgs=function(I,k,r){if(null==I)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return I+""};
$jscomp.polyfill("String.prototype.startsWith",function(I){return I?I:function(k,r){var q=$jscomp.checkStringArgs(this,k,"startsWith");k+="";var w=q.length,D=k.length;r=Math.max(0,Math.min(r|0,q.length));for(var H=0;H<D&&r<w;)if(q[r++]!=k[H++])return!1;return H>=D}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(I){return I?I:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6","es3");
$jscomp.polyfill("String.fromCodePoint",function(I){return I?I:function(k){for(var r="",q=0;q<arguments.length;q++){var w=Number(arguments[q]);if(0>w||1114111<w||w!==Math.floor(w))throw new RangeError("invalid_code_point "+w);65535>=w?r+=String.fromCharCode(w):(w-=65536,r+=String.fromCharCode(w>>>10&1023|55296),r+=String.fromCharCode(w&1023|56320))}return r}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(I){return I?I:function(k,r){var q=$jscomp.checkStringArgs(this,k,"endsWith");k+="";void 0===r&&(r=q.length);r=Math.max(0,Math.min(r|0,q.length));for(var w=k.length;0<w&&0<r;)if(q[--r]!=k[--w])return!1;return 0>=w}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(I){return I?I:function(k,r,q){var w=this.length||0;0>r&&(r=Math.max(0,w+r));if(null==q||q>w)q=w;q=Number(q);0>q&&(q=Math.max(0,w+q));for(r=Number(r||0);r<q;r++)this[r]=k;return this}},"es6","es3");
(function(I,k){I.lime=I.lime||{};I.lime.$scripts=I.lime.$scripts||{};I.lime.$scripts.tyke=function(k,q){(function(k,r){function H(a,b){a=Object.create(a);for(var c in b)a[c]=b[c];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function q(a,b){null==b&&(b=1);null==a&&(a=0);return a+Math.random()*(b-a)}function w(a){null==a&&(a=50);return Math.random()<a/100}function E(a){return a instanceof Array?new nc(a):a.iterator()}function d(a,b){if(null==b)return null;null==b.__id__&&
(b.__id__=r.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}k.echo=k.echo||{};k.lime=k.lime||{};var h={},p=function(){return ra.__string_rec(this,"")},y=y||{},n,Q=function(){};h["lime.app.IModule"]=Q;Q.__name__=!0;Q.__isInterface__=!0;var ia=function(){this.onExit=new jc};h["lime.app.Module"]=ia;ia.__name__=!0;ia.__interfaces__=[Q];ia.prototype={__class__:ia};var Ta=function(a){this.gameDeviceCache=
new zb;this.parent=a;this.nextUpdate=this.lastUpdate=this.currentUpdate=0;this.framePeriod=-1;ec.init();this.accelerometer=Cb.registerSensor(Oe.ACCELEROMETER,0)};h["lime._internal.backend.html5.HTML5Application"]=Ta;Ta.__name__=!0;Ta.prototype={convertKeyCode:function(a){if(65<=a&&90>=a)return a+32;switch(a){case 12:return 1073741980;case 16:return 1073742049;case 17:return 1073742048;case 18:return 1073742050;case 19:return 1073741896;case 20:return 1073741881;case 33:return 1073741899;case 34:return 1073741902;
case 35:return 1073741901;case 36:return 1073741898;case 37:return 1073741904;case 38:return 1073741906;case 39:return 1073741903;case 40:return 1073741905;case 41:return 1073741943;case 43:return 1073741940;case 44:return 1073741894;case 45:return 1073741897;case 46:return 127;case 91:return 1073742051;case 92:return 1073742055;case 93:return 1073742055;case 95:return 1073742106;case 96:return 1073741922;case 97:return 1073741913;case 98:return 1073741914;case 99:return 1073741915;case 100:return 1073741916;
case 101:return 1073741917;case 102:return 1073741918;case 103:return 1073741919;case 104:return 1073741920;case 105:return 1073741921;case 106:return 1073741909;case 107:return 1073741911;case 108:return 1073741923;case 109:return 1073741910;case 110:return 1073741923;case 111:return 1073741908;case 112:return 1073741882;case 113:return 1073741883;case 114:return 1073741884;case 115:return 1073741885;case 116:return 1073741886;case 117:return 1073741887;case 118:return 1073741888;case 119:return 1073741889;
case 120:return 1073741890;case 121:return 1073741891;case 122:return 1073741892;case 123:return 1073741893;case 124:return 1073741928;case 125:return 1073741929;case 126:return 1073741930;case 127:return 1073741931;case 128:return 1073741932;case 129:return 1073741933;case 130:return 1073741934;case 131:return 1073741935;case 132:return 1073741936;case 133:return 1073741937;case 134:return 1073741938;case 135:return 1073741939;case 144:return 1073741907;case 145:return 1073741895;case 160:return 94;
case 161:return 33;case 163:return 35;case 164:return 36;case 166:return 1073742094;case 167:return 1073742095;case 168:return 1073742097;case 169:return 41;case 170:return 42;case 171:return 96;case 172:return 1073741898;case 173:return 45;case 174:return 1073741953;case 175:return 1073741952;case 176:return 1073742082;case 177:return 1073742083;case 178:return 1073742084;case 179:return 1073742085;case 180:return 1073742089;case 181:return 1073742086;case 182:return 1073741953;case 183:return 1073741952;
case 186:return 59;case 187:return 61;case 188:return 44;case 189:return 45;case 190:return 46;case 191:return 47;case 192:return 96;case 193:return 63;case 194:return 1073741923;case 219:return 91;case 220:return 92;case 221:return 93;case 222:return 39;case 223:return 96;case 224:return 1073742051;case 226:return 92}return a},exec:function(){window.addEventListener("keydown",d(this,this.handleKeyEvent),!1);window.addEventListener("keyup",d(this,this.handleKeyEvent),!1);window.addEventListener("focus",
d(this,this.handleWindowEvent),!1);window.addEventListener("blur",d(this,this.handleWindowEvent),!1);window.addEventListener("resize",d(this,this.handleWindowEvent),!1);window.addEventListener("beforeunload",d(this,this.handleWindowEvent),!1);window.addEventListener("devicemotion",d(this,this.handleSensorEvent),!1);CanvasRenderingContext2D.prototype.isPointInStroke||(CanvasRenderingContext2D.prototype.isPointInStroke=function(a,b,c){return!1});CanvasRenderingContext2D.prototype.isPointInPath||(CanvasRenderingContext2D.prototype.isPointInPath=
function(a,b,c){return!1});0=="performance"in window&&(window.performance={});if(0=="now"in window.performance){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart);window.performance.now=function(){return Date.now()-a}}for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+
"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,c){var e=(new Date).getTime(),f=Math.max(0,16-(e-b));c=window.setTimeout(function(){a(e+f)},f);b=e+f;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});window.requestAnimFrame=window.requestAnimationFrame;this.lastUpdate=(new Date).getTime();this.handleApplicationEvent();return 0},exit:function(){},handleApplicationEvent:function(a){a=0;for(var b=this.parent.__windows;a<
b.length;){var c=b[a];++a;c.__backend.updateSize()}this.updateGameDevices();this.currentUpdate=(new Date).getTime();if(this.currentUpdate>=this.nextUpdate){this.deltaTime=this.currentUpdate-this.lastUpdate;a=0;for(b=this.parent.__windows;a<b.length;)c=b[a],++a,this.parent.onUpdate.dispatch(this.deltaTime|0),null!=c.context&&c.onRender.dispatch(c.context);this.nextUpdate=0>this.framePeriod?this.currentUpdate:this.currentUpdate-this.currentUpdate%this.framePeriod+this.framePeriod;this.lastUpdate=this.currentUpdate}window.requestAnimationFrame(d(this,
this.handleApplicationEvent))},handleKeyEvent:function(a){if(null!=this.parent.__window){var b=this.convertKeyCode(null!=a.keyCode?a.keyCode:a.which),c=(a.shiftKey?3:0)|(a.ctrlKey?192:0)|(a.altKey?768:0)|(a.metaKey?3072:0);"keydown"==a.type?(this.parent.__window.onKeyDown.dispatch(b,c),this.parent.__window.onKeyDown.canceled&&a.cancelable&&a.preventDefault()):(this.parent.__window.onKeyUp.dispatch(b,c),this.parent.__window.onKeyUp.canceled&&a.cancelable&&a.preventDefault())}},handleSensorEvent:function(a){this.accelerometer.onUpdate.dispatch(a.accelerationIncludingGravity.x,
a.accelerationIncludingGravity.y,a.accelerationIncludingGravity.z)},handleWindowEvent:function(a){if(null!=this.parent.__window)switch(a.type){case "blur":this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0);break;case "focus":this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1);break;case "resize":this.parent.__window.__backend.handleResizeEvent(a);break;case "visibilitychange":window.document.hidden?
this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0):this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1)}},updateGameDevices:function(){var a=Pa.__getDeviceData();if(null!=a)for(var b,c,e,f,g,v=0,l=a.length;v<l;)if(b=v++,f=a[b],null!=f){if(!this.gameDeviceCache.h.hasOwnProperty(b)){g=new Qd;g.id=b;g.connected=f.connected;c=0;for(e=f.buttons.length;c<e;){var d=c++;g.buttons.push(f.buttons[d].value)}c=
0;for(e=f.axes.length;c<e;)d=c++,g.axes.push(f.axes[d]);"standard"==f.mapping&&(g.isGamepad=!0);this.gameDeviceCache.h[b]=g;f.connected&&(Pa.__connect(b),g.isGamepad&&cb.__connect(b))}g=this.gameDeviceCache.h[b];e=Pa.devices.h[b];c=cb.devices.h[b];if(f.connected){for(var h=0,N=f.buttons.length;h<N;){var t=h++;d=f.buttons[t].value;if(d!=g.buttons[t]){if(6==t)e.onAxisMove.dispatch(f.axes.length,d),null!=c&&c.onAxisMove.dispatch(4,d);else if(7==t)e.onAxisMove.dispatch(f.axes.length+1,d),null!=c&&c.onAxisMove.dispatch(5,
d);else if(0<d?e.onButtonDown.dispatch(t):e.onButtonUp.dispatch(t),null!=c){switch(t){case 0:b=0;break;case 1:b=1;break;case 2:b=2;break;case 3:b=3;break;case 4:b=9;break;case 5:b=10;break;case 8:b=4;break;case 9:b=6;break;case 10:b=7;break;case 11:b=8;break;case 12:b=11;break;case 13:b=12;break;case 14:b=13;break;case 15:b=14;break;case 16:b=5;break;default:continue}0<d?c.onButtonDown.dispatch(b):c.onButtonUp.dispatch(b)}g.buttons[t]=d}}b=0;for(d=f.axes.length;b<d;)h=b++,f.axes[h]!=g.axes[h]&&(e.onAxisMove.dispatch(h,
f.axes[h]),null!=c&&c.onAxisMove.dispatch(h,f.axes[h]),g.axes[h]=f.axes[h])}else g.connected&&(g.connected=!1,Pa.__disconnect(b),cb.__disconnect(b))}},__class__:Ta};var D=function(){this.onCreateWindow=new Rd;this.onUpdate=new jc;this.onExit=new jc;null==D.current&&(D.current=this);this.meta=new ha;this.modules=[];this.__windowByID=new zb;this.__windows=[];this.__backend=new Ta(this);this.__registerLimeModule(this);this.__preloader=new Sd;this.__preloader.onProgress.add(d(this,this.onPreloadProgress));
this.__preloader.onComplete.add(d(this,this.onPreloadComplete))};h["lime.app.Application"]=D;D.__name__=!0;D.__super__=ia;D.prototype=H(ia.prototype,{createWindow:function(a){a=this.__createWindow(a);this.__addWindow(a);return a},exec:function(){D.current=this;return this.__backend.exec()},onGamepadAxisMove:function(a,b,c){},onGamepadButtonDown:function(a,b){},onGamepadButtonUp:function(a,b){},onGamepadConnect:function(a){},onGamepadDisconnect:function(a){},onJoystickAxisMove:function(a,b,c){},onJoystickButtonDown:function(a,
b){},onJoystickButtonUp:function(a,b){},onJoystickConnect:function(a){},onJoystickDisconnect:function(a){},onJoystickHatMove:function(a,b,c){},onJoystickTrackballMove:function(a,b,c,e){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onModuleExit:function(a){},onMouseDown:function(a,b,c){},onMouseMove:function(a,b){},onMouseMoveRelative:function(a,b){},onMouseUp:function(a,b,c){},onMouseWheel:function(a,b,c){},onPreloadComplete:function(){},onPreloadProgress:function(a,b){},onRenderContextLost:function(){},
onRenderContextRestored:function(a){},onTextEdit:function(a,b,c){},onTextInput:function(a){},onTouchCancel:function(a){},onTouchEnd:function(a){},onTouchMove:function(a){},onTouchStart:function(a){},onWindowActivate:function(){},onWindowClose:function(){},onWindowCreate:function(){},onWindowDeactivate:function(){},onWindowDropFile:function(a){},onWindowEnter:function(){},onWindowExpose:function(){},onWindowFocusIn:function(){},onWindowFocusOut:function(){},onWindowFullscreen:function(){},onWindowLeave:function(){},
onWindowMove:function(a,b){},onWindowMinimize:function(){},onWindowResize:function(a,b){},onWindowRestore:function(){},render:function(a){},update:function(a){},__addWindow:function(a){if(null!=a){this.__windows.push(a);this.__windowByID.h[a.id]=a;var b=d(this,this.__onWindowClose);a.onClose.add(function(){b(a)},!1,-1E4);null==this.__window&&(this.__window=a,a.onActivate.add(d(this,this.onWindowActivate)),a.onRenderContextLost.add(d(this,this.onRenderContextLost)),a.onRenderContextRestored.add(d(this,
this.onRenderContextRestored)),a.onDeactivate.add(d(this,this.onWindowDeactivate)),a.onDropFile.add(d(this,this.onWindowDropFile)),a.onEnter.add(d(this,this.onWindowEnter)),a.onExpose.add(d(this,this.onWindowExpose)),a.onFocusIn.add(d(this,this.onWindowFocusIn)),a.onFocusOut.add(d(this,this.onWindowFocusOut)),a.onFullscreen.add(d(this,this.onWindowFullscreen)),a.onKeyDown.add(d(this,this.onKeyDown)),a.onKeyUp.add(d(this,this.onKeyUp)),a.onLeave.add(d(this,this.onWindowLeave)),a.onMinimize.add(d(this,
this.onWindowMinimize)),a.onMouseDown.add(d(this,this.onMouseDown)),a.onMouseMove.add(d(this,this.onMouseMove)),a.onMouseMoveRelative.add(d(this,this.onMouseMoveRelative)),a.onMouseUp.add(d(this,this.onMouseUp)),a.onMouseWheel.add(d(this,this.onMouseWheel)),a.onMove.add(d(this,this.onWindowMove)),a.onRender.add(d(this,this.render)),a.onResize.add(d(this,this.onWindowResize)),a.onRestore.add(d(this,this.onWindowRestore)),a.onTextEdit.add(d(this,this.onTextEdit)),a.onTextInput.add(d(this,this.onTextInput)),
this.onWindowCreate());this.onCreateWindow.dispatch(a)}},__createWindow:function(a){a=new Td(this,a);return-1==a.id?null:a},__registerLimeModule:function(a){a.onUpdate.add(d(this,this.update));a.onExit.add(d(this,this.onModuleExit),!1,0);a.onExit.add(d(this,this.__onModuleExit),!1,0);for(a=cb.devices.iterator();a.hasNext();){var b=a.next();this.__onGamepadConnect(b)}cb.onConnect.add(d(this,this.__onGamepadConnect));for(a=Pa.devices.iterator();a.hasNext();)b=a.next(),this.__onJoystickConnect(b);Pa.onConnect.add(d(this,
this.__onJoystickConnect));Ib.onCancel.add(d(this,this.onTouchCancel));Ib.onStart.add(d(this,this.onTouchStart));Ib.onMove.add(d(this,this.onTouchMove));Ib.onEnd.add(d(this,this.onTouchEnd))},__removeWindow:function(a){null!=a&&this.__windowByID.h.hasOwnProperty(a.id)&&(this.__window==a&&(this.__window=null),z.remove(this.__windows,a),this.__windowByID.remove(a.id),a.close(),0==this.__windows.length&&wb.exit(0))},__onGamepadConnect:function(a){this.onGamepadConnect(a);var b=d(this,this.onGamepadAxisMove),
c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=d(this,this.onGamepadButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);var f=d(this,this.onGamepadButtonUp);c=function(b){f(a,b)};a.onButtonUp.add(c);var g=d(this,this.onGamepadDisconnect);a.onDisconnect.add(function(){g(a)})},__onJoystickConnect:function(a){this.onJoystickConnect(a);var b=d(this,this.onJoystickAxisMove),c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=d(this,this.onJoystickButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);
var f=d(this,this.onJoystickButtonUp);c=function(b){f(a,b)};a.onButtonUp.add(c);var g=d(this,this.onJoystickDisconnect);a.onDisconnect.add(function(){g(a)});var v=d(this,this.onJoystickHatMove);c=function(b,c){v(a,b,c)};a.onHatMove.add(c);var l=d(this,this.onJoystickTrackballMove);c=function(b,c,e){l(a,b,c,e)};a.onTrackballMove.add(c)},__onModuleExit:function(a){this.__backend.exit()},__onWindowClose:function(a){if(this.__window==a)this.onWindowClose();this.__removeWindow(a)},__class__:D});var I=
function(){this.isReadyForUpdate=!1;D.call(this)};h["ob.gum.backends.App"]=I;I.__name__=!0;I.__super__=D;I.prototype=H(D.prototype,{init:function(a,b){this.gum=new Ud(a,b);this.isReadyForUpdate=!0},onWindowCreate:function(){la.trace("App onWindowCreate",{fileName:"ob/gum/backends/Lime.hx",lineNumber:22,className:"ob.gum.backends.App",methodName:"onWindowCreate"});switch(this.__window.context.type){case "opengl":case "opengles":case "webgl":try{this.init(this.__window)}catch(b){var a=A.caught(b);la.trace(Pb.toString(Pb.exceptionStack()),
{fileName:"ob/gum/backends/Lime.hx",lineNumber:28,className:"ob.gum.backends.App",methodName:"onWindowCreate",customParams:[a]})}break;default:throw A.thrown("Sorry, only works with OpenGL.");}},update:function(a){if(this.isReadyForUpdate)this.gum.onUpdate(a)},onKeyDown:function(a,b){this.gum.onKeyDown(a,b)},onKeyUp:function(a,b){this.gum.onKeyUp(a,b)},onMouseMove:function(a,b){this.gum.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.gum.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.gum.onMouseUp(a,
b,c)},onMouseWheel:function(a,b,c){this.gum.onMouseScroll(a,b,c)},onWindowResize:function(a,b){D.prototype.onWindowResize.call(this,a,b);this.gum.onWindowResize(a,b)},__class__:I});var pa=function(){I.call(this)};h.SampleApp=pa;pa.__name__=!0;pa.__super__=I;pa.prototype=H(I.prototype,{init:function(a,b){I.prototype.init.call(this,a,{framesPerSecond:30,drawOnlyWhenRequested:!0,displayWidth:800,displayHeight:600,displayIsScaled:!0});this.initLoop()},initLoop:function(){},__class__:pa});var Y=function(){I.call(this)};
h.ShapeDebugApp=Y;Y.__name__=!0;Y.__super__=pa;Y.prototype=H(pa.prototype,{initLoop:function(){pa.prototype.initLoop.call(this);this.gum.changeLoop(new Ac(new Vd({fonts:["assets/fonts/tiled/hack_ascii.json"],images:["assets/images/bit-bonanza-food.png"]})))},__class__:Y});var O=function(){};h.ApplicationMain=O;O.__name__=!0;O.main=function(){wb.__registerEntryPoint("tyke",O.create)};O.create=function(a){G.init(a);var b=new Y;b.meta.h.build="1";b.meta.h.company="ob";b.meta.h.file="tyke";b.meta.h.name=
"tyke";b.meta.h.packageName="tyke";b.meta.h.version="0.0.1";var c={allowHighDPI:!1,alwaysOnTop:!1,borderless:!1,element:null,frameRate:61,height:0,hidden:!1,maximized:!1,minimized:!1,parameters:{},resizable:!0,title:"tyke",width:0,x:null,y:null,context:{antialiasing:0,background:16777215,colorDepth:32,depth:!0,hardware:!0,stencil:!0,type:null,vsync:!1}};if(null==b.__window&&null!=a)for(var e=0,f=B.fields(a);e<f.length;){var g=f[e];++e;Object.prototype.hasOwnProperty.call(c,g)?c[g]=B.field(a,g):Object.prototype.hasOwnProperty.call(c.context,
g)&&(c.context[g]=B.field(a,g))}b.createWindow(c);e=0;for(f=G.preloadLibraries;e<f.length;)a=f[e],++e,b.__preloader.addLibrary(a);e=0;for(f=G.preloadLibraryNames;e<f.length;)a=f[e],++e,b.__preloader.addLibraryName(a);b.__preloader.load();O.start(b)};O.start=function(a){a.exec()};var da=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};h.EReg=da;da.__name__=!0;da.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=
this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw A.thrown("EReg::matched");},matchedRight:function(){if(null==this.r.m)throw A.thrown("No string matched");var a=this.r.m.index+this.r.m[0].length;return z.substr(this.r.s,a,this.r.s.length-a)},matchedPos:function(){if(null==this.r.m)throw A.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(a,b,c){null==c&&(c=-1);if(this.r.global){if(this.r.lastIndex=b,this.r.m=this.r.exec(0>c?a:z.substr(a,0,b+
c)),c=null!=this.r.m)this.r.s=a}else if(c=this.match(0>c?z.substr(a,b,null):z.substr(a,b,c)))this.r.s=a,this.r.m.index+=b;return c},map:function(a,b){for(var c=0,e="";!(c>=a.length);){if(!this.matchSub(a,c)){e+=J.string(z.substr(a,c,null));break}var f=this.matchedPos();e+=J.string(z.substr(a,c,f.pos-c));e+=J.string(b(this));0==f.len?(e+=J.string(z.substr(a,f.pos,1)),c=f.pos+1):c=f.pos+f.len;if(!this.r.global)break}!this.r.global&&0<c&&c<a.length&&(e+=J.string(z.substr(a,c,null)));return e},__class__:da};
var z=function(){};h.HxOverrides=z;z.__name__=!0;z.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return a=a.split(" "),b=a[0].split("-"),a=a[1].split(":"),new Date(b[0],b[1]-1,b[2],a[0],a[1],a[2]);default:throw A.thrown("Invalid date format : "+a);}};z.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};z.substr=
function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};z.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};z.now=function(){return Date.now()};var C=function(a,b,c){this.errors=a;this.putils=b;this.errorType=c};h["json2object.reader.BaseParser"]=C;C.__name__=!0;C.prototype={fromJson:function(a,b){null==b&&(b="");this.putils=new Wd(a);this.errors=[];try{var c=(new Xd(a,b)).doParse();this.loadJson(c)}catch(e){if(ja.lastError=
e,a=A.caught(e).unwrap(),a instanceof Qb)this.errors.push(va.ParserError(a.message,this.putils.convertPosition(a.pos)));else throw e;}return this.value},loadJson:function(a,b){null==b&&(b="");var c=this.putils.convertPosition(a.pos);a=a.value;switch(a._hx_index){case 0:this.loadJsonString(a.s,c,b);break;case 1:this.loadJsonNumber(a.s,c,b);break;case 2:this.loadJsonObject(a.fields,c,b);break;case 3:this.loadJsonArray(a.values,c,b);break;case 4:this.loadJsonBool(a.b,c,b);break;case 5:this.loadJsonNull(c,
b)}return this.value},loadJsonNull:function(a,b){this.onIncorrectType(a,b)},loadJsonString:function(a,b,c){this.onIncorrectType(b,c)},loadJsonNumber:function(a,b,c){this.onIncorrectType(b,c)},loadJsonUInt:function(a,b,c,e){var f=0;a=U.trim(a);"-"==a.charAt(0)&&(a=z.substr(a,1,null));var g=U.startsWith(a,"0x");g&&(a=z.substr(a,2,null));for(var v=g?16:10,l=1,d=a.length-1;0<=d;){var h=g?J.parseInt("0x"+a.charAt(d)):J.parseInt(a.charAt(d));if(null==h)return this.onIncorrectType(b,c),e;f+=l*h;l*=v;--d}return f},
loadJsonInt:function(a,b,c,e){if(null!=J.parseInt(a)&&J.parseInt(a)==parseFloat(a))return J.parseInt(a);this.onIncorrectType(b,c);return e},loadJsonFloat:function(a,b,c,e){if(null!=J.parseInt(a))return parseFloat(a);this.onIncorrectType(b,c);return e},loadJsonBool:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArray:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArrayValue:function(a,b,c){for(var e=[],f=0;f<a.length;){var g=a[f];++f;try{var v=b(g,c)}catch(l){if(ja.lastError=l,g=A.caught(l).unwrap(),
ra.__instanceof(g,Db)){if(g!=Db.ParsingThrow)throw A.thrown(g);continue}else throw l;}e.push(v)}return e},loadJsonObject:function(a,b,c){this.onIncorrectType(b,c)},loadObjectField:function(a,b,c,e,f,g){try{var v=a(b.value,b.name);this.mapSet(e,c,!0);return v}catch(l){if(ja.lastError=l,a=A.caught(l).unwrap(),ra.__instanceof(a,Db)){if(a!=Db.ParsingThrow)throw A.thrown(a);}else this.errors.push(va.CustomFunctionException(a,g))}return f},objectSetupAssign:function(a,b,c){for(var e=0,f=b.length;e<f;){var g=
e++;this.mapSet(a,b[g],c[g])}},objectErrors:function(a,b){b=this.putils.convertPosition(new ka(b.file,b.max-1,b.max-1));for(var c=Object.keys(a.h),e=c.length,f=0;f<e;){var g=c[f++];a.h[g]||this.errors.push(va.UninitializedVariable(g,b))}},onIncorrectType:function(a,b){this.parsingThrow()},parsingThrow:function(){if(0!=this.errorType)throw A.thrown(Db.ParsingThrow);},mapSet:function(a,b,c){a.h[b]=c},__class__:C};var ea=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_0=ea;ea.__name__=
!0;ea.__super__=C;ea.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"peote.text.FontConfig",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new ha;this.objectSetupAssign(c,"packed distancefield kerning width height color bgColor line tiles rangeSplitSize ranges".split(" "),[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "bgColor":this.value.bgColor=
this.loadObjectField((n=new aa(this.errors,this.putils,1),d(n,n.loadJson)),f,"bgColor",c,this.value.bgColor,b);break;case "color":this.value.color=this.loadObjectField((n=new aa(this.errors,this.putils,1),d(n,n.loadJson)),f,"color",c,this.value.color,b);break;case "distancefield":this.value.distancefield=this.loadObjectField((n=new Wa(this.errors,this.putils,1),d(n,n.loadJson)),f,"distancefield",c,this.value.distancefield,b);break;case "height":this.value.height=this.loadObjectField((n=new Ca(this.errors,
this.putils,1),d(n,n.loadJson)),f,"height",c,this.value.height,b);break;case "kerning":this.value.kerning=this.loadObjectField((n=new Aa(this.errors,this.putils,1),d(n,n.loadJson)),f,"kerning",c,this.value.kerning,b);break;case "line":this.value.line=this.loadObjectField((n=new ba(this.errors,this.putils,1),d(n,n.loadJson)),f,"line",c,this.value.line,b);break;case "packed":this.value.packed=this.loadObjectField((n=new Wa(this.errors,this.putils,1),d(n,n.loadJson)),f,"packed",c,this.value.packed,b);
break;case "rangeSplitSize":this.value.rangeSplitSize=this.loadObjectField((n=new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"rangeSplitSize",c,this.value.rangeSplitSize,b);break;case "ranges":this.value.ranges=this.loadObjectField((n=new S(this.errors,this.putils,1),d(n,n.loadJson)),f,"ranges",c,this.value.ranges,b);break;case "tiles":this.value.tiles=this.loadObjectField((n=new fa(this.errors,this.putils,1),d(n,n.loadJson)),f,"tiles",c,this.value.tiles,b);break;case "width":this.value.width=
this.loadObjectField((n=new Ca(this.errors,this.putils,1),d(n,n.loadJson)),f,"width",c,this.value.width,b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(Yd.prototype);a.packed=!1;a.distancefield=!1;a.kerning=null;a.width=16;a.height=16;a.color=-1;a.bgColor=0;a.line=null;a.tiles=null;a.rangeSplitSize=4096;a.ranges=(new S([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1)));return a},
__class__:ea});var S=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_1=S;S.__name__=!0;S.__super__=C;S.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"Array<{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }>",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},
loadJsonArray:function(a,b,c){this.value=this.loadJsonArrayValue(a,(n=new Na(this.errors,this.putils,2),d(n,n.loadJson)),c)},__class__:S});var T=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c);this.value=0};h.JsonParser_10=T;T.__name__=!0;T.__super__=C;T.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"UInt",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonUInt(a,b,c,this.value)},__class__:T});var Na=
function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_11=Na;Na.__name__=!0;Na.__super__=C;Na.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,
b,c){c=new ha;this.objectSetupAssign(c,"data image line range slot tiles".split(" "),[!0,!1,!0,!1,!1,!0]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "data":this.value.data=this.loadObjectField((n=new Oa(this.errors,this.putils,1),d(n,n.loadJson)),f,"data",c,this.value.data,b);break;case "image":this.value.image=this.loadObjectField((n=new Xa(this.errors,this.putils,1),d(n,n.loadJson)),f,"image",c,this.value.image,b);break;case "line":this.value.line=this.loadObjectField((n=
new Ja(this.errors,this.putils,1),d(n,n.loadJson)),f,"line",c,this.value.line,b);break;case "range":this.value.range=this.loadObjectField((n=new Ua(this.errors,this.putils,1),d(n,n.loadJson)),f,"range",c,this.value.range,b);break;case "slot":this.value.slot=this.loadObjectField((n=new Da(this.errors,this.putils,1),d(n,n.loadJson)),f,"slot",c,this.value.slot,b);break;case "tiles":this.value.tiles=this.loadObjectField((n=new u(this.errors,this.putils,1),d(n,n.loadJson)),f,"tiles",c,this.value.tiles,
b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{data:(new Oa([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),image:(new Xa([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),line:(new Ja([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),range:(new Ua([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),slot:(new Da([],this.putils,0)).loadJson(new ma(za.JNull,
new ka("",0,1))),tiles:(new u([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1)))}},__class__:Na});var Oa=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_13=Oa;Oa.__name__=!0;Oa.__super__=C;Oa.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"String",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,b,c){this.value=a},__class__:Oa});var Xa=function(a,b,c){null==c&&
(c=0);C.call(this,a,b,c)};h.JsonParser_14=Xa;Xa.__name__=!0;Xa.__super__=C;Xa.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"String",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,b,c){this.value=a},__class__:Xa});var Ja=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_16=Ja;Ja.__name__=!0;Ja.__super__=C;Ja.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,
"{ height : Float, base : Float }",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new ha;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "base":this.value.base=this.loadObjectField((n=new Ca(this.errors,this.putils,1),d(n,n.loadJson)),f,"base",c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((n=new Ca(this.errors,
this.putils,1),d(n,n.loadJson)),f,"height",c,this.value.height,b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new Ca([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),height:(new Ca([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1)))}},__class__:Ja});var Ua=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_17=Ua;Ua.__name__=!0;Ua.__super__=C;Ua.prototype=
H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"peote.text.Range",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new ha;this.objectSetupAssign(c,["min","max"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "max":this.value.max=this.loadObjectField((n=new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"max",c,this.value.max,b);break;case "min":this.value.min=
this.loadObjectField((n=new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"min",c,this.value.min,b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(Zd.prototype);a.min=(new L([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1)));a.max=(new L([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1)));return a},__class__:Ua});var Da=function(a,b,c){null==c&&(c=0);C.call(this,
a,b,c)};h.JsonParser_18=Da;Da.__name__=!0;Da.__super__=C;Da.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"{ width : Int, height : Int }",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new ha;this.objectSetupAssign(c,["height","width"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "height":this.value.height=this.loadObjectField((n=
new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"height",c,this.value.height,b);break;case "width":this.value.width=this.loadObjectField((n=new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"width",c,this.value.width,b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{height:(new L([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),width:(new L([],this.putils,0)).loadJson(new ma(za.JNull,
new ka("",0,1)))}},__class__:Da});var Wa=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c);this.value=!1};h.JsonParser_2=Wa;Wa.__name__=!0;Wa.__super__=C;Wa.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"Bool",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonBool:function(a,b,c){this.value=a},__class__:Wa});var u=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_20=u;u.__name__=!0;u.__super__=C;u.prototype=H(C.prototype,{onIncorrectType:function(a,
b){this.errors.push(va.IncorrectType(b,"{ y : Int, x : Int }",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new ha;this.objectSetupAssign(c,["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "x":this.value.x=this.loadObjectField((n=new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((n=new L(this.errors,
this.putils,1),d(n,n.loadJson)),f,"y",c,this.value.y,b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new L([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),y:(new L([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1)))}},__class__:u});var Aa=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_4=Aa;Aa.__name__=!0;Aa.__super__=C;Aa.prototype=H(C.prototype,{onIncorrectType:function(a,
b){this.errors.push(va.IncorrectType(b,"Bool",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonBool:function(a,b,c){this.value=a},__class__:Aa});var Ca=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c);this.value=0};h.JsonParser_5=Ca;Ca.__name__=!0;Ca.__super__=C;Ca.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"Float",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=
this.loadJsonFloat(a,b,c,this.value)},__class__:Ca});var aa=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_6=aa;aa.__name__=!0;aa.__super__=C;aa.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"peote.view.Color",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=(new T(this.errors,this.putils,0)).loadJson(new ma(za.JNumber(a),new ka(b.file,b.min-1,b.max-1)),c)},__class__:aa});var ba=function(a,b,c){null==
c&&(c=0);C.call(this,a,b,c)};h.JsonParser_7=ba;ba.__name__=!0;ba.__super__=C;ba.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"{ height : Float, base : Float }",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new ha;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "base":this.value.base=this.loadObjectField((n=
new Ca(this.errors,this.putils,1),d(n,n.loadJson)),f,"base",c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((n=new Ca(this.errors,this.putils,1),d(n,n.loadJson)),f,"height",c,this.value.height,b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new Ca([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),height:(new Ca([],this.putils,0)).loadJson(new ma(za.JNull,
new ka("",0,1)))}},__class__:ba});var fa=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c)};h.JsonParser_8=fa;fa.__name__=!0;fa.__super__=C;fa.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"{ y : Int, x : Int }",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new ha;this.objectSetupAssign(c,["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "x":this.value.x=
this.loadObjectField((n=new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((n=new L(this.errors,this.putils,1),d(n,n.loadJson)),f,"y",c,this.value.y,b);break;default:this.errors.push(va.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new L([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",0,1))),y:(new L([],this.putils,0)).loadJson(new ma(za.JNull,new ka("",
0,1)))}},__class__:fa});var L=function(a,b,c){null==c&&(c=0);C.call(this,a,b,c);this.value=0};h.JsonParser_9=L;L.__name__=!0;L.__super__=C;L.prototype=H(C.prototype,{onIncorrectType:function(a,b){this.errors.push(va.IncorrectType(b,"Int",a));C.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonInt(a,b,c,this.value)},__class__:L});var G=function(){};h.ManifestResources=G;G.__name__=!0;G.init=function(a){G.preloadLibraries=[];G.preloadLibraryNames=[];G.rootPath=
null;null!=a&&Object.prototype.hasOwnProperty.call(a,"rootPath")&&(G.rootPath=B.field(a,"rootPath"));null==G.rootPath&&(G.rootPath="./");a=Eb.parse('{"name":null,"assets":"aoy4:pathy39:assets%2Ffonts%2Ftiled%2Fhack_ascii.pngy4:sizei12425y4:typey5:IMAGEy2:idR1y7:preloadtgoR0y40:assets%2Ffonts%2Ftiled%2Fhack_ascii.jsonR2i1258R3y4:TEXTR5R7R6tgoR0y27:assets%2Fimages%2Freadme.mdR2i225R3R8R5R9R6tgoR0y38:assets%2Fimages%2Fbit-bonanza-food.pngR2i25790R3R4R5R10R6tgh","rootPath":null,"version":2,"libraryArgs":[],"libraryType":null}',
G.rootPath);a=Wb.fromManifest(a);Z.registerLibrary("default",a);a=Z.getLibrary("default");null!=a?G.preloadLibraries.push(a):G.preloadLibraryNames.push("default")};Math.__name__=!0;var B=function(){};h.Reflect=B;B.__name__=!0;B.field=function(a,b){try{return a[b]}catch(c){return ja.lastError=c,null}};B.getProperty=function(a,b){var c;if(null==a)return null;var e=a.__properties__?c=a.__properties__["get_"+b]:!1;return e?a[c]():a[b]};B.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,
e;for(e in a)"__id__"!=e&&"hx__closures__"!=e&&c.call(a,e)&&b.push(e)}return b};B.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};B.compareMethods=function(a,b){return a==b?!0:B.isFunction(a)&&B.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};B.copy=function(a){if(null==a)return null;for(var b={},c=0,e=B.fields(a);c<e.length;){var f=e[c];++c;b[f]=B.field(a,f)}return b};var J=function(){};h.Std=J;J.__name__=!0;J.string=function(a){return ra.__string_rec(a,
"")};J.parseInt=function(a){if(null!=a)for(var b=0,c=a.length;b<c;){var e=b++,f=a.charCodeAt(e);if(8>=f||14<=f&&32!=f&&45!=f)if(b=a.charCodeAt(e+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};var qa=function(){};h["_String.String_Impl_"]=qa;qa.__name__=!0;qa.fromCharCode=function(a){return String.fromCodePoint(a)};var Fa=function(){this.b=""};h.StringBuf=Fa;Fa.__name__=!0;Fa.prototype={__class__:Fa};var U=function(){};h.StringTools=U;U.__name__=!0;U.startsWith=function(a,
b){return a.length>=b.length?0==a.lastIndexOf(b,0):!1};U.endsWith=function(a,b){var c=b.length,e=a.length;return e>=c?a.indexOf(b,e-c)==e-c:!1};U.isSpace=function(a,b){a=z.cca(a,b);return 8<a&&14>a?!0:32==a};U.ltrim=function(a){for(var b=a.length,c=0;c<b&&U.isSpace(a,c);)++c;return 0<c?z.substr(a,c,b-c):a};U.rtrim=function(a){for(var b=a.length,c=0;c<b&&U.isSpace(a,b-c-1);)++c;return 0<c?z.substr(a,0,b-c):a};U.trim=function(a){return U.ltrim(U.rtrim(a))};U.replace=function(a,b,c){return a.split(b).join(c)};
var m=function(){};h.Type=m;m.__name__=!0;m.createInstance=function(a,b){return new (Function.prototype.bind.apply(a,[null].concat(b)))};m.createEnum=function(a,b,c){var e=B.field(a,b);if(null==e)throw A.thrown("No such constructor "+b);if(B.isFunction(e)){if(null==c)throw A.thrown("Constructor "+b+" need parameters");return e.apply(a,c)}if(null!=c&&0!=c.length)throw A.thrown("Constructor "+b+" does not need parameters");return e};var db={toFloat:function(a){return 0>a?4294967296+a:a+0}},K=function(){};
h["echo.util.Disposable"]=K;K.__name__=!0;K.__isInterface__=!0;var x=function(a){this.transform=new Bc;this.layer_mask=Re._new();this.layers=Re._new();var b=new P(0,0);this.drag=b;this.max_velocity=b=new P(0,0);this.torque=0;this.acceleration=b=new P(0,0);this.velocity=b=new P(0,0);this.material=fc.global;this.id=++x.ids;this.active=!0;this.shapes=[];this.data={};this.disposed=!1;this.transform.on_dirty=d(this,this.on_dirty);this.load_options(a)};h["echo.Body"]=x;x.__name__=!0;x.__interfaces__=[K];
x.__properties__={get_defaults:"get_defaults"};x.get_defaults=function(){return{kinematic:!1,mass:x.default_mass,x:0,y:0,rotation:0,scale_x:1,scale_y:1,velocity_x:0,velocity_y:0,rotational_velocity:0,max_velocity_x:0,max_velocity_y:0,max_velocity_length:0,max_rotational_velocity:1E4,drag_x:0,drag_y:0,drag_length:0,rotational_drag:0}};x.prototype={load_options:function(a){a=bd.copy_fields(a,x.get_defaults());for(var b=0,c=this.shapes;b<c.length;){var e=c[b];++b;e.put()}this.shapes.length=0;c=a.x;b=
this.transform;b.dirty||b.set_dirty();b.local_x=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);c=a.y;b=this.transform;b.dirty||b.set_dirty();b.local_y=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);b=this.transform;c=Math.PI/180*a.rotation;b.dirty||b.set_dirty();b.local_radians=c;if(null!=this.on_rotate)this.on_rotate(180/Math.PI*this.transform.local_radians);c=a.scale_x;b=this.transform;b.dirty||b.set_dirty();b.local_scale_x=
c;c=a.scale_y;b=this.transform;b.dirty||b.set_dirty();b.local_scale_y=c;this.kinematic=a.kinematic;this.material=null!=a.material?a.material:null!=a.gravity_scale||null!=a.elasticity?new fc(a.elasticity,null,null,null,a.gravity_scale):fc.global;c=this.velocity;c.x=a.velocity_x;c.y=a.velocity_y;this.rotational_velocity=a.rotational_velocity;c=this.max_velocity;c.x=a.max_velocity_x;c.y=a.max_velocity_y;this.max_velocity_length=a.max_velocity_length;this.max_rotational_velocity=a.max_rotational_velocity;
c=this.drag;c.x=a.drag_x;c.y=a.drag_y;this.drag_length=a.drag_length;this.rotational_drag=a.rotational_drag;this.last_rotation=this.last_y=this.last_x=NaN;this.dirty=!0;if(null!=a.shape){e=Ea.get(a.shape);var f=-1;null==f&&(f=-1);-1==this.shapes.indexOf(e)&&(-1<f?this.shapes[f]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)))}if(null!=a.shapes)for(b=0,c=a.shapes;b<
c.length;)e=c[b],++b,e=Ea.get(e),f=-1,null==f&&(f=-1),-1==this.shapes.indexOf(e)&&(-1<f?this.shapes[f]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));null!=a.shape_instance&&(e=a.shape_instance,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))));
if(null!=a.shape_instances)for(b=0,c=a.shape_instances;b<c.length;)e=c[b],++b,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));b=a.mass;if(null==b)c=a.mass,c<x.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&
null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);else switch(b){case -1:b=a=0;for(c=this.shapes;b<c.length;)e=c[b],++b,a+=e.volume()*this.material.density;a<x.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=a,this.inverse_mass=
1/this.mass);break;case 0:c=0;c<x.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);break;default:c=a.mass,c<x.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):
(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass)}},set_position:function(a,b){null==b&&(b=0);null==a&&(a=0);var c=this.transform;null==b&&(b=0);null==a&&(a=0);c.dirty||c.set_dirty();c.local_x=a;c.dirty||c.set_dirty();c.local_y=b},bounds:function(a){if(0==this.shapes.length){var b=this.transform.local_x,c=this.transform.local_y,e=1,f=1;null==f&&(f=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);a=hb.pool.get();var g=b;
null==f&&(f=1);null==e&&(e=1);null==c&&(c=0);null==g&&(g=0);e*=.5;f*=.5;a.min_x=g-e;a.min_y=c-f;a.max_x=g+e;a.max_y=c+f;a.pooled=!1;return a}g=this.shapes[0].bounds();if(1<this.shapes.length)for(f=1,e=this.shapes.length;f<e;)c=f++,c=this.shapes[c].bounds(),g.min_x>c.min_x&&(g.min_x=c.min_x),g.min_y>c.min_y&&(g.min_y=c.min_y),g.max_x<c.max_x&&(g.max_x=c.max_x),g.max_y<c.max_y&&(g.max_y=c.max_y),c.put();null==a&&(a=hb.pool.get(),c=b=0,f=e=1,null==f&&(f=1),null==e&&(e=1),null==c&&(c=0),null==b&&(b=0),
e*=.5,f*=.5,a.min_x=b-e,a.min_y=c-f,a.max_x=b+e,a.max_y=c+f,a.pooled=!1);a.min_x=g.min_x;a.max_x=g.max_x;a.min_y=g.min_y;a.max_y=g.max_y;g.put();return a},on_dirty:function(a){this.dirty=!0;0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))},__class__:x};var na=function(){};h["echo.Collisions"]=na;na.__name__=!0;na.update_quadtree=function(a){for(var b=0,c=a.members;b<c.length;){var e=c[b];++b;if(!e.disposed){e.collided=!1;
for(var f=0,g=e.shapes;f<g.length;){var v=g[f];++f;v.collided=!1}e.active&&0<e.mass&&e.dirty&&0<e.shapes.length&&(null==e.quadtree_data.bounds?e.quadtree_data.bounds=e.bounds():e.bounds(e.quadtree_data.bounds),a.quadtree.update(e.quadtree_data,!1),e.dirty=!1)}}a.quadtree.shake()};na.query=function(a,b){na.update_quadtree(a);b=null==b?a.listeners.members:b.members;for(var c=0;c<b.length;){var e=b[c];++c;e.quadtree_results.length=0;var f=e.a;switch(f._hx_index){case 0:f=f.v;var g=e.b;switch(g._hx_index){case 0:f=
na.overlap_body_and_body_bounds(f,g.v);null!=f&&e.quadtree_results.push(f);break;case 1:na.overlap_body_and_bodies_bounds(f,g.v,a,e.quadtree_results)}break;case 1:switch(f=f.v,g=e.b,g._hx_index){case 0:na.overlap_body_and_bodies_bounds(g.v,f,a,e.quadtree_results);break;case 1:g=g.v,na.overlap_bodies_and_bodies_bounds(f,g,a,e.quadtree_results),f!=g&&na.overlap_bodies_and_bodies_bounds(g,f,a,e.quadtree_results)}}f=0;for(g=e.last_collisions;f<g.length;){var v=g[f];++f;v.put()}e.last_collisions.length=
e.collisions.length;f=0;for(g=e.collisions.length;f<g;)v=f++,e.last_collisions[v]=e.collisions[v];f=e.collisions.length=0;for(g=e.quadtree_results;f<g.length;)if(v=g[f],++f,v.a.disposed||v.b.disposed)v.put();else if(v.a.id==v.b.id)v.put();else{for(var l=!1,d=0,h=e.collisions;d<h.length;){var N=h[d];++d;if(N.a.id==v.a.id&&N.b.id==v.b.id||N.b.id==v.a.id&&N.a.id==v.b.id){l=!0;break}}if(l)v.put();else{if(1==v.a.shapes.length&&1==v.b.shapes.length)l=v.a.shapes[0].collides(v.b.shapes[0]),null!=l&&v.data.push(l);
else for(l=v.a.shapes,d=0,h=l.length;d<h;){N=d++;for(var t=v.b.shapes,m=l[N].bounds(),n=0,x=t.length;n<x;){var p=n++,K=t[p].bounds();m.min_x<K.max_x&&m.max_x>=K.min_x&&m.min_y<K.max_y&&m.max_y>=K.min_y&&(p=l[N].collides(t[p]),null!=p&&v.data.push(p));K.put()}m.put()}if(0==v.data.length)v.put();else if(null==e.condition||e.condition(v.a,v.b,v.data)&&!v.a.disposed&&!v.b.disposed){l=0;for(d=v.data;l<d.length;)h=d[l],++l,h.sa.collided=h.sb.collided=!0;v.a.collided=v.b.collided=!0;e.collisions.push(v)}else v.put()}}}};
na.notify=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(null!=c.enter||null!=c.stay)for(var e=0,f=c.collisions;e<f.length;){var g=f[e];++e;if(!g.a.disposed&&!g.b.disposed){if(null!=c.enter){var v=!1;for(var l=0,d=c.last_collisions;l<d.length;){var h=d[l];++l;if(h.a==g.a&&h.b==g.b||h.a==g.b&&h.b==g.a){v=!0;break}}v=!v}else v=!1;v?c.enter(g.a,g.b,g.data):null!=c.stay&&c.stay(g.a,g.b,g.data)}}if(null!=c.exit)for(e=0,f=c.last_collisions;e<f.length;){g=f[e];
++e;if(g.a.disposed||g.b.disposed)v=!1;else{v=!1;l=0;for(d=c.collisions;l<d.length;)if(h=d[l],++l,h.a==g.a&&h.b==g.b||h.a==g.b&&h.b==g.a){v=!0;break}v=!v}v&&c.exit(g.a,g.b)}}};na.overlap_bodies_and_bodies_bounds=function(a,b,c,e){if(0!=a.length&&0!=b.length)for(var f=0;f<a.length;){var g=a[f];++f;na.overlap_body_and_bodies_bounds(g,b,c,e)}};na.overlap_body_and_bodies_bounds=function(a,b,c,e){if(!(a.disposed||0==a.shapes.length||!a.active||0>=a.mass)){var f=a.bounds();na.qr.length=0;na.sqr.length=
0;c.quadtree.query(f,na.qr);c.static_quadtree.query(f,na.sqr);for(c=0;c<b.length;){var g=b[c];++c;if(!g.disposed&&0!=g.shapes.length&&g.active&&(0==a.layer_mask||0==g.layer_mask||0!=(a.layer_mask&g.layers)&&0!=(g.layer_mask&a.layers)))for(var v=0,l=0<g.mass?na.qr:na.sqr;v<l.length;){var d=l[v];++v;d.id==g.id&&(d=pc.pool.get(),d.a=a,d.b=g,d.data.length=0,d.pooled=!1,e.push(d))}}f.put()}};na.overlap_body_and_body_bounds=function(a,b){if(a.disposed||b.disposed||0==a.shapes.length||0==b.shapes.length||
!a.active||!b.active||a==b||0!=a.layer_mask&&0!=b.layer_mask&&(0==(a.layer_mask&b.layers)||0==(b.layer_mask&a.layers))||0>=a.mass&&0>=b.mass)return null;var c=a.bounds(),e=b.bounds(),f=c.min_x<e.max_x&&c.max_x>=e.min_x&&c.min_y<e.max_y&&c.max_y>=e.min_y;c.put();e.put();return f?(c=pc.pool.get(),c.a=a,c.b=b,c.data.length=0,c.pooled=!1,c):null};var xa=function(a){this.members=null==a?[]:a};h["echo.Listeners"]=xa;xa.__name__=!0;xa.__interfaces__=[K];xa.prototype={add:function(a,b,c){c=bd.copy_fields(c,
eb.get_defaults());a=new eb(a,b,c.separate,[],[],null,null,null,null,[],c.percent_correction,c.correction_threshold);null!=c.enter&&(a.enter=c.enter);null!=c.stay&&(a.stay=c.stay);null!=c.exit&&(a.exit=c.exit);null!=c.condition&&(a.condition=c.condition);this.members.push(a);return a},clear:function(){this.members.length=0},__class__:xa};var V=k.echo.Echo=function(){};h["echo.Echo"]=V;V.__name__=!0;V.start=function(a){return new Sc(a)};V.make=function(a,b){return a.add(new x(b))};V.listen=function(a,
b,c,e){return null==b?null==c?a.listeners.add(Cc.Right(a.members),Cc.Right(a.members),e):a.listeners.add(c,c,e):null==c?a.listeners.add(b,b,e):a.listeners.add(b,c,e)};V.check=function(a,b,c,e){V.cached_listeners.clear();null==b&&null==c?V.cached_listeners.add(Cc.Right(a.members),Cc.Right(a.members),e):null==b?V.cached_listeners.add(c,c,e):null==c?V.cached_listeners.add(b,b,e):V.cached_listeners.add(b,c,e);na.query(a,V.cached_listeners);Dc.separate(a,V.cached_listeners);na.notify(a,V.cached_listeners)};
V.step=function(a,b){if(null!=a.history){for(var c=a.history,e=[],f=0,g=a.members;f<g.length;){var v=g[f];++f;e.push(new Xc(v.id,v.transform.local_x,v.transform.local_y,180/Math.PI*v.transform.local_radians,v.velocity.x,v.velocity.y,v.acceleration.x,v.acceleration.y,v.rotational_velocity))}c.add(e)}b/=a.iterations;e=0;for(f=a.iterations;e<f;)e++,Dc.step(a,b),na.query(a),Dc.separate(a),na.notify(a)};V.linecast_floats=function(a,b,c,e,f,g,v){null==v&&(v=!0);null==e&&(e=1);null==c&&(c=1);null==b&&(b=
0);null==a&&(a=0);var l=Jb.pool.get();null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=l.start;d.x=a;d.y=b;d=l.end;d.x=c;d.y=e;l.pooled=!1;f=V.linecast(l,f,g,v);l.pooled||(l.pooled=!0,Jb.pool.put_unsafe(l));return f};V.linecast_vector=function(a,b,c,e,f,g){null==g&&(g=!0);var v=Jb.pool.get();v.set_from_vector(a,b,c);v.pooled=!1;a=V.linecast(v,e,f,g);v.pooled||(v.pooled=!0,Jb.pool.put_unsafe(v));return a};V.linecast_vectors=function(a,b,c,e,f){f=a.x;var g=a.y;a=b.x;var v=b.y;null==
v&&(v=1);null==a&&(a=1);null==g&&(g=0);null==f&&(f=0);b=Jb.pool.get();null==v&&(v=1);null==a&&(a=1);null==g&&(g=0);null==f&&(f=0);var l=b.start;l.x=f;l.y=g;l=b.end;l.x=a;l.y=v;b.pooled=!1;c=V.linecast(b,c,e);b.pooled||(b.pooled=!0,Jb.pool.put_unsafe(b));return c};V.linecast=function(a,b,c,e){null==e&&(e=!0);var f=null,g=Math.min(a.start.x,a.end.x),v=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),h=hb.pool.get();h.min_x=g;h.max_x=l;h.min_y=v;h.max_y=d;h.pooled=
!1;var N=b;switch(N._hx_index){case 0:var t=N.v;if(!t.disposed&&t.active){var m=t.bounds();if(h.min_x<m.max_x&&h.max_x>=m.min_x&&h.min_y<m.max_y&&h.max_y>=m.min_y){var n=0;for(e=t.shapes.length;n<e;)v=n++,g=t.shapes[v].intersect(a),null!=g&&(null==f&&(v=Rb.pool.get(),v.line=a,v.body=t,v.data.length=0,v.pooled=!1,f=v),f.data.push(g))}m.put()}break;case 1:if(b=N.v,null==c)for(N=0;N<b.length;){if(t=b[N],++N,null!=t&&!t.disposed&&t.active){m=t.bounds();v=Rb.pool.get();v.line=a;v.body=t;v.data.length=
0;v.pooled=!1;c=v;if(h.min_x<m.max_x&&h.max_x>=m.min_x&&h.min_y<m.max_y&&h.max_y>=m.min_y)for(n=0,e=t.shapes.length;n<e;)v=n++,g=t.shapes[v].intersect(a),null!=g&&c.data.push(g);m.put();if(0<c.data.length)if(null!=f){if(0==f.data.length)g=null;else if(1==f.data.length)g=f.data[0];else{m=f.data[0];t=1;for(g=f.data.length;t<g;)v=t++,null!=f.data[v]&&f.data[v].distance<m.distance&&(m=f.data[v]);g=m}m=g.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{t=c.data[0];e=1;for(g=
c.data.length;e<g;)v=e++,null!=c.data[v]&&c.data[v].distance<t.distance&&(t=c.data[v]);e=t}g=m>e.distance}else g=!0;else g=!1;g?(null!=f&&f.put(),f=c):c.put()}}else{N=0;for(n=V.cached_collisions;N<n.length;)m=n[N],++N,m.put();V.cached_collisions.length=0;m=V.cached_body;g=h.min_x;v=h.min_y;l=h.max_x;d=h.max_y;t=Kb.pool.get();N=.5*(g+l);n=.5*(v+d);g=l-g;d-=v;null==d&&(d=0);null==g&&(g=1);null==n&&(n=0);null==N&&(N=0);l=t.transform;l.dirty||l.set_dirty();l.local_x=N;l=t.transform;l.dirty||l.set_dirty();
l.local_y=n;N=.5*g;l=t.transform;null==l.parent?n=l.local_scale_x:(l.sync(),n=l._scale_x);t.local_ex=N/n;if(null!=t.transformed_rect){l=t.transformed_rect;l.count=4;N=0;for(n=l.count;N<n;)if(v=N++,null==l.local_vertices[v]){var x=l.local_vertices,p=new P(0,0);x[v]=p}N=l.local_vertices[0];N.x=-(t.local_ex*t.transform.local_scale_x);N.y=-(t.local_ey*t.transform.local_scale_y);N=l.local_vertices[1];N.x=t.local_ex*t.transform.local_scale_x;N.y=-(t.local_ey*t.transform.local_scale_y);N=l.local_vertices[2];
N.x=t.local_ex*t.transform.local_scale_x;N.y=t.local_ey*t.transform.local_scale_y;N=l.local_vertices[3];N.x=-(t.local_ex*t.transform.local_scale_x);N.y=t.local_ey*t.transform.local_scale_y;N=t.transform.local_x;x=l.transform;x.dirty||x.set_dirty();x.local_x=N;N=t.transform.local_y;x=l.transform;x.dirty||x.set_dirty();x.local_y=N;x=l.transform;N=Math.PI/180*(180/Math.PI)*t.transform.local_radians;x.dirty||x.set_dirty();x.local_radians=N;N=t.transform.local_scale_x;x=l.transform;x.dirty||x.set_dirty();
x.local_scale_x=N;N=t.transform.local_scale_y;x=l.transform;x.dirty||x.set_dirty();x.local_scale_y=N;l.dirty_vertices=!0;l.dirty_bounds=!0}N=.5*(0>=d?g:d);l=t.transform;null==l.parent?n=l.local_scale_y:(l.sync(),n=l._scale_y);t.local_ey=N/n;if(null!=t.transformed_rect){l=t.transformed_rect;l.count=4;N=0;for(n=l.count;N<n;)v=N++,null==l.local_vertices[v]&&(x=l.local_vertices,p=new P(0,0),x[v]=p);N=l.local_vertices[0];N.x=-(t.local_ex*t.transform.local_scale_x);N.y=-(t.local_ey*t.transform.local_scale_y);
N=l.local_vertices[1];N.x=t.local_ex*t.transform.local_scale_x;N.y=-(t.local_ey*t.transform.local_scale_y);N=l.local_vertices[2];N.x=t.local_ex*t.transform.local_scale_x;N.y=t.local_ey*t.transform.local_scale_y;N=l.local_vertices[3];N.x=-(t.local_ex*t.transform.local_scale_x);N.y=t.local_ey*t.transform.local_scale_y;N=t.transform.local_x;x=l.transform;x.dirty||x.set_dirty();x.local_x=N;N=t.transform.local_y;x=l.transform;x.dirty||x.set_dirty();x.local_y=N;x=l.transform;N=Math.PI/180*(180/Math.PI)*
t.transform.local_radians;x.dirty||x.set_dirty();x.local_radians=N;N=t.transform.local_scale_x;x=l.transform;x.dirty||x.set_dirty();x.local_scale_x=N;N=t.transform.local_scale_y;x=l.transform;x.dirty||x.set_dirty();x.local_scale_y=N;l.dirty_vertices=!0;l.dirty_bounds=!0}l=t.transform;N=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=N;l=t.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=t.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==t.transformed_rect?(l=t.transform,null==l.parent?
g=180/Math.PI*l.local_radians:(l.sync(),g=180/Math.PI*l._radians),g=0!=g):g=!1;if(g){g=Ra.pool.get();g.count=4;N=0;for(n=g.count;N<n;)v=N++,null==g.local_vertices[v]&&(d=g.local_vertices,p=new P(0,0),d[v]=p);N=g.local_vertices[0];N.x=-(t.local_ex*t.transform.local_scale_x);N.y=-(t.local_ey*t.transform.local_scale_y);N=g.local_vertices[1];N.x=t.local_ex*t.transform.local_scale_x;N.y=-(t.local_ey*t.transform.local_scale_y);N=g.local_vertices[2];N.x=t.local_ex*t.transform.local_scale_x;N.y=t.local_ey*
t.transform.local_scale_y;N=g.local_vertices[3];N.x=-(t.local_ex*t.transform.local_scale_x);N.y=t.local_ey*t.transform.local_scale_y;N=t.transform.local_x;l=g.transform;l.dirty||l.set_dirty();l.local_x=N;N=t.transform.local_y;l=g.transform;l.dirty||l.set_dirty();l.local_y=N;l=g.transform;N=Math.PI/180*(180/Math.PI)*t.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=N;N=t.transform.local_scale_x;l=g.transform;l.dirty||l.set_dirty();l.local_scale_x=N;N=t.transform.local_scale_y;l=g.transform;
l.dirty||l.set_dirty();l.local_scale_y=N;g.dirty_vertices=!0;g.dirty_bounds=!0;g.pooled=!1;t.transformed_rect=g;t.transformed_rect.set_parent(t.parent)}else null!=t.transformed_rect&&(N=t.transform.local_x,l=t.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_x=N,N=t.transform.local_y,l=t.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=N,l=t.transformed_rect.transform,N=Math.PI/180*(180/Math.PI)*t.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=N,N=t.transform.local_scale_x,
l=t.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_x=N,N=t.transform.local_scale_y,l=t.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=N);t.pooled=!1;null!=m.shapes[0]&&m.shapes[0].put();m.shapes[0]=t;m.shapes[0].set_parent(m);m.dirty=!0;0>=m.mass&&null!=m.world&&(m.bounds(m.quadtree_data.bounds),m.world.static_quadtree.update(m.quadtree_data));e&&na.update_quadtree(c);na.overlap_body_and_bodies_bounds(V.cached_body,b,c,V.cached_collisions);N=0;for(n=V.cached_collisions;N<
n.length;){m=n[N];++N;t=m.b;v=Rb.pool.get();v.line=a;v.body=t;v.data.length=0;v.pooled=!1;c=v;e=0;for(t=m.b.shapes.length;e<t;)v=e++,g=m.b.shapes[v].intersect(a),null!=g&&c.data.push(g);if(0<c.data.length)if(null!=f){if(0==f.data.length)g=null;else if(1==f.data.length)g=f.data[0];else{m=f.data[0];g=1;for(e=f.data.length;g<e;)v=g++,null!=f.data[v]&&f.data[v].distance<m.distance&&(m=f.data[v]);g=m}m=g.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{t=c.data[0];g=1;for(b=
c.data.length;g<b;)v=g++,null!=c.data[v]&&c.data[v].distance<t.distance&&(t=c.data[v]);e=t}g=m>e.distance}else g=!0;else g=!1;g?(null!=f&&f.put(),f=c):c.put()}V.cached_body.shapes[0].put()}}h.put();return f};V.linecast_all=function(a,b,c,e){null==e&&(e=!0);var f=[],g=Math.min(a.start.x,a.end.x),v=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),h=hb.pool.get();h.min_x=g;h.max_x=l;h.min_y=v;h.max_y=d;h.pooled=!1;var m=b;switch(m._hx_index){case 0:var t=m.v;v=
Rb.pool.get();v.line=a;v.body=t;v.data.length=0;v.pooled=!1;c=v;var n=t.bounds();if(h.min_x<n.max_x&&h.max_x>=n.min_x&&h.min_y<n.max_y&&h.max_y>=n.min_y){var x=0;for(e=t.shapes.length;x<e;)v=x++,v=t.shapes[v].intersect(a),null!=v&&c.data.push(v)}n.put();0<c.data.length?f.push(c):c.put();break;case 1:if(b=m.v,null==c)for(m=0;m<b.length;){if(t=b[m],++m,null!=t){n=t.bounds();v=Rb.pool.get();v.line=a;v.body=t;v.data.length=0;v.pooled=!1;c=v;if(h.min_x<n.max_x&&h.max_x>=n.min_x&&h.min_y<n.max_y&&h.max_y>=
n.min_y)for(x=0,e=t.shapes.length;x<e;)v=x++,v=t.shapes[v].intersect(a),null!=v&&c.data.push(v);n.put();0<c.data.length?f.push(c):c.put()}}else{m=0;for(x=V.cached_collisions;m<x.length;)n=x[m],++m,n.put();V.cached_collisions.length=0;n=V.cached_body;g=h.min_x;v=h.min_y;l=h.max_x;d=h.max_y;t=Kb.pool.get();m=.5*(g+l);x=.5*(v+d);g=l-g;d-=v;null==d&&(d=0);null==g&&(g=1);null==x&&(x=0);null==m&&(m=0);l=t.transform;l.dirty||l.set_dirty();l.local_x=m;l=t.transform;l.dirty||l.set_dirty();l.local_y=x;m=.5*
g;l=t.transform;null==l.parent?x=l.local_scale_x:(l.sync(),x=l._scale_x);t.local_ex=m/x;if(null!=t.transformed_rect){l=t.transformed_rect;l.count=4;m=0;for(x=l.count;m<x;)if(v=m++,null==l.local_vertices[v]){var p=l.local_vertices,K=new P(0,0);p[v]=K}m=l.local_vertices[0];m.x=-(t.local_ex*t.transform.local_scale_x);m.y=-(t.local_ey*t.transform.local_scale_y);m=l.local_vertices[1];m.x=t.local_ex*t.transform.local_scale_x;m.y=-(t.local_ey*t.transform.local_scale_y);m=l.local_vertices[2];m.x=t.local_ex*
t.transform.local_scale_x;m.y=t.local_ey*t.transform.local_scale_y;m=l.local_vertices[3];m.x=-(t.local_ex*t.transform.local_scale_x);m.y=t.local_ey*t.transform.local_scale_y;m=t.transform.local_x;p=l.transform;p.dirty||p.set_dirty();p.local_x=m;m=t.transform.local_y;p=l.transform;p.dirty||p.set_dirty();p.local_y=m;p=l.transform;m=Math.PI/180*(180/Math.PI)*t.transform.local_radians;p.dirty||p.set_dirty();p.local_radians=m;m=t.transform.local_scale_x;p=l.transform;p.dirty||p.set_dirty();p.local_scale_x=
m;m=t.transform.local_scale_y;p=l.transform;p.dirty||p.set_dirty();p.local_scale_y=m;l.dirty_vertices=!0;l.dirty_bounds=!0}m=.5*(0>=d?g:d);l=t.transform;null==l.parent?x=l.local_scale_y:(l.sync(),x=l._scale_y);t.local_ey=m/x;if(null!=t.transformed_rect){l=t.transformed_rect;l.count=4;m=0;for(x=l.count;m<x;)v=m++,null==l.local_vertices[v]&&(p=l.local_vertices,K=new P(0,0),p[v]=K);m=l.local_vertices[0];m.x=-(t.local_ex*t.transform.local_scale_x);m.y=-(t.local_ey*t.transform.local_scale_y);m=l.local_vertices[1];
m.x=t.local_ex*t.transform.local_scale_x;m.y=-(t.local_ey*t.transform.local_scale_y);m=l.local_vertices[2];m.x=t.local_ex*t.transform.local_scale_x;m.y=t.local_ey*t.transform.local_scale_y;m=l.local_vertices[3];m.x=-(t.local_ex*t.transform.local_scale_x);m.y=t.local_ey*t.transform.local_scale_y;m=t.transform.local_x;p=l.transform;p.dirty||p.set_dirty();p.local_x=m;m=t.transform.local_y;p=l.transform;p.dirty||p.set_dirty();p.local_y=m;p=l.transform;m=Math.PI/180*(180/Math.PI)*t.transform.local_radians;
p.dirty||p.set_dirty();p.local_radians=m;m=t.transform.local_scale_x;p=l.transform;p.dirty||p.set_dirty();p.local_scale_x=m;m=t.transform.local_scale_y;p=l.transform;p.dirty||p.set_dirty();p.local_scale_y=m;l.dirty_vertices=!0;l.dirty_bounds=!0}l=t.transform;m=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=m;l=t.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=t.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==t.transformed_rect?(l=t.transform,null==l.parent?m=180/Math.PI*l.local_radians:
(l.sync(),m=180/Math.PI*l._radians),m=0!=m):m=!1;if(m){g=Ra.pool.get();g.count=4;m=0;for(x=g.count;m<x;)v=m++,null==g.local_vertices[v]&&(d=g.local_vertices,K=new P(0,0),d[v]=K);m=g.local_vertices[0];m.x=-(t.local_ex*t.transform.local_scale_x);m.y=-(t.local_ey*t.transform.local_scale_y);m=g.local_vertices[1];m.x=t.local_ex*t.transform.local_scale_x;m.y=-(t.local_ey*t.transform.local_scale_y);m=g.local_vertices[2];m.x=t.local_ex*t.transform.local_scale_x;m.y=t.local_ey*t.transform.local_scale_y;m=
g.local_vertices[3];m.x=-(t.local_ex*t.transform.local_scale_x);m.y=t.local_ey*t.transform.local_scale_y;m=t.transform.local_x;l=g.transform;l.dirty||l.set_dirty();l.local_x=m;m=t.transform.local_y;l=g.transform;l.dirty||l.set_dirty();l.local_y=m;l=g.transform;m=Math.PI/180*(180/Math.PI)*t.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=m;m=t.transform.local_scale_x;l=g.transform;l.dirty||l.set_dirty();l.local_scale_x=m;m=t.transform.local_scale_y;l=g.transform;l.dirty||l.set_dirty();
l.local_scale_y=m;g.dirty_vertices=!0;g.dirty_bounds=!0;g.pooled=!1;t.transformed_rect=g;t.transformed_rect.set_parent(t.parent)}else null!=t.transformed_rect&&(m=t.transform.local_x,l=t.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_x=m,m=t.transform.local_y,l=t.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=m,l=t.transformed_rect.transform,m=Math.PI/180*(180/Math.PI)*t.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=m,m=t.transform.local_scale_x,l=t.transformed_rect.transform,
l.dirty||l.set_dirty(),l.local_scale_x=m,m=t.transform.local_scale_y,l=t.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=m);t.pooled=!1;null!=n.shapes[0]&&n.shapes[0].put();n.shapes[0]=t;n.shapes[0].set_parent(n);n.dirty=!0;0>=n.mass&&null!=n.world&&(n.bounds(n.quadtree_data.bounds),n.world.static_quadtree.update(n.quadtree_data));e&&na.update_quadtree(c);na.overlap_body_and_bodies_bounds(V.cached_body,b,c,V.cached_collisions);m=0;for(x=V.cached_collisions;m<x.length;){n=x[m];++m;
t=n.b;v=Rb.pool.get();v.line=a;v.body=t;v.data.length=0;v.pooled=!1;c=v;e=0;for(b=n.b.shapes.length;e<b;)v=e++,v=n.b.shapes[v].intersect(a),null!=v&&c.data.push(v);0<c.data.length?f.push(c):c.put()}V.cached_body.shapes[0].put()}}h.put();return f};V.undo=function(a){if(null!=a.history){var b=a.history.undo();if(null!=b){for(var c=0;c<b.length;){var e=b[c];++c;for(var f=0,g=a.members;f<g.length;){var v=g[f];++f;if(e.id==v.id){var l=e.x,d=v.transform;d.dirty||d.set_dirty();d.local_x=l;if(null!=v.on_move)v.on_move(v.transform.local_x,
v.transform.local_y);l=e.y;d=v.transform;d.dirty||d.set_dirty();d.local_y=l;if(null!=v.on_move)v.on_move(v.transform.local_x,v.transform.local_y);l=v.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();l.local_radians=d;if(null!=v.on_rotate)v.on_rotate(180/Math.PI*v.transform.local_radians);l=v.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=v.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;v.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}}return a};V.redo=function(a){if(null!=
a.history){var b=a.history.redo();if(null!=b)for(var c=0;c<b.length;){var e=b[c];++c;for(var f=0,g=a.members;f<g.length;){var v=g[f];++f;if(e.id==v.id){var l=e.x,d=v.transform;d.dirty||d.set_dirty();d.local_x=l;if(null!=v.on_move)v.on_move(v.transform.local_x,v.transform.local_y);l=e.y;d=v.transform;d.dirty||d.set_dirty();d.local_y=l;if(null!=v.on_move)v.on_move(v.transform.local_x,v.transform.local_y);l=v.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();l.local_radians=d;if(null!=v.on_rotate)v.on_rotate(180/
Math.PI*v.transform.local_radians);l=v.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=v.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;v.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}return a};var oa=function(){};h["echo.util.Poolable"]=oa;oa.__name__=!0;oa.__isInterface__=!0;var La=function(){};h["echo.util.Pool"]=La;La.__name__=!0;La.__isInterface__=!0;var jb=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_Line"]=jb;jb.__name__=!0;jb.__interfaces__=
[La];jb.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:jb};var Jb=function(a,b,c,e){null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.pooled=!1;this.start=a=new P(a,b);this.end=a=new P(c,e)};h["echo.Line"]=Jb;Jb.__name__=!0;Jb.__interfaces__=[oa];Jb.prototype={set_from_vector:function(a,b,c){var e=Math.PI/180*b;b=a.x;var f=a.y,g=a.x+c*Math.cos(e);a=a.y+
c*Math.sin(e);null==a&&(a=1);null==g&&(g=1);null==f&&(f=0);null==b&&(b=0);c=this.start;c.x=b;c.y=f;c=this.end;c.x=g;c.y=a;return this},get_x:function(){return this.start.x},get_y:function(){return this.start.y},get_dx:function(){return this.end.x},get_dy:function(){return this.end.y},__class__:Jb,__properties__:{get_dy:"get_dy",get_dx:"get_dx",get_y:"get_y",get_x:"get_x"}};var eb=function(a,b,c,e,f,g,v,l,d,h,m,t){this.a=a;this.b=b;this.separate=c;this.collisions=e;this.last_collisions=f;this.enter=
g;this.stay=v;this.exit=l;this.condition=d;this.quadtree_results=h;this.percent_correction=m;this.correction_threshold=t};h["echo.Listener"]=eb;eb.__name__=!0;eb.__properties__={get_defaults:"get_defaults"};eb.get_defaults=function(){return{separate:!0,percent_correction:.9,correction_threshold:.013}};eb.prototype={__class__:eb};var fc=function(a,b,c,e,f){this.gravity_scale=1;this.friction=this.static_friction=0;this.density=1;this.elasticity=0;null!=a&&(this.elasticity=a);null!=b&&(this.density=
b);null!=c&&(this.friction=c);null!=e&&(this.static_friction=e);null!=f&&(this.gravity_scale=f)};h["echo.Material"]=fc;fc.__name__=!0;fc.prototype={__class__:fc};var Dc=function(){};h["echo.Physics"]=Dc;Dc.__name__=!0;Dc.step=function(a,b){for(var c=0,e=a.members;c<e.length;){var f=e[c];++c;if(0<f.mass&&!f.disposed&&f.active){f.last_x=f.transform.local_x;f.last_y=f.transform.local_y;f.last_rotation=180/Math.PI*f.transform.local_radians;var g=f.acceleration.x*f.inverse_mass,v=f.acceleration.y*f.inverse_mass;
f.kinematic||(g+=a.gravity.x*f.material.gravity_scale,v+=a.gravity.y*f.material.gravity_scale);var l=f.velocity.x,d=f.drag.x,h=f.max_velocity.x;1E-5>=Math.abs(g)?1E-5>=Math.abs(d)||(d*=b,l=0<l-d?l-d:0>l+d?l+d:0):l+=g*b;1E-5>=Math.abs(h)||(g=-h,l<g?l=g:l>h&&(l=h));f.velocity.x=l;l=f.velocity.y;g=f.drag.y;h=f.max_velocity.y;1E-5>=Math.abs(v)?1E-5>=Math.abs(g)||(g*=b,l=0<l-g?l-g:0>l+g?l+g:0):l+=v*b;1E-5>=Math.abs(h)||(v=-h,l<v?l=v:l>h&&(l=h));f.velocity.y=l;0<f.drag_length?(v=f.acceleration,v=0==v.x&&
0==v.y):v=!1;v?(v=f.velocity,v=!(0==v.x&&0==v.y)):v=!1;v&&(v=h=f.velocity,v=Math.sqrt(v.x*v.x+v.y*v.y)-f.drag_length*b,g=l=h,g=g.x*g.x+g.y*g.y,g=0==g?1:Math.sqrt(g),d=h.y/g*v,l.x=h.x/g*v,l.y=d);0<f.max_velocity_length?(v=f.velocity,v=Math.sqrt(v.x*v.x+v.y*v.y)>f.max_velocity_length):v=!1;v&&(h=f.velocity,v=f.max_velocity_length,g=l=h,g=g.x*g.x+g.y*g.y,g=0==g?1:Math.sqrt(g),d=h.y/g*v,l.x=h.x/g*v,l.y=d);v=f.transform.local_x+f.velocity.x*b;l=f.transform;l.dirty||l.set_dirty();l.local_x=v;if(null!=f.on_move)f.on_move(f.transform.local_x,
f.transform.local_y);v=f.transform.local_y+f.velocity.y*b;l=f.transform;l.dirty||l.set_dirty();l.local_y=v;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);v=f.rotational_velocity;h=f.rotational_drag;g=f.torque*f.inverse_mass;l=f.max_rotational_velocity;1E-5>=Math.abs(h)?1E-5>=Math.abs(g)||(g*=b,v=0<v-g?v-g:0>v+g?v+g:0):v+=h*b;1E-5>=Math.abs(l)||(h=-l,v<h?v=h:v>l&&(v=l));f.rotational_velocity=v;v=f.transform;l=Math.PI/180*(180/Math.PI*f.transform.local_radians+f.rotational_velocity*
b);v.dirty||v.set_dirty();v.local_radians=l;if(null!=f.on_rotate)f.on_rotate(180/Math.PI*f.transform.local_radians)}}};Dc.separate=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(c.separate)for(var e=0,f=c.collisions;e<f.length;){var g=f[e];++e;for(var v=0,l=g.data.length;v<l;){var d=v++,h=g.a,m=g.b;d=g.data[d];var t=c.correction_threshold,n=c.percent_correction;null==n&&(n=.9);null==t&&(t=.013);if(d.sa.solid&&d.sb.solid&&h.active&&m.active&&!h.disposed&&
!m.disposed&&!(0>=h.mass&&0>=m.mass)){var x=(h.velocity.x-m.velocity.x)*d.normal.x+(h.velocity.y-m.velocity.y)*d.normal.y,p=h.inverse_mass+m.inverse_mass;if(0<x){var K=-(1+.5*(h.material.elasticity+m.material.elasticity))*x/p;x=-K*d.normal.x;K=-K*d.normal.y;h.kinematic||(h.velocity.x-=x*h.inverse_mass,h.velocity.y-=K*h.inverse_mass);m.kinematic||(m.velocity.x+=x*m.inverse_mass,m.velocity.y+=K*m.inverse_mass)}n*=Math.max(d.overlap-t,0)/p;t=n*d.normal.x;d=n*d.normal.y;if(!h.kinematic){n=h.transform.local_x-
h.inverse_mass*t;p=h.transform;p.dirty||p.set_dirty();p.local_x=n;if(null!=h.on_move)h.on_move(h.transform.local_x,h.transform.local_y);n=h.transform.local_y-h.inverse_mass*d;p=h.transform;p.dirty||p.set_dirty();p.local_y=n;if(null!=h.on_move)h.on_move(h.transform.local_x,h.transform.local_y)}if(!m.kinematic){h=m.transform.local_x+m.inverse_mass*t;t=m.transform;t.dirty||t.set_dirty();t.local_x=h;if(null!=m.on_move)m.on_move(m.transform.local_x,m.transform.local_y);h=m.transform.local_y+m.inverse_mass*
d;d=m.transform;d.dirty||d.set_dirty();d.local_y=h;if(null!=m.on_move)m.on_move(m.transform.local_x,m.transform.local_y)}}}}}};var Ea=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.solid=!0;var e=this.transform=new Bc;e.dirty||e.set_dirty();e.local_x=a;e=this.transform;e.dirty||e.set_dirty();e.local_y=b;e=this.transform;a=Math.PI/180*c;e.dirty||e.set_dirty();e.local_radians=a};h["echo.Shape"]=Ea;Ea.__name__=!0;Ea.__properties__={get_defaults:"get_defaults"};Ea.get=function(a){a=
bd.copy_fields(a,Ea.get_defaults());switch(a.type){case 0:var b=a.offset_x,c=a.offset_y,e=a.width,f=a.height,g=a.rotation,v=a.scale_x,l=a.scale_y;null==l&&(l=1);null==v&&(v=1);null==g&&(g=0);null==f&&(f=0);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);var d=Kb.pool.get();var h=b,m=c;b=f;null==l&&(l=1);null==v&&(v=1);null==g&&(g=0);null==b&&(b=0);null==e&&(e=1);null==m&&(m=0);null==h&&(h=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=h;c=d.transform;c.dirty||c.set_dirty();c.local_y=m;h=.5*e;c=d.transform;
null==c.parent?m=c.local_scale_x:(c.sync(),m=c._scale_x);d.local_ex=h/m;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;h=0;for(m=c.count;h<m;)if(f=h++,null==c.local_vertices[f]){var t=c.local_vertices,n=new P(0,0);t[f]=n}h=c.local_vertices[0];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[1];h.x=d.local_ex*d.transform.local_scale_x;h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[2];h.x=d.local_ex*d.transform.local_scale_x;
h.y=d.local_ey*d.transform.local_scale_y;h=c.local_vertices[3];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=d.local_ey*d.transform.local_scale_y;h=d.transform.local_x;t=c.transform;t.dirty||t.set_dirty();t.local_x=h;h=d.transform.local_y;t=c.transform;t.dirty||t.set_dirty();t.local_y=h;t=c.transform;h=Math.PI/180*(180/Math.PI)*d.transform.local_radians;t.dirty||t.set_dirty();t.local_radians=h;h=d.transform.local_scale_x;t=c.transform;t.dirty||t.set_dirty();t.local_scale_x=h;h=d.transform.local_scale_y;
t=c.transform;t.dirty||t.set_dirty();t.local_scale_y=h;c.dirty_vertices=!0;c.dirty_bounds=!0}h=.5*(0>=b?e:b);c=d.transform;null==c.parent?m=c.local_scale_y:(c.sync(),m=c._scale_y);d.local_ey=h/m;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;h=0;for(m=c.count;h<m;)f=h++,null==c.local_vertices[f]&&(t=c.local_vertices,n=new P(0,0),t[f]=n);h=c.local_vertices[0];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[1];h.x=d.local_ex*d.transform.local_scale_x;
h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[2];h.x=d.local_ex*d.transform.local_scale_x;h.y=d.local_ey*d.transform.local_scale_y;h=c.local_vertices[3];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=d.local_ey*d.transform.local_scale_y;h=d.transform.local_x;t=c.transform;t.dirty||t.set_dirty();t.local_x=h;h=d.transform.local_y;t=c.transform;t.dirty||t.set_dirty();t.local_y=h;t=c.transform;h=Math.PI/180*(180/Math.PI)*d.transform.local_radians;t.dirty||t.set_dirty();t.local_radians=
h;h=d.transform.local_scale_x;t=c.transform;t.dirty||t.set_dirty();t.local_scale_x=h;h=d.transform.local_scale_y;t=c.transform;t.dirty||t.set_dirty();t.local_scale_y=h;c.dirty_vertices=!0;c.dirty_bounds=!0}c=d.transform;h=Math.PI/180*g;c.dirty||c.set_dirty();c.local_radians=h;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=v;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;null==d.transformed_rect?(c=d.transform,null==c.parent?l=180/Math.PI*c.local_radians:(c.sync(),l=180/Math.PI*c._radians),
l=0!=l):l=!1;if(l){e=Ra.pool.get();e.count=4;h=0;for(m=e.count;h<m;)f=h++,null==e.local_vertices[f]&&(l=e.local_vertices,n=new P(0,0),l[f]=n);h=e.local_vertices[0];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=-(d.local_ey*d.transform.local_scale_y);h=e.local_vertices[1];h.x=d.local_ex*d.transform.local_scale_x;h.y=-(d.local_ey*d.transform.local_scale_y);h=e.local_vertices[2];h.x=d.local_ex*d.transform.local_scale_x;h.y=d.local_ey*d.transform.local_scale_y;h=e.local_vertices[3];h.x=-(d.local_ex*
d.transform.local_scale_x);h.y=d.local_ey*d.transform.local_scale_y;h=d.transform.local_x;c=e.transform;c.dirty||c.set_dirty();c.local_x=h;h=d.transform.local_y;c=e.transform;c.dirty||c.set_dirty();c.local_y=h;c=e.transform;h=Math.PI/180*(180/Math.PI)*d.transform.local_radians;c.dirty||c.set_dirty();c.local_radians=h;h=d.transform.local_scale_x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=h;h=d.transform.local_scale_y;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=h;e.dirty_vertices=
!0;e.dirty_bounds=!0;e.pooled=!1;d.transformed_rect=e;d.transformed_rect.set_parent(d.parent)}else null!=d.transformed_rect&&(h=d.transform.local_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_x=h,h=d.transform.local_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_y=h,c=d.transformed_rect.transform,h=Math.PI/180*(180/Math.PI)*d.transform.local_radians,c.dirty||c.set_dirty(),c.local_radians=h,h=d.transform.local_scale_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),
c.local_scale_x=h,h=d.transform.local_scale_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_y=h);d.pooled=!1;break;case 1:b=a.offset_x;c=a.offset_y;t=a.radius;g=a.rotation;v=a.scale_x;l=a.scale_y;null==l&&(l=1);null==v&&(v=1);null==g&&(g=0);null==t&&(t=1);null==c&&(c=0);null==b&&(b=0);d=ac.pool.get();h=b;m=c;e=t;null==l&&(l=1);null==v&&(v=1);null==g&&(g=0);null==e&&(e=1);null==m&&(m=0);null==h&&(h=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=h;c=d.transform;c.dirty||c.set_dirty();
c.local_y=m;c=d.transform;h=Math.PI/180*g;c.dirty||c.set_dirty();c.local_radians=h;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=v;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;c=d.transform;null==c.parent?l=c.local_scale_x:(c.sync(),l=c._scale_x);d.local_radius=e/l;d.pooled=!1;break;case 2:if(null!=a.vertices)b=a.offset_x,c=a.offset_y,g=a.rotation,d=a.vertices,v=a.scale_x,l=a.scale_y,null==l&&(l=1),null==v&&(v=1),null==g&&(g=0),null==c&&(c=0),null==b&&(b=0),e=Ra.pool.get(),h=b,m=
c,null==l&&(l=1),null==v&&(v=1),null==g&&(g=0),null==m&&(m=0),null==h&&(h=0),c=e.transform,c.dirty||c.set_dirty(),c.local_x=h,c=e.transform,c.dirty||c.set_dirty(),c.local_y=m,c=e.transform,h=Math.PI/180*g,c.dirty||c.set_dirty(),c.local_radians=h,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_x=v,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_y=l,l=null,e.local_vertices=null==d?[]:d;else{b=a.offset_x;c=a.offset_y;m=a.sides;t=a.radius;g=a.rotation;v=a.scale_x;l=a.scale_y;null==l&&(l=1);null==
v&&(v=1);null==g&&(g=0);null==t&&(t=1);null==m&&(m=3);null==c&&(c=0);null==b&&(b=0);if(3>m)throw A.thrown("Polygons require 3 sides as a minimum");e=Ra.pool.get();var x=2*Math.PI/m;d=[];for(h=0;h<m;)f=h++,f=f*x+.5*(Math.PI-x),n=new P(Math.cos(f)*t,Math.sin(f)*t),d.push(n);h=b;m=c;null==l&&(l=1);null==v&&(v=1);null==g&&(g=0);null==m&&(m=0);null==h&&(h=0);c=e.transform;c.dirty||c.set_dirty();c.local_x=h;c=e.transform;c.dirty||c.set_dirty();c.local_y=m;c=e.transform;h=Math.PI/180*g;c.dirty||c.set_dirty();
c.local_radians=h;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=v;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=l;l=null;e.local_vertices=null==d?[]:d}e.count=null!=l&&0<=l?l:e.local_vertices.length;if(l>e.local_vertices.length)for(h=e.local_vertices.length,m=l;h<m;)f=h++,l=e.local_vertices,n=new P(0,0),l[f]=n;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d=e}d.solid=a.solid;return d};Ea.get_defaults=function(){return{type:0,radius:1,width:1,height:0,sides:3,rotation:0,scale_x:1,
scale_y:1,offset_x:0,offset_y:0,solid:!0}};Ea.prototype={put:function(){this.transform.set_parent(null);this.parent=null;this.collided=!1},set_parent:function(a){this.parent!=a&&(this.parent=a,this.transform.set_parent(null==a?null:a.transform))},bounds:function(a){if(null==a){var b=this.transform;if(null==b.parent)var c=b.local_x;else b.sync(),c=b._x;b=this.transform;if(null==b.parent)var e=b.local_y;else b.sync(),e=b._y;var f=0;b=0;null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);a=hb.pool.get();
null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;b*=.5;a.min_x=c-f;a.min_y=e-b;a.max_x=c+f;a.max_y=e+b;a.pooled=!1;return a}b=this.transform;null==b.parent?c=b.local_x:(b.sync(),c=b._x);b=this.transform;null==b.parent?e=b.local_y:(b.sync(),e=b._y);b=f=0;null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;b*=.5;a.min_x=c-f;a.min_y=e-b;a.max_x=c+f;a.max_y=e+b;return a},volume:function(){return 0},intersect:function(a){return null},collides:function(a){return null},collide_rect:function(a){return null},
collide_circle:function(a){return null},collide_polygon:function(a){return null},__class__:Ea};var Sc=function(a){this.members=null==a.members?[]:a.members;this.init=!1;var b;if(1>a.width)throw A.thrown("World must have a width of at least 1");this.width=b=a.width;this.init&&this.reset_quadtrees();if(1>a.height)throw A.thrown("World must have a width of at least 1");this.height=b=a.height;this.init&&this.reset_quadtrees();this.x=null==a.x?0:a.x;this.init&&this.reset_quadtrees();this.y=null==a.y?0:
a.y;this.init&&this.reset_quadtrees();this.gravity=new P(null==a.gravity_x?0:a.gravity_x,null==a.gravity_y?0:a.gravity_y);this.reset_quadtrees();this.listeners=new xa(a.listeners);this.iterations=null==a.iterations?5:a.iterations;null!=a.history&&(this.history=new $d(a.history))};h["echo.World"]=Sc;Sc.__name__=!0;Sc.__interfaces__=[K];Sc.prototype={add:function(a){if(a.world==this)return a;null!=a.world&&(null!=a.world&&a.world.remove(a),null!=a.quadtree_data&&null!=a.quadtree_data.bounds&&a.quadtree_data.bounds.put());
a.world=this;a.dirty=!0;this.members.push(a);a.quadtree_data=new ae(a.id,a.bounds(),!1);0>=a.mass?this.static_quadtree.insert(a.quadtree_data):this.quadtree.insert(a.quadtree_data);return a},remove:function(a){this.quadtree.remove(a.quadtree_data);this.static_quadtree.remove(a.quadtree_data);z.remove(this.members,a);a.world=null;return a},reset_quadtrees:function(){this.init=!0;if(null!=this.quadtree){var a=this.quadtree;if(!a.pooled){a.pooled=!0;for(var b=0,c=a.children.length;b<c;){var e=b++;if(null!=
a.children[e]){a.children[e].clear_children();var f=a.children[e];f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=0,f.contents_count=0,f.nodes_list.length=0,Ma.pool.put_unsafe(f));a.children[e]=null}}a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;Ma.pool.put_unsafe(a)}}var g=Ma.pool.get();c=b=0;var v=1,l=1;null==l&&(l=1);null==v&&(v=1);null==c&&(c=0);null==b&&(b=0);v*=.5;l*=.5;g.min_x=b-v;g.min_y=c-l;g.max_x=b+v;g.max_y=c+l;b=0;for(c=g.children.length;b<c;)e=b++,null!=g.children[e]&&
(g.children[e].clear_children(),a=g.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=0,Ma.pool.put_unsafe(a)),g.children[e]=null);g.contents.length=0;g.contents_count=0;g.pooled=!1;this.quadtree=g;if(null!=this.static_quadtree&&(a=this.static_quadtree,!a.pooled)){a.pooled=!0;b=0;for(c=a.children.length;b<c;)e=b++,null!=a.children[e]&&(a.children[e].clear_children(),f=a.children[e],f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=
0,f.contents_count=0,f.nodes_list.length=0,Ma.pool.put_unsafe(f)),a.children[e]=null);a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;Ma.pool.put_unsafe(a)}g=Ma.pool.get();c=b=0;l=v=1;null==l&&(l=1);null==v&&(v=1);null==c&&(c=0);null==b&&(b=0);v*=.5;l*=.5;g.min_x=b-v;g.min_y=c-l;g.max_x=b+v;g.max_y=c+l;b=0;for(c=g.children.length;b<c;)e=b++,null!=g.children[e]&&(g.children[e].clear_children(),a=g.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=
0,a.nodes_list.length=0,Ma.pool.put_unsafe(a)),g.children[e]=null);g.contents.length=0;g.contents_count=0;g.pooled=!1;this.static_quadtree=g;g=null;if(null!=g){b=this.x+.5*this.width;c=this.y+.5*this.height;v=this.width;l=this.height;null==l&&(l=0);null==v&&(v=1);null==c&&(c=0);null==b&&(b=0);a=g.transform;a.dirty||a.set_dirty();a.local_x=b;a=g.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*v;a=g.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);g.local_ex=b/a;if(null!=g.transformed_rect){a=
g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)if(e=b++,null==a.local_vertices[e]){f=a.local_vertices;var d=new P(0,0);f[e]=d}b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);
b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*
(0>=l?v:l);a=g.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);g.local_ey=b/a;if(null!=g.transformed_rect){a=g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,d=new P(0,0),f[e]=d);b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*
g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=
b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=g.transform;b=Math.PI/180*0;a.dirty||a.set_dirty();a.local_radians=b;a=g.transform;a.dirty||a.set_dirty();a.local_scale_x=1;a=g.transform;a.dirty||a.set_dirty();a.local_scale_y=1;null==g.transformed_rect?(a=g.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=Ra.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==
l.local_vertices[e]&&(a=l.local_vertices,d=new P(0,0),a[e]=d);b=l.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=l.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=l.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=l.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;
a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=g.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=g.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=g.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;g.transformed_rect=l;g.transformed_rect.set_parent(g.parent)}else null!=
g.transformed_rect&&(b=g.transform.local_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=g.transform.local_y,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=g.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*g.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=g.transform.local_scale_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=g.transform.local_scale_y,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),
a.local_scale_y=b)}else{b=this.x+.5*this.width;c=this.y+.5*this.height;v=this.width;l=this.height;null==l&&(l=0);null==v&&(v=1);null==c&&(c=0);null==b&&(b=0);g=Kb.pool.get();var h=0,m=1,t=1;null==t&&(t=1);null==m&&(m=1);null==h&&(h=0);null==l&&(l=0);null==v&&(v=1);null==c&&(c=0);null==b&&(b=0);a=g.transform;a.dirty||a.set_dirty();a.local_x=b;a=g.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*v;a=g.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);g.local_ex=b/a;if(null!=g.transformed_rect){a=
g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,d=new P(0,0),f[e]=d);b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);
b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*
(0>=l?v:l);a=g.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);g.local_ey=b/a;if(null!=g.transformed_rect){a=g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,d=new P(0,0),f[e]=d);b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*
g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=
b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=g.transform;b=Math.PI/180*h;a.dirty||a.set_dirty();a.local_radians=b;a=g.transform;a.dirty||a.set_dirty();a.local_scale_x=m;a=g.transform;a.dirty||a.set_dirty();a.local_scale_y=t;null==g.transformed_rect?(a=g.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=Ra.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==
l.local_vertices[e]&&(a=l.local_vertices,d=new P(0,0),a[e]=d);b=l.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=l.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=l.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=l.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;
a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=g.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=g.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=g.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;g.transformed_rect=l;g.transformed_rect.set_parent(g.parent)}else null!=
g.transformed_rect&&(b=g.transform.local_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=g.transform.local_y,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=g.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*g.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=g.transform.local_scale_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=g.transform.local_scale_y,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),
a.local_scale_y=b);g.pooled=!1}b=g.to_aabb(!0);a=this.quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;a=this.static_quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;b=0;for(c=this.members;b<c.length;)g=c[b],++b,0<g.mass?g.dirty=!0:(g.bounds(g.quadtree_data.bounds),this.static_quadtree.update(g.quadtree_data))},__class__:Sc};var Xc=function(a,b,c,e,f,g,v,l,d){this.id=a;this.x=b;this.y=c;this.rotation=e;this.velocity_x=f;this.velocity_y=g;this.acceleration_x=
v;this.acceleration_y=l;this.rotational_velocity=d};h["echo.data.BodyState"]=Xc;Xc.__name__=!0;Xc.prototype={__class__:Xc};var Tc=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_data_Collision"]=Tc;Tc.__name__=!0;Tc.__interfaces__=[La];Tc.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Tc};var pc=function(){this.pooled=!1;this.data=
[]};h["echo.data.Collision"]=pc;pc.__name__=!0;pc.__interfaces__=[oa];pc.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;pc.pool.put_unsafe(this)}},__class__:pc};var cd=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_data_CollisionData"]=cd;cd.__name__=!0;cd.__interfaces__=[La];cd.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=
a&&(this.members[this.count++]=a)},__class__:cd};var qc=function(){this.pooled=!1;var a=new P(0,0);this.normal=a;a=new P(0,0);var b=new P(0,0);this.contacts=[a,b].slice(0);this.overlap=this.contact_count=0};h["echo.data.CollisionData"]=qc;qc.__name__=!0;qc.__interfaces__=[oa];qc.prototype={put:function(){this.pooled||(this.pooled=!0,qc.pool.put_unsafe(this))},__class__:qc};var yd=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_data_Intersection"]=yd;yd.__name__=
!0;yd.__interfaces__=[La];yd.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:yd};var Rb=function(){this.pooled=!1;this.data=[]};h["echo.data.Intersection"]=Rb;Rb.__name__=!0;Rb.__interfaces__=[oa];Rb.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;Rb.pool.put_unsafe(this)}},__class__:Rb};var dd=function(a){this.type=
a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_data_IntersectionData"]=dd;dd.__name__=!0;dd.__interfaces__=[La];dd.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:dd};var Fb=function(){this.inverse_normal=this.pooled=!1;var a=new P(0,0);this.normal=a;this.distance=this.overlap=0;this.hit=a=new P(0,0);this.hit=a=new P(0,0);this.normal=a=new P(0,0)};h["echo.data.IntersectionData"]=
Fb;Fb.__name__=!0;Fb.__interfaces__=[oa];Fb.prototype={put:function(){this.pooled||(this.pooled=!0,Fb.pool.put_unsafe(this))},__class__:Fb};var ae=function(a,b,c){this.flag=!1;this.bounds=null;this.id=a;null!=b&&(this.bounds=b);null!=c&&(this.flag=c)};h["echo.data.QuadTreeData"]=ae;ae.__name__=!0;ae.prototype={__class__:ae};var be=function(a,b,c,e,f,g,v,l,d){this.m00=a;this.m10=b;this.m20=c;this.m01=e;this.m11=f;this.m21=g;this.m02=v;this.m12=l;this.m22=d};h["echo.math.Matrix3Default"]=be;be.__name__=
!0;be.prototype={__class__:be};var P=function(a,b){this.x=a;this.y=b};h["echo.math.Vector2Default"]=P;P.__name__=!0;P.prototype={__class__:P};var ed=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_shape_Circle"]=ed;ed.__name__=!0;ed.__interfaces__=[La];ed.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:ed};var ac=function(){this.pooled=
!1;Ea.call(this);this.type=1;var a=this.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);this.local_radius=0/a};h["echo.shape.Circle"]=ac;ac.__name__=!0;ac.__interfaces__=[oa];ac.get=function(a,b,c,e,f,g){null==g&&(g=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var v=ac.pool.get();null==g&&(g=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=v.transform;l.dirty||l.set_dirty();l.local_x=a;l=v.transform;l.dirty||l.set_dirty();
l.local_y=b;l=v.transform;a=Math.PI/180*e;l.dirty||l.set_dirty();l.local_radians=a;l=v.transform;l.dirty||l.set_dirty();l.local_scale_x=f;l=v.transform;l.dirty||l.set_dirty();l.local_scale_y=g;l=v.transform;null==l.parent?a=l.local_scale_x:(l.sync(),a=l._scale_x);v.local_radius=c/a;v.pooled=!1;return v};ac.__super__=Ea;ac.prototype=H(Ea.prototype,{put:function(){Ea.prototype.put.call(this);this.pooled||(this.pooled=!0,ac.pool.put_unsafe(this))},bounds:function(a){var b=this.local_radius,c=this.transform;
null==c.parent?c=c.local_scale_x:(c.sync(),c=c._scale_x);b=b*c*2;if(null==a){c=this.transform;if(null==c.parent)var e=c.local_x;else c.sync(),e=c._x;c=this.transform;if(null==c.parent)var f=c.local_y;else c.sync(),f=c._y;c=b;null==b&&(b=1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);a=hb.pool.get();null==b&&(b=1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=f-b;a.max_x=e+c;a.max_y=f+b;a.pooled=!1;return a}c=this.transform;null==c.parent?e=c.local_x:(c.sync(),e=c._x);
c=this.transform;null==c.parent?f=c.local_y:(c.sync(),f=c._y);c=b;null==b&&(b=1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=f-b;a.max_x=e+c;a.max_y=f+b;return a},volume:function(){var a=this.local_radius,b=this.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);a*=b;return Math.PI*a*a},intersect:function(a){return ta.line_intersects_circle(a,this)},collides:function(a){return a.collide_circle(this)},collide_rect:function(a){return ta.rect_and_circle(a,
this,!0)},collide_circle:function(a){return ta.circle_and_circle(a,this)},collide_polygon:function(a){return ta.circle_and_polygon(this,a,!0)},__class__:ac});var zd=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_shape_Polygon"]=zd;zd.__name__=!0;zd.__interfaces__=[La];zd.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:zd};var Ra=function(a){this.pooled=
!1;Ea.call(this);this.type=2;this._vertices=[];this._normals=[];var b=hb.pool.get(),c=0,e=0,f=1,g=1;null==g&&(g=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;g*=.5;b.min_x=c-f;b.min_y=e-g;b.max_x=c+f;b.max_y=e+g;b.pooled=!1;this._bounds=b;this.transform.on_dirty=d(this,this.on_dirty);this.local_vertices=null==a?[]:a;this.count=this.local_vertices.length;if(null>this.local_vertices.length)for(a=this.local_vertices.length;null>a;)b=a++,c=this.local_vertices,e=new P(0,0),c[b]=e;this.dirty_bounds=
this.dirty_vertices=!0};h["echo.shape.Polygon"]=Ra;Ra.__name__=!0;Ra.__interfaces__=[oa];Ra.get=function(a,b,c,e,f,g,v){null==v&&(v=1);null==g&&(g=1);null==f&&(f=0);null==e&&(e=1);null==c&&(c=3);null==b&&(b=0);null==a&&(a=0);if(3>c)throw A.thrown("Polygons require 3 sides as a minimum");for(var l=Ra.pool.get(),d=2*Math.PI/c,h,m=[],t=0;t<c;){h=t++;h=h*d+.5*(Math.PI-d);var n=new P(Math.cos(h)*e,Math.sin(h)*e);m.push(n)}t=a;null==v&&(v=1);null==g&&(g=1);null==f&&(f=0);null==b&&(b=0);null==t&&(t=0);a=
l.transform;a.dirty||a.set_dirty();a.local_x=t;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;f*=Math.PI/180;a.dirty||a.set_dirty();a.local_radians=f;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=g;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=v;l.local_vertices=null==m?[]:m;l.count=l.local_vertices.length;if(null>l.local_vertices.length)for(t=l.local_vertices.length,c=null;t<c;)h=t++,m=l.local_vertices,n=new P(0,0),m[h]=n;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=
!1;return l};Ra.__super__=Ea;Ra.prototype=H(Ea.prototype,{put:function(){Ea.prototype.put.call(this);this.pooled||(this.pooled=!0,Ra.pool.put_unsafe(this))},bounds:function(a){if(this.dirty_bounds){this.dirty_bounds=!1;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var f=this._vertices,g=new P(0,0);f[e]=g}var v=this.local_vertices[e].x,l=
this.local_vertices[e].y;null==l&&(l=0);null==v&&(v=0);f=this.transform.get_local_to_world_matrix();g=v;v=f.m01*g+f.m11*l+1*f.m21;var d=this._vertices[e];d.x=f.m00*g+f.m10*l+1*f.m20;d.y=v}}b=0;for(c=this.count;b<c;)e=b++,d=this._vertices[(e+1)%this.count],g=d.x,l=d.y,f=this._vertices[e],l-=f.y,g-=f.x,v=-l,l=g,g=v,null==this._normals[e]?(f=this._normals,g=new P(g,l),f[e]=g):(f=this._normals[e],f.x=g,f.y=l),l=e=g=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),f=g.y/l,e.x=g.x/l,e.y=f}d=this._vertices;
g=d[0].x;l=d[0].y;f=d[0].x;v=d[0].y;b=1;for(c=this.count;b<c;)e=b++,d[e].x<g&&(g=d[e].x),d[e].y<l&&(l=d[e].y),d[e].x>f&&(f=d[e].x),d[e].y>v&&(v=d[e].y);b=this._bounds;b.min_x=g;b.max_x=f;b.min_y=l;b.max_y=v}if(null==a)return b=this._bounds,a=b.min_x,c=b.min_y,e=b.max_x,g=b.max_y,b=hb.pool.get(),b.min_x=a,b.max_x=e,b.min_y=c,b.max_y=g,b.pooled=!1,b;b=this._bounds;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;return a},volume:function(){var a=0;if(this.dirty_vertices){for(this.dirty_vertices=
!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var f=this._vertices,g=new P(0,0);f[e]=g}var v=this.local_vertices[e].x,l=this.local_vertices[e].y;null==l&&(l=0);null==v&&(v=0);f=this.transform.get_local_to_world_matrix();g=v;var d=f.m01*g+f.m11*l+1*f.m21;v=this._vertices[e];v.x=f.m00*g+f.m10*l+1*f.m20;v.y=d}}b=0;for(c=this.count;b<c;)e=b++,v=this._vertices[(e+1)%this.count],g=v.x,l=v.y,
f=this._vertices[e],l-=f.y,g-=f.x,v=-l,l=g,g=v,null==this._normals[e]?(f=this._normals,g=new P(g,l),f[e]=g):(f=this._normals[e],f.x=g,f.y=l),l=e=g=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),f=g.y/l,e.x=g.x/l,e.y=f}g=this._vertices;v=g[g.length-1];b=0;for(c=this.count;b<c;)e=b++,e=g[e],a+=e.x*v.y-v.x*e.y,v=e;return.5*Math.abs(a)},intersect:function(a){return ta.line_intersects_polygon(a,this)},collides:function(a){return a.collide_polygon(this)},collide_rect:function(a){return ta.rect_and_polygon(a,
this,!0)},collide_circle:function(a){return ta.circle_and_polygon(a,this)},collide_polygon:function(a){return ta.polygon_and_polygon(a,this,!0)},on_dirty:function(a){this.dirty_bounds=this.dirty_vertices=!0},__class__:Ra});var Ec=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_shape_Rect"]=Ec;Ec.__name__=!0;Ec.__interfaces__=[La];Ec.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=
a&&(this.members[this.count++]=a)},__class__:Ec};var Kb=function(){this.pooled=!1;Ea.call(this);this.local_ex=0;if(null!=this.transformed_rect){var a=this.transformed_rect;a.count=4;for(var b=0,c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var f=a.local_vertices,g=new P(0,0);f[e]=g}}b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*
this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=this.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;f.dirty||f.set_dirty();
f.local_radians=b;b=this.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=this.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.local_ey=0;if(null!=this.transformed_rect){a=this.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,g=new P(0,0),f[e]=g);b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);
b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=this.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;
f=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=this.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=this.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.type=0;this.transform.on_dirty=d(this,this.on_dirty)};h["echo.shape.Rect"]=Kb;Kb.__name__=!0;Kb.__interfaces__=[oa];Kb.get=function(a,b,c,e,f,g,v){null==v&&(v=1);null==g&&(g=
1);null==f&&(f=0);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=Kb.pool.get(),d=b;null==v&&(v=1);null==g&&(g=1);null==f&&(f=0);null==e&&(e=0);null==c&&(c=1);null==d&&(d=0);null==a&&(a=0);b=l.transform;b.dirty||b.set_dirty();b.local_x=a;b=l.transform;b.dirty||b.set_dirty();b.local_y=d;a=.5*c;b=l.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);l.local_ex=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;b.count=4;a=0;for(d=b.count;a<d;){var h=a++;if(null==
b.local_vertices[h]){var m=b.local_vertices,t=new P(0,0);m[h]=t}}a=b.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;
m=b.transform;m.dirty||m.set_dirty();m.local_x=a;a=l.transform.local_y;m=b.transform;m.dirty||m.set_dirty();m.local_y=a;m=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;m.dirty||m.set_dirty();m.local_radians=a;a=l.transform.local_scale_x;m=b.transform;m.dirty||m.set_dirty();m.local_scale_x=a;a=l.transform.local_scale_y;m=b.transform;m.dirty||m.set_dirty();m.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}a=.5*(0>=e?c:e);b=l.transform;null==b.parent?b=b.local_scale_y:(b.sync(),
b=b._scale_y);l.local_ey=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;b.count=4;a=0;for(d=b.count;a<d;)h=a++,null==b.local_vertices[h]&&(m=b.local_vertices,t=new P(0,0),m[h]=t);a=b.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;
a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;m=b.transform;m.dirty||m.set_dirty();m.local_x=a;a=l.transform.local_y;m=b.transform;m.dirty||m.set_dirty();m.local_y=a;m=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;m.dirty||m.set_dirty();m.local_radians=a;a=l.transform.local_scale_x;m=b.transform;m.dirty||m.set_dirty();m.local_scale_x=a;a=l.transform.local_scale_y;m=b.transform;m.dirty||m.set_dirty();
m.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}b=l.transform;a=Math.PI/180*f;b.dirty||b.set_dirty();b.local_radians=a;b=l.transform;b.dirty||b.set_dirty();b.local_scale_x=g;b=l.transform;b.dirty||b.set_dirty();b.local_scale_y=v;null==l.transformed_rect?(b=l.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c){c=Ra.pool.get();c.count=4;a=0;for(d=c.count;a<d;)h=a++,null==c.local_vertices[h]&&(e=c.local_vertices,t=new P(0,0),e[h]=t);a=
c.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=c.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=c.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=c.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=a;a=l.transform.local_y;
b=c.transform;b.dirty||b.set_dirty();b.local_y=a;b=c.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=a;a=l.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=a;a=l.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=a;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;l.transformed_rect=c;l.transformed_rect.set_parent(l.parent)}else null!=l.transformed_rect&&(a=l.transform.local_x,b=l.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_x=a,a=l.transform.local_y,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=a,b=l.transformed_rect.transform,a=Math.PI/180*(180/Math.PI)*l.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=a,a=l.transform.local_scale_x,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=a,a=l.transform.local_scale_y,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=a);l.pooled=!1;return l};Kb.__super__=Ea;Kb.prototype=
H(Ea.prototype,{put:function(){Ea.prototype.put.call(this);null!=this.transformed_rect&&(this.transformed_rect.put(),this.transformed_rect=null);this.pooled||(this.pooled=!0,Kb.pool.put_unsafe(this))},to_aabb:function(a){null==a&&(a=!1);if(a){a=null;if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;b=0!=c}else b=!1;if(b)a=this.transformed_rect.bounds(a);else if(null==a){b=this.transform;if(null==b.parent)var e=
b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var f=2*this.local_ex;b=this.transform;if(null==b.parent)var g=b.local_scale_x;else b.sync(),g=b._scale_x;f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);b=hb.pool.get();null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;b.min_x=e-f;b.min_y=c-g;b.max_x=e+f;b.max_y=c+g;b.pooled=
!1;a=b}else b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),f=2*this.local_ex,b=this.transform,null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x),f*=g,g=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),g*=b,null==g&&(g=1),null==f&&(f=1),null==c&&(c=0),null==e&&(e=0),f*=.5,g*=.5,a.min_x=e-f,a.min_y=c-g,a.max_x=e+f,a.max_y=c+g;this.put();return a}a=null;null!=this.transformed_rect?
(b=this.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a)return b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),f=2*this.local_ex,b=this.transform,null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x),f*=g,g=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),g*=b,null==g&&
(g=1),null==f&&(f=1),null==c&&(c=0),null==e&&(e=0),a=hb.pool.get(),null==g&&(g=1),null==f&&(f=1),null==c&&(c=0),null==e&&(e=0),f*=.5,g*=.5,a.min_x=e-f,a.min_y=c-g,a.max_x=e+f,a.max_y=c+g,a.pooled=!1,a;b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);f=2*this.local_ex;b=this.transform;null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x);f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=
b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;a.min_x=e-f;a.min_y=c-g;a.max_x=e+f;a.max_y=c+g;return a},bounds:function(a){if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),
c=b._y);var f=2*this.local_ex;b=this.transform;if(null==b.parent)var g=b.local_scale_x;else b.sync(),g=b._scale_x;f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);a=hb.pool.get();null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;a.min_x=e-f;a.min_y=c-g;a.max_x=e+f;a.max_y=c+g;a.pooled=!1;return a}b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;
null==b.parent?c=b.local_y:(b.sync(),c=b._y);f=2*this.local_ex;b=this.transform;null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x);f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;a.min_x=e-f;a.min_y=c-g;a.max_x=e+f;a.max_y=c+g;return a},volume:function(){var a=2*this.local_ex,b=this.transform;if(null==b.parent)var c=b.local_scale_x;else b.sync(),c=b._scale_x;var e=2*
this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);return a*c*e*b},intersect:function(a){return ta.line_intersects_rect(a,this)},collides:function(a){return a.collide_rect(this)},collide_rect:function(a){return ta.rect_and_rect(a,this)},collide_circle:function(a){return ta.rect_and_circle(this,a)},collide_polygon:function(a){return ta.rect_and_polygon(this,a)},set_parent:function(a){Ea.prototype.set_parent.call(this,a);if(null==this.transformed_rect){var b=this.transform;
if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c){c=Ra.pool.get();c.count=4;b=0;for(var e=c.count;b<e;){var f=b++;if(null==c.local_vertices[f]){var g=c.local_vertices,v=new P(0,0);g[f]=v}}e=c.local_vertices[0];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[1];e.x=this.local_ex*this.transform.local_scale_x;e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[2];
e.x=this.local_ex*this.transform.local_scale_x;e.y=this.local_ey*this.transform.local_scale_y;e=c.local_vertices[3];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=this.local_ey*this.transform.local_scale_y;e=this.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=e;e=this.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=e;b=c.transform;e=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=e;e=this.transform.local_scale_x;
b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=e;e=this.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=e;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;this.transformed_rect=c;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(e=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=e,e=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=e,b=this.transformed_rect.transform,
e=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=e,e=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=e,e=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=e);null!=this.transformed_rect&&this.transformed_rect.set_parent(a)},on_dirty:function(a){if(null==this.transformed_rect){var b=this.transform;null==b.parent?a=180/Math.PI*b.local_radians:(b.sync(),
a=180/Math.PI*b._radians);a=0!=a}else a=!1;if(a){a=Ra.pool.get();a.count=4;b=0;for(var c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var f=a.local_vertices,g=new P(0,0);f[e]=g}}c=a.local_vertices[0];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[1];c.x=this.local_ex*this.transform.local_scale_x;c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[2];c.x=this.local_ex*this.transform.local_scale_x;c.y=
this.local_ey*this.transform.local_scale_y;c=a.local_vertices[3];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=this.local_ey*this.transform.local_scale_y;c=this.transform.local_x;b=a.transform;b.dirty||b.set_dirty();b.local_x=c;c=this.transform.local_y;b=a.transform;b.dirty||b.set_dirty();b.local_y=c;b=a.transform;c=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=c;c=this.transform.local_scale_x;b=a.transform;b.dirty||b.set_dirty();b.local_scale_x=
c;c=this.transform.local_scale_y;b=a.transform;b.dirty||b.set_dirty();b.local_scale_y=c;a.dirty_vertices=!0;a.dirty_bounds=!0;a.pooled=!1;this.transformed_rect=a;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(c=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=c,c=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=c,b=this.transformed_rect.transform,c=Math.PI/180*(180/Math.PI)*this.transform.local_radians,
b.dirty||b.set_dirty(),b.local_radians=c,c=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=c,c=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=c)},__class__:Kb});var fd=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_util_AABB"]=fd;fd.__name__=!0;fd.__interfaces__=[La];fd.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},
put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:fd};var hb=function(){this.pooled=!1;this.min_x=0;this.max_x=1;this.min_y=0;this.max_y=1};h["echo.util.AABB"]=hb;hb.__name__=!0;hb.__interfaces__=[oa];hb.prototype={put:function(){this.pooled||(this.pooled=!0,hb.pool.put_unsafe(this))},__class__:hb};var Re={_new:function(a){null==a&&(a=0);return a}},Mc=function(a){this.type=a;this.members=[];this.count=0};h["echo.util.GenericPool_echo_util_QuadTree"]=Mc;Mc.__name__=!0;Mc.__interfaces__=
[La];Mc.prototype={get:function(){return 0==this.count?m.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Mc};var $d=function(a){this.re=new Fc(a);this.un=new Fc(a)};h["echo.util.History_Array_echo_data_BodyState"]=$d;$d.__name__=!0;$d.prototype={redo:function(){var a=this.re.pop();null!=a&&this.un.push(a);return a},undo:function(){var a=this.un.pop();null!=a&&this.re.push(a);return a},add:function(a){this.un.push(a);
this.re.reset()},__class__:$d};var bd=function(){};h["echo.util.JSON"]=bd;bd.__name__=!0;bd.copy_fields=function(a,b){if(null==a)return b;if(null==b)b=B.copy(a);else for(var c=0,e=B.fields(a);c<e.length;){var f=e[c];++c;b[f]=B.field(a,f)}return b};var Ma=function(a,b){null==b&&(b=0);this.nodes_list=[];this.max_contents=10;this.max_depth=5;hb.call(this);null!=a&&(this.min_x=a.min_x,this.max_x=a.max_x,this.min_y=a.min_y,this.max_y=a.max_y);this.depth=b;this.children=Array(4);this.contents=[];this.contents_count=
0};h["echo.util.QuadTree"]=Ma;Ma.__name__=!0;Ma.__super__=hb;Ma.prototype=H(hb.prototype,{put:function(){if(!this.pooled){this.pooled=!0;for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,Ma.pool.put_unsafe(e));this.children[c]=null}}this.contents_count=this.contents.length=0;this.nodes_list.length=0;Ma.pool.put_unsafe(this)}},
insert:function(a){if(null!=a.bounds){var b=a.bounds;if(b.min_x<this.max_x&&b.max_x>=this.min_x&&b.min_y<this.max_y&&b.max_y>=this.min_y)if(null==this.children[0]&&this.contents_count+1>this.max_contents&&this.split(),null==this.children[0])b=this.get_first_null(this.contents),-1==b?this.contents.push(a):this.contents[b]=a,this.contents_count++;else{b=0;for(var c=this.children;b<c.length;){var e=c[b];++b;e.insert(a)}}}},remove:function(a,b){null==b&&(b=!0);if(null==this.children[0]){for(b=0;b<this.contents.length;){if(null!=
this.contents[b]&&this.contents[b].id==a.id)return this.contents[b]=null,this.contents_count--,!0;++b}return!1}for(var c=!1,e=0,f=this.children;e<f.length;){var g=f[e];++e;null!=g&&g.remove(a)&&(c=!0)}b&&c&&this.shake();return c},update:function(a,b){null==b&&(b=!0);this.remove(a,b);this.insert(a)},query:function(a,b){if(this.min_x<a.max_x&&this.max_x>=a.min_x&&this.min_y<a.max_y&&this.max_y>=a.min_y)if(null==this.children[0])for(var c=0,e=this.contents;c<e.length;){var f=e[c];++c;if(null!=f){var g=
f.bounds;g=g.min_x<a.max_x&&g.max_x>=a.min_x&&g.min_y<a.max_y&&g.max_y>=a.min_y}else g=!1;g&&b.push(f)}else for(c=0,e=this.children;c<e.length;)f=e[c],++c,f.query(a,b)},shake:function(){if(null==this.children[0])return!1;var a=this.get_count();if(0==a){a=0;for(var b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){for(var e=this.children[c],f=0,g=e.children.length;f<g;){var v=f++;if(null!=e.children[v]){e.children[v].clear_children();var l=e.children[v];l.pooled||(l.pooled=!0,l.clear_children(),
l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Ma.pool.put_unsafe(l));e.children[v]=null}}f=this.children[c];if(!f.pooled){f.pooled=!0;g=0;for(e=f.children.length;g<e;)v=g++,null!=f.children[v]&&(f.children[v].clear_children(),l=f.children[v],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Ma.pool.put_unsafe(l)),f.children[v]=null);f.contents.length=0;f.contents_count=0;f.nodes_list.length=0;Ma.pool.put_unsafe(f)}this.children[c]=
null}}}else if(a<this.max_contents){this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;)if(b=this.nodes_list.shift(),b!=this&&null==b.children[0])for(a=0,b=b.contents;a<b.length;)c=b[a],++a,-1==this.contents.indexOf(c)&&(f=this.get_first_null(this.contents),-1==f?this.contents.push(c):this.contents[f]=c,this.contents_count++);else for(f=0,g=b.children;f<g.length;)a=g[f],++f,this.nodes_list.push(a);a=0;for(b=this.children.length;a<b;)if(c=a++,null!=this.children[c]){e=
this.children[c];f=0;for(g=e.children.length;f<g;)v=f++,null!=e.children[v]&&(e.children[v].clear_children(),l=e.children[v],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Ma.pool.put_unsafe(l)),e.children[v]=null);f=this.children[c];if(!f.pooled){f.pooled=!0;g=0;for(e=f.children.length;g<e;)v=g++,null!=f.children[v]&&(f.children[v].clear_children(),l=f.children[v],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=
0,l.nodes_list.length=0,Ma.pool.put_unsafe(l)),f.children[v]=null);f.contents.length=0;f.contents_count=0;f.nodes_list.length=0;Ma.pool.put_unsafe(f)}this.children[c]=null}return!0}return!1},split:function(){if(!(this.depth+1>=this.max_depth)){for(var a=.5*(this.max_x-this.min_x),b=.5*(this.max_y-this.min_y),c=0;4>c;){var e=c++,f=Ma.pool.get(),g=0,v=0,l=1,d=1;null==d&&(d=1);null==l&&(l=1);null==v&&(v=0);null==g&&(g=0);l*=.5;d*=.5;f.min_x=g-l;f.min_y=v-d;f.max_x=g+l;f.max_y=v+d;g=0;for(v=f.children.length;g<
v;)l=g++,null!=f.children[l]&&(f.children[l].clear_children(),d=f.children[l],d.pooled||(d.pooled=!0,d.clear_children(),d.contents.length=0,d.contents_count=0,d.nodes_list.length=0,Ma.pool.put_unsafe(d)),f.children[l]=null);f.contents.length=0;f.contents_count=0;f.pooled=!1;switch(e){case 0:g=this.min_x+a;v=this.min_y+b;f.min_x=this.min_x;f.max_x=g;f.min_y=this.min_y;f.max_y=v;break;case 1:g=this.min_y+b;f.min_x=this.min_x+a;f.max_x=this.max_x;f.min_y=this.min_y;f.max_y=g;break;case 2:g=this.min_x+
a;f.min_x=this.min_x;f.max_x=g;f.min_y=this.min_y+b;f.max_y=this.max_y;break;case 3:f.min_x=this.min_x+a,f.max_x=this.max_x,f.min_y=this.min_y+b,f.max_y=this.max_y}f.depth=this.depth+1;g=this.max_depth;v=0;for(l=f.children.length;v<l;)if(d=v++,null!=f.children[d]){d=f.children[d];for(var h=0,m=d.children.length;h<m;){var t=h++;null!=d.children[t]&&d.children[t].set_max_depth(g)}d.max_depth=g}f.max_depth=g;g=this.max_contents;v=0;for(l=f.children.length;v<l;)if(d=v++,null!=f.children[d]){d=f.children[d];
h=0;for(m=d.children.length;h<m;)if(t=h++,null!=d.children[t]){t=d.children[t];for(var n=0,x=t.children.length;n<x;){var p=n++;null!=t.children[p]&&t.children[p].set_max_depth(g)}t.max_depth=g}d.max_depth=g}f.max_contents=g;f.shake();g=0;for(v=this.contents.length;g<v;)l=g++,null!=this.contents[l]&&f.insert(this.contents[l]);this.children[e]=f}this.contents_count=this.contents.length=0}},clear_children:function(){for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();
var e=this.children[c];e.pooled||(e.pooled=!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,Ma.pool.put_unsafe(e));this.children[c]=null}}},reset_data_flags:function(){for(var a=0,b=this.contents.length;a<b;){var c=a++;null!=this.contents[c]&&(this.contents[c].flag=!1)}a=0;for(b=this.children.length;a<b;)c=a++,null!=this.children[c]&&this.children[c].reset_data_flags()},get_count:function(){this.reset_data_flags();for(var a=0,b=0,c=this.contents.length;b<c;){var e=
b++;null!=this.contents[e]&&(this.contents[e].flag=!0,++a)}this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;){var f=this.nodes_list.shift();if(null==f.children[0])for(b=0,c=f.contents.length;b<c;)e=b++,null==f.contents[e]||f.contents[e].flag||(++a,f.contents[e].flag=!0);else for(b=0,c=f.children.length;b<c;)e=b++,this.nodes_list.push(f.children[e])}return a},get_first_null:function(a){for(var b=0,c=a.length;b<c;){var e=b++;if(null==a[e])return e}return-1},set_max_depth:function(a){for(var b=
0,c=this.children.length;b<c;){var e=b++;null!=this.children[e]&&this.children[e].set_max_depth(a)}return this.max_depth=a},__class__:Ma,__properties__:{get_count:"get_count",set_max_depth:"set_max_depth"}});var Fc=function(a){this.a=Array(a);this.reset()};h["echo.util.Ring_Array_echo_data_BodyState"]=Fc;Fc.__name__=!0;Fc.prototype={pop:function(){if(0>=this.i+this.left-this.start)return null;0==this.i&&(this.i=this.a.length,this.left=0);return this.a[--this.i]},push:function(a){this.i==this.a.length&&
(0<this.left&&this.start==this.i&&(this.start=0),this.i=0,this.left=this.a.length);this.i+this.left-this.start==this.a.length&&this.start++;this.a[this.i++]=a},reset:function(){this.left=this.start=this.i=0},__class__:Fc};var ta=function(){};h["echo.util.SAT"]=ta;ta.__name__=!0;ta.line_intersects_rect=function(a,b){if(null!=b.transformed_rect){var c=b.transform;if(null==c.parent)var e=180/Math.PI*c.local_radians;else c.sync(),e=180/Math.PI*c._radians;var f=0!=e}else f=!1;if(f)return b.transformed_rect.intersect(a);
var g=null;if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var d=180/Math.PI*c.local_radians;else c.sync(),d=180/Math.PI*c._radians;var l=0==d}else l=!0;if(l){c=b.transform;null==c.parent?l=c.local_x:(c.sync(),l=c._x);var h=l-b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var m=0,n=c.count;m<n;){var t=m++;if(null!=c.local_vertices[t]){if(null==c._vertices[t]){var x=
c._vertices,p=new P(0,0);x[t]=p}var K=c.local_vertices[t].x,k=c.local_vertices[t].y;null==k&&(k=0);null==K&&(K=0);var u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[t];q.x=r;q.y=H}}m=0;for(n=c.count;m<n;){t=m++;q=c._vertices[(t+1)%c.count];z=q.x;y=q.y;var w=c._vertices[t],B=z-w.x,C=y-w.y;z=B;y=C;K=-y;y=z;z=K;null==c._normals[t]?(x=c._normals,p=new P(z,y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y);var ia=c._normals[t],V=
ia,F=ia,E=F,G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa;V.x=J;V.y=I}}l=null==c._vertices[0]}else l=!0;if(l)x=c.transform,null==x.parent?h=x.local_x:(x.sync(),h=x._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();m=0;for(n=c.count;m<n;)t=m++,null!=c.local_vertices[t]&&(null==c._vertices[t]&&(x=c._vertices,p=new P(0,0),x[t]=p),K=c.local_vertices[t].x,k=c.local_vertices[t].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),
z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[t],q.x=r,q.y=H);m=0;for(n=c.count;m<n;)t=m++,q=c._vertices[(t+1)%c.count],z=q.x,y=q.y,w=c._vertices[t],B=z-w.x,C=y-w.y,z=B,y=C,K=-y,y=z,z=K,null==c._normals[t]?(x=c._normals,p=new P(z,y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y),E=F=V=ia=c._normals[t],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}l=c._vertices[0].x;m=1;for(n=c.count;m<n;){t=m++;if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();for(var M=0,Ta=c.count;M<Ta;){var ea=M++;null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(x=c._vertices,p=new P(0,0),x[ea]=p),K=c.local_vertices[ea].x,k=c.local_vertices[ea].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[ea],q.x=r,q.y=H)}for(var db=0,S=c.count;db<S;){var T=db++;ia=c._vertices[(T+1)%c.count];var L=ia.x,ca=ia.y;w=c._vertices[T];
B=L-w.x;C=ca-w.y;L=B;ca=C;var R=-ca;ca=L;L=R;if(null==c._normals[T]){var jb=c._normals,U=new P(L,ca);jb[T]=U}else{var Y=c._normals[T];Y.x=L;Y.y=ca}var aa=c._normals[T];E=F=V=aa;G=E.x*E.x+E.y*E.y;D=0==G?1:Math.sqrt(G);oa=F.x/D;xa=F.y/D;J=oa;I=xa;V.x=J;V.y=I}}if(c._vertices[t].x<l){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var Z=0,gb=c.count;Z<gb;){var O=Z++;if(null!=c.local_vertices[O]){if(null==c._vertices[O]){var da=c._vertices,fa=new P(0,0);da[O]=
fa}var La=c.local_vertices[O].x,ba=c.local_vertices[O].y;null==ba&&(ba=0);null==La&&(La=0);var W=c.transform.get_local_to_world_matrix(),ha=La,pa=ba,Na=1,la=W.m00*ha+W.m10*pa+W.m20*Na,ja=W.m01*ha+W.m11*pa+W.m21*Na,Xa=la,Ua=ja,Da=c._vertices[O];Da.x=Xa;Da.y=Ua}}for(var qa=0,ua=c.count;qa<ua;){var qb=qa++,ra=c._vertices[(qb+1)%c.count],ka=ra.x,rb=ra.y,va=c._vertices[qb],eb=ka-va.x,Aa=rb-va.y;ka=eb;rb=Aa;var ya=-rb;rb=ka;ka=ya;if(null==c._normals[qb]){var Ca=c._normals,za=new P(ka,rb);Ca[qb]=za}else{var ma=
c._normals[qb];ma.x=ka;ma.y=rb}var Fa=c._normals[qb],sa=Fa,Ja=Fa,wa=Ja,Oa=wa.x*wa.x+wa.y*wa.y,Ea=0==Oa?1:Math.sqrt(Oa),Ba=Ja.x/Ea,Ia=Ja.y/Ea,Ma=Ba,Ga=Ia;sa.x=Ma;sa.y=Ga}}l=c._vertices[t].x}}h=l}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var ab=180/Math.PI*c.local_radians;else c.sync(),ab=180/Math.PI*c._radians;var Ha=0==ab}else Ha=!0;if(Ha){c=b.transform;null==c.parent?Ha=c.local_x:(c.sync(),Ha=c._x);var Pa=Ha+b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=
c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();m=0;for(n=c.count;m<n;)t=m++,null!=c.local_vertices[t]&&(null==c._vertices[t]&&(x=c._vertices,p=new P(0,0),x[t]=p),K=c.local_vertices[t].x,k=c.local_vertices[t].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[t],q.x=r,q.y=H);m=0;for(n=c.count;m<n;)t=m++,q=c._vertices[(t+1)%c.count],z=q.x,
y=q.y,w=c._vertices[t],B=z-w.x,C=y-w.y,z=B,y=C,K=-y,y=z,z=K,null==c._normals[t]?(x=c._normals,p=new P(z,y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y),E=F=V=ia=c._normals[t],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}Ha=null==c._vertices[0]}else Ha=!0;if(Ha)x=c.transform,null==x.parent?Pa=x.local_x:(x.sync(),Pa=x._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();m=0;for(n=c.count;m<n;)t=m++,null!=c.local_vertices[t]&&
(null==c._vertices[t]&&(x=c._vertices,p=new P(0,0),x[t]=p),K=c.local_vertices[t].x,k=c.local_vertices[t].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[t],q.x=r,q.y=H);m=0;for(n=c.count;m<n;)t=m++,q=c._vertices[(t+1)%c.count],z=q.x,y=q.y,w=c._vertices[t],B=z-w.x,C=y-w.y,z=B,y=C,K=-y,y=z,z=K,null==c._normals[t]?(x=c._normals,p=new P(z,y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y),E=F=V=ia=
c._normals[t],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}Ha=c._vertices[0].x;m=1;for(n=c.count;m<n;){t=m++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();M=0;for(Ta=c.count;M<Ta;)ea=M++,null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(x=c._vertices,p=new P(0,0),x[ea]=p),K=c.local_vertices[ea].x,k=c.local_vertices[ea].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*
y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[ea],q.x=r,q.y=H);db=0;for(S=c.count;db<S;)T=db++,ia=c._vertices[(T+1)%c.count],L=ia.x,ca=ia.y,w=c._vertices[T],B=L-w.x,C=ca-w.y,L=B,ca=C,R=-ca,ca=L,L=R,null==c._normals[T]?(jb=c._normals,U=new P(L,ca),jb[T]=U):(Y=c._normals[T],Y.x=L,Y.y=ca),E=F=V=aa=c._normals[T],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}if(c._vertices[t].x>Ha){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();
Z=0;for(gb=c.count;Z<gb;)O=Z++,null!=c.local_vertices[O]&&(null==c._vertices[O]&&(da=c._vertices,fa=new P(0,0),da[O]=fa),La=c.local_vertices[O].x,ba=c.local_vertices[O].y,null==ba&&(ba=0),null==La&&(La=0),W=c.transform.get_local_to_world_matrix(),ha=La,pa=ba,Na=1,la=W.m00*ha+W.m10*pa+W.m20*Na,ja=W.m01*ha+W.m11*pa+W.m21*Na,Xa=la,Ua=ja,Da=c._vertices[O],Da.x=Xa,Da.y=Ua);qa=0;for(ua=c.count;qa<ua;)qb=qa++,ra=c._vertices[(qb+1)%c.count],ka=ra.x,rb=ra.y,va=c._vertices[qb],eb=ka-va.x,Aa=rb-va.y,ka=eb,rb=
Aa,ya=-rb,rb=ka,ka=ya,null==c._normals[qb]?(Ca=c._normals,za=new P(ka,rb),Ca[qb]=za):(ma=c._normals[qb],ma.x=ka,ma.y=rb),wa=Ja=sa=Fa=c._normals[qb],Oa=wa.x*wa.x+wa.y*wa.y,Ea=0==Oa?1:Math.sqrt(Oa),Ba=Ja.x/Ea,Ia=Ja.y/Ea,Ma=Ba,Ga=Ia,sa.x=Ma,sa.y=Ga}Ha=c._vertices[t].x}}Pa=Ha}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var hb=180/Math.PI*c.local_radians;else c.sync(),hb=180/Math.PI*c._radians;var Nc=0==hb}else Nc=!0;if(Nc){c=b.transform;null==c.parent?Nc=c.local_y:(c.sync(),Nc=c._y);
var Ra=Nc-b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();m=0;for(n=c.count;m<n;)t=m++,null!=c.local_vertices[t]&&(null==c._vertices[t]&&(x=c._vertices,p=new P(0,0),x[t]=p),K=c.local_vertices[t].x,k=c.local_vertices[t].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[t],
q.x=r,q.y=H);m=0;for(n=c.count;m<n;)t=m++,q=c._vertices[(t+1)%c.count],z=q.x,y=q.y,w=c._vertices[t],B=z-w.x,C=y-w.y,z=B,y=C,K=-y,y=z,z=K,null==c._normals[t]?(x=c._normals,p=new P(z,y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y),E=F=V=ia=c._normals[t],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}Nc=null==c._vertices[0]}else Nc=!0;if(Nc)x=c.transform,null==x.parent?Ra=x.local_y:(x.sync(),Ra=x._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();
m=0;for(n=c.count;m<n;)t=m++,null!=c.local_vertices[t]&&(null==c._vertices[t]&&(x=c._vertices,p=new P(0,0),x[t]=p),K=c.local_vertices[t].x,k=c.local_vertices[t].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[t],q.x=r,q.y=H);m=0;for(n=c.count;m<n;)t=m++,q=c._vertices[(t+1)%c.count],z=q.x,y=q.y,w=c._vertices[t],B=z-w.x,C=y-w.y,z=B,y=C,K=-y,y=z,z=K,null==c._normals[t]?(x=c._normals,p=new P(z,
y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y),E=F=V=ia=c._normals[t],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}Nc=c._vertices[0].y;m=1;for(n=c.count;m<n;){t=m++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();M=0;for(Ta=c.count;M<Ta;)ea=M++,null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(x=c._vertices,p=new P(0,0),x[ea]=p),K=c.local_vertices[ea].x,k=c.local_vertices[ea].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),
z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[ea],q.x=r,q.y=H);db=0;for(S=c.count;db<S;)T=db++,ia=c._vertices[(T+1)%c.count],L=ia.x,ca=ia.y,w=c._vertices[T],B=L-w.x,C=ca-w.y,L=B,ca=C,R=-ca,ca=L,L=R,null==c._normals[T]?(jb=c._normals,U=new P(L,ca),jb[T]=U):(Y=c._normals[T],Y.x=L,Y.y=ca),E=F=V=aa=c._normals[T],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}if(c._vertices[t].y<Nc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>
c.count;)c._vertices.pop();Z=0;for(gb=c.count;Z<gb;)O=Z++,null!=c.local_vertices[O]&&(null==c._vertices[O]&&(da=c._vertices,fa=new P(0,0),da[O]=fa),La=c.local_vertices[O].x,ba=c.local_vertices[O].y,null==ba&&(ba=0),null==La&&(La=0),W=c.transform.get_local_to_world_matrix(),ha=La,pa=ba,Na=1,la=W.m00*ha+W.m10*pa+W.m20*Na,ja=W.m01*ha+W.m11*pa+W.m21*Na,Xa=la,Ua=ja,Da=c._vertices[O],Da.x=Xa,Da.y=Ua);qa=0;for(ua=c.count;qa<ua;)qb=qa++,ra=c._vertices[(qb+1)%c.count],ka=ra.x,rb=ra.y,va=c._vertices[qb],eb=
ka-va.x,Aa=rb-va.y,ka=eb,rb=Aa,ya=-rb,rb=ka,ka=ya,null==c._normals[qb]?(Ca=c._normals,za=new P(ka,rb),Ca[qb]=za):(ma=c._normals[qb],ma.x=ka,ma.y=rb),wa=Ja=sa=Fa=c._normals[qb],Oa=wa.x*wa.x+wa.y*wa.y,Ea=0==Oa?1:Math.sqrt(Oa),Ba=Ja.x/Ea,Ia=Ja.y/Ea,Ma=Ba,Ga=Ia,sa.x=Ma,sa.y=Ga}Nc=c._vertices[t].y}}Ra=Nc}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var Ya=180/Math.PI*c.local_radians;else c.sync(),Ya=180/Math.PI*c._radians;var rc=0==Ya}else rc=!0;if(rc){c=b.transform;null==c.parent?rc=
c.local_y:(c.sync(),rc=c._y);var Za=rc+b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();m=0;for(n=c.count;m<n;)t=m++,null!=c.local_vertices[t]&&(null==c._vertices[t]&&(x=c._vertices,p=new P(0,0),x[t]=p),K=c.local_vertices[t].x,k=c.local_vertices[t].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*
Q,r=A,H=na,q=c._vertices[t],q.x=r,q.y=H);m=0;for(n=c.count;m<n;)t=m++,q=c._vertices[(t+1)%c.count],z=q.x,y=q.y,w=c._vertices[t],B=z-w.x,C=y-w.y,z=B,y=C,K=-y,y=z,z=K,null==c._normals[t]?(x=c._normals,p=new P(z,y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y),E=F=V=ia=c._normals[t],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}rc=null==c._vertices[0]}else rc=!0;if(rc)x=c.transform,null==x.parent?Za=x.local_y:(x.sync(),Za=x._y);else{if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();m=0;for(n=c.count;m<n;)t=m++,null!=c.local_vertices[t]&&(null==c._vertices[t]&&(x=c._vertices,p=new P(0,0),x[t]=p),K=c.local_vertices[t].x,k=c.local_vertices[t].y,null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[t],q.x=r,q.y=H);m=0;for(n=c.count;m<n;)t=m++,q=c._vertices[(t+1)%c.count],z=q.x,y=q.y,w=c._vertices[t],B=z-w.x,C=y-w.y,z=B,y=C,K=
-y,y=z,z=K,null==c._normals[t]?(x=c._normals,p=new P(z,y),x[t]=p):(u=c._normals[t],u.x=z,u.y=y),E=F=V=ia=c._normals[t],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=I}rc=c._vertices[0].y;m=1;for(n=c.count;m<n;){t=m++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();M=0;for(Ta=c.count;M<Ta;)ea=M++,null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(x=c._vertices,p=new P(0,0),x[ea]=p),K=c.local_vertices[ea].x,k=c.local_vertices[ea].y,
null==k&&(k=0),null==K&&(K=0),u=c.transform.get_local_to_world_matrix(),z=K,y=k,Q=1,A=u.m00*z+u.m10*y+u.m20*Q,na=u.m01*z+u.m11*y+u.m21*Q,r=A,H=na,q=c._vertices[ea],q.x=r,q.y=H);db=0;for(S=c.count;db<S;)T=db++,ia=c._vertices[(T+1)%c.count],L=ia.x,ca=ia.y,w=c._vertices[T],B=L-w.x,C=ca-w.y,L=B,ca=C,R=-ca,ca=L,L=R,null==c._normals[T]?(jb=c._normals,U=new P(L,ca),jb[T]=U):(Y=c._normals[T],Y.x=L,Y.y=ca),E=F=V=aa=c._normals[T],G=E.x*E.x+E.y*E.y,D=0==G?1:Math.sqrt(G),oa=F.x/D,xa=F.y/D,J=oa,I=xa,V.x=J,V.y=
I}if(c._vertices[t].y>rc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();Z=0;for(gb=c.count;Z<gb;)O=Z++,null!=c.local_vertices[O]&&(null==c._vertices[O]&&(da=c._vertices,fa=new P(0,0),da[O]=fa),La=c.local_vertices[O].x,ba=c.local_vertices[O].y,null==ba&&(ba=0),null==La&&(La=0),W=c.transform.get_local_to_world_matrix(),ha=La,pa=ba,Na=1,la=W.m00*ha+W.m10*pa+W.m20*Na,ja=W.m01*ha+W.m11*pa+W.m21*Na,Xa=la,Ua=ja,Da=c._vertices[O],Da.x=Xa,Da.y=Ua);qa=0;for(ua=c.count;qa<
ua;)qb=qa++,ra=c._vertices[(qb+1)%c.count],ka=ra.x,rb=ra.y,va=c._vertices[qb],eb=ka-va.x,Aa=rb-va.y,ka=eb,rb=Aa,ya=-rb,rb=ka,ka=ya,null==c._normals[qb]?(Ca=c._normals,za=new P(ka,rb),Ca[qb]=za):(ma=c._normals[qb],ma.x=ka,ma.y=rb),wa=Ja=sa=Fa=c._normals[qb],Oa=wa.x*wa.x+wa.y*wa.y,Ea=0==Oa?1:Math.sqrt(Oa),Ba=Ja.x/Ea,Ia=Ja.y/Ea,Ma=Ba,Ga=Ia,sa.x=Ma,sa.y=Ga}rc=c._vertices[t].y}}Za=rc}}K=h;k=Ra;var kb=Pa,sc=Ra;null==sc&&(sc=1);null==kb&&(kb=1);null==k&&(k=0);null==K&&(K=0);var X=Jb.pool.get();R=K;ba=k;
var cb=kb,Qa=sc;null==Qa&&(Qa=1);null==cb&&(cb=1);null==ba&&(ba=0);null==R&&(R=0);q=X.start;q.x=R;q.y=ba;q=X.end;q.x=cb;q.y=Qa;X.pooled=!1;var $a=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs($a))var ib=null;else{var sb=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/$a,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/$a;if(0>sb||1<sb||0>bc||1<bc)ib=
null;else{u=a.start;var tc=sb;Y=a.end;w=a.start;var Ab=Y.x-w.x,Sa=Y.y-w.y;B=Ab*tc;C=Sa*tc;var gc=u.x+B,Xb=u.y+C;u=a.start;var Ka=gc-u.x,Va=Xb-u.y,nb=Math.sqrt(Ka*Ka+Va*Va);u=a.start;w=a.end;Ka=w.x-u.x;Va=w.y-u.y;var Wa=Math.sqrt(Ka*Ka+Va*Va)-nb,lb=0<=$a;u=X.start;w=X.end;Ka=w.x-u.x;Va=w.y-u.y;var tb=Math.sqrt(Ka*Ka+Va*Va)*(lb?-1:1);q=ta.norm;K=(X.get_dy()-X.get_y())/tb;k=-(X.get_dx()-X.get_x())/tb;q.x=K;q.y=k;var bb=ta.norm.x,fb=ta.norm.y,Lb=lb;null==Lb&&(Lb=!1);t=Fb.pool.get();t.line=null;t.shape=
null;t.line2=null;var xb=Lb;null==xb&&(xb=!1);t.distance=nb;t.overlap=Wa;t.inverse_normal=xb;q=t.hit;q.x=gc;q.y=Xb;q=t.normal;q.x=bb;q.y=fb;t.pooled=!1;var Mb=t;Mb.line=a;Mb.line2=X;ib=Mb}}null!=ib&&(g=ib);K=Pa;k=Ra;kb=Pa;sc=Za;null==sc&&(sc=1);null==kb&&(kb=1);null==k&&(k=0);null==K&&(K=0);q=X.start;q.x=K;q.y=k;q=X.end;q.x=kb;q.y=sc;$a=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs($a)?ib=null:(sb=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-
(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/$a,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/$a,0>sb||1<sb||0>bc||1<bc?ib=null:(u=a.start,tc=sb,Y=a.end,w=a.start,Ab=Y.x-w.x,Sa=Y.y-w.y,B=Ab*tc,C=Sa*tc,gc=u.x+B,Xb=u.y+C,u=a.start,Ka=gc-u.x,Va=Xb-u.y,nb=Math.sqrt(Ka*Ka+Va*Va),u=a.start,w=a.end,Ka=w.x-u.x,Va=w.y-u.y,Wa=Math.sqrt(Ka*Ka+Va*Va)-nb,lb=0<=$a,u=X.start,w=X.end,Ka=w.x-u.x,Va=w.y-u.y,tb=Math.sqrt(Ka*Ka+Va*Va)*(lb?-1:1),q=ta.norm,K=(X.get_dy()-
X.get_y())/tb,k=-(X.get_dx()-X.get_x())/tb,q.x=K,q.y=k,bb=ta.norm.x,fb=ta.norm.y,Lb=lb,null==Lb&&(Lb=!1),t=Fb.pool.get(),t.line=null,t.shape=null,t.line2=null,xb=Lb,null==xb&&(xb=!1),t.distance=nb,t.overlap=Wa,t.inverse_normal=xb,q=t.hit,q.x=gc,q.y=Xb,q=t.normal,q.x=bb,q.y=fb,t.pooled=!1,Mb=t,Mb.line=a,Mb.line2=X,ib=Mb));null!=ib&&(null==g||g.distance>ib.distance)&&(g=ib);K=Pa;k=Za;kb=h;sc=Za;null==sc&&(sc=1);null==kb&&(kb=1);null==k&&(k=0);null==K&&(K=0);q=X.start;q.x=K;q.y=k;q=X.end;q.x=kb;q.y=
sc;$a=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs($a)?ib=null:(sb=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/$a,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/$a,0>sb||1<sb||0>bc||1<bc?ib=null:(u=a.start,tc=sb,Y=a.end,w=a.start,Ab=Y.x-w.x,Sa=Y.y-w.y,B=Ab*tc,C=Sa*tc,gc=u.x+B,Xb=u.y+C,u=a.start,Ka=gc-u.x,Va=Xb-u.y,nb=Math.sqrt(Ka*Ka+Va*Va),u=
a.start,w=a.end,Ka=w.x-u.x,Va=w.y-u.y,Wa=Math.sqrt(Ka*Ka+Va*Va)-nb,lb=0<=$a,u=X.start,w=X.end,Ka=w.x-u.x,Va=w.y-u.y,tb=Math.sqrt(Ka*Ka+Va*Va)*(lb?-1:1),q=ta.norm,K=(X.get_dy()-X.get_y())/tb,k=-(X.get_dx()-X.get_x())/tb,q.x=K,q.y=k,bb=ta.norm.x,fb=ta.norm.y,Lb=lb,null==Lb&&(Lb=!1),t=Fb.pool.get(),t.line=null,t.shape=null,t.line2=null,xb=Lb,null==xb&&(xb=!1),t.distance=nb,t.overlap=Wa,t.inverse_normal=xb,q=t.hit,q.x=gc,q.y=Xb,q=t.normal,q.x=bb,q.y=fb,t.pooled=!1,Mb=t,Mb.line=a,Mb.line2=X,ib=Mb));null!=
ib&&(null==g||g.distance>ib.distance)&&(g=ib);K=h;k=Za;kb=h;sc=Ra;null==sc&&(sc=1);null==kb&&(kb=1);null==k&&(k=0);null==K&&(K=0);q=X.start;q.x=K;q.y=k;q=X.end;q.x=kb;q.y=sc;$a=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs($a)?ib=null:(sb=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/$a,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/$a,0>sb||1<
sb||0>bc||1<bc?ib=null:(u=a.start,tc=sb,Y=a.end,w=a.start,Ab=Y.x-w.x,Sa=Y.y-w.y,B=Ab*tc,C=Sa*tc,gc=u.x+B,Xb=u.y+C,u=a.start,Ka=gc-u.x,Va=Xb-u.y,nb=Math.sqrt(Ka*Ka+Va*Va),u=a.start,w=a.end,Ka=w.x-u.x,Va=w.y-u.y,Wa=Math.sqrt(Ka*Ka+Va*Va)-nb,lb=0<=$a,u=X.start,w=X.end,Ka=w.x-u.x,Va=w.y-u.y,tb=Math.sqrt(Ka*Ka+Va*Va)*(lb?-1:1),q=ta.norm,K=(X.get_dy()-X.get_y())/tb,k=-(X.get_dx()-X.get_x())/tb,q.x=K,q.y=k,bb=ta.norm.x,fb=ta.norm.y,Lb=lb,null==Lb&&(Lb=!1),t=Fb.pool.get(),t.line=null,t.shape=null,t.line2=
null,xb=Lb,null==xb&&(xb=!1),t.distance=nb,t.overlap=Wa,t.inverse_normal=xb,q=t.hit,q.x=gc,q.y=Xb,q=t.normal,q.x=bb,q.y=fb,t.pooled=!1,Mb=t,Mb.line=a,Mb.line2=X,ib=Mb));null!=ib&&(null==g||g.distance>ib.distance)&&(g=ib);null!=g&&(g.line=a,g.shape=b);return g};ta.line_intersects_circle=function(a,b){var c=a.end,e=a.start,f=c.x-e.x,g=c.y-e.y;c=a.start;var d=b.transform;d.sync();var l=d._x,h=d._y,m=c.x-l;l=c.y-h;h=b.local_radius;d=b.transform;null==d.parent?c=d.local_scale_x:(d.sync(),c=d._scale_x);
h*=c;c=f*f+g*g;e=2*(m*f+l*g);g=e*e-4*c*(m*m+l*l-h*h);if(0>g)return null;g=Math.sqrt(g);f=(-e-g)/(2*c);g=(-e+g)/(2*c);return 0<=f&&1>=f?(c=a.start,g=f,d=a.end,e=a.start,f=d.x-e.x,m=d.y-e.y,f=c.x+f*g,g=c.y+m*g,c=a.start,d=f-c.x,c=g-c.y,m=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-m,c=ta.norm,d=b.transform,null==d.parent?l=d.local_x:(d.sync(),l=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=f-l,c.y=g-d,c=ta.norm,l=c.x/h,h=c.y/h,c.x=l,c.y=h,h=ta.norm.x,
d=ta.norm.y,l=Fb.pool.get(),l.line=null,l.shape=null,l.line2=null,c=!1,null==c&&(c=!1),l.distance=m,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=f,c.y=g,c=l.normal,c.x=h,c.y=d,l.pooled=!1,h=l,h.line=a,h.shape=b,h):0<=g&&1>=g?(c=a.start,d=a.end,e=a.start,f=d.x-e.x,m=d.y-e.y,f=c.x+f*g,g=c.y+m*g,c=a.start,d=f-c.x,c=g-c.y,m=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-m,c=ta.norm,d=b.transform,null==d.parent?l=d.local_x:(d.sync(),l=d._x),d=b.transform,null==d.parent?d=d.local_y:
(d.sync(),d=d._y),c.x=f-l,c.y=g-d,d=c=ta.norm,l=-d.y,c.x=-d.x/h,c.y=l/h,h=ta.norm.x,d=ta.norm.y,c=!0,null==c&&(c=!1),l=Fb.pool.get(),l.line=null,l.shape=null,l.line2=null,null==c&&(c=!1),l.distance=m,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=f,c.y=g,c=l.normal,c.x=h,c.y=d,l.pooled=!1,h=l,h.line=a,h.shape=b,h):null};ta.line_intersects_polygon=function(a,b){var c=null,e=Jb.pool.get(),f=0,g=0,d=1,l=1;null==l&&(l=1);null==d&&(d=1);null==g&&(g=0);null==f&&(f=0);var h=e.start;h.x=f;h.y=g;h=e.end;h.x=d;
h.y=l;e.pooled=!1;for(var m=0,n=b.count;m<n;){var t=m++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var x=0,p=b.count;x<p;){var K=x++;if(null!=b.local_vertices[K]){if(null==b._vertices[K]){var u=b._vertices,k=new P(0,0);u[K]=k}f=b.local_vertices[K].x;g=b.local_vertices[K].y;null==g&&(g=0);null==f&&(f=0);var z=b.transform.get_local_to_world_matrix(),y=f,q=g,w=z.m00*y+z.m10*q+1*z.m20,Q=z.m01*y+z.m11*q+1*z.m21;h=b._vertices[K];h.x=w;h.y=Q}}for(var A=
0,na=b.count;A<na;){var r=A++,H=b._vertices[(r+1)%b.count],B=H.x,C=H.y,E=b._vertices[r],ia=C-E.y;B-=E.x;C=ia;var V=-C;C=B;B=V;if(null==b._normals[r]){var F=b._normals,G=new P(B,C);F[r]=G}else{var D=b._normals[r];D.x=B;D.y=C}var oa=b._normals[r],xa=oa,J=oa,I=J,ea=I.x*I.x+I.y*I.y,M=0==ea?1:Math.sqrt(ea),T=J.y/M;xa.x=J.x/M;xa.y=T}}var Ta=b._vertices[t];if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var db=0,L=b.count;db<L;){var S=db++;if(null!=b.local_vertices[S]){if(null==
b._vertices[S]){var ca=b._vertices,Y=new P(0,0);ca[S]=Y}var R=b.local_vertices[S].x,O=b.local_vertices[S].y;null==O&&(O=0);null==R&&(R=0);var jb=b.transform.get_local_to_world_matrix(),W=R,U=O,ba=jb.m01*W+jb.m11*U+1*jb.m21,Z=b._vertices[S];Z.x=jb.m00*W+jb.m10*U+1*jb.m20;Z.y=ba}}for(var La=0,gb=b.count;La<gb;){var aa=La++,da=b._vertices[(aa+1)%b.count],fa=da.x,ha=da.y,ka=b._vertices[aa],pa=ha-ka.y;fa-=ka.x;ha=pa;var Na=-ha;ha=fa;fa=Na;if(null==b._normals[aa]){var la=b._normals,ja=new P(fa,ha);la[aa]=
ja}else{var Da=b._normals[aa];Da.x=fa;Da.y=ha}var qa=b._normals[aa],Xa=qa,Ua=qa,ra=Ua,wa=ra.x*ra.x+ra.y*ra.y,va=0==wa?1:Math.sqrt(wa),ua=Ua.y/va;Xa.x=Ua.x/va;Xa.y=ua}}var eb=b._vertices[(t+1)%b.count],Aa=Ta.x,ma=Ta.y;d=eb.x;l=eb.y;null==l&&(l=1);null==d&&(d=1);null==ma&&(ma=0);null==Aa&&(Aa=0);var ya=e.start;ya.x=Aa;ya.y=ma;var Ca=e.end;Ca.x=d;Ca.y=l;var za=(e.get_dy()-e.get_y())*(a.get_dx()-a.get_x())-(e.get_dx()-e.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(za))var Ja=null;else{var sa=((e.get_dx()-
e.get_x())*(a.get_y()-e.get_y())-(e.get_dy()-e.get_y())*(a.get_x()-e.get_x()))/za,Oa=((a.get_dx()-a.get_x())*(a.get_y()-e.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-e.get_x()))/za;if(0>sa||1<sa||0>Oa||1<Oa)Ja=null;else{var Ea=a.start,Ha=sa,Fa=a.end,Ba=a.start,Ia=Ea.x+(Fa.x-Ba.x)*Ha,Ma=Ea.y+(Fa.y-Ba.y)*Ha,Ga=a.start,Pa=Ia-Ga.x,Ra=Ma-Ga.y,Za=Math.sqrt(Pa*Pa+Ra*Ra),Sa=a.start,Wa=a.end,ab=Wa.x-Sa.x,bb=Wa.y-Sa.y,fb=Math.sqrt(ab*ab+bb*bb)-Za,rc=0<=za,cb=e.start,kb=e.end,hb=kb.x-cb.x,X=kb.y-cb.y,Qa=Math.sqrt(hb*
hb+X*X)*(rc?-1:1),Ya=ta.norm,$a=(e.get_dy()-e.get_y())/Qa,ib=-(e.get_dx()-e.get_x())/Qa;Ya.x=$a;Ya.y=ib;var sb=ta.norm.x,bc=ta.norm.y,tc=rc;null==tc&&(tc=!1);var Ab=Fb.pool.get();Ab.line=null;Ab.shape=null;Ab.line2=null;var mb=tc;null==mb&&(mb=!1);Ab.distance=Za;Ab.overlap=fb;Ab.inverse_normal=mb;var gc=Ab.hit;gc.x=Ia;gc.y=Ma;var Xb=Ab.normal;Xb.x=sb;Xb.y=bc;Ab.pooled=!1;var Ka=Ab;Ka.line=a;Ka.line2=e;Ja=Ka}}null!=Ja&&(null==c||c.distance>Ja.distance)&&(c=Ja)}null!=c&&(c.line=a,c.shape=b);return c};
ta.rect_and_rect=function(a,b,c){null==c&&(c=!1);var e=null,f=a.transform;if(null==f.parent)var g=180/Math.PI*f.local_radians;else f.sync(),g=180/Math.PI*f._radians;0==g?(f=b.transform,null==f.parent?g=180/Math.PI*f.local_radians:(f.sync(),g=180/Math.PI*f._radians),g=0!=g):g=!0;if(g){if(null!=a.transformed_rect){e=ta.rect_and_polygon(b,a.transformed_rect,c);if(null==e)return null;c?e.sa=a:e.sb=a;return e}if(null!=b.transformed_rect){e=ta.rect_and_polygon(a,b.transformed_rect,!c);if(null==e)return null;
c?e.sa=b:e.sb=b;return e}}g=c?b:a;a=c?a:b;f=a.transform;null==f.parent?b=f.local_x:(f.sync(),b=f._x);f=g.transform;null==f.parent?f=f.local_x:(f.sync(),f=f._x);b-=f;f=a.transform;null==f.parent?c=f.local_y:(f.sync(),c=f._y);f=g.transform;null==f.parent?f=f.local_y:(f.sync(),f=f._y);f=c-f;c=g.local_ex*g.transform.local_scale_x+a.local_ex*a.transform.local_scale_x-Math.abs(b);if(0<c){var d=g.local_ey*g.transform.local_scale_y+a.local_ey*a.transform.local_scale_y-Math.abs(f);if(0<d){if(c<d){e=qc.pool.get();
e.sa=null;e.sb=null;for(var l=e.contact_count=0,h=e.contacts;l<h.length;){var m=h[l];++l;m.x=0;m.y=0}e.overlap=c;c=e.normal;c.x=0>b?-1:1;c.y=0}else{e=qc.pool.get();e.sa=null;e.sb=null;l=e.contact_count=0;for(h=e.contacts;l<h.length;)m=h[l],++l,m.x=0,m.y=0;e.overlap=d;c=e.normal;c.x=0;c.y=0>f?-1:1}e.pooled=!1;e.sa=g;e.sb=a}}return e};ta.circle_and_circle=function(a,b,c){null==c&&(c=!1);var e=c?b:a;a=c?a:b;var f=a.transform;null==f.parent?b=f.local_x:(f.sync(),b=f._x);f=e.transform;null==f.parent?c=
f.local_x:(f.sync(),c=f._x);b-=c;f=a.transform;null==f.parent?c=f.local_y:(f.sync(),c=f._y);f=e.transform;null==f.parent?f=f.local_y:(f.sync(),f=f._y);c-=f;var g=e.local_radius;f=e.transform;if(null==f.parent)var d=f.local_scale_x;else f.sync(),d=f._scale_x;var l=a.local_radius;f=a.transform;null==f.parent?f=f.local_scale_x:(f.sync(),f=f._scale_x);g=g*d+l*f;d=b*b+c*c;f=null;if(d>=g*g)return f;if(1E-5>=Math.abs(d)){g=e.local_radius;f=e.transform;null==f.parent?b=f.local_scale_x:(f.sync(),b=f._scale_x);
b*=g;f=qc.pool.get();f.sa=null;f.sb=null;l=f.contact_count=0;for(var h=f.contacts;l<h.length;){var m=h[l];++l;m.x=0;m.y=0}f.overlap=b;g=f.normal;g.x=1;g.y=0}else{d=Math.sqrt(d);b/=d;c/=d;f=qc.pool.get();f.sa=null;f.sb=null;l=f.contact_count=0;for(h=f.contacts;l<h.length;)m=h[l],++l,m.x=0,m.y=0;f.overlap=g-d;g=f.normal;g.x=b;g.y=c}f.pooled=!1;f.sa=e;f.sb=a;return f};ta.polygon_and_polygon=function(a,b,c){null==c&&(c=!1);var e=ta.check_polygons(a,b,c);if(null==e)return null;a=ta.check_polygons(b,a,
!c);if(null==a)return null;0>e.overlap&&(e.overlap=Math.abs(e.overlap));0>a.overlap&&(a.overlap=Math.abs(a.overlap));if(e.overlap<a.overlap)return a.put(),e;e.put();return a};ta.rect_and_circle=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect){var e=a.transform;if(null==e.parent)var f=180/Math.PI*e.local_radians;else e.sync(),f=180/Math.PI*e._radians;f=0!=f}else f=!1;if(f){f=ta.circle_and_polygon(b,a.transformed_rect,c);if(null==f)return null;c?f.sa=a:f.sb=a;return f}c?(e=b.transform,null==
e.parent?f=e.local_x:(e.sync(),f=e._x),e=a.transform):(e=a.transform,null==e.parent?f=e.local_x:(e.sync(),f=e._x),e=b.transform);if(null==e.parent)var g=e.local_x;else e.sync(),g=e._x;f-=g;c?(e=b.transform,null==e.parent?g=e.local_y:(e.sync(),g=e._y),e=a.transform):(e=a.transform,null==e.parent?g=e.local_y:(e.sync(),g=e._y),e=b.transform);if(null==e.parent)var d=e.local_y;else e.sync(),d=e._y;g-=d;var l=f,h=g;d=-(a.local_ex*a.transform.local_scale_x);var m=a.local_ex*a.transform.local_scale_x;l<d?
l=d:l>m&&(l=m);d=-(a.local_ey*a.transform.local_scale_y);m=a.local_ey*a.transform.local_scale_y;h<d?h=d:h>m&&(h=m);m=!1;d=b.local_radius;e=b.transform;null==e.parent?e=e.local_scale_x:(e.sync(),e=e._scale_x);d*=e;1E-5>=Math.abs(f-l)&&1E-5>=Math.abs(g-h)&&(m=!0,Math.abs(f)>Math.abs(g)?l=0<l?a.local_ex*a.transform.local_scale_x+d+.1:-(a.local_ex*a.transform.local_scale_x)-d-.1:h=0<h?a.local_ey*a.transform.local_scale_y+d+.1:-(a.local_ey*a.transform.local_scale_y)-d-.1);f-=l;g-=h;l=f*f+g*g;if(l>d*d&&
!m)return null;l=Math.sqrt(l);f/=l;g/=l;m&&(f*=-1,g*=-1);l=Math.abs(d-l);d=qc.pool.get();d.sa=null;d.sb=null;h=d.contact_count=0;for(m=d.contacts;h<m.length;)e=m[h],++h,e.x=0,e.y=0;d.overlap=l;l=d.normal;l.x=f;l.y=g;d.pooled=!1;f=d;f.sa=c?b:a;f.sb=c?a:b;return f};ta.rect_and_polygon=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect)b=ta.polygon_and_polygon(a.transformed_rect,b,c);else{var e=Ra.pool.get();e.count=4;for(var f=0,g=e.count;f<g;){var d=f++;if(null==e.local_vertices[d]){var l=
e.local_vertices,h=new P(0,0);l[d]=h}}f=e.local_vertices[0];f.x=-(a.local_ex*a.transform.local_scale_x);f.y=-(a.local_ey*a.transform.local_scale_y);f=e.local_vertices[1];f.x=a.local_ex*a.transform.local_scale_x;f.y=-(a.local_ey*a.transform.local_scale_y);f=e.local_vertices[2];f.x=a.local_ex*a.transform.local_scale_x;f.y=a.local_ey*a.transform.local_scale_y;f=e.local_vertices[3];f.x=-(a.local_ex*a.transform.local_scale_x);f.y=a.local_ey*a.transform.local_scale_y;f=a.transform.local_x;g=e.transform;
g.dirty||g.set_dirty();g.local_x=f;f=a.transform.local_y;g=e.transform;g.dirty||g.set_dirty();g.local_y=f;g=e.transform;f=Math.PI/180*(180/Math.PI)*a.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=f;f=a.transform.local_scale_x;g=e.transform;g.dirty||g.set_dirty();g.local_scale_x=f;f=a.transform.local_scale_y;g=e.transform;g.dirty||g.set_dirty();g.local_scale_y=f;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;e.set_parent(a.parent);b=ta.polygon_and_polygon(e,b,c);e.put()}if(null==
b)return null;c?b.sb=a:b.sa=a;return b};ta.circle_and_polygon=function(a,b,c){null==c&&(c=!1);var e=0,f=1073741823,g=a.transform;g.sync();var d=g._x,l=g._y,h=a.local_radius;g=a.transform;if(null==g.parent)var m=g.local_scale_x;else g.sync(),m=g._scale_x;for(var n=h*m,t=0,x=b.count;t<x;){var p=t++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var K=0,u=b.count;K<u;){var k=K++;if(null!=b.local_vertices[k]){if(null==b._vertices[k]){var z=b._vertices,y=
new P(0,0);z[k]=y}var q=b.local_vertices[k].x,w=b.local_vertices[k].y;null==w&&(w=0);null==q&&(q=0);var Q=b.transform.get_local_to_world_matrix(),A=q,r=w,C=1,B=Q.m00*A+Q.m10*r+Q.m20*C,H=Q.m01*A+Q.m11*r+Q.m21*C,na=B,E=H,ia=b._vertices[k];ia.x=na;ia.y=E}}for(var V=0,F=b.count;V<F;){var G=V++,D=b._vertices[(G+1)%b.count],oa=D.x,xa=D.y,J=b._vertices[G],I=oa-J.x,ea=xa-J.y;oa=I;xa=ea;var M=-xa;xa=oa;oa=M;if(null==b._normals[G]){var Ta=b._normals,T=new P(oa,xa);Ta[G]=T}else{var db=b._normals[G];db.x=oa;
db.y=xa}var L=b._normals[G],S=L,ca=L,Y=ca,R=Y.x*Y.x+Y.y*Y.y,O=0==R?1:Math.sqrt(R),jb=ca.x/O,W=ca.y/O,U=jb,ba=W;S.x=U;S.y=ba}}var Z=b._vertices[p],aa=d-Z.x,La=l-Z.y;e=aa*aa+La*La;if(e<f){f=e;var fa=ta.closest;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var gb=0,ha=b.count;gb<ha;){var da=gb++;if(null!=b.local_vertices[da]){if(null==b._vertices[da]){var ka=b._vertices,pa=new P(0,0);ka[da]=pa}var Na=b.local_vertices[da].x,la=b.local_vertices[da].y;null==
la&&(la=0);null==Na&&(Na=0);var ja=b.transform.get_local_to_world_matrix(),Da=Na,qa=la,ra=1,Xa=ja.m00*Da+ja.m10*qa+ja.m20*ra,Ua=ja.m01*Da+ja.m11*qa+ja.m21*ra,wa=Xa,va=Ua,ua=b._vertices[da];ua.x=wa;ua.y=va}}for(var Ja=0,Aa=b.count;Ja<Aa;){var ma=Ja++,za=b._vertices[(ma+1)%b.count],eb=za.x,sa=za.y,ya=b._vertices[ma],Ca=eb-ya.x,Oa=sa-ya.y;eb=Ca;sa=Oa;var Ea=-sa;sa=eb;eb=Ea;if(null==b._normals[ma]){var Jb=b._normals,Ha=new P(eb,sa);Jb[ma]=Ha}else{var Fa=b._normals[ma];Fa.x=eb;Fa.y=sa}var Ba=b._normals[ma],
Ia=Ba,Ma=Ba,Ga=Ma,Pa=Ga.x*Ga.x+Ga.y*Ga.y,Ra=0==Pa?1:Math.sqrt(Pa),Za=Ma.x/Ra,Sa=Ma.y/Ra,Wa=Za,ab=Sa;Ia.x=Wa;Ia.y=ab}}var bb=b._vertices[p].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var cb=0,hb=b.count;cb<hb;){var kb=cb++;if(null!=b.local_vertices[kb]){if(null==b._vertices[kb]){var fb=b._vertices,X=new P(0,0);fb[kb]=X}var Qa=b.local_vertices[kb].x,Ya=b.local_vertices[kb].y;null==Ya&&(Ya=0);null==Qa&&(Qa=0);var $a=b.transform.get_local_to_world_matrix(),
ib=Qa,sb=Ya,bc=1,mb=$a.m00*ib+$a.m10*sb+$a.m20*bc,Ab=$a.m01*ib+$a.m11*sb+$a.m21*bc,Ib=mb,gc=Ab,Xb=b._vertices[kb];Xb.x=Ib;Xb.y=gc}}for(var Ka=0,Va=b.count;Ka<Va;){var nb=Ka++,Eb=b._vertices[(nb+1)%b.count],lb=Eb.x,tb=Eb.y,fc=b._vertices[nb],ob=lb-fc.x,Lb=tb-fc.y;lb=ob;tb=Lb;var xb=-tb;tb=lb;lb=xb;if(null==b._normals[nb]){var Mb=b._normals,Gb=new P(lb,tb);Mb[nb]=Gb}else{var zb=b._normals[nb];zb.x=lb;zb.y=tb}var Db=b._normals[nb],Kb=Db,Fb=Db,gd=Fb,pb=gd.x*gd.x+gd.y*gd.y,Hb=0==pb?1:Math.sqrt(pb),Vb=
Fb.x/Hb,Rb=Fb.y/Hb,Sb=Vb,Tb=Rb;Kb.x=Sb;Kb.y=Tb}}var Ob=b._vertices[p].y;fa.x=bb;fa.y=Ob}}Q=ta.closest;aa=Q.x-d;La=Q.y-l;R=aa*aa+La*La;O=0==R?1:Math.sqrt(R);var yb=aa/O,wb=La/O,ub=0;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();t=0;for(x=b.count;t<x;)p=t++,null!=b.local_vertices[p]&&(null==b._vertices[p]&&(z=b._vertices,y=new P(0,0),z[p]=y),q=b.local_vertices[p].x,w=b.local_vertices[p].y,null==w&&(w=0),null==q&&(q=0),Q=b.transform.get_local_to_world_matrix(),
A=q,r=w,C=1,B=Q.m00*A+Q.m10*r+Q.m20*C,H=Q.m01*A+Q.m11*r+Q.m21*C,na=B,E=H,ia=b._vertices[p],ia.x=na,ia.y=E);t=0;for(x=b.count;t<x;)p=t++,ia=b._vertices[(p+1)%b.count],A=ia.x,r=ia.y,J=b._vertices[p],I=A-J.x,ea=r-J.y,A=I,r=ea,q=-r,r=A,A=q,null==b._normals[p]?(z=b._normals,y=new P(A,r),z[p]=y):(Q=b._normals[p],Q.x=A,Q.y=r),Y=ca=S=D=b._normals[p],R=Y.x*Y.x+Y.y*Y.y,O=0==R?1:Math.sqrt(R),jb=ca.x/O,W=ca.y/O,U=jb,ba=W,S.x=U,S.y=ba}J=b._vertices[0];var Oc=yb*J.x+wb*J.y,Bb=Oc;t=1;for(x=b.count;t<x;){var Nb=
t++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();K=0;for(u=b.count;K<u;)p=K++,null!=b.local_vertices[p]&&(null==b._vertices[p]&&(z=b._vertices,y=new P(0,0),z[p]=y),q=b.local_vertices[p].x,w=b.local_vertices[p].y,null==w&&(w=0),null==q&&(q=0),Q=b.transform.get_local_to_world_matrix(),A=q,r=w,C=1,B=Q.m00*A+Q.m10*r+Q.m20*C,H=Q.m01*A+Q.m11*r+Q.m21*C,na=B,E=H,ia=b._vertices[p],ia.x=na,ia.y=E);V=0;for(F=b.count;V<F;)k=V++,D=b._vertices[(k+1)%b.count],oa=D.x,
xa=D.y,J=b._vertices[k],I=oa-J.x,ea=xa-J.y,oa=I,xa=ea,M=-xa,xa=oa,oa=M,null==b._normals[k]?(Ta=b._normals,T=new P(oa,xa),Ta[k]=T):(db=b._normals[k],db.x=oa,db.y=xa),Y=ca=S=L=b._normals[k],R=Y.x*Y.x+Y.y*Y.y,O=0==R?1:Math.sqrt(R),jb=ca.x/O,W=ca.y/O,U=jb,ba=W,S.x=U,S.y=ba}Z=b._vertices[Nb];ub=yb*Z.x+wb*Z.y;ub<Oc&&(Oc=ub);ub>Bb&&(Bb=ub)}var Ub=n,Zb=-n;I=-d;ea=-l;var Wb=yb*I+wb*ea;Oc+=Wb;Bb+=Wb;var Dc=Oc-Ub,ac=Zb-Bb;if(0<Dc||0<ac)return null;var vb=-(Ub-Oc);c&&(vb*=-1);q=yb;w=wb;h=qc.pool.get();h.sa=null;
h.sb=null;t=h.contact_count=0;for(x=h.contacts;t<x.length;){var kc=x[t];++t;kc.x=0;kc.y=0}h.overlap=vb;ia=h.normal;ia.x=q;ia.y=w;h.pooled=!1;var Cb=h,Xc=Math.abs(vb);t=0;for(x=b.count;t<x;){p=t++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();K=0;for(u=b.count;K<u;)k=K++,null!=b.local_vertices[k]&&(null==b._vertices[k]&&(z=b._vertices,y=new P(0,0),z[k]=y),q=b.local_vertices[k].x,w=b.local_vertices[k].y,null==w&&(w=0),null==q&&(q=0),Q=b.transform.get_local_to_world_matrix(),
A=q,r=w,C=1,B=Q.m00*A+Q.m10*r+Q.m20*C,H=Q.m01*A+Q.m11*r+Q.m21*C,na=B,E=H,ia=b._vertices[k],ia.x=na,ia.y=E);V=0;for(F=b.count;V<F;)G=V++,D=b._vertices[(G+1)%b.count],oa=D.x,xa=D.y,J=b._vertices[G],I=oa-J.x,ea=xa-J.y,oa=I,xa=ea,M=-xa,xa=oa,oa=M,null==b._normals[G]?(Ta=b._normals,T=new P(oa,xa),Ta[G]=T):(db=b._normals[G],db.x=oa,db.y=xa),Y=ca=S=L=b._normals[G],R=Y.x*Y.x+Y.y*Y.y,O=0==R?1:Math.sqrt(R),jb=ca.x/O,W=ca.y/O,U=jb,ba=W,S.x=U,S.y=ba}Na=b._normals[p].x;if(b.dirty_vertices){for(b.dirty_vertices=
!1;b._vertices.length>b.count;)b._vertices.pop();gb=0;for(ha=b.count;gb<ha;)da=gb++,null!=b.local_vertices[da]&&(null==b._vertices[da]&&(ka=b._vertices,pa=new P(0,0),ka[da]=pa),Ea=b.local_vertices[da].x,la=b.local_vertices[da].y,null==la&&(la=0),null==Ea&&(Ea=0),ja=b.transform.get_local_to_world_matrix(),Da=Ea,qa=la,ra=1,Xa=ja.m00*Da+ja.m10*qa+ja.m20*ra,Ua=ja.m01*Da+ja.m11*qa+ja.m21*ra,wa=Xa,va=Ua,fa=b._vertices[da],fa.x=wa,fa.y=va);Ja=0;for(Aa=b.count;Ja<Aa;)ma=Ja++,ua=b._vertices[(ma+1)%b.count],
eb=ua.x,sa=ua.y,Z=b._vertices[ma],Ca=eb-Z.x,Oa=sa-Z.y,eb=Ca,sa=Oa,bb=-sa,sa=eb,eb=bb,null==b._normals[ma]?(Jb=b._normals,Ha=new P(eb,sa),Jb[ma]=Ha):(Fa=b._normals[ma],Fa.x=eb,Fa.y=sa),Ga=Ma=Ia=za=b._normals[ma],Pa=Ga.x*Ga.x+Ga.y*Ga.y,Ra=0==Pa?1:Math.sqrt(Pa),Za=Ma.x/Ra,Sa=Ma.y/Ra,Wa=Za,ab=Sa,Ia.x=Wa,Ia.y=ab}yb=Na;wb=b._normals[p].y;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();cb=0;for(hb=b.count;cb<hb;)kb=cb++,null!=b.local_vertices[kb]&&(null==b._vertices[kb]&&
(fb=b._vertices,X=new P(0,0),fb[kb]=X),Qa=b.local_vertices[kb].x,Ya=b.local_vertices[kb].y,null==Ya&&(Ya=0),null==Qa&&(Qa=0),$a=b.transform.get_local_to_world_matrix(),ib=Qa,sb=Ya,bc=1,mb=$a.m00*ib+$a.m10*sb+$a.m20*bc,Ab=$a.m01*ib+$a.m11*sb+$a.m21*bc,Ib=mb,gc=Ab,Ba=b._vertices[kb],Ba.x=Ib,Ba.y=gc);Ka=0;for(Va=b.count;Ka<Va;)nb=Ka++,Xb=b._vertices[(nb+1)%b.count],lb=Xb.x,tb=Xb.y,ya=b._vertices[nb],ob=lb-ya.x,Lb=tb-ya.y,lb=ob,tb=Lb,xb=-tb,tb=lb,lb=xb,null==b._normals[nb]?(Mb=b._normals,Gb=new P(lb,
tb),Mb[nb]=Gb):(zb=b._normals[nb],zb.x=lb,zb.y=tb),gd=Fb=Kb=Eb=b._normals[nb],pb=gd.x*gd.x+gd.y*gd.y,Hb=0==pb?1:Math.sqrt(pb),Vb=Fb.x/Hb,Rb=Fb.y/Hb,Sb=Vb,Tb=Rb,Kb.x=Sb,Kb.y=Tb}fc=b._vertices[0];Bb=Oc=yb*fc.x+wb*fc.y;for(var Tc=1,Yb=b.count;Tc<Yb;){Nb=Tc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var ic=0,vc=b.count;ic<vc;){var Qb=ic++;if(null!=b.local_vertices[Qb]){if(null==b._vertices[Qb]){var pc=b._vertices,dc=new P(0,0);pc[Qb]=dc}var hc=b.local_vertices[Qb].x;
Ob=b.local_vertices[Qb].y;null==Ob&&(Ob=0);null==hc&&(hc=0);var $b=b.transform.get_local_to_world_matrix(),lc=hc,mc=Ob,jc=$b.m00*lc+$b.m10*mc+1*$b.m20,Sc=$b.m01*lc+$b.m11*mc+1*$b.m21;Db=b._vertices[Qb];Db.x=jc;Db.y=Sc}}for(var yc=0,Jc=b.count;yc<Jc;){var cc=yc++,ec=b._vertices[(cc+1)%b.count],Pb=ec.x,Id=ec.y,Gc=b._vertices[cc],xc=Id-Gc.y;Pb-=Gc.x;Id=xc;var uc=-Id;Id=Pb;Pb=uc;if(null==b._normals[cc]){var Ic=b._normals,Qc=new P(Pb,Id);Ic[cc]=Qc}else{var Kc=b._normals[cc];Kc.x=Pb;Kc.y=Id}var Lc=b._normals[cc],
zc=Lc,wc=Lc,nc=wc,Bc=nc.x*nc.x+nc.y*nc.y,Cc=0==Bc?1:Math.sqrt(Bc),Pc=wc.y/Cc;zc.x=wc.x/Cc;zc.y=Pc}}var hd=b._vertices[Nb];ub=yb*hd.x+wb*hd.y;ub<Oc&&(Oc=ub);ub>Bb&&(Bb=ub)}Ub=n;Zb=-n;Wb=yb*-d+wb*-l;Oc+=Wb;Bb+=Wb;Dc=Oc-Ub;ac=Zb-Bb;if(0<Dc||0<ac)return Cb.put(),null;vb=-(Ub-Oc);c&&(vb*=-1);if(Math.abs(vb)<Xc){var Hc=Cb.normal;Hc.x=yb;Hc.y=wb;Cb.overlap=vb;Xc=Math.abs(vb)}}Cb.sa=c?b:a;Cb.sb=c?a:b;Cb.overlap=Math.abs(Cb.overlap);c&&(ia=Cb.normal,ia.x=-ia.x,ia.y=-ia.y);return Cb};ta.check_polygons=function(a,
b,c){null==c&&(c=!1);for(var e=0,f=0,g=0,d=0,l=0,h=0,m=0,x=1073741823,t=null,n=0,p=0,K=0,u=a.count;K<u;){var k=K++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var z=0,y=a.count;z<y;){var q=z++;if(null!=a.local_vertices[q]){if(null==a._vertices[q]){var Q=a._vertices,w=new P(0,0);Q[q]=w}var A=a.local_vertices[q].x,r=a.local_vertices[q].y;null==r&&(r=0);null==A&&(A=0);var C=a.transform.get_local_to_world_matrix(),B=A,H=r,na=C.m01*B+C.m11*H+1*C.m21,ia=
a._vertices[q];ia.x=C.m00*B+C.m10*H+1*C.m20;ia.y=na}}for(var E=0,V=a.count;E<V;){var F=E++,G=a._vertices[(F+1)%a.count],D=G.x,oa=G.y,xa=a._vertices[F],J=oa-xa.y;D-=xa.x;oa=J;var I=-oa;oa=D;D=I;if(null==a._normals[F]){var ea=a._normals,M=new P(D,oa);ea[F]=M}else{var db=a._normals[F];db.x=D;db.y=oa}var Ta=a._normals[F],T=Ta,L=Ta,S=L,ca=S.x*S.x+S.y*S.y,Y=0==ca?1:Math.sqrt(ca),R=L.y/Y;T.x=L.x/Y;T.y=R}}var O=a._normals[k].x;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();
for(var jb=0,W=a.count;jb<W;){var U=jb++;if(null!=a.local_vertices[U]){if(null==a._vertices[U]){var Z=a._vertices,ba=new P(0,0);Z[U]=ba}var da=a.local_vertices[U].x,aa=a.local_vertices[U].y;null==aa&&(aa=0);null==da&&(da=0);var La=a.transform.get_local_to_world_matrix(),fa=da,gb=aa,ha=La.m01*fa+La.m11*gb+1*La.m21,ja=a._vertices[U];ja.x=La.m00*fa+La.m10*gb+1*La.m20;ja.y=ha}}for(var ka=0,Na=a.count;ka<Na;){var pa=ka++,la=a._vertices[(pa+1)%a.count],Da=la.x,ma=la.y,qa=a._vertices[pa],eb=ma-qa.y;Da-=
qa.x;ma=eb;var ra=-ma;ma=Da;Da=ra;if(null==a._normals[pa]){var sa=a._normals,Xa=new P(Da,ma);sa[pa]=Xa}else{var Ua=a._normals[pa];Ua.x=Da;Ua.y=ma}var ta=a._normals[pa],wa=ta,va=ta,ua=va,Ja=ua.x*ua.x+ua.y*ua.y,ya=0==Ja?1:Math.sqrt(Ja),Aa=va.y/ya;wa.x=va.x/ya;wa.y=Aa}}n=O;p=a._normals[k].y;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var za=0,Ca=a.count;za<Ca;){var Ea=za++;if(null!=a.local_vertices[Ea]){if(null==a._vertices[Ea]){var Oa=a._vertices,Ga=
new P(0,0);Oa[Ea]=Ga}var Fa=a.local_vertices[Ea].x,Jb=a.local_vertices[Ea].y;null==Jb&&(Jb=0);null==Fa&&(Fa=0);var Ba=a.transform.get_local_to_world_matrix(),Ha=Fa,Ia=Jb,Ma=Ba.m01*Ha+Ba.m11*Ia+1*Ba.m21,Pa=a._vertices[Ea];Pa.x=Ba.m00*Ha+Ba.m10*Ia+1*Ba.m20;Pa.y=Ma}}for(var Ra=0,Za=a.count;Ra<Za;){var Qa=Ra++,Ya=a._vertices[(Qa+1)%a.count],Sa=Ya.x,Wa=Ya.y,ab=a._vertices[Qa],bb=Wa-ab.y;Sa-=ab.x;Wa=bb;var cb=-Wa;Wa=Sa;Sa=cb;if(null==a._normals[Qa]){var X=a._normals,hb=new P(Sa,Wa);X[Qa]=hb}else{var fb=
a._normals[Qa];fb.x=Sa;fb.y=Wa}var $a=a._normals[Qa],ib=$a,sb=$a,mb=sb,ub=mb.x*mb.x+mb.y*mb.y,Ab=0==ub?1:Math.sqrt(ub),yb=sb.y/Ab;ib.x=sb.x/Ab;ib.y=yb}}var wb=a._vertices[0];l=d=n*wb.x+p*wb.y;for(var fc=1,Ka=a.count;fc<Ka;){var Va=fc++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var nb=0,Bb=a.count;nb<Bb;){var lb=nb++;if(null!=a.local_vertices[lb]){if(null==a._vertices[lb]){var tb=a._vertices,Fb=new P(0,0);tb[lb]=Fb}var zb=a.local_vertices[lb].x,
Lb=a.local_vertices[lb].y;null==Lb&&(Lb=0);null==zb&&(zb=0);var xb=a.transform.get_local_to_world_matrix(),Mb=zb,Cb=Lb,Ib=xb.m01*Mb+xb.m11*Cb+1*xb.m21,Db=a._vertices[lb];Db.x=xb.m00*Mb+xb.m10*Cb+1*xb.m20;Db.y=Ib}}for(var Eb=0,Kb=a.count;Eb<Kb;){var ob=Eb++,Gb=a._vertices[(ob+1)%a.count],vb=Gb.x,pb=Gb.y,Hb=a._vertices[ob],Ob=pb-Hb.y;vb-=Hb.x;pb=Ob;var Ub=-pb;pb=vb;vb=Ub;if(null==a._normals[ob]){var Vb=a._normals,Wb=new P(vb,pb);Vb[ob]=Wb}else{var Rb=a._normals[ob];Rb.x=vb;Rb.y=pb}var Sb=a._normals[ob],
Tb=Sb,Qb=Sb,Nb=Qb,Zb=Nb.x*Nb.x+Nb.y*Nb.y,$b=0==Zb?1:Math.sqrt(Zb),Dc=Qb.y/$b;Tb.x=Qb.x/$b;Tb.y=Dc}}var ac=a._vertices[Va];g=n*ac.x+p*ac.y;g<d&&(d=g);g>l&&(l=g)}if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var cc=0,kc=b.count;cc<kc;){var Pb=cc++;if(null!=b.local_vertices[Pb]){if(null==b._vertices[Pb]){var Xc=b._vertices,Tc=new P(0,0);Xc[Pb]=Tc}var hc=b.local_vertices[Pb].x,ic=b.local_vertices[Pb].y;null==ic&&(ic=0);null==hc&&(hc=0);var Yb=b.transform.get_local_to_world_matrix(),
lc=hc,mc=ic,vc=Yb.m01*lc+Yb.m11*mc+1*Yb.m21,nc=b._vertices[Pb];nc.x=Yb.m00*lc+Yb.m10*mc+1*Yb.m20;nc.y=vc}}for(var pc=0,yc=b.count;pc<yc;){var dc=pc++,wc=b._vertices[(dc+1)%b.count],jc=wc.x,ec=wc.y,Sc=b._vertices[dc],Gc=ec-Sc.y;jc-=Sc.x;ec=Gc;var Jc=-ec;ec=jc;jc=Jc;if(null==b._normals[dc]){var Kc=b._normals,Lc=new P(jc,ec);Kc[dc]=Lc}else{var zc=b._normals[dc];zc.x=jc;zc.y=ec}var Bc=b._normals[dc],Cc=Bc,xc=Bc,uc=xc,Hc=uc.x*uc.x+uc.y*uc.y,Ic=0==Hc?1:Math.sqrt(Hc),Qc=xc.y/Ic;Cc.x=xc.x/Ic;Cc.y=Qc}}var Pc=
b._vertices[0];m=h=n*Pc.x+p*Pc.y;for(var Yc=1,kd=b.count;Yc<kd;){var md=Yc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var $c=0,qd=b.count;$c<qd;){var hd=$c++;if(null!=b.local_vertices[hd]){if(null==b._vertices[hd]){var sd=b._vertices,xd=new P(0,0);sd[hd]=xd}var Vc=b.local_vertices[hd].x,Wc=b.local_vertices[hd].y;null==Wc&&(Wc=0);null==Vc&&(Vc=0);var Ac=b.transform.get_local_to_world_matrix(),bd=Vc,cd=Wc,yd=Ac.m01*bd+Ac.m11*cd+1*Ac.m21,dd=b._vertices[hd];
dd.x=Ac.m00*bd+Ac.m10*cd+1*Ac.m20;dd.y=yd}}for(var ed=0,zd=b.count;ed<zd;){var Ec=ed++,fd=b._vertices[(Ec+1)%b.count],Mc=fd.x,Fc=fd.y,id=b._vertices[Ec],Bd=Fc-id.y;Mc-=id.x;Fc=Bd;var Cd=-Fc;Fc=Mc;Mc=Cd;if(null==b._normals[Ec]){var Dd=b._normals,Ed=new P(Mc,Fc);Dd[Ec]=Ed}else{var jd=b._normals[Ec];jd.x=Mc;jd.y=Fc}var ld=b._normals[Ec],nd=ld,Zc=ld,Uc=Zc,od=Uc.x*Uc.x+Uc.y*Uc.y,pd=0==od?1:Math.sqrt(od),Fd=Zc.y/pd;nd.x=Zc.x/pd;nd.y=Fd}}var rd=b._vertices[md];g=n*rd.x+p*rd.y;g<h&&(h=g);g>m&&(m=g)}e=d-m;
f=h-l;if(0<e||0<f)return null;var Rc=-(m-d);c&&(Rc*=-1);if(Math.abs(Rc)<x){if(null==t){var Gd=n,Hd=p,Ad=qc.pool.get();Ad.sa=null;Ad.sb=null;for(var ad=Ad.contact_count=0,td=Ad.contacts;ad<td.length;){var ud=td[ad];++ad;ud.x=0;ud.y=0}Ad.overlap=Rc;var vd=Ad.normal;vd.x=Gd;vd.y=Hd;Ad.pooled=!1;t=Ad}else{t.overlap=Rc;var wd=t.normal;wd.x=n;wd.y=p}x=Math.abs(Rc)}}if(null==t)return null;t.sa=c?b:a;t.sb=c?a:b;c&&(ia=t.normal,ia.x=-ia.x,ia.y=-ia.y);return t};var Bc=function(a,b,c,e,f){null==f&&(f=1);null==
e&&(e=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.dirty=this.inverse_dirty=this.coordinates_dirty=!1;this.local_to_world_matrix=new be(1,0,0,0,1,0,0,0,1);this.children=[];this._scale_x=this._scale_y=1;this._x=this._y=this._radians=0;this.on_dirty=null;this.dirty||this.set_dirty();this.local_x=a;this.dirty||this.set_dirty();this.local_y=b;a=Math.PI/180*c;this.dirty||this.set_dirty();this.local_radians=a;this.dirty||this.set_dirty();this.local_scale_x=e;this.dirty||this.set_dirty();this.local_scale_y=
f};h["echo.util.Transform"]=Bc;Bc.__name__=!0;Bc.__interfaces__=[K];Bc.prototype={set_parent:function(a,b){null!=this.parent&&z.remove(this.parent.children,this);this.parent=a;null!=a&&this.parent.children.push(this);this.set_dirty()},get_local_to_world_matrix:function(){if(this.dirty){if(null==this.parent){var a=this.local_to_world_matrix,b=Math.sin(this.local_radians),c=Math.cos(this.local_radians),e=c*this.local_scale_x,f=-b*this.local_scale_y,g=this.local_x;b*=this.local_scale_x;var d=c*this.local_scale_y,
l=this.local_y;a.m00=e;a.m10=f;a.m20=g;a.m01=b;a.m11=d;a.m21=l;a.m02=0;a.m12=0;a.m22=1}else{a=this.local_to_world_matrix;var h=this.parent.get_local_to_world_matrix();b=Math.sin(this.local_radians);c=Math.cos(this.local_radians);e=c*this.local_scale_x;f=-b*this.local_scale_y;g=this.local_x;b*=this.local_scale_x;d=c*this.local_scale_y;l=this.local_y;c=h.m00*f+h.m10*d+0*h.m20;var m=h.m00*g+h.m10*l+1*h.m20,n=h.m01*e+h.m11*b+0*h.m21,t=h.m01*f+h.m11*d+0*h.m21,x=h.m01*g+h.m11*l+1*h.m21,p=h.m02*e+h.m12*
b+0*h.m22;f=h.m02*f+h.m12*d+0*h.m22;g=h.m02*g+h.m12*l+1*h.m22;a.m00=h.m00*e+h.m10*b+0*h.m20;a.m10=c;a.m20=m;a.m01=n;a.m11=t;a.m21=x;a.m02=p;a.m12=f;a.m22=g}this.dirty=!1}return this.local_to_world_matrix},sync:function(){if(this.coordinates_dirty){var a=this.get_local_to_world_matrix();if(null==this.parent)this._x=this.local_x,this._y=this.local_y,this._scale_x=this.local_scale_x,this._scale_y=this.local_scale_y,this._radians=this.local_radians;else{var b=a.m00,c=a.m01,e=a.m10,f=a.m11;this._x=a.m20;
this._y=a.m21;this._scale_x=Math.sqrt(b*b+c*c);this._scale_y=Math.sqrt(e*e+f*f);this._radians=180/Math.PI*Math.atan2(-e/this._scale_y,b/this._scale_x)}this.coordinates_dirty=!1}},set_dirty:function(){this.dirty=this.inverse_dirty=this.coordinates_dirty=!0;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.set_dirty()}if(null!=this.on_dirty)this.on_dirty(this)},__class__:Bc};var ub=y["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",
toString:p},Module:(n=function(a){return{_hx_index:1,m:a,__enum__:"haxe.StackItem",toString:p}},n._hx_name="Module",n.__params__=["m"],n),FilePos:(n=function(a,b,c,e){return{_hx_index:2,s:a,file:b,line:c,column:e,__enum__:"haxe.StackItem",toString:p}},n._hx_name="FilePos",n.__params__=["s","file","line","column"],n),Method:(n=function(a,b){return{_hx_index:3,classname:a,method:b,__enum__:"haxe.StackItem",toString:p}},n._hx_name="Method",n.__params__=["classname","method"],n),LocalFunction:(n=function(a){return{_hx_index:4,
v:a,__enum__:"haxe.StackItem",toString:p}},n._hx_name="LocalFunction",n.__params__=["v"],n)};ub.__constructs__=[ub.CFunction,ub.Module,ub.FilePos,ub.Method,ub.LocalFunction];var Pb={callStack:function(){return ja.toHaxe(ja.callStack())},exceptionStack:function(a){null==a&&(a=!1);var b=ja.toHaxe(ja.exceptionStack());return a?b:Pb.subtract(b,Pb.callStack())},toString:function(a){for(var b=new Fa,c=0;c<a.length;){var e=a[c];++c;b.b+="\nCalled from ";Pb.itemToString(b,e)}return b.b},subtract:function(a,
b){for(var c=-1,e=-1;++e<a.length;){for(var f=0,g=b.length;f<g;){var d=f++;if(Pb.equalItems(a[e],b[d])){if(0>c&&(c=e),++e,e>=a.length)break}else c=-1}if(0<=c)break}return 0<=c?a.slice(0,c):a},equalItems:function(a,b){if(null==a)return null==b?!0:!1;switch(a._hx_index){case 0:return null==b?!1:0==b._hx_index?!0:!1;case 1:return null==b?!1:1==b._hx_index?a.m==b.m:!1;case 2:if(null==b)return!1;if(2==b._hx_index){var c=b.s,e=b.line,f=b.column,g=a.column,d=a.line,l=a.s;return a.file==b.file&&d==e&&g==
f?Pb.equalItems(l,c):!1}return!1;case 3:return null==b?!1:3==b._hx_index?(c=b.method,e=a.method,a.classname==b.classname?e==c:!1):!1;case 4:return null==b?!1:4==b._hx_index?a.v==b.v:!1}},itemToString:function(a,b){switch(b._hx_index){case 0:a.b+="a C function";break;case 1:b=b.m;a.b+="module ";a.b+=null==b?"null":""+b;break;case 2:var c=b.s,e=b.file,f=b.line;b=b.column;null!=c&&(Pb.itemToString(a,c),a.b+=" (");a.b+=null==e?"null":""+e;a.b+=" line ";a.b+=null==f?"null":""+f;null!=b&&(a.b+=" column ",
a.b+=null==b?"null":""+b);null!=c&&(a.b+=")");break;case 3:c=b.classname;b=b.method;a.b+=J.string(null==c?"<unknown>":c);a.b+=".";a.b+=null==b?"null":""+b;break;case 4:b=b.v,a.b+="local function #",a.b+=null==b?"null":""+b}}},Gc=function(){};h["haxe.IMap"]=Gc;Gc.__name__=!0;Gc.__isInterface__=!0;Gc.prototype={__class__:Gc};var A=function(a,b,c){Error.call(this,a);this.message=a;this.__previousException=b;this.__nativeException=null!=c?c:this;this.__skipStack=0;a=Error.prepareStackTrace;Error.prepareStackTrace=
function(a){return a.stack};if(c instanceof Error)this.stack=c.stack;else{c=null;if(Error.captureStackTrace)Error.captureStackTrace(this,A),c=this;else if(c=Error(),"undefined"==typeof c.stack){try{throw c;}catch(e){}this.__skipStack++}this.stack=c.stack}Error.prepareStackTrace=a};h["haxe.Exception"]=A;A.__name__=!0;A.caught=function(a){return a instanceof A?a:a instanceof Error?new A(a.message,null,a):new Pc(a,null,a)};A.thrown=function(a){if(a instanceof A)return a.get_native();if(a instanceof Error)return a;
a=new Pc(a);a.__skipStack++;return a};A.__super__=Error;A.prototype=H(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_native:function(){return this.__nativeException},get_stack:function(){var a=this.__exceptionStack;null==a&&(a=ja.toHaxe(ja.normalize(this.stack),this.__skipStack),this.setProperty("__exceptionStack",a));return a},setProperty:function(a,
b){try{Object.defineProperty(this,a,{value:b})}catch(c){this[a]=b}},__class__:A,__properties__:{get_native:"get_native",get_stack:"get_stack",get_message:"get_message"}});var la=function(){};h["haxe.Log"]=la;la.__name__=!0;la.formatOutput=function(a,b){var c=J.string(a);if(null==b)return c;var e=b.fileName+":"+b.lineNumber;if(null!=b.customParams){var f=0;for(b=b.customParams;f<b.length;)a=b[f],++f,c+=", "+J.string(a)}return e+": "+c};la.trace=function(a,b){a=la.formatOutput(a,b);"undefined"!=typeof console&&
null!=console.log&&console.log(a)};var ja=function(){};h["haxe.NativeStackTrace"]=ja;ja.__name__=!0;ja.saveStack=function(a){ja.lastError=a};ja.callStack=function(){var a=Error(""),b=ja.tryHaxeStack(a);if("undefined"==typeof b){try{throw a;}catch(c){}b=a.stack}return ja.normalize(b,2)};ja.exceptionStack=function(){return ja.normalize(ja.tryHaxeStack(ja.lastError))};ja.toHaxe=function(a,b){null==b&&(b=0);if(null==a)return[];if("string"==typeof a){a=a.split("\n");"Error"==a[0]&&a.shift();for(var c=
[],e=0,f=a.length;e<f;){var g=e++;if(!(b>g)){var d=a[g];g=d.match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=g){d=g[1].split(".");"$hxClasses"==d[0]&&d.shift();var l=d.pop(),h=g[2],m=J.parseInt(g[3]);g=J.parseInt(g[4]);c.push(ub.FilePos("Anonymous function"==l?ub.LocalFunction():"Global code"==l?null:ub.Method(d.join("."),l),h,m,g))}else c.push(ub.Module(U.trim(d)))}}return c}return 0<b&&Array.isArray(a)?a.slice(b):a};ja.tryHaxeStack=function(a){if(null==a)return[];var b=
Error.prepareStackTrace;Error.prepareStackTrace=ja.prepareHxStackTrace;a=a.stack;Error.prepareStackTrace=b;return a};ja.prepareHxStackTrace=function(a,b){a=[];for(var c=0;c<b.length;){var e=b[c];++c;null!=ja.wrapCallSite&&(e=ja.wrapCallSite(e));var f=null,g=e.getFunctionName();if(null!=g){var d=g.lastIndexOf(".");0<=d?(f=g.substring(0,d),g=g.substring(d+1),f=ub.Method(f,g)):f=ub.Method(null,g)}g=e.getFileName();d=null==g?-1:g.indexOf("file:");null!=ja.wrapCallSite&&0<d&&(g=g.substring(d+6));a.push(ub.FilePos(f,
g,e.getLineNumber(),e.getColumnNumber()))}return a};ja.normalize=function(a,b){null==b&&(b=0);if(Array.isArray(a)&&0<b)return a.slice(b);if("string"==typeof a){switch(a.substring(0,6)){case "Error\n":case "Error:":++b}return ja.skipLines(a,b)}return a};ja.skipLines=function(a,b,c){null==c&&(c=0);return 0<b?(c=a.indexOf("\n",c),0>c?"":ja.skipLines(a,--b,c+1)):a.substring(c)};var id=function(){};h["haxe._Unserializer.DefaultResolver"]=id;id.__name__=!0;id.prototype={resolveClass:function(a){return h[a]},
resolveEnum:function(a){return y[a]},__class__:id};var ob=function(a){this.buf=a;this.length=this.buf.length;this.pos=0;this.scache=[];this.cache=[];a=ob.DEFAULT_RESOLVER;null==a&&(a=new id,ob.DEFAULT_RESOLVER=a);this.resolver=a};h["haxe.Unserializer"]=ob;ob.__name__=!0;ob.initCodes=function(){for(var a=[],b=0,c=ob.BASE64.length;b<c;){var e=b++;a[ob.BASE64.charCodeAt(e)]=e}return a};ob.run=function(a){return(new ob(a)).unserialize()};ob.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var e=
this.buf.charCodeAt(this.pos);if(e!=e)break;if(45==e){if(this.pos!=c)break;b=!0}else{if(48>e||57<e)break;a=10*a+(e-48)}this.pos++}b&&(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(z.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw A.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();
if("string"!=typeof b)throw A.thrown("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw A.thrown("Invalid enum format");var c=this.readDigits();if(0==c)return m.createEnum(a,b);for(var e=[];0<c--;)e.push(this.unserialize());return m.createEnum(a,b,e)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+
a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw A.thrown("Enum not found "+a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);b.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw A.thrown("Invalid custom data");return b;case 77:a=new Sb;this.cache.push(a);for(var c;104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,
this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw A.thrown("Invalid string reference");return this.scache[a];case 97:b=[];for(this.cache.push(b);;){c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}117==c?(this.pos++,a=this.readDigits(),b[b.length+a-1]=null):b.push(this.unserialize())}return b;case 98:a=new ha;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),c=this.unserialize(),a.h[b]=c;this.pos++;return a;
case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);this.unserializeObject(b);return b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw A.thrown("Enum not found "+a);this.pos++;for(var e=this.readDigits(),f=c.__constructs__,g=Array(f.length),d=0,l=f.length;d<l;)b=d++,g[b]=f[b]._hx_name;
b=g[e];if(null==b)throw A.thrown("Unknown enum index "+a+"@"+e);b=this.unserializeEnum(c,b);this.cache.push(b);return b;case 107:return NaN;case 108:b=new Tb;for(this.cache.push(b);104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());this.pos++;return b;case 109:return-Infinity;case 110:return null;case 111:return b={},this.cache.push(b),this.unserializeObject(b),b;case 112:return Infinity;case 113:a=new zb;this.cache.push(a);for(c=this.buf.charCodeAt(this.pos++);58==c;)b=this.readDigits(),
c=this.unserialize(),a.h[b]=c,c=this.buf.charCodeAt(this.pos++);if(104!=c)throw A.thrown("Invalid IntMap format");return a;case 114:a=this.readDigits();if(0>a||a>=this.cache.length)throw A.thrown("Invalid reference");return this.cache[a];case 115:a=this.readDigits();c=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw A.thrown("Invalid bytes length");e=ob.CODES;null==e&&(e=ob.initCodes(),ob.CODES=e);b=this.pos;f=a&3;g=b+(a-f);d=new Ga(new ArrayBuffer(3*(a>>2)+(2<=f?f-1:
0)));for(l=0;b<g;){var h=e[c.charCodeAt(b++)],m=e[c.charCodeAt(b++)];d.b[l++]=(h<<2|m>>4)&255;h=e[c.charCodeAt(b++)];d.b[l++]=(m<<4|h>>2)&255;m=e[c.charCodeAt(b++)];d.b[l++]=(h<<6|m)&255}2<=f&&(h=e[c.charCodeAt(b++)],m=e[c.charCodeAt(b++)],d.b[l++]=(h<<2|m>>4)&255,3==f&&(h=e[c.charCodeAt(b++)],d.b[l++]=(m<<4|h>>2)&255));this.pos+=a;this.cache.push(d);return d;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&
57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(b=z.strDate(z.substr(this.buf,this.pos,19)),this.pos+=19):b=new Date(this.readFloat()),this.cache.push(b),b;case 119:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw A.thrown("Enum not found "+a);b=this.unserializeEnum(c,this.unserialize());this.cache.push(b);
return b;case 120:throw A.thrown(this.unserialize());case 121:a=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw A.thrown("Invalid string length");b=z.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw A.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:ob};var Pc=function(a,b,c){A.call(this,String(a),b,c);this.value=a;this.__skipStack++};
h["haxe.ValueException"]=Pc;Pc.__name__=!0;Pc.__super__=A;Pc.prototype=H(A.prototype,{unwrap:function(){return this.value},__class__:Pc});var xc=function(){this.a1=1;this.a2=0};h["haxe.crypto.Adler32"]=xc;xc.__name__=!0;xc.read=function(a){var b=new xc,c=a.readByte(),e=a.readByte(),f=a.readByte();a=a.readByte();b.a1=f<<8|a;b.a2=c<<8|e;return b};xc.prototype={update:function(a,b,c){var e=this.a1,f=this.a2,g=b;for(b+=c;g<b;)c=g++,e=(e+a.b[c])%65521,f=(f+e)%65521;this.a1=e;this.a2=f},equals:function(a){return a.a1==
this.a1?a.a2==this.a2:!1},__class__:xc};var Ga=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};h["haxe.io.Bytes"]=Ga;Ga.__name__=!0;Ga.ofString=function(a,b){b=[];for(var c=0;c<a.length;){var e=a.charCodeAt(c++);55296<=e&&56319>=e&&(e=e-55232<<10|a.charCodeAt(c++)&1023);127>=e?b.push(e):(2047>=e?b.push(192|e>>6):(65535>=e?b.push(224|e>>12):(b.push(240|e>>18),b.push(128|e>>12&63)),b.push(128|e>>6&63)),b.push(128|e&63))}return new Ga((new Uint8Array(b)).buffer)};
Ga.ofData=function(a){var b=a.hxBytes;return null!=b?b:new Ga(a)};Ga.prototype={blit:function(a,b,c,e){if(0>a||0>c||0>e||a+e>this.length||c+e>b.length)throw A.thrown(Bb.OutsideBounds);0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},getString:function(a,b,c){if(0>a||0>b||a+b>this.length)throw A.thrown(Bb.OutsideBounds);c="";var e=this.b,f=qa.fromCharCode,g=a;for(a+=b;g<a;)if(b=e[g++],128>b){if(0==b)break;c+=f(b)}else if(224>b)c+=f((b&63)<<6|e[g++]&127);else if(240>b){var d=
e[g++];c+=f((b&31)<<12|(d&127)<<6|e[g++]&127)}else{d=e[g++];var l=e[g++];b=(b&15)<<18|(d&127)<<12|(l&127)<<6|e[g++]&127;c+=f((b>>10)+55232);c+=f(b&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},__class__:Ga};var Cc=y["haxe.ds.Either"]={__ename__:!0,__constructs__:null,Left:(n=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Either",toString:p}},n._hx_name="Left",n.__params__=["v"],n),Right:(n=function(a){return{_hx_index:1,v:a,__enum__:"haxe.ds.Either",toString:p}},
n._hx_name="Right",n.__params__=["v"],n)};Cc.__constructs__=[Cc.Left,Cc.Right];var zb=function(){this.h={}};h["haxe.ds.IntMap"]=zb;zb.__name__=!0;zb.__interfaces__=[Gc];zb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(+b);return new nc(a)},iterator:function(){return{ref:this.h,
it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=null==c?"null":""+c;a+=" => ";a+=J.string(J.string(this.h[c]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:zb};var Tb=function(){this.length=0};h["haxe.ds.List"]=Tb;Tb.__name__=!0;Tb.prototype={add:function(a){a=new Bd(a,null);null==this.h?this.h=a:this.q.next=a;this.q=a;this.length++},push:function(a){this.h=
a=new Bd(a,this.h);null==this.q&&(this.q=a);this.length++},first:function(){return null==this.h?null:this.h.item},pop:function(){if(null==this.h)return null;var a=this.h.item;this.h=this.h.next;null==this.h&&(this.q=null);this.length--;return a},isEmpty:function(){return null==this.h},toString:function(){var a,b=!0,c=this.h;for(a="{";null!=c;)b?b=!1:a+=", ",a+=J.string(J.string(c.item)),c=c.next;return a+"}"},__class__:Tb};var Bd=function(a,b){this.item=a;this.next=b};h["haxe.ds._List.ListNode"]=
Bd;Bd.__name__=!0;Bd.prototype={__class__:Bd};var Sb=function(){this.h={__keys__:{}}};h["haxe.ds.ObjectMap"]=Sb;Sb.__name__=!0;Sb.__interfaces__=[Gc];Sb.prototype={set:function(a,b){var c=a.__id__;null==c&&(c=a.__id__=r.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},keys:function(){var a=
[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return new nc(a)},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=J.string(J.string(c));a+=" => ";a+=J.string(J.string(this.h[c.__id__]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:Sb};var ha=function(){this.h=Object.create(null)};h["haxe.ds.StringMap"]=ha;ha.__name__=!0;ha.__interfaces__=[Gc];ha.stringify=function(a){var b="{",c=!0,e;for(e in a)c?c=!1:b+=",",b+=e+" => "+J.string(a[e]);
return b+"}"};ha.prototype={exists:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)},get:function(a){return this.h[a]},set:function(a,b){this.h[a]=b},remove:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)?(delete this.h[a],!0):!1},toString:function(){return ha.stringify(this.h)},__class__:ha};var uc=function(a,b,c){A.call(this,a,b);this.posInfos=null==c?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:c;this.__skipStack++};h["haxe.exceptions.PosException"]=
uc;uc.__name__=!0;uc.__super__=A;uc.prototype=H(A.prototype,{toString:function(){return""+A.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:uc});var Cd=function(a,b,c){null==a&&(a="Not implemented");uc.call(this,a,b,c);this.__skipStack++};h["haxe.exceptions.NotImplementedException"]=Cd;Cd.__name__=!0;Cd.__super__=uc;Cd.prototype=H(uc.prototype,{__class__:Cd});var Dd=function(){this.size=
this.pos=0};h["haxe.io.BytesBuffer"]=Dd;Dd.__name__=!0;Dd.prototype={addByte:function(a){this.pos==this.size&&this.grow(1);this.view.setUint8(this.pos++,a)},add:function(a){this.pos+a.length>this.size&&this.grow(a.length);if(0!=this.size){var b=new Uint8Array(a.b.buffer,a.b.byteOffset,a.length);this.u8.set(b,this.pos);this.pos+=a.length}},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw A.thrown(Bb.OutsideBounds);this.pos+c>this.size&&this.grow(c);0!=this.size&&(a=new Uint8Array(a.b.buffer,
a.b.byteOffset+b,c),this.u8.set(a,this.pos),this.pos+=c)},grow:function(a){var b=this.pos+a;for(a=0==this.size?16:this.size;a<b;)a=3*a>>1;b=new ArrayBuffer(a);var c=new Uint8Array(b);0<this.size&&c.set(this.u8);this.size=a;this.buffer=b;this.u8=c;this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new Ga(new ArrayBuffer(0));var a=new Ga(this.buffer);a.length=this.pos;return a},__class__:Dd};var Ed=function(){};h["haxe.io.Input"]=Ed;Ed.__name__=!0;Ed.prototype={readByte:function(){throw new Cd(null,
null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"});},readBytes:function(a,b,c){var e=c,f=a.b;if(0>b||0>c||b+c>a.length)throw A.thrown(Bb.OutsideBounds);try{for(;0<e;)f[b]=this.readByte(),++b,--e}catch(g){if(ja.lastError=g,!(A.caught(g).unwrap()instanceof Hc))throw g;}return c-e},readFullBytes:function(a,b,c){for(;0<c;){var e=this.readBytes(a,b,c);if(0==e)throw A.thrown(Bb.Blocked);b+=e;c-=e}},read:function(a){for(var b=new Ga(new ArrayBuffer(a)),c=0;0<
a;){var e=this.readBytes(b,c,a);if(0==e)throw A.thrown(Bb.Blocked);c+=e;a-=e}return b},readInt16:function(){var a=this.readByte(),b=this.readByte();a=this.bigEndian?b|a<<8:a|b<<8;return 0!=(a&32768)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();return this.bigEndian?b|a<<8:a|b<<8},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),e=this.readByte();return this.bigEndian?e|c<<8|b<<16|a<<24:a|b<<8|c<<16|e<<24},readString:function(a,b){var c=new Ga(new ArrayBuffer(a));
this.readFullBytes(c,0,a);return c.getString(0,a,b)},__class__:Ed};var jd=function(a,b,c){null==b&&(b=0);null==c&&(c=a.length-b);if(0>b||0>c||b+c>a.length)throw A.thrown(Bb.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};h["haxe.io.BytesInput"]=jd;jd.__name__=!0;jd.__super__=Ed;jd.prototype=H(Ed.prototype,{readByte:function(){if(0==this.len)throw A.thrown(new Hc);this.len--;return this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw A.thrown(Bb.OutsideBounds);
if(0==this.len&&0<c)throw A.thrown(new Hc);this.len<c&&(c=this.len);var e=this.b;a=a.b;for(var f=0,g=c;f<g;){var d=f++;a[b+d]=e[this.pos+d]}this.pos+=c;this.len-=c;return c},__class__:jd});var Pe=y["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:p},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:p}};Pe.__constructs__=[Pe.UTF8,Pe.RawNative];var Hc=function(){};h["haxe.io.Eof"]=Hc;Hc.__name__=
!0;Hc.prototype={toString:function(){return"Eof"},__class__:Hc};var Bb=y["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:p},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:p},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:p},Custom:(n=function(a){return{_hx_index:3,e:a,__enum__:"haxe.io.Error",toString:p}},n._hx_name="Custom",n.__params__=["e"],n)};Bb.__constructs__=
[Bb.Blocked,Bb.Overflow,Bb.OutsideBounds,Bb.Custom];var yc=function(a){switch(a){case ".":case "..":this.dir=a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=z.substr(a,0,c),a=z.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=z.substr(a,0,b),a=z.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=z.substr(a,b+1,null),this.file=z.substr(a,0,b)):(this.ext=null,this.file=a)};h["haxe.io.Path"]=yc;yc.__name__=!0;yc.directory=function(a){a=new yc(a);
return null==a.dir?"":a.dir};yc.prototype={__class__:yc};var nc=function(a){this.current=0;this.array=a};h["haxe.iterators.ArrayIterator"]=nc;nc.__name__=!0;nc.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:nc};var Ic=y["haxe.zip.ExtraField"]={__ename__:!0,__constructs__:null,FUnknown:(n=function(a,b){return{_hx_index:0,tag:a,bytes:b,__enum__:"haxe.zip.ExtraField",toString:p}},n._hx_name="FUnknown",n.__params__=["tag",
"bytes"],n),FInfoZipUnicodePath:(n=function(a,b){return{_hx_index:1,name:a,crc:b,__enum__:"haxe.zip.ExtraField",toString:p}},n._hx_name="FInfoZipUnicodePath",n.__params__=["name","crc"],n),FUtf8:{_hx_name:"FUtf8",_hx_index:2,__enum__:"haxe.zip.ExtraField",toString:p}};Ic.__constructs__=[Ic.FUnknown,Ic.FInfoZipUnicodePath,Ic.FUtf8];var Nb=y["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(n=function(a){return{_hx_index:0,i:a,__enum__:"haxe.zip.Huffman",toString:p}},n._hx_name="Found",n.__params__=
["i"],n),NeedBit:(n=function(a,b){return{_hx_index:1,left:a,right:b,__enum__:"haxe.zip.Huffman",toString:p}},n._hx_name="NeedBit",n.__params__=["left","right"],n),NeedBits:(n=function(a,b){return{_hx_index:2,n:a,table:b,__enum__:"haxe.zip.Huffman",toString:p}},n._hx_name="NeedBits",n.__params__=["n","table"],n)};Nb.__constructs__=[Nb.Found,Nb.NeedBit,Nb.NeedBits];var ce=function(){};h["haxe.zip.HuffTools"]=ce;ce.__name__=!0;ce.prototype={treeDepth:function(a){switch(a._hx_index){case 0:return 0;case 1:var b=
a.right;a=this.treeDepth(a.left);b=this.treeDepth(b);return 1+(a<b?a:b);case 2:throw A.thrown("assert");}},treeCompress:function(a){var b=this.treeDepth(a);if(0==b)return a;if(1==b){if(1==a._hx_index)return b=a.right,Nb.NeedBit(this.treeCompress(a.left),this.treeCompress(b));throw A.thrown("assert");}for(var c=[],e=0,f=1<<b;e<f;)e++,c.push(Nb.Found(-1));this.treeWalk(c,0,0,b,a);return Nb.NeedBits(b,c)},treeWalk:function(a,b,c,e,f){if(1==f._hx_index){var g=f.left,d=f.right;0<e?(this.treeWalk(a,b,c+
1,e-1,g),this.treeWalk(a,b|1<<c,c+1,e-1,d)):a[b]=this.treeCompress(f)}else a[b]=this.treeCompress(f)},treeMake:function(a,b,c,e){if(e>b)throw A.thrown("Invalid huffman");var f=c<<5|e;if(a.h.hasOwnProperty(f))return Nb.Found(a.h[f]);c<<=1;++e;return Nb.NeedBit(this.treeMake(a,b,c,e),this.treeMake(a,b,c|1,e))},make:function(a,b,c,e){if(1==c)return Nb.NeedBit(Nb.Found(0),Nb.Found(0));var f=[],g=[];if(32<e)throw A.thrown("Invalid huffman");for(var d=0,l=e;d<l;)d++,f.push(0),g.push(0);d=0;for(l=c;d<l;){var h=
d++;h=a[h+b];if(h>=e)throw A.thrown("Invalid huffman");f[h]++}var m=0;d=1;for(l=e-1;d<l;)h=d++,m=m+f[h]<<1,g[h]=m;f=new zb;d=0;for(l=c;d<l;)h=d++,c=a[h+b],0!=c&&(m=g[c-1],g[c-1]=m+1,f.h[m<<5|c]=h);return this.treeCompress(Nb.NeedBit(this.treeMake(f,e,0,1),this.treeMake(f,e,1,1)))},__class__:ce};var de=function(a){this.buffer=new Ga(new ArrayBuffer(65536));this.pos=0;a&&(this.crc=new xc)};h["haxe.zip._InflateImpl.Window"]=de;de.__name__=!0;de.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,
0,32768);var a=new Ga(new ArrayBuffer(65536));this.pos-=32768;a.blit(0,this.buffer,32768,this.pos);this.buffer=a},addBytes:function(a,b,c){65536<this.pos+c&&this.slide();this.buffer.blit(this.pos,a,b,c);this.pos+=c},addByte:function(a){65536==this.pos&&this.slide();this.buffer.b[this.pos]=a&255;this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){null!=this.crc&&this.crc.update(this.buffer,0,this.pos);return this.crc},__class__:de};
var ab=y["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:p},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:p},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:p},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:p},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:p},
Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:p},DistOne:{_hx_name:"DistOne",_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:p},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:p}};ab.__constructs__=[ab.Head,ab.Block,ab.CData,ab.Flat,ab.Crc,ab.Dist,ab.DistOne,ab.Done];var bb=function(a,b,c){null==c&&(c=!0);null==b&&(b=!0);this.isFinal=!1;this.htools=new ce;this.huffman=this.buildFixedHuffman();this.huffdist=null;this.dist=
this.len=0;this.state=b?ab.Head:ab.Block;this.input=a;this.needed=this.nbits=this.bits=0;this.output=null;this.outpos=0;this.lengths=[];this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);
this.lengths.push(-1);this.lengths.push(-1);this.window=new de(c)};h["haxe.zip.InflateImpl"]=bb;bb.__name__=!0;bb.prototype={buildFixedHuffman:function(){if(null!=bb.FIXED_HUFFMAN)return bb.FIXED_HUFFMAN;for(var a=[],b=0;288>b;){var c=b++;a.push(143>=c?8:255>=c?9:279>=c?7:8)}bb.FIXED_HUFFMAN=this.htools.make(a,0,288,10);return bb.FIXED_HUFFMAN},readBytes:function(a,b,c){this.needed=c;this.outpos=b;this.output=a;if(0<c)for(;this.inflateLoop(););return c-this.needed},getBits:function(a){for(;this.nbits<
a;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<a)-1;this.nbits-=a;this.bits>>=a;return b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var a=1==(this.bits&1);this.nbits--;this.bits>>=1;return a},getRevBits:function(a){return 0==a?0:this.getBit()?1<<a-1|this.getRevBits(a-1):this.getRevBits(a-1)},resetBits:function(){this.nbits=this.bits=0},addBytes:function(a,b,c){this.window.addBytes(a,b,c);this.output.blit(this.outpos,a,b,c);this.needed-=
c;this.outpos+=c},addByte:function(a){this.window.addByte(a);this.output.b[this.outpos]=a&255;this.needed--;this.outpos++},addDistOne:function(a){for(var b=this.window.getLastChar(),c=0;c<a;)c++,this.addByte(b)},addDist:function(a,b){this.addBytes(this.window.buffer,this.window.pos-a,b)},applyHuffman:function(a){switch(a._hx_index){case 0:var b=a.i;return b;case 1:return b=a.left,a=a.right,this.applyHuffman(this.getBit()?a:b);case 2:return b=a.n,this.applyHuffman(a.table[this.getBits(b)])}},inflateLengths:function(a,
b){for(var c=0,e=0;c<b;){var f=this.applyHuffman(this.huffman);switch(f){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:e=f;a[c]=f;++c;break;case 16:f=c+3+this.getBits(2);if(f>b)throw A.thrown("Invalid data");for(;c<f;)a[c]=e,++c;break;case 17:c+=3+this.getBits(3);if(c>b)throw A.thrown("Invalid data");break;case 18:c+=11+this.getBits(7);if(c>b)throw A.thrown("Invalid data");break;default:throw A.thrown("Invalid data");}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var a=
this.input.readByte();if(8!=(a&15))throw A.thrown("Invalid data");var b=this.input.readByte(),c=0!=(b&32);if(0!=((a<<8)+b)%31)throw A.thrown("Invalid data");if(c)throw A.thrown("Unsupported dictionary");this.state=ab.Block;return!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:this.len=this.input.readUInt16();if(this.input.readUInt16()!=65535-this.len)throw A.thrown("Invalid data");this.state=ab.Flat;a=this.inflateLoop();this.resetBits();return a;case 1:return this.huffman=this.buildFixedHuffman(),
this.huffdist=null,this.state=ab.CData,!0;case 2:a=this.getBits(5)+257;b=this.getBits(5)+1;var e=this.getBits(4)+4;c=0;for(var f=e;c<f;){var g=c++;this.lengths[bb.CODE_LENGTHS_POS[g]]=this.getBits(3)}c=e;for(f=19;c<f;)g=c++,this.lengths[bb.CODE_LENGTHS_POS[g]]=0;this.huffman=this.htools.make(this.lengths,0,19,8);e=[];c=0;for(f=a+b;c<f;)c++,e.push(0);this.inflateLengths(e,a+b);this.huffdist=this.htools.make(e,a,b,16);this.huffman=this.htools.make(e,0,a,16);this.state=ab.CData;return!0;default:throw A.thrown("Invalid data");
}case 2:b=this.applyHuffman(this.huffman);if(256>b)return this.addByte(b),0<this.needed;if(256==b)this.state=this.isFinal?ab.Crc:ab.Block;else{b-=257;a=bb.LEN_EXTRA_BITS_TBL[b];if(-1==a)throw A.thrown("Invalid data");this.len=bb.LEN_BASE_VAL_TBL[b]+this.getBits(a);b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);a=bb.DIST_EXTRA_BITS_TBL[b];if(-1==a)throw A.thrown("Invalid data");this.dist=bb.DIST_BASE_VAL_TBL[b]+this.getBits(a);if(this.dist>this.window.available())throw A.thrown("Invalid data");
this.state=1==this.dist?ab.DistOne:ab.Dist}return!0;case 3:return a=this.len<this.needed?this.len:this.needed,b=this.input.read(a),this.len-=a,this.addBytes(b,0,a),0==this.len&&(this.state=this.isFinal?ab.Crc:ab.Block),0<this.needed;case 4:a=this.window.checksum();if(null==a)return this.state=ab.Done,!0;b=xc.read(this.input);if(!a.equals(b))throw A.thrown("Invalid CRC");this.state=ab.Done;return!0;case 5:for(;0<this.len&&0<this.needed;)a=this.len<this.dist?this.len:this.dist,a=this.needed<a?this.needed:
a,this.addDist(this.dist,a),this.len-=a;0==this.len&&(this.state=ab.CData);return 0<this.needed;case 6:return a=this.len<this.needed?this.len:this.needed,this.addDistOne(a),this.len-=a,0==this.len&&(this.state=ab.CData),0<this.needed;case 7:return!1}},__class__:bb};var Yc=function(a){this.i=a};h["haxe.zip.Reader"]=Yc;Yc.__name__=!0;Yc.readZip=function(a){return(new Yc(a)).read()};Yc.prototype={readZipDate:function(){var a=this.i.readUInt16(),b=a>>11&31,c=a>>5&63;a&=31;var e=this.i.readUInt16();return new Date((e>>
9)+1980,(e>>5&15)-1,e&31,b,c,a<<1)},readExtraFields:function(a){for(var b=new Tb;0<a;){if(4>a)throw A.thrown("Invalid extra fields data");var c=this.i.readUInt16(),e=this.i.readUInt16();if(a<e)throw A.thrown("Invalid extra fields data");if(28789==c){var f=this.i.readByte();if(1!=f){var g=new Dd;g.addByte(f);g.add(this.i.read(e-1));b.add(Ic.FUnknown(c,g.getBytes()))}else c=this.i.readInt32(),f=this.i.read(e-5).toString(),b.add(Ic.FInfoZipUnicodePath(f,c))}else b.add(Ic.FUnknown(c,this.i.read(e)));
a-=4+e}return b},readEntryHeader:function(){var a=this.i,b=a.readInt32();if(33639248==b||101010256==b)return null;if(67324752!=b)throw A.thrown("Invalid Zip Data");a.readUInt16();b=a.readUInt16();var c=0!=(b&2048),e=a.readUInt16(),f=0!=e;if(f&&8!=e)throw A.thrown("Unsupported compression "+e);e=this.readZipDate();var g=a.readInt32(),d=a.readInt32(),l=a.readInt32(),h=a.readInt16(),m=a.readInt16();a=a.readString(h);m=this.readExtraFields(m);c&&m.push(Ic.FUtf8);0!=(b&8)&&(d=-1);return{fileName:a,fileSize:l,
fileTime:e,compressed:f,dataSize:d,data:null,crc32:g,extraFields:m}},read:function(){for(var a=new Tb,b=null;;){var c=this.readEntryHeader();if(null==c)break;if(0>c.dataSize){null==b&&(b=new Ga(new ArrayBuffer(65536)));for(var e=new Dd,f=new bb(this.i,!1,!1);;){var g=f.readBytes(b,0,65536);e.addBytes(b,0,g);if(65536>g)break}c.data=e.getBytes();c.crc32=this.i.readInt32();134695760==c.crc32&&(c.crc32=this.i.readInt32());c.dataSize=this.i.readInt32();c.fileSize=this.i.readInt32();c.dataSize=c.fileSize;
c.compressed=!1}else c.data=this.i.read(c.dataSize);a.add(c)}return a},__class__:Yc};var Qb=function(a,b){this.message=a;this.pos=b};h["hxjsonast.Error"]=Qb;Qb.__name__=!0;Qb.prototype={__class__:Qb};var ma=function(a,b){this.value=a;this.pos=b};h["hxjsonast.Json"]=ma;ma.__name__=!0;ma.prototype={__class__:ma};var za=y["hxjsonast.JsonValue"]={__ename__:!0,__constructs__:null,JString:(n=function(a){return{_hx_index:0,s:a,__enum__:"hxjsonast.JsonValue",toString:p}},n._hx_name="JString",n.__params__=
["s"],n),JNumber:(n=function(a){return{_hx_index:1,s:a,__enum__:"hxjsonast.JsonValue",toString:p}},n._hx_name="JNumber",n.__params__=["s"],n),JObject:(n=function(a){return{_hx_index:2,fields:a,__enum__:"hxjsonast.JsonValue",toString:p}},n._hx_name="JObject",n.__params__=["fields"],n),JArray:(n=function(a){return{_hx_index:3,values:a,__enum__:"hxjsonast.JsonValue",toString:p}},n._hx_name="JArray",n.__params__=["values"],n),JBool:(n=function(a){return{_hx_index:4,b:a,__enum__:"hxjsonast.JsonValue",
toString:p}},n._hx_name="JBool",n.__params__=["b"],n),JNull:{_hx_name:"JNull",_hx_index:5,__enum__:"hxjsonast.JsonValue",toString:p}};za.__constructs__=[za.JString,za.JNumber,za.JObject,za.JArray,za.JBool,za.JNull];var ee=function(a,b,c){this.name=a;this.namePos=b;this.value=c};h["hxjsonast.JObjectField"]=ee;ee.__name__=!0;ee.prototype={__class__:ee};var Xd=function(a,b){this.source=a;this.filename=b;this.pos=0};h["hxjsonast.Parser"]=Xd;Xd.__name__=!0;Xd.prototype={doParse:function(){for(var a=this.parseRec(),
b;;){var c=b=this.source.charCodeAt(this.pos++);if(c!=c)break;switch(b){case 9:case 10:case 13:case 32:break;default:this.invalidChar()}}return a},parseRec:function(){for(;;){var a=this.source.charCodeAt(this.pos++);switch(a){case 9:case 10:case 13:case 32:break;case 34:var b=this.pos,c=this.parseString();return new ma(za.JString(c),new ka(this.filename,b-1,this.pos));case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:b=this.pos-1;c=45==a;var e=!c;a=48==a;for(var f=
!1,g=!1,d=!1,l=!1;;){switch(this.source.charCodeAt(this.pos++)){case 43:case 45:g&&!d||this.invalidNumber(b);e=!1;d=!0;break;case 46:(c||f||g)&&this.invalidNumber(b);e=!1;f=!0;break;case 48:a&&!f&&this.invalidNumber(b);c&&(c=!1,a=!0);e=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a&&!f&&this.invalidNumber(b);c&&(c=!1);e=!0;a=!1;break;case 69:case 101:(c||a||g)&&this.invalidNumber(b);e=!1;g=!0;break;default:e||this.invalidNumber(b),this.pos--,l=!0}if(l)break}c=z.substr(this.source,
b,this.pos-b);return new ma(za.JNumber(c),new ka(this.filename,b,this.pos));case 91:for(b=[],c=null,e=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 44:c?c=!1:this.invalidChar();break;case 93:return 0==c&&this.invalidChar(),new ma(za.JArray(b),new ka(this.filename,e,this.pos));default:c&&this.invalidChar(),this.pos--,b.push(this.parseRec()),c=!0}case 102:b=this.pos;if(97!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||
115!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new ma(za.JBool(!1),new ka(this.filename,b-1,this.pos));case 110:b=this.pos;if(117!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new ma(za.JNull,new ka(this.filename,b-1,this.pos));case 116:b=this.pos;if(114!=this.source.charCodeAt(this.pos++)||117!=this.source.charCodeAt(this.pos++)||
101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new ma(za.JBool(!0),new ka(this.filename,b-1,this.pos));case 123:for(b=[],c=Object.create(null),a=g=e=null,f=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 34:(null!=e||a)&&this.invalidChar();g=this.pos-1;e=this.parseString();g=new ka(this.filename,g,this.pos);if(Object.prototype.hasOwnProperty.call(c,e))throw A.thrown(new Qb('Duplicate field name "'+e+'"',g));c[e]=!0;break;
case 44:a?a=!1:this.invalidChar();break;case 58:null==e&&this.invalidChar();b.push(new ee(e,g,this.parseRec()));g=e=null;a=!0;break;case 125:return null==e&&0!=a||this.invalidChar(),new ma(za.JObject(b),new ka(this.filename,f,this.pos));default:this.invalidChar()}default:this.invalidChar()}}},parseString:function(){for(var a=this.pos,b=null;;){var c=this.source.charCodeAt(this.pos++);if(34==c)break;if(92==c){null==b&&(b=new Fa);c=this.source;var e=this.pos-a-1;b.b+=null==e?z.substr(c,a,null):z.substr(c,
a,e);c=this.source.charCodeAt(this.pos++);switch(c){case 34:case 47:case 92:b.b+=String.fromCodePoint(c);break;case 98:b.b+=String.fromCodePoint(8);break;case 102:b.b+=String.fromCodePoint(12);break;case 110:b.b+=String.fromCodePoint(10);break;case 114:b.b+=String.fromCodePoint(13);break;case 116:b.b+=String.fromCodePoint(9);break;case 117:a=J.parseInt("0x"+z.substr(this.source,this.pos,4));this.pos+=4;b.b+=String.fromCodePoint(a);break;default:throw A.thrown(new Qb("Invalid escape sequence \\"+String.fromCodePoint(c),
new ka(this.filename,this.pos-2,this.pos)));}a=this.pos}else if(c!=c)throw this.pos--,A.thrown(new Qb("Unclosed string",new ka(this.filename,a-1,this.pos)));}if(null==b)return z.substr(this.source,a,this.pos-a-1);c=this.source;e=this.pos-a-1;b.b+=null==e?z.substr(c,a,null):z.substr(c,a,e);return b.b},invalidChar:function(){this.pos--;throw A.thrown(new Qb("Invalid character: "+this.source.charAt(this.pos),new ka(this.filename,this.pos,this.pos+1)));},invalidNumber:function(a){throw A.thrown(new Qb("Invalid number: "+
this.source.substring(a,this.pos),new ka(this.filename,a,this.pos)));},__class__:Xd};var ka=function(a,b,c){this.file=a;this.min=b;this.max=c};h["hxjsonast.Position"]=ka;ka.__name__=!0;ka.prototype={__class__:ka};var ra=function(){};h["js.Boot"]=ra;ra.__name__=!0;ra.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=ra.__nativeClassName(a);return null!=a?ra.__resolveNativeClass(a):null};ra.__string_rec=function(a,b){if(null==a)return"null";
if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a.__enum__){var e=y[a.__enum__].__constructs__[a._hx_index];c=e._hx_name;if(e.__params__){b+="\t";var f=[],g=0;for(e=e.__params__;g<e.length;){var d=e[g];g+=1;f.push(ra.__string_rec(a[d],b))}return c+"("+f.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";f=0;for(g=a.length;f<g;)e=f++,c+=(0<e?",":"")+ra.__string_rec(a[e],b);return c+
"]"}try{f=a.toString}catch(l){return ja.lastError=l,"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";f=null!=a.hasOwnProperty;g=null;for(g in a)f&&!a.hasOwnProperty(g)||"prototype"==g||"__class__"==g||"__super__"==g||"__interfaces__"==g||"__properties__"==g||(2!=c.length&&(c+=", \n"),c+=b+g+" : "+ra.__string_rec(a[g],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};ra.__interfLoop=
function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var e=0,f=c.length;e<f;){var g=e++;g=c[g];if(g==b||ra.__interfLoop(g,b))return!0}return ra.__interfLoop(a.__super__,b)};ra.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;case Te:return"boolean"==typeof a;case Ue:return null!=a;case Ve:return"number"==typeof a;case We:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==
typeof b){if(ra.__downcastCheck(a,b))return!0}else{if("object"==typeof b&&ra.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==Xe&&null!=a.__name__||b==Ye&&null!=a.__ename__?!0:null!=a.__enum__?y[a.__enum__]==b:!1}};ra.__downcastCheck=function(a,b){return a instanceof b?!0:b.__isInterface__?ra.__interfLoop(ra.getClass(a),b):!1};ra.__cast=function(a,b){if(null==a||ra.__instanceof(a,b))return a;throw A.thrown("Cannot cast "+J.string(a)+" to "+J.string(b));};ra.__nativeClassName=function(a){a=
ra.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};ra.__isNativeObj=function(a){return null!=ra.__nativeClassName(a)};ra.__resolveNativeClass=function(a){return r[a]};var va=y["json2object.Error"]={__ename__:!0,__constructs__:null,IncorrectType:(n=function(a,b,c){return{_hx_index:0,variable:a,expected:b,pos:c,__enum__:"json2object.Error",toString:p}},n._hx_name="IncorrectType",n.__params__=["variable","expected","pos"],n),IncorrectEnumValue:(n=function(a,
b,c){return{_hx_index:1,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:p}},n._hx_name="IncorrectEnumValue",n.__params__=["value","expected","pos"],n),InvalidEnumConstructor:(n=function(a,b,c){return{_hx_index:2,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:p}},n._hx_name="InvalidEnumConstructor",n.__params__=["value","expected","pos"],n),UninitializedVariable:(n=function(a,b){return{_hx_index:3,variable:a,pos:b,__enum__:"json2object.Error",toString:p}},n._hx_name=
"UninitializedVariable",n.__params__=["variable","pos"],n),UnknownVariable:(n=function(a,b){return{_hx_index:4,variable:a,pos:b,__enum__:"json2object.Error",toString:p}},n._hx_name="UnknownVariable",n.__params__=["variable","pos"],n),ParserError:(n=function(a,b){return{_hx_index:5,message:a,pos:b,__enum__:"json2object.Error",toString:p}},n._hx_name="ParserError",n.__params__=["message","pos"],n),CustomFunctionException:(n=function(a,b){return{_hx_index:6,e:a,pos:b,__enum__:"json2object.Error",toString:p}},
n._hx_name="CustomFunctionException",n.__params__=["e","pos"],n)};va.__constructs__=[va.IncorrectType,va.IncorrectEnumValue,va.InvalidEnumConstructor,va.UninitializedVariable,va.UnknownVariable,va.ParserError,va.CustomFunctionException];var Db=y["json2object.InternalError"]={__ename__:!0,__constructs__:null,AbstractNoJsonRepresentation:(n=function(a){return{_hx_index:0,name:a,__enum__:"json2object.InternalError",toString:p}},n._hx_name="AbstractNoJsonRepresentation",n.__params__=["name"],n),CannotGenerateSchema:(n=
function(a){return{_hx_index:1,name:a,__enum__:"json2object.InternalError",toString:p}},n._hx_name="CannotGenerateSchema",n.__params__=["name"],n),HandleExpr:{_hx_name:"HandleExpr",_hx_index:2,__enum__:"json2object.InternalError",toString:p},ParsingThrow:{_hx_name:"ParsingThrow",_hx_index:3,__enum__:"json2object.InternalError",toString:p},UnsupportedAbstractEnumType:(n=function(a){return{_hx_index:4,name:a,__enum__:"json2object.InternalError",toString:p}},n._hx_name="UnsupportedAbstractEnumType",
n.__params__=["name"],n),UnsupportedEnumAbstractValue:(n=function(a){return{_hx_index:5,name:a,__enum__:"json2object.InternalError",toString:p}},n._hx_name="UnsupportedEnumAbstractValue",n.__params__=["name"],n),UnsupportedMapKeyType:(n=function(a){return{_hx_index:6,name:a,__enum__:"json2object.InternalError",toString:p}},n._hx_name="UnsupportedMapKeyType",n.__params__=["name"],n),UnsupportedSchemaObjectType:(n=function(a){return{_hx_index:7,name:a,__enum__:"json2object.InternalError",toString:p}},
n._hx_name="UnsupportedSchemaObjectType",n.__params__=["name"],n),UnsupportedSchemaType:(n=function(a){return{_hx_index:8,type:a,__enum__:"json2object.InternalError",toString:p}},n._hx_name="UnsupportedSchemaType",n.__params__=["type"],n)};Db.__constructs__=[Db.AbstractNoJsonRepresentation,Db.CannotGenerateSchema,Db.HandleExpr,Db.ParsingThrow,Db.UnsupportedAbstractEnumType,Db.UnsupportedEnumAbstractValue,Db.UnsupportedMapKeyType,Db.UnsupportedSchemaObjectType,Db.UnsupportedSchemaType];var Fe=function(){};
h["json2object.ErrorUtils"]=Fe;Fe.__name__=!0;Fe.convertError=function(a){switch(a._hx_index){case 0:var b=a.pos;var c=b;break;case 1:c=b=a.pos;break;case 2:c=b=a.pos;break;case 3:c=b=a.pos;break;case 4:c=b=a.pos;break;case 5:c=b=a.pos;break;case 6:c=b=a.pos}b="";if(null!=c){var e=""==c.file?"line":""+c.file+":";1==c.lines.length?b=""+e+c.lines[0].number+": characters "+c.lines[0].start+"-"+c.lines[0].end+" : ":1<c.lines.length&&(b=""+e+c.lines[0].number+": lines "+c.lines[0].number+"-"+c.lines[c.lines.length-
1].number+" : ")}switch(a._hx_index){case 0:return c=a.variable,a=a.expected,b+("Variable '"+c+"' should be of type '"+a+"'");case 1:return c=a.value,a=a.expected,b+("Identifier '"+c+"' isn't part of '"+a+"'");case 2:return c=a.value,a=a.expected,b+("Enum argument '"+c+"' should be of type '"+a+"'");case 3:return c=a.variable,b+("Variable '"+c+"' should be in the json");case 4:return c=a.variable,b+("Variable '"+c+"' isn't part of the schema");case 5:return b+("Parser error: "+a.message);case 6:return a=
a.e,b+("Custom function exception: "+(null==a?"null":J.string(a)))}};var Wd=function(a){this.linesInfo=[];for(var b=0,c,e=0,f=0;e<a.length;)switch(a.charAt(e)){case "\n":c=e;this.linesInfo.push({number:f,start:b,end:c});++f;++e;b=e;break;case "\r":c=e;"\n"==a.charAt(e+1)&&++c;this.linesInfo.push({number:f,start:b,end:c});++f;b=e=c+1;break;default:++e}this.linesInfo.push({number:f,start:b,end:e})};h["json2object.PositionUtils"]=Wd;Wd.__name__=!0;Wd.prototype={convertPosition:function(a){var b=a.min,
c=a.max;a={file:a.file,min:b+1,max:c+1,lines:[]};var e=0,f=this.linesInfo.length-1;if(b>this.linesInfo[0].end)for(;f>e;){var g=(e+f)/2|0,d=this.linesInfo[g];d.start==b&&(f=e=g);d.end<b&&(e=g+1);if(d.start>b||d.end>=b&&d.start<b)f=g}for(f=this.linesInfo.length;e<f;){g=e++;d=this.linesInfo[g];if(d.start<=b&&d.end>=c){a.lines.push({number:d.number+1,start:b-d.start+1,end:c-d.start+1});break}d.start<=b&&b<=d.end&&a.lines.push({number:d.number+1,start:b-d.start+1,end:d.end+1});d.start<=c&&c<=d.end&&a.lines.push({number:d.number+
1,start:d.start+1,end:c-d.start+1});if(d.start>=c||d.end>=c)break}return a},__class__:Wd};var Qd=function(){this.connected=!0;this.buttons=[];this.axes=[]};h["lime._internal.backend.html5.GameDeviceData"]=Qd;Qd.__name__=!0;Qd.prototype={__class__:Qd};var R=function(){this.validStatus0=(new da("Tizen","gi")).match(window.navigator.userAgent)};h["lime._internal.backend.html5.HTML5HTTPRequest"]=R;R.__name__=!0;R.loadImage=function(a){var b=new Gb;R.activeRequests<R.requestLimit?(R.activeRequests++,R.__loadImage(a,
b,0)):R.requestQueue.add({instance:null,uri:a,promise:b,type:"IMAGE",options:0});return b.future};R.loadImageFromBytes=function(a,b){var c=URL.createObjectURL(new Blob([a.b.bufferValue],{type:b}));return null!=c?(a=new Gb,R.activeRequests<R.requestLimit?(R.activeRequests++,R.__loadImage(c,a,1)):R.requestQueue.add({instance:null,uri:c,promise:a,type:"IMAGE",options:1}),a.future):R.loadImage("data:"+b+";base64,"+vb.encode(a))};R.processQueue=function(){if(R.activeRequests<R.requestLimit&&0<R.requestQueue.length){R.activeRequests++;
var a=R.requestQueue.pop();switch(a.type){case "BINARY":a.instance.__loadData(a.uri,a.promise);break;case "IMAGE":R.__loadImage(a.uri,a.promise,a.options);break;case "TEXT":a.instance.__loadText(a.uri,a.promise);break;default:R.activeRequests--}}};R.__fixHostname=function(a){return null==a?"":a};R.__fixPort=function(a,b){if(null==a||""==a)switch(b){case "ftp:":return"21";case "gopher:":return"70";case "http:":return"80";case "https:":return"443";case "ws:":return"80";case "wss:":return"443";default:return""}return a};
R.__fixProtocol=function(a){return null==a||""==a?"http:":a};R.__isInMemoryURI=function(a){return U.startsWith(a,"data:")?!0:U.startsWith(a,"blob:")};R.__isSameOrigin=function(a){if(null==a||""==a||R.__isInMemoryURI(a))return!0;null==R.originElement&&(R.originElement=window.document.createElement("a"),R.originHostname=R.__fixHostname(r.location.hostname),R.originProtocol=R.__fixProtocol(r.location.protocol),R.originPort=R.__fixPort(r.location.port,R.originProtocol));var b=R.originElement;b.href=a;
""==b.hostname&&(b.href=b.href);var c=R.__fixHostname(b.hostname);a=R.__fixProtocol(b.protocol);b=R.__fixPort(b.port,a);c=""==c||c==R.originHostname;b=""==b||b==R.originPort;return"file:"!=a&&c?b:!1};R.__loadImage=function(a,b,c){var e=new Image;R.__isSameOrigin(a)||(e.crossOrigin="Anonymous");null==R.supportsImageProgress&&(R.supportsImageProgress="onprogress"in e);if(R.supportsImageProgress||R.__isInMemoryURI(a))e.addEventListener("load",function(f){R.__revokeBlobURI(a,c);f=new Jc(null,e.width,
e.height);f.__srcImage=e;R.activeRequests--;R.processQueue();b.complete(new Ba(f))},!1),e.addEventListener("progress",function(a){b.progress(a.loaded,a.total)},!1),e.addEventListener("error",function(e){R.__revokeBlobURI(a,c);R.activeRequests--;R.processQueue();b.error(e.detail)},!1),e.src=a;else{var f=new XMLHttpRequest;f.onload=function(a){R.activeRequests--;R.processQueue();(new Ba).__fromBytes(Ga.ofData(f.response),function(a){b.complete(a)})};f.onerror=function(a){b.error(a.message)};f.onprogress=
function(a){a.lengthComputable&&b.progress(a.loaded,a.total)};f.open("GET",a,!0);f.responseType="arraybuffer";f.overrideMimeType("text/plain; charset=x-user-defined");f.send(null)}};R.__revokeBlobURI=function(a,b){0!=(b&1)&&URL.revokeObjectURL(a)};R.prototype={init:function(a){this.parent=a},load:function(a,b,c){this.request=new XMLHttpRequest;"POST"==this.parent.method?this.request.upload.addEventListener("progress",b,!1):this.request.addEventListener("progress",b,!1);this.request.onreadystatechange=
c;b="";if(null==this.parent.data){c=Object.keys(this.parent.formData.h);for(var e=c.length,f=0;f<e;){var g=c[f++];0<b.length&&(b+="&");var d=this.parent.formData.h[g];if(-1<g.indexOf("[]")&&d instanceof Array){var l=[];for(d=E(d);d.hasNext();){var h=d.next();l.push(encodeURIComponent(h))}l=l.join("&amp;"+g+"=");b+=encodeURIComponent(g)+"="+l}else l=encodeURIComponent(g)+"=",g=J.string(d),b+=l+encodeURIComponent(g)}"GET"==this.parent.method&&""!=b&&(a=-1<a.indexOf("?")?a+("&"+b):a+("?"+b),b="")}this.request.open(J.string(this.parent.method),
a,!0);0<this.parent.timeout&&(this.request.timeout=this.parent.timeout);this.binary&&(this.request.responseType="arraybuffer");a=null;l=0;for(c=this.parent.headers;l<c.length;)e=c[l],++l,"Content-Type"==e.name?a=e.value:this.request.setRequestHeader(e.name,e.value);null!=this.parent.contentType&&(a=this.parent.contentType);null==a&&(null!=this.parent.data?a="application/octet-stream":""!=b&&(a="application/x-www-form-urlencoded"));null!=a&&this.request.setRequestHeader("Content-Type",a);this.parent.withCredentials&&
(this.request.withCredentials=!0);null!=this.parent.data?this.request.send(this.parent.data.b.bufferValue):this.request.send(b)},loadData:function(a){var b=new Gb;R.activeRequests<R.requestLimit?(R.activeRequests++,this.__loadData(a,b)):R.requestQueue.add({instance:this,uri:a,promise:b,type:"BINARY",options:0});return b.future},loadText:function(a){var b=new Gb;R.activeRequests<R.requestLimit?(R.activeRequests++,this.__loadText(a,b)):R.requestQueue.add({instance:this,uri:a,promise:b,type:"TEXT",options:0});
return b.future},processResponse:function(){if(this.parent.enableResponseHeaders){this.parent.responseHeaders=[];for(var a,b,c=0,e=this.request.getAllResponseHeaders().split("\n");c<e.length;)b=e[c],++c,a=U.trim(z.substr(b,0,b.indexOf(":"))),b=U.trim(z.substr(b,b.indexOf(":")+1,null)),""!=a&&this.parent.responseHeaders.push(new fe(a,b))}this.parent.responseStatus=this.request.status},__loadData:function(a,b){var c=this;this.binary=!0;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==
c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>c.request.status||c.validStatus0&&0==c.request.status)?(a=null,""==c.request.responseType?null!=c.request.responseText&&(a=Ga.ofString(c.request.responseText)):null!=c.request.response&&(a=Ga.ofData(c.request.response)),c.processResponse(),b.complete(a)):(c.processResponse(),b.error(c.request.status)),c.request=null,R.activeRequests--,R.processQueue())})},__loadText:function(a,b){var c=this;this.binary=!1;this.load(a,function(a){b.progress(a.loaded,
a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>=c.request.status||c.validStatus0&&0==c.request.status)?(c.processResponse(),b.complete(c.request.responseText)):(c.processResponse(),b.error(c.request.status)),c.request=null,R.activeRequests--,R.processQueue())})},__class__:R};var kd=function(a){this.unusedTouchesPool=new Tb;this.scale=1;this.currentTouches=new zb;this.parent=a;this.cursor=pb.DEFAULT;this.cacheMouseY=this.cacheMouseX=0;var b=a.__attributes;
Object.prototype.hasOwnProperty.call(b,"context")||(b.context={});this.renderType=b.context.type;Object.prototype.hasOwnProperty.call(b,"element")&&(a.element=b.element);var c=a.element;Object.prototype.hasOwnProperty.call(b,"allowHighDPI")&&b.allowHighDPI&&"dom"!=this.renderType&&(this.scale=window.devicePixelRatio);a.__scale=this.scale;this.setWidth=Object.prototype.hasOwnProperty.call(b,"width")?b.width:0;this.setHeight=Object.prototype.hasOwnProperty.call(b,"height")?b.height:0;a.__width=this.setWidth;
a.__height=this.setHeight;a.id=kd.windowID++;c instanceof HTMLCanvasElement?this.canvas=c:"dom"==this.renderType?this.div=window.document.createElement("div"):this.canvas=window.document.createElement("canvas");if(null!=this.canvas){var e=this.canvas.style;e.setProperty("-webkit-transform","translateZ(0)",null);e.setProperty("transform","translateZ(0)",null)}else null!=this.div&&(e=this.div.style,e.setProperty("-webkit-transform","translate3D(0,0,0)",null),e.setProperty("transform","translate3D(0,0,0)",
null),e.position="relative",e.overflow="hidden",e.setProperty("-webkit-user-select","none",null),e.setProperty("-moz-user-select","none",null),e.setProperty("-ms-user-select","none",null),e.setProperty("-o-user-select","none",null));0==a.__width&&0==a.__height&&(null!=c?(a.__width=c.clientWidth,a.__height=c.clientHeight):(a.__width=window.innerWidth,a.__height=window.innerHeight),this.cacheElementWidth=a.__width,this.cacheElementHeight=a.__height,this.resizeElement=!0);null!=this.canvas?(this.canvas.width=
Math.round(a.__width*this.scale),this.canvas.height=Math.round(a.__height*this.scale),this.canvas.style.width=a.__width+"px",this.canvas.style.height=a.__height+"px"):(this.div.style.width=a.__width+"px",this.div.style.height=a.__height+"px");if(Object.prototype.hasOwnProperty.call(b,"resizable")&&b.resizable||!Object.prototype.hasOwnProperty.call(b,"width")&&0==this.setWidth&&0==this.setHeight)a.__resizable=!0;this.updateSize();if(null!=c){null!=this.canvas?c!=this.canvas&&c.appendChild(this.canvas):
c.appendChild(this.div);b="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");for(e=0;e<b.length;){var f=b[e];++e;c.addEventListener(f,d(this,this.handleMouseEvent),!0)}c.addEventListener("contextmenu",d(this,this.handleContextMenuEvent),!0);c.addEventListener("dragstart",d(this,this.handleDragEvent),!0);c.addEventListener("dragover",d(this,this.handleDragEvent),!0);c.addEventListener("drop",d(this,this.handleDragEvent),!0);c.addEventListener("touchstart",d(this,this.handleTouchEvent),
!0);c.addEventListener("touchmove",d(this,this.handleTouchEvent),!0);c.addEventListener("touchend",d(this,this.handleTouchEvent),!0);c.addEventListener("touchcancel",d(this,this.handleTouchEvent),!0);c.addEventListener("gamepadconnected",d(this,this.handleGamepadEvent),!0);c.addEventListener("gamepaddisconnected",d(this,this.handleGamepadEvent),!0)}this.createContext();"webgl"==a.context.type&&(this.canvas.addEventListener("webglcontextlost",d(this,this.handleContextEvent),!1),this.canvas.addEventListener("webglcontextrestored",
d(this,this.handleContextEvent),!1))};h["lime._internal.backend.html5.HTML5Window"]=kd;kd.__name__=!0;kd.prototype={close:function(){this.parent.application.__removeWindow(this.parent)},createContext:function(){var a=new ge,b=this.parent.__attributes.context;a.window=this.parent;a.attributes=b;if(null!=this.div)a.dom=this.div,a.type="dom",a.version="";else if(null!=this.canvas){var c=null,e="canvas"==this.renderType,f="opengl"==this.renderType||"opengles"==this.renderType||"webgl"==this.renderType,
g=!Object.prototype.hasOwnProperty.call(b,"version")||"1"!=b.version,d=!1;if(f||!e&&(!Object.prototype.hasOwnProperty.call(b,"hardware")||b.hardware)){e=Object.prototype.hasOwnProperty.call(b,"background")&&null==b.background;f=Object.prototype.hasOwnProperty.call(b,"colorDepth")?b.colorDepth:16;var l=Object.prototype.hasOwnProperty.call(b,"antialiasing")&&0<b.antialiasing,h=Object.prototype.hasOwnProperty.call(b,"depth")?b.depth:!0;b=Object.prototype.hasOwnProperty.call(b,"stencil")&&b.stencil;b=
{alpha:e||16<f,antialias:l,depth:h,premultipliedAlpha:!0,stencil:b,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1};e=["webgl","experimental-webgl"];g&&e.unshift("webgl2");for(g=0;g<e.length&&(f=e[g],++g,c=this.canvas.getContext(f,b),null!=c&&"webgl2"==f&&(d=!0),null==c););}null==c?(a.canvas2D=this.canvas.getContext("2d"),a.type="canvas",a.version=""):(a.webgl=Ze.fromWebGL2RenderContext(c),d&&(a.webgl2=c),null==ld.context&&(ld.context=c,ld.type="webgl",ld.version=d?2:1),a.type="webgl",a.version=
d?"2":"1")}this.parent.context=a},handleContextEvent:function(a){switch(a.type){case "webglcontextlost":a.cancelable&&a.preventDefault();this.parent.context=null;this.parent.onRenderContextLost.dispatch();break;case "webglcontextrestored":this.createContext(),this.parent.onRenderContextRestored.dispatch(this.parent.context)}},handleContextMenuEvent:function(a){(this.parent.onMouseUp.canceled||this.parent.onMouseDown.canceled)&&a.cancelable&&a.preventDefault()},handleDragEvent:function(a){switch(a.type){case "dragover":return a.preventDefault(),
!1;case "dragstart":if("img"==ra.__cast(a.target,HTMLElement).nodeName.toLowerCase()&&a.cancelable)return a.preventDefault(),!1;break;case "drop":if(null!=a.dataTransfer&&0<a.dataTransfer.files.length)return this.parent.onDropFile.dispatch(a.dataTransfer.files),a.preventDefault(),!1}return!0},handleGamepadEvent:function(a){switch(a.type){case "gamepadconnected":Pa.__connect(a.gamepad.index);"standard"==a.gamepad.mapping&&cb.__connect(a.gamepad.index);break;case "gamepaddisconnected":Pa.__disconnect(a.gamepad.index),
cb.__disconnect(a.gamepad.index)}},handleMouseEvent:function(a){if("wheel"!=a.type){if(null!=this.parent.element)if(null!=this.canvas){var b=this.canvas.getBoundingClientRect();var c=this.parent.__width/b.width*(a.clientX-b.left);b=this.parent.__height/b.height*(a.clientY-b.top)}else null!=this.div?(b=this.div.getBoundingClientRect(),c=a.clientX-b.left,b=a.clientY-b.top):(b=this.parent.element.getBoundingClientRect(),c=this.parent.__width/b.width*(a.clientX-b.left),b=this.parent.__height/b.height*
(a.clientY-b.top));else c=a.clientX,b=a.clientY;switch(a.type){case "mousedown":a.currentTarget==this.parent.element&&window.addEventListener("mouseup",d(this,this.handleMouseEvent));this.parent.onMouseDown.dispatch(c,b,a.button);this.parent.onMouseDown.canceled&&a.cancelable&&a.preventDefault();break;case "mouseenter":a.target==this.parent.element&&(this.parent.onEnter.dispatch(),this.parent.onEnter.canceled&&a.cancelable&&a.preventDefault());break;case "mouseleave":a.target==this.parent.element&&
(this.parent.onLeave.dispatch(),this.parent.onLeave.canceled&&a.cancelable&&a.preventDefault());break;case "mousemove":if(c!=this.cacheMouseX||b!=this.cacheMouseY)this.parent.onMouseMove.dispatch(c,b),this.parent.onMouseMoveRelative.dispatch(c-this.cacheMouseX,b-this.cacheMouseY),(this.parent.onMouseMove.canceled||this.parent.onMouseMoveRelative.canceled)&&a.cancelable&&a.preventDefault();break;case "mouseup":window.removeEventListener("mouseup",d(this,this.handleMouseEvent)),a.currentTarget==this.parent.element&&
a.stopPropagation(),this.parent.onMouseUp.dispatch(c,b,a.button),this.parent.onMouseUp.canceled&&a.cancelable&&a.preventDefault()}this.cacheMouseX=c;this.cacheMouseY=b}else{switch(a.deltaMode){case 0:c=cc.PIXELS;break;case 1:c=cc.LINES;break;case 2:c=cc.PAGES;break;default:c=cc.UNKNOWN}this.parent.onMouseWheel.dispatch(a.deltaX,-a.deltaY,c);this.parent.onMouseWheel.canceled&&a.cancelable&&a.preventDefault()}},handleResizeEvent:function(a){this.primaryTouch=null;this.updateSize()},handleTouchEvent:function(a){a.cancelable&&
a.preventDefault();var b=null;null!=this.parent.element&&(b=null!=this.canvas?this.canvas.getBoundingClientRect():null!=this.div?this.div.getBoundingClientRect():this.parent.element.getBoundingClientRect());var c=this.setWidth,e=this.setHeight;if(0==c||0==e)null!=b?(c=b.width,e=b.height):e=c=1;for(var f,g,d,l,h,m=0,n=a.changedTouches;m<n.length;){var t=n[m];++m;null!=b?(g=c/b.width*(t.clientX-b.left),d=e/b.height*(t.clientY-b.top)):(g=t.clientX,d=t.clientY);if("touchstart"==a.type)f=this.unusedTouchesPool.pop(),
null==f?f=new Ib(g/c,d/e,t.identifier,0,0,t.force,this.parent.id):(f.x=g/c,f.y=d/e,f.id=t.identifier,f.dx=0,f.dy=0,f.pressure=t.force,f.device=this.parent.id),this.currentTouches.h[t.identifier]=f,Ib.onStart.dispatch(f),null==this.primaryTouch&&(this.primaryTouch=f),f==this.primaryTouch&&this.parent.onMouseDown.dispatch(g,d,0);else if(f=this.currentTouches.h[t.identifier],null!=f)switch(l=f.x,h=f.y,f.x=g/c,f.y=d/e,f.dx=f.x-l,f.dy=f.y-h,f.pressure=t.force,a.type){case "touchcancel":Ib.onCancel.dispatch(f);
this.currentTouches.remove(t.identifier);this.unusedTouchesPool.add(f);f==this.primaryTouch&&(this.primaryTouch=null);break;case "touchend":Ib.onEnd.dispatch(f);this.currentTouches.remove(t.identifier);this.unusedTouchesPool.add(f);f==this.primaryTouch&&(this.parent.onMouseUp.dispatch(g,d,0),this.primaryTouch=null);break;case "touchmove":Ib.onMove.dispatch(f),f==this.primaryTouch&&this.parent.onMouseMove.dispatch(g,d)}}},updateSize:function(){if(this.parent.__resizable){if(null!=this.parent.element){var a=
this.parent.element.clientWidth;var b=this.parent.element.clientHeight}else a=window.innerWidth,b=window.innerHeight;if(a!=this.cacheElementWidth||b!=this.cacheElementHeight){this.cacheElementWidth=a;this.cacheElementHeight=b;var c=this.resizeElement||0==this.setWidth&&0==this.setHeight;if(null!=this.parent.element&&(null==this.div||null!=this.div&&c))if(c){if(this.parent.__width!=a||this.parent.__height!=b)this.parent.__width=a,this.parent.__height=b,null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.width=Math.round(a*this.scale),this.canvas.height=Math.round(b*this.scale),this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"):(this.div.style.width=a+"px",this.div.style.height=b+"px"),this.parent.onResize.dispatch(a,b)}else{c=0!=this.setWidth?a/this.setWidth:1;var e=0!=this.setHeight?b/this.setHeight:1,f=a,g=b,d=0,l=0;c<e?(g=Math.floor(this.setHeight*c),l=Math.floor((b-g)/2)):(f=Math.floor(this.setWidth*e),d=Math.floor((a-f)/2));null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.style.width=f+"px",this.canvas.style.height=g+"px",this.canvas.style.marginLeft=d+"px",this.canvas.style.marginTop=l+"px"):(this.div.style.width=f+"px",this.div.style.height=g+"px",this.div.style.marginLeft=d+"px",this.div.style.marginTop=l+"px")}}}},__class__:kd};var vb=function(){};h["lime._internal.format.Base64"]=vb;vb.__name__=!0;vb.encode=function(a){var b=[],c=vb.DICTIONARY,e=vb.EXTENDED_DICTIONARY,f=a.length,g=Math.floor(f/3),d=2*g;b.length=2*Math.ceil(f/3);for(var l=0,h=0,m;h<
d;)m=a.b[l]<<16|a.b[l+1]<<8|a.b[l+2],b[h]=e[m>>12&4095],b[h+1]=e[m&4095],l+=3,h+=2;switch(f-3*g){case 1:m=a.b[l]<<16;b[h]=e[m>>12&4095];b[h+1]="==";break;case 2:m=a.b[l]<<16|a.b[l+1]<<8,b[h]=e[m>>12&4095],b[h+1]=c[m>>6&63]+"="}return b.join("")};var Ge=function(){};h["lime._internal.format.Deflate"]=Ge;Ge.__name__=!0;Ge.decompress=function(a){a=pako.inflateRaw(a.b.bufferValue);return Ga.ofData(a)};var He=function(){};h["lime._internal.format.GZip"]=He;He.__name__=!0;He.decompress=function(a){a=pako.ungzip(a.b.bufferValue);
return Ga.ofData(a)};var Ie=function(){};h["lime._internal.format.LZMA"]=Ie;Ie.__name__=!0;Ie.decompress=function(a){return null};var Je=function(){};h["lime._internal.format.Zlib"]=Je;Je.__name__=!0;Je.decompress=function(a){a=pako.inflate(a.b.bufferValue);return Ga.ofData(a)};var fb=function(){};h["lime._internal.graphics.ImageCanvasUtil"]=fb;fb.__name__=!0;fb.convertToCanvas=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage?(null==c.__srcCanvas&&(fb.createCanvas(a,c.__srcImage.width,
c.__srcImage.height),c.__srcContext.drawImage(c.__srcImage,0,0)),c.__srcImage=null):null==c.__srcCanvas&&null!=c.data?(a.set_transparent(!0),fb.createCanvas(a,c.width,c.height),fb.createImageData(a),c.__srcContext.putImageData(c.__srcImageData,0,0)):a.type==Yb.DATA&&null!=c.__srcImageData&&a.dirty&&(c.__srcContext.putImageData(c.__srcImageData,0,0),a.dirty=!1);b?(c.data=null,c.__srcImageData=null):null==c.data&&null!=c.__srcImageData&&(c.data=c.__srcImageData.data);a.type=Yb.CANVAS};fb.convertToData=
function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage&&fb.convertToCanvas(a);if(null!=c.__srcCanvas&&null==c.data)fb.createImageData(a),a.type==Yb.CANVAS&&(a.dirty=!1);else if(a.type==Yb.CANVAS&&null!=c.__srcCanvas&&a.dirty){if(null==c.__srcImageData)fb.createImageData(a);else{c.__srcImageData=c.__srcContext.getImageData(0,0,c.width,c.height);var e=c.__srcImageData.data.buffer;e=null!=e?new Uint8Array(e):null;c.data=e}a.dirty=!1}b&&(a.buffer.__srcCanvas=null,a.buffer.__srcContext=null);
a.type=Yb.DATA};fb.createCanvas=function(a,b,c){var e=a.buffer;null==e.__srcCanvas&&(e.__srcCanvas=window.document.createElement("canvas"),e.__srcCanvas.width=b,e.__srcCanvas.height=c,a.get_transparent()?e.__srcContext=e.__srcCanvas.getContext("2d"):(a.get_transparent()||e.__srcCanvas.setAttribute("moz-opaque","true"),e.__srcContext=e.__srcCanvas.getContext("2d",{alpha:!1})))};fb.createImageData=function(a){a=a.buffer;if(null==a.__srcImageData){null==a.data?a.__srcImageData=a.__srcContext.getImageData(0,
0,a.width,a.height):(a.__srcImageData=a.__srcContext.createImageData(a.width,a.height),a.__srcImageData.data.set(a.data));var b=a.__srcImageData.data.buffer;b=null!=b?new Uint8Array(b):null;a.data=b}};fb.fillRect=function(a,b,c,e){fb.convertToCanvas(a);if(1==e){e=c>>16&255;var f=c>>8&255;var g=c&255;c=a.get_transparent()?c>>24&255:255}else e=c>>24&255,f=c>>16&255,g=c>>8&255,c=a.get_transparent()?c&255:255;0==b.x&&0==b.y&&b.width==a.width&&b.height==a.height&&a.get_transparent()&&0==c?a.buffer.__srcCanvas.width=
a.buffer.width:(255>c&&a.buffer.__srcContext.clearRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY),0<c&&(a.buffer.__srcContext.fillStyle="rgba("+e+", "+f+", "+g+", "+c/255+")",a.buffer.__srcContext.fillRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY)),a.dirty=!0,a.version++)};var Ke=function(){};h["lime._internal.graphics.ImageDataUtil"]=Ke;Ke.__name__=!0;Ke.fillRect=function(a,b,c,e){switch(e){case 1:c=(c>>>16&255)<<24|(c>>>8&255)<<16|(c&255)<<8|c>>>24&
255;break;case 2:c=(c>>>8&255)<<24|(c>>>16&255)<<16|(c>>>24&255)<<8|c&255}a.get_transparent()||(c=(c>>>24&255)<<24|(c>>>16&255)<<16|(c>>>8&255)<<8|255);var f=a.buffer.data;if(null!=f){e=a.buffer.format;var g=a.buffer.premultiplied;g&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Hb.a16=Hb.__alpha16[c&255],c=((c>>>24&255)*Hb.a16>>16&255)<<24|((c>>>16&255)*Hb.a16>>16&255)<<16|((c>>>8&255)*Hb.a16>>16&255)<<8|c&255));b=new he(a,b);for(var d,l=0,h=b.height;l<h;){g=l++;d=b.byteOffset+b.stride*g;for(var m=0,n=
b.width;m<n;){g=m++;var t=d+4*g,x=e;g=!1;null==g&&(g=!1);null==x&&(x=0);g&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Hb.a16=Hb.__alpha16[c&255],c=((c>>>24&255)*Hb.a16>>16&255)<<24|((c>>>16&255)*Hb.a16>>16&255)<<16|((c>>>8&255)*Hb.a16>>16&255)<<8|c&255));switch(x){case 0:f[t]=c>>>24&255;f[t+1]=c>>>16&255;f[t+2]=c>>>8&255;f[t+3]=c&255;break;case 1:f[t]=c&255;f[t+1]=c>>>24&255;f[t+2]=c>>>16&255;f[t+3]=c>>>8&255;break;case 2:f[t]=c>>>8&255,f[t+1]=c>>>16&255,f[t+2]=c>>>24&255,f[t+3]=c&255}}}a.dirty=!0;a.version++}};
var he=function(a,b){this.image=a;null==b?this.rect=a.get_rect():(0>b.x&&(b.x=0),0>b.y&&(b.y=0),b.x+b.width>a.width&&(b.width=a.width-b.x),b.y+b.height>a.height&&(b.height=a.height-b.y),0>b.width&&(b.width=0),0>b.height&&(b.height=0),this.rect=b);this.stride=a.buffer.get_stride();this.__update()};h["lime._internal.graphics._ImageDataUtil.ImageDataView"]=he;he.__name__=!0;he.prototype={__update:function(){this.x=Math.ceil(this.rect.x);this.y=Math.ceil(this.rect.y);this.width=Math.floor(this.rect.width);
this.height=Math.floor(this.rect.height);this.byteOffset=this.stride*(this.y+this.image.offsetY)+4*(this.x+this.image.offsetX)},__class__:he};var Ha=function(a,b){null==b&&(b=!1);if(null!=a)if(b)b=new Gb,b.future=this,mb.queue({promise:b,work:a});else try{this.value=a(),this.isComplete=!0}catch(c){ja.lastError=c,this.error=A.caught(c).unwrap(),this.isError=!0}};h["lime.app.Future"]=Ha;Ha.__name__=!0;Ha.withValue=function(a){var b=new Ha;b.isComplete=!0;b.value=a;return b};Ha.prototype={onComplete:function(a){null!=
a&&(this.isComplete?a(this.value):this.isError||(null==this.__completeListeners&&(this.__completeListeners=[]),this.__completeListeners.push(a)));return this},onError:function(a){null!=a&&(this.isError?a(this.error):this.isComplete||(null==this.__errorListeners&&(this.__errorListeners=[]),this.__errorListeners.push(a)));return this},onProgress:function(a){null!=a&&(null==this.__progressListeners&&(this.__progressListeners=[]),this.__progressListeners.push(a));return this},then:function(a){if(this.isComplete)return a(this.value);
if(this.isError){var b=new Ha;b.isError=!0;b.error=this.error;return b}var c=new Gb;this.onError(d(c,c.error));this.onProgress(d(c,c.progress));this.onComplete(function(b){b=a(b);b.onError(d(c,c.error));b.onComplete(d(c,c.complete))});return c.future},__class__:Ha};var mb=function(){};h["lime.app._Future.FutureWork"]=mb;mb.__name__=!0;mb.queue=function(a){null==mb.threadPool&&(mb.threadPool=new ie,mb.threadPool.doWork.add(mb.threadPool_doWork),mb.threadPool.onComplete.add(mb.threadPool_onComplete),
mb.threadPool.onError.add(mb.threadPool_onError));mb.threadPool.queue(a)};mb.threadPool_doWork=function(a){try{var b=a.work();mb.threadPool.sendComplete({promise:a.promise,result:b})}catch(c){ja.lastError=c,b=A.caught(c).unwrap(),mb.threadPool.sendError({promise:a.promise,error:b})}};mb.threadPool_onComplete=function(a){a.promise.complete(a.result)};mb.threadPool_onError=function(a){a.promise.error(a.error)};var Gb=function(){this.future=new Ha};h["lime.app.Promise"]=Gb;Gb.__name__=!0;Gb.prototype=
{complete:function(a){if(!this.future.isError&&(this.future.isComplete=!0,this.future.value=a,null!=this.future.__completeListeners)){for(var b=0,c=this.future.__completeListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__completeListeners=null}return this},completeWith:function(a){a.onComplete(d(this,this.complete));a.onError(d(this,this.error));a.onProgress(d(this,this.progress));return this},error:function(a){if(!this.future.isComplete&&(this.future.isError=!0,this.future.error=a,null!=this.future.__errorListeners)){for(var b=
0,c=this.future.__errorListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__errorListeners=null}return this},progress:function(a,b){if(!this.future.isError&&!this.future.isComplete&&null!=this.future.__progressListeners)for(var c=0,e=this.future.__progressListeners;c<e.length;){var f=e[c];++c;f(a,b)}return this},__class__:Gb};var Qc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Dynamic_Void"]=Qc;Qc.__name__=!0;Qc.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Qc};var je=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Float_Float_Float_Void"]=je;je.__name__=!0;je.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,
b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:je};var ke=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Float_Float_Int_Void"]=ke;ke.__name__=!0;ke.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,
0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:ke};var md=function(){this.canceled=
!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Float_Float_Void"]=md;md.__name__=!0;md.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:md};var le=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Float_Float_lime_ui_MouseButton_Void"]=le;le.__name__=!0;le.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=
0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,
f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:le};var me=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Float_Float_lime_ui_MouseWheelMode_Void"]=me;me.__name__=!0;me.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:me};var ne=function(){this.canceled=!1;this.__listeners=
[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Int_Float_Float_Void"]=ne;ne.__name__=!0;ne.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:ne};var oe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};h["lime.app._Event_Int_Float_Void"]=oe;oe.__name__=!0;oe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:oe};var nd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Int_Int_Void"]=nd;nd.__name__=!0;nd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>
this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?
++f:this.remove(c[f]),!this.canceled););},__class__:nd};var jc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Int_Void"]=jc;jc.__name__=!0;jc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},
remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:jc};var pe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Int_lime_ui_JoystickHatPosition_Void"]=
pe;pe.__name__=!0;pe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:pe};var qe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_String_Int_Int_Void"]=qe;qe.__name__=
!0;qe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:qe};var Zc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_String_Void"]=Zc;Zc.__name__=!0;Zc.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Zc};var Qa=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_Void_Void"]=Qa;Qa.__name__=!0;Qa.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(){this.canceled=!1;for(var a=this.__listeners,b=this.__repeat,c=0;c<a.length&&(a[c](),b[c]?++c:this.remove(a[c]),!this.canceled););},__class__:Qa};var Uc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};h["lime.app._Event_lime_graphics_RenderContext_Void"]=Uc;Uc.__name__=!0;Uc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Uc};var re=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_lime_ui_GamepadAxis_Float_Void"]=re;re.__name__=!0;re.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=
this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=
this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:re};var od=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_lime_ui_GamepadButton_Void"]=od;od.__name__=!0;od.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);
return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:od};var se=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};h["lime.app._Event_lime_ui_Gamepad_Void"]=se;se.__name__=!0;se.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:se};var te=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_lime_ui_Joystick_Void"]=te;te.__name__=!0;te.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<
f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:te};var pd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_lime_ui_KeyCode_lime_ui_KeyModifier_Void"]=pd;pd.__name__=!0;pd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:pd};var Kc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};h["lime.app._Event_lime_ui_Touch_Void"]=Kc;Kc.__name__=!0;Kc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Kc};var Rd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};h["lime.app._Event_lime_ui_Window_Void"]=Rd;Rd.__name__=!0;Rd.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)B.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Rd};var Ba=function(a,b,c,e,f,g,d){null==f&&(f=-1);null==e&&(e=-1);null==c&&(c=0);null==b&&(b=0);this.offsetX=b;this.offsetY=c;this.width=e;this.height=f;this.version=0;null==d&&(d=Yb.CANVAS);this.type=d;if(null==a){if(0<e&&0<f)switch(this.type._hx_index){case 0:this.buffer=new Jc(null,
e,f);fb.createCanvas(this,e,f);null!=g&&0!=g&&this.fillRect(new $c(0,0,e,f),g);break;case 1:a=e*f*4,a=null!=a?new Uint8Array(a):null,this.buffer=new Jc(a,e,f),null!=g&&0!=g&&this.fillRect(new $c(0,0,e,f),g)}}else this.__fromImageBuffer(a)};h["lime.graphics.Image"]=Ba;Ba.__name__=!0;Ba.fromFile=function(a){if(null==a)return null;var b=new Ba;return b.__fromFile(a)?b:null};Ba.loadFromBytes=function(a){if(null==a)return Ha.withValue(null);if(Ba.__isPNG(a))var b="image/png";else if(Ba.__isJPG(a))b="image/jpeg";
else if(Ba.__isGIF(a))b="image/gif";else if(Ba.__isWebP(a))b="image/webp";else return Ha.withValue(null);return R.loadImageFromBytes(a,b)};Ba.loadFromFile=function(a){return null==a?Ha.withValue(null):R.loadImage(a)};Ba.__isGIF=function(a){if(null==a||6>a.length)return!1;a=a.getString(0,6);return"GIF87a"!=a?"GIF89a"==a:!0};Ba.__isJPG=function(a){return null==a||4>a.length?!1:255==a.b[0]&&216==a.b[1]&&255==a.b[a.length-2]?217==a.b[a.length-1]:!1};Ba.__isPNG=function(a){return null==a||8>a.length?!1:
137==a.b[0]&&80==a.b[1]&&78==a.b[2]&&71==a.b[3]&&13==a.b[4]&&10==a.b[5]&&26==a.b[6]?10==a.b[7]:!1};Ba.__isWebP=function(a){return null==a||16>a.length?!1:"RIFF"==a.getString(0,4)?"WEBP"==a.getString(8,4):!1};Ba.prototype={fillRect:function(a,b,c){a=this.__clipRect(a);if(null!=this.buffer&&null!=a)switch(this.type._hx_index){case 0:fb.fillRect(this,a,b,c);break;case 1:fb.convertToData(this);if(0==this.buffer.data.length)break;Ke.fillRect(this,a,b,c);break;case 2:a.offset(this.offsetX,this.offsetY);
if(null==c)b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255;else switch(c){case 1:break;case 2:b=(b&255)<<24|(b>>>8&255)<<16|(b>>>16&255)<<8|b>>>24&255;break;default:b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255}this.buffer.__srcBitmapData.fillRect(a.__toFlashRectangle(),b)}},__clipRect:function(a){return null==a||0>a.x&&(a.width-=-a.x,a.x=0,0>=a.x+a.width)||0>a.y&&(a.height-=-a.y,a.y=0,0>=a.y+a.height)||a.x+a.width>=this.width&&(a.width-=a.x+a.width-this.width,0>=a.width)||a.y+
a.height>=this.height&&(a.height-=a.y+a.height-this.height,0>=a.height)?null:a},__fromBase64:function(a,b,c){var e=this,f=new Image;f.addEventListener("load",function(a){e.buffer=new Jc(null,f.width,f.height);e.buffer.__srcImage=f;e.offsetX=0;e.offsetY=0;e.width=e.buffer.width;e.height=e.buffer.height;null!=c&&c(e)},!1);f.src="data:"+b+";base64,"+a},__fromBytes:function(a,b){if(Ba.__isPNG(a))var c="image/png";else if(Ba.__isJPG(a))c="image/jpeg";else if(Ba.__isGIF(a))c="image/gif";else return!1;this.__fromBase64(vb.encode(a),
c,b);return!0},__fromFile:function(a,b,c){var e=this,f=new Image;R.__isSameOrigin(a)||(f.crossOrigin="Anonymous");f.onload=function(a){e.buffer=new Jc(null,f.width,f.height);e.buffer.__srcImage=f;e.width=f.width;e.height=f.height;null!=b&&b(e)};f.onerror=function(a){null!=c&&c()};f.src=a;return!0},__fromImageBuffer:function(a){this.buffer=a;null!=a&&(-1==this.width&&(this.width=a.width),-1==this.height&&(this.height=a.height))},get_data:function(){null==this.buffer.data&&0<this.buffer.width&&0<this.buffer.height&&
fb.convertToData(this);return this.buffer.data},get_rect:function(){return new $c(0,0,this.width,this.height)},get_transparent:function(){return null==this.buffer?!1:this.buffer.transparent},set_transparent:function(a){return null==this.buffer?!1:this.buffer.transparent=a},__class__:Ba,__properties__:{set_transparent:"set_transparent",get_transparent:"get_transparent",get_rect:"get_rect",get_data:"get_data"}};var Jc=function(a,b,c,e,f){null==e&&(e=32);null==c&&(c=0);null==b&&(b=0);this.data=a;this.width=
b;this.height=c;this.bitsPerPixel=e;this.format=null==f?0:f;this.premultiplied=!1;this.transparent=!0};h["lime.graphics.ImageBuffer"]=Jc;Jc.__name__=!0;Jc.prototype={get_stride:function(){return this.width*(this.bitsPerPixel/8|0)},__class__:Jc,__properties__:{get_stride:"get_stride"}};var Yb=y["lime.graphics.ImageType"]={__ename__:!0,__constructs__:null,CANVAS:{_hx_name:"CANVAS",_hx_index:0,__enum__:"lime.graphics.ImageType",toString:p},DATA:{_hx_name:"DATA",_hx_index:1,__enum__:"lime.graphics.ImageType",
toString:p},FLASH:{_hx_name:"FLASH",_hx_index:2,__enum__:"lime.graphics.ImageType",toString:p},CUSTOM:{_hx_name:"CUSTOM",_hx_index:3,__enum__:"lime.graphics.ImageType",toString:p}};Yb.__constructs__=[Yb.CANVAS,Yb.DATA,Yb.FLASH,Yb.CUSTOM];var ge=function(){};h["lime.graphics.RenderContext"]=ge;ge.__name__=!0;ge.prototype={__class__:ge};var Ze={fromWebGL2RenderContext:function(a){return a}},ld=function(){};h["lime.graphics.opengl.GL"]=ld;ld.__name__=!0;var Hb={},$c=function(a,b,c,e){null==e&&(e=0);
null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.width=c;this.height=e};h["lime.math.Rectangle"]=$c;$c.__name__=!0;$c.prototype={offset:function(a,b){this.x+=a;this.y+=b},__toFlashRectangle:function(){return null},__class__:$c};var Ya=function(){};h["lime.media.AudioBuffer"]=Ya;Ya.__name__=!0;Ya.fromBytes=function(a){if(null==a)return null;var b=new Ya;b.set_src(new Howl({src:["data:"+Ya.__getCodec(a)+";base64,"+vb.encode(a)],html5:!0,preload:!1}));return b};Ya.fromFile=function(a){if(null==
a)return null;var b=new Ya;b.__srcHowl=new Howl({src:[a],preload:!1});return b};Ya.fromFiles=function(a){var b=new Ya;b.__srcHowl=new Howl({src:a,preload:!1});return b};Ya.loadFromFile=function(a){var b=new Gb,c=Ya.fromFile(a);null!=c?null!=c&&(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(a,c){b.error(c)}),c.__srcHowl.load()):b.error(null);return b.future};Ya.loadFromFiles=function(a){var b=new Gb,c=Ya.fromFiles(a);null!=c?(c.__srcHowl.on("load",function(){b.complete(c)}),
c.__srcHowl.on("loaderror",function(){b.error(null)}),c.__srcHowl.load()):b.error(null);return b.future};Ya.__getCodec=function(a){switch(a.getString(0,4)){case "OggS":return"audio/ogg";case "RIFF":if("WAVE"==a.getString(8,4))return"audio/wav";var b=a.b[1],c=a.b[2];switch(a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}break;case "fLaC":return"audio/flac";default:switch(b=a.b[1],c=a.b[2],a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";
break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}}sa.error("Unsupported sound format",{fileName:"lime/media/AudioBuffer.hx",lineNumber:362,className:"lime.media.AudioBuffer",methodName:"__getCodec"});return null};Ya.prototype={set_src:function(a){return this.__srcHowl=a},__class__:Ya,__properties__:{set_src:"set_src"}};var ve=function(a){if("custom"!=a){if(null==a||"web"==a)try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.web=new window.AudioContext,
this.type="web"}catch(b){ja.lastError=b}null==this.web&&"web"!=a&&(this.html5=new ue,this.type="html5")}else this.type="custom"};h["lime.media.AudioContext"]=ve;ve.__name__=!0;ve.prototype={__class__:ve};var ec=function(){};h["lime.media.AudioManager"]=ec;ec.__name__=!0;ec.init=function(a){if(null==ec.context){if(null==a&&(ec.context=new ve,a=ec.context,"openal"==a.type)){var b=a.openal,c=b.openDevice();c=b.createContext(c);b.makeContextCurrent(c);b.processContext(c)}ec.context=a}};var ue=function(){};
h["lime.media.HTML5AudioContext"]=ue;ue.__name__=!0;ue.prototype={__class__:ue};var Le=function(){};h["lime.media.OpenALAudioContext"]=Le;Le.__name__=!0;Le.prototype={createContext:function(a,b){return dc.createContext(a,b)},makeContextCurrent:function(a){return dc.makeContextCurrent(a)},openDevice:function(a){return dc.openDevice(a)},processContext:function(a){dc.processContext(a)},__class__:Le};var dc=function(){};h["lime.media.openal.ALC"]=dc;dc.__name__=!0;dc.createContext=function(a,b){return null};
dc.makeContextCurrent=function(a){return!1};dc.openDevice=function(a){return null};dc.processContext=function(a){};var Fd=function(){};h["lime.net._IHTTPRequest"]=Fd;Fd.__name__=!0;Fd.__isInterface__=!0;Fd.prototype={__class__:Fd};var kc=function(a){this.uri=a;this.contentType="application/x-www-form-urlencoded";this.followRedirects=!0;this.enableResponseHeaders=!1;this.formData=new ha;this.headers=[];this.method="GET";this.timeout=3E4;this.withCredentials=!1;this.__backend=new R;this.__backend.init(this)};
h["lime.net._HTTPRequest.AbstractHTTPRequest"]=kc;kc.__name__=!0;kc.__interfaces__=[Fd];kc.prototype={__class__:kc};var qd=function(a){kc.call(this,a)};h["lime.net._HTTPRequest_Bytes"]=qd;qd.__name__=!0;qd.__super__=kc;qd.prototype=H(kc.prototype,{fromBytes:function(a){return a},load:function(a){var b=this;null!=a&&(this.uri=a);var c=new Gb;a=this.__backend.loadData(this.uri);a.onProgress(d(c,c.progress));a.onError(d(c,c.error));a.onComplete(function(a){b.responseData=b.fromBytes(a);c.complete(b.responseData)});
return c.future},__class__:qd});var rd=function(a){kc.call(this,a)};h["lime.net._HTTPRequest_String"]=rd;rd.__name__=!0;rd.__super__=kc;rd.prototype=H(kc.prototype,{load:function(a){var b=this;null!=a&&(this.uri=a);var c=new Gb;a=this.__backend.loadText(this.uri);a.onProgress(d(c,c.progress));a.onError(d(c,c.error));a.onComplete(function(a){b.responseData=a;c.complete(b.responseData)});return c.future},__class__:rd});var fe=function(a,b){null==b&&(b="");this.name=a;this.value=b};h["lime.net.HTTPRequestHeader"]=
fe;fe.__name__=!0;fe.prototype={__class__:fe};var Rc=function(a){kc.call(this,a)};h["lime.net._HTTPRequest_lime_utils_Bytes"]=Rc;Rc.__name__=!0;Rc.__super__=qd;Rc.prototype=H(qd.prototype,{fromBytes:function(a){return hc.fromBytes(a)},__class__:Rc});var Cb=function(a,b){this.onUpdate=new je;this.type=a;this.id=b};h["lime.system.Sensor"]=Cb;Cb.__name__=!0;Cb.registerSensor=function(a,b){a=new Cb(a,b);Cb.sensors.push(a);return Cb.sensorByID.h[b]=a};Cb.prototype={__class__:Cb};var Oe=y["lime.system.SensorType"]=
{__ename__:!0,__constructs__:null,ACCELEROMETER:{_hx_name:"ACCELEROMETER",_hx_index:0,__enum__:"lime.system.SensorType",toString:p}};Oe.__constructs__=[Oe.ACCELEROMETER];var wb=function(){};h["lime.system.System"]=wb;wb.__name__=!0;wb.embed=k.lime.embed=function(a,b,c,e,f){if(null!=wb.__applicationEntryPoint&&Object.prototype.hasOwnProperty.call(wb.__applicationEntryPoint.h,a)){var g="string"==typeof b?window.document.getElementById(b):null==b?window.document.createElement("div"):b;null==g?window.console.log("[lime.embed] ERROR: Cannot find target element: "+
J.string(b)):(null==c&&(c=0),null==e&&(e=0),null==f&&(f={}),Object.prototype.hasOwnProperty.call(f,"background")&&"string"==typeof f.background&&(b=U.replace(J.string(f.background),"#",""),-1<b.indexOf("0x")?f.background=J.parseInt(b):f.background=J.parseInt("0x"+b)),f.element=g,f.width=c,f.height=e,wb.__applicationEntryPoint.h[a](f))}};wb.exit=function(a){};wb.__registerEntryPoint=function(a,b){null==wb.__applicationEntryPoint&&(wb.__applicationEntryPoint=new ha);wb.__applicationEntryPoint.h[a]=
b};var ie=function(a,b){null==b&&(b=1);null==a&&(a=0);this.onRun=new Qc;this.onError=new Qc;this.onComplete=new Qc;this.doWork=new Qc;this.minThreads=a;this.maxThreads=b;this.currentThreads=0};h["lime.system.ThreadPool"]=ie;ie.__name__=!0;ie.prototype={queue:function(a){this.runWork(a)},sendComplete:function(a){this.onComplete.dispatch(a)},sendError:function(a){this.onError.dispatch(a)},runWork:function(a){this.onRun.dispatch(a);this.doWork.dispatch(a)},__class__:ie};var Ob=function(a){null!=a&&(this.name=
a);this.__init||(void 0==this.ascender&&(this.ascender=0),void 0==this.descender&&(this.descender=0),void 0==this.height&&(this.height=0),void 0==this.numGlyphs&&(this.numGlyphs=0),void 0==this.underlinePosition&&(this.underlinePosition=0),void 0==this.underlineThickness&&(this.underlineThickness=0),void 0==this.unitsPerEM&&(this.unitsPerEM=0),null!=this.__fontID?Z.isLocal(this.__fontID)&&this.__fromBytes(Z.getBytes(this.__fontID)):null!=this.__fontPath&&this.__fromFile(this.__fontPath))};h["lime.text.Font"]=
Ob;Ob.__name__=!0;Ob.fromFile=function(a){if(null==a)return null;var b=new Ob;b.__fromFile(a);return b};Ob.loadFromName=function(a){return(new Ob).__loadFromName(a)};Ob.__measureFontNode=function(a){var b=window.document.createElement("span");b.setAttribute("aria-hidden","true");var c=window.document.createTextNode("BESbswy");b.appendChild(c);c=b.style;c.display="block";c.position="absolute";c.top="-9999px";c.left="-9999px";c.fontSize="300px";c.width="auto";c.height="auto";c.lineHeight="normal";c.margin=
"0";c.padding="0";c.fontVariant="normal";c.whiteSpace="nowrap";c.fontFamily=a;window.document.body.appendChild(b);return b};Ob.prototype={__fromBytes:function(a){this.__fontPath=null},__fromFile:function(a){this.__fontPath=a},__loadFromName:function(a){var b=this,c=new Gb;this.name=a;var e=r.navigator.userAgent.toLowerCase(),f=0<=e.indexOf(" safari/")&&0>e.indexOf(" chrome/");e=(new da("(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)","i")).match(e);if(!f&&!e&&window.document.fonts&&(n=window.document.fonts,
d(n,n.load)))window.document.fonts.load("1em '"+a+"'").then(function(a){c.complete(b)},function(e){sa.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:513,className:"lime.text.Font",methodName:"__loadFromName"});c.complete(b)});else{var g=Ob.__measureFontNode("'"+a+"', sans-serif"),h=Ob.__measureFontNode("'"+a+"', serif"),l=g.offsetWidth,m=h.offsetWidth,x=-1,p=0,t,K;x=window.setInterval(function(){p+=1;t=g.offsetWidth!=l||h.offsetWidth!=m;K=3E3<=50*p;if(t||K)window.clearInterval(x),
g.parentNode.removeChild(g),h.parentNode.removeChild(h),h=g=null,K&&sa.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:548,className:"lime.text.Font",methodName:"__loadFromName"}),c.complete(b)},50)}return c.future},__class__:Ob};var cb=function(a){this.onDisconnect=new Qa;this.onButtonUp=new od;this.onButtonDown=new od;this.onAxisMove=new re;this.id=a;this.connected=!0};h["lime.ui.Gamepad"]=cb;cb.__name__=!0;cb.__connect=function(a){if(!cb.devices.h.hasOwnProperty(a)){var b=
new cb(a);cb.devices.h[a]=b;cb.onConnect.dispatch(b)}};cb.__disconnect=function(a){var b=cb.devices.h[a];null!=b&&(b.connected=!1);cb.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};cb.prototype={__class__:cb};var Pa=function(a){this.onTrackballMove=new ne;this.onHatMove=new pe;this.onDisconnect=new Qa;this.onButtonUp=new jc;this.onButtonDown=new jc;this.onAxisMove=new oe;this.id=a;this.connected=!0};h["lime.ui.Joystick"]=Pa;Pa.__name__=!0;Pa.__connect=function(a){if(!Pa.devices.h.hasOwnProperty(a)){var b=
new Pa(a);Pa.devices.h[a]=b;Pa.onConnect.dispatch(b)}};Pa.__disconnect=function(a){var b=Pa.devices.h[a];null!=b&&(b.connected=!1);Pa.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};Pa.__getDeviceData=function(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():null};Pa.prototype={__class__:Pa};var pb=y["lime.ui.MouseCursor"]={__ename__:!0,__constructs__:null,ARROW:{_hx_name:"ARROW",_hx_index:0,__enum__:"lime.ui.MouseCursor",toString:p},
CROSSHAIR:{_hx_name:"CROSSHAIR",_hx_index:1,__enum__:"lime.ui.MouseCursor",toString:p},DEFAULT:{_hx_name:"DEFAULT",_hx_index:2,__enum__:"lime.ui.MouseCursor",toString:p},MOVE:{_hx_name:"MOVE",_hx_index:3,__enum__:"lime.ui.MouseCursor",toString:p},POINTER:{_hx_name:"POINTER",_hx_index:4,__enum__:"lime.ui.MouseCursor",toString:p},RESIZE_NESW:{_hx_name:"RESIZE_NESW",_hx_index:5,__enum__:"lime.ui.MouseCursor",toString:p},RESIZE_NS:{_hx_name:"RESIZE_NS",_hx_index:6,__enum__:"lime.ui.MouseCursor",toString:p},
RESIZE_NWSE:{_hx_name:"RESIZE_NWSE",_hx_index:7,__enum__:"lime.ui.MouseCursor",toString:p},RESIZE_WE:{_hx_name:"RESIZE_WE",_hx_index:8,__enum__:"lime.ui.MouseCursor",toString:p},TEXT:{_hx_name:"TEXT",_hx_index:9,__enum__:"lime.ui.MouseCursor",toString:p},WAIT:{_hx_name:"WAIT",_hx_index:10,__enum__:"lime.ui.MouseCursor",toString:p},WAIT_ARROW:{_hx_name:"WAIT_ARROW",_hx_index:11,__enum__:"lime.ui.MouseCursor",toString:p},CUSTOM:{_hx_name:"CUSTOM",_hx_index:12,__enum__:"lime.ui.MouseCursor",toString:p}};
pb.__constructs__=[pb.ARROW,pb.CROSSHAIR,pb.DEFAULT,pb.MOVE,pb.POINTER,pb.RESIZE_NESW,pb.RESIZE_NS,pb.RESIZE_NWSE,pb.RESIZE_WE,pb.TEXT,pb.WAIT,pb.WAIT_ARROW,pb.CUSTOM];var cc=y["lime.ui.MouseWheelMode"]={__ename__:!0,__constructs__:null,PIXELS:{_hx_name:"PIXELS",_hx_index:0,__enum__:"lime.ui.MouseWheelMode",toString:p},LINES:{_hx_name:"LINES",_hx_index:1,__enum__:"lime.ui.MouseWheelMode",toString:p},PAGES:{_hx_name:"PAGES",_hx_index:2,__enum__:"lime.ui.MouseWheelMode",toString:p},UNKNOWN:{_hx_name:"UNKNOWN",
_hx_index:3,__enum__:"lime.ui.MouseWheelMode",toString:p}};cc.__constructs__=[cc.PIXELS,cc.LINES,cc.PAGES,cc.UNKNOWN];var Ib=function(a,b,c,e,f,g,d){this.x=a;this.y=b;this.id=c;this.dx=e;this.dy=f;this.pressure=g;this.device=d};h["lime.ui.Touch"]=Ib;Ib.__name__=!0;Ib.prototype={__class__:Ib};var Td=function(a,b){this.onTextInput=new Zc;this.onTextEdit=new qe;this.onRestore=new Qa;this.onResize=new nd;this.onRenderContextRestored=new Uc;this.onRenderContextLost=new Qa;this.onRender=new Uc;this.onMove=
new md;this.onMouseWheel=new me;this.onMouseUp=new ke;this.onMouseMoveRelative=new md;this.onMouseMove=new md;this.onMouseDown=new le;this.onMinimize=new Qa;this.onLeave=new Qa;this.onKeyUp=new pd;this.onKeyDown=new pd;this.onFullscreen=new Qa;this.onFocusOut=new Qa;this.onFocusIn=new Qa;this.onExpose=new Qa;this.onEnter=new Qa;this.onDropFile=new Zc;this.onDeactivate=new Qa;this.onClose=new Qa;this.onActivate=new Qa;this.application=a;this.__attributes=null!=b?b:{};Object.prototype.hasOwnProperty.call(this.__attributes,
"parameters")&&(this.parameters=this.__attributes.parameters);this.__height=this.__width=0;this.__fullscreen=!1;this.__scale=1;this.__y=this.__x=0;this.__title="";this.id=-1;this.__backend=new kd(this)};h["lime.ui.Window"]=Td;Td.__name__=!0;Td.prototype={close:function(){this.__backend.close()},__class__:Td};var Ub=function(){this.data=new ha;this.paths=[]};h["lime.utils.AssetBundle"]=Ub;Ub.__name__=!0;Ub.fromBytes=function(a){a=new jd(a);return Ub.__extractBundle(a)};Ub.loadFromBytes=function(a){return Ha.withValue(Ub.fromBytes(a))};
Ub.loadFromFile=function(a){return hc.loadFromFile(a).then(Ub.loadFromBytes)};Ub.__extractBundle=function(a){var b=Yc.readZip(a);a=new Ub;for(b=b.h;null!=b;){var c=b.item;b=b.next;if(c.compressed){var e=a.data,f=c.fileName,g=hc.decompress(c.data,Gd.DEFLATE);e.h[f]=g}else a.data.h[c.fileName]=c.data;a.paths.push(c.fileName)}return a};Ub.prototype={__class__:Ub};var we=function(){this.enabled=!0;this.audio=new ha;this.font=new ha;this.image=new ha;this.version=612855};h["lime.utils.AssetCache"]=we;
we.__name__=!0;we.prototype={exists:function(a,b){return("IMAGE"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.image.h,a)||("FONT"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.font.h,a)||("SOUND"==b||"MUSIC"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.audio.h,a)?!0:!1},set:function(a,b,c){switch(b){case "FONT":this.font.h[a]=c;break;case "IMAGE":if(!(c instanceof Ba))throw A.thrown("Cannot cache non-Image asset: "+J.string(c)+" as Image");this.image.h[a]=c;break;case "MUSIC":case "SOUND":if(!(c instanceof
Ya))throw A.thrown("Cannot cache non-AudioBuffer asset: "+J.string(c)+" as AudioBuffer");this.audio.h[a]=c;break;default:throw A.thrown(b+" assets are not cachable");}},clear:function(a){if(null==a)this.audio=new ha,this.font=new ha,this.image=new ha;else{var b=this.audio.h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var f=b[e++];if(U.startsWith(f,a)){var g=this.audio;Object.prototype.hasOwnProperty.call(g.h,f)&&delete g.h[f]}}b=this.font.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)f=b[e++],U.startsWith(f,
a)&&(g=this.font,Object.prototype.hasOwnProperty.call(g.h,f)&&delete g.h[f]);b=this.image.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)f=b[e++],U.startsWith(f,a)&&(g=this.image,Object.prototype.hasOwnProperty.call(g.h,f)&&delete g.h[f])}},__class__:we};var Wb=function(){this.types=new ha;this.sizes=new ha;this.preload=new ha;this.paths=new ha;this.pathGroups=new ha;this.classTypes=new ha;this.cachedText=new ha;this.cachedImages=new ha;this.cachedFonts=new ha;this.cachedBytes=new ha;this.cachedAudioBuffers=
new ha;this.onChange=new Qa;this.bytesTotal=this.bytesLoaded=0};h["lime.utils.AssetLibrary"]=Wb;Wb.__name__=!0;Wb.fromBundle=function(a){if(Object.prototype.hasOwnProperty.call(a.data.h,"library.json")){var b=Eb.fromBytes(a.data.h["library.json"]);if(null!=b){if(null==b.libraryType)var c=new Wb;else if(c=h[b.libraryType],null!=c)c=m.createInstance(c,b.libraryArgs);else return sa.warn("Could not find library type: "+b.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:122,className:"lime.utils.AssetLibrary",
methodName:"fromBundle"}),null;c.__fromBundle(a,b);return c}}else return c=new Wb,c.__fromBundle(a),c;return null};Wb.fromManifest=function(a){if(null==a)return null;if(null==a.libraryType)var b=new Wb;else if(b=h[a.libraryType],null!=b)b=m.createInstance(b,a.libraryArgs);else return sa.warn("Could not find library type: "+a.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:160,className:"lime.utils.AssetLibrary",methodName:"fromManifest"}),null;b.__fromManifest(a);return b};Wb.prototype=
{exists:function(a,b){b=null!=b?ra.__cast(b,String):null;a=this.types.h[a];return null==a||a!=b&&("SOUND"!=b&&"MUSIC"!=b||"MUSIC"!=a&&"SOUND"!=a)&&"BINARY"!=b&&null!=b&&("BINARY"!=a||"TEXT"!=b)?!1:!0},getAsset:function(a,b){switch(b){case "BINARY":return this.getBytes(a);case "FONT":return this.getFont(a);case "IMAGE":return this.getImage(a);case "MUSIC":case "SOUND":return this.getAudioBuffer(a);case "TEMPLATE":throw A.thrown("Not sure how to get template: "+a);case "TEXT":return this.getText(a);
default:throw A.thrown("Unknown asset type: "+b);}},getAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?this.cachedAudioBuffers.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ya.fromBytes(ra.__cast(m.createInstance(this.classTypes.h[a],[]),Ga)):Ya.fromFile(this.paths.h[a])},getBytes:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a))return this.cachedBytes.h[a];if(Object.prototype.hasOwnProperty.call(this.cachedText.h,
a)){var b=hc.ofString(this.cachedText.h[a]);return this.cachedBytes.h[a]=b}return Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?ra.__cast(m.createInstance(this.classTypes.h[a],[]),Ga):hc.fromFile(this.paths.h[a])},getFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?this.cachedFonts.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?ra.__cast(m.createInstance(this.classTypes.h[a],[]),Ob):Ob.fromFile(this.paths.h[a])},getImage:function(a){return Object.prototype.hasOwnProperty.call(this.cachedImages.h,
a)?this.cachedImages.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?ra.__cast(m.createInstance(this.classTypes.h[a],[]),Ba):Ba.fromFile(this.paths.h[a])},getText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return this.cachedText.h[a];a=this.getBytes(a);return null==a?null:a.getString(0,a.length)},isLocal:function(a,b){if(Object.prototype.hasOwnProperty.call(this.classTypes.h,a))return!0;b=null!=b?ra.__cast(b,String):null;if(null==b)return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,
a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a);switch(b){case "FONT":return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a);case "IMAGE":return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a);case "MUSIC":case "SOUND":return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a);default:return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a)}},load:function(){if(this.loaded)return Ha.withValue(this);
if(null==this.promise){this.promise=new Gb;this.bytesLoadedCache=new ha;this.assetsLoaded=0;this.assetsTotal=1;for(var a=Object.keys(this.preload.h),b=a.length,c=0;c<b;){var e=a[c++];if(this.preload.h[e]){sa.verbose("Preloading asset: "+e+" ["+this.types.h[e]+"]",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:405,className:"lime.utils.AssetLibrary",methodName:"load"});var f=this.types.h[e];if(null!=f)switch(f){case "BINARY":this.assetsTotal++;f=this.loadBytes(e);f.onProgress(function(a,b){return function(c,
e){b[0](a[0],c,e)}}([e],[d(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.load_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.loadBytes_onComplete)]));break;case "FONT":this.assetsTotal++;f=this.loadFont(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[d(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.load_onError)]));
f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.loadFont_onComplete)]));break;case "IMAGE":this.assetsTotal++;f=this.loadImage(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[d(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.load_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.loadImage_onComplete)]));break;case "MUSIC":case "SOUND":this.assetsTotal++;
f=this.loadAudioBuffer(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[d(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.loadAudioBuffer_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.loadAudioBuffer_onComplete)]));break;case "TEXT":this.assetsTotal++,f=this.loadText(e),f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[d(this,this.load_onProgress)])),f.onError(function(a,
b){return function(c){b[0](a[0],c)}}([e],[d(this,this.load_onError)])),f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[d(this,this.loadText_onComplete)]))}}}this.__assetLoaded(null)}return this.promise.future},loadAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?Ha.withValue(this.cachedAudioBuffers.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ha.withValue(m.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.pathGroups.h,
a)?Ya.loadFromFiles(this.pathGroups.h[a]):Ya.loadFromFile(this.paths.h[a])},loadBytes:function(a){return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ha.withValue(this.cachedBytes.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ha.withValue(m.createInstance(this.classTypes.h[a],[])):hc.loadFromFile(this.paths.h[a])},loadFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?Ha.withValue(this.cachedFonts.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,
a)?(a=m.createInstance(this.classTypes.h[a],[]),a.__loadFromName(a.name)):Ob.loadFromName(this.paths.h[a])},loadImage:function(a){var b=this;return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a)?Ha.withValue(this.cachedImages.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ha.withValue(m.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ba.loadFromBytes(this.cachedBytes.h[a]).then(function(c){var e=b.cachedBytes;Object.prototype.hasOwnProperty.call(e.h,
a)&&delete e.h[a];b.cachedImages.h[a]=c;return Ha.withValue(c)}):Ba.loadFromFile(this.paths.h[a])},loadText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return Ha.withValue(this.cachedText.h[a]);if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)||Object.prototype.hasOwnProperty.call(this.classTypes.h,a)){var b=this.getBytes(a);if(null==b)return Ha.withValue(null);b=b.getString(0,b.length);this.cachedText.h[a]=b;return Ha.withValue(b)}return(new rd).load(this.paths.h[a])},
unload:function(){},__assetLoaded:function(a){this.assetsLoaded++;null!=a&&sa.verbose("Loaded asset: "+a+" ["+this.types.h[a]+"] ("+(this.assetsLoaded-1)+"/"+(this.assetsTotal-1)+")",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:619,className:"lime.utils.AssetLibrary",methodName:"__assetLoaded"});if(null!=a){var b=Object.prototype.hasOwnProperty.call(this.sizes.h,a)?this.sizes.h[a]:0;if(Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)){var c=this.bytesLoadedCache.h[a];c<b&&(this.bytesLoaded+=
b-c)}else this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b}this.assetsLoaded<this.assetsTotal?this.promise.progress(this.bytesLoaded,this.bytesTotal):(this.loaded=!0,this.promise.progress(this.bytesTotal,this.bytesTotal),this.promise.complete(this))},__cacheBreak:function(a){return Z.__cacheBreak(a)},__fromBundle:function(a,b){if(null!=b){var c=0;for(b=b.assets;c<b.length;){var e=b[c];++c;var f=Object.prototype.hasOwnProperty.call(e,"id")?e.id:e.path;var g=a.data.h[e.path];if(Object.prototype.hasOwnProperty.call(e,
"type")){var d=e.type;"TEXT"==d?this.cachedText.h[f]=null!=g?J.string(g):null:this.cachedBytes.h[f]=g;this.types.h[f]=e.type}else this.cachedBytes.h[f]=g,this.types.h[f]="BINARY"}}else for(c=0,b=a.paths;c<b.length;)f=b[c],++c,this.cachedBytes.h[f]=a.data.h[f],this.types.h[f]="BINARY"},__fromManifest:function(a){var b=2<=a.version,c=a.rootPath;null==c&&(c="");""!=c&&(c+="/");for(var e=0,f=a.assets;e<f.length;){var g=f[e];++e;var d=b&&Object.prototype.hasOwnProperty.call(g,"size")?g.size:100;var l=
Object.prototype.hasOwnProperty.call(g,"id")?g.id:g.path;if(Object.prototype.hasOwnProperty.call(g,"path")){var m=this.paths;var n=this.__cacheBreak(this.__resolvePath(c+J.string(B.field(g,"path"))));m.h[l]=n}if(Object.prototype.hasOwnProperty.call(g,"pathGroup")){m=B.field(g,"pathGroup");n=0;for(var x=m.length;n<x;){var t=n++;m[t]=this.__cacheBreak(this.__resolvePath(c+m[t]))}this.pathGroups.h[l]=m}this.sizes.h[l]=d;this.types.h[l]=g.type;Object.prototype.hasOwnProperty.call(g,"preload")&&(this.preload.h[l]=
B.field(g,"preload"));Object.prototype.hasOwnProperty.call(g,"className")&&(d=B.field(g,"className"),d=h[d],this.classTypes.h[l]=d)}e=this.bytesTotal=0;for(f=a.assets;e<f.length;)g=f[e],++e,l=Object.prototype.hasOwnProperty.call(g,"id")?g.id:g.path,Object.prototype.hasOwnProperty.call(this.preload.h,l)&&this.preload.h[l]&&Object.prototype.hasOwnProperty.call(this.sizes.h,l)&&(this.bytesTotal+=this.sizes.h[l])},__resolvePath:function(a){a=U.replace(a,"\\","/");var b=a.indexOf(":");U.startsWith(a,"http")&&
0<b?(b+=3,a=z.substr(a,0,b)+U.replace(z.substr(a,b,null),"//","/")):a=U.replace(a,"//","/");if(-1<a.indexOf("./")){a=a.split("/");b=[];for(var c=0,e=a.length;c<e;){var f=c++;".."==a[f]?0==f||".."==b[f-1]?b.push(".."):b.pop():"."==a[f]?0==f&&b.push("."):b.push(a[f])}a=b.join("/")}return a},loadAudioBuffer_onComplete:function(a,b){this.cachedAudioBuffers.h[a]=b;if(Object.prototype.hasOwnProperty.call(this.pathGroups.h,a))for(var c=this.pathGroups.h[a],e=Object.keys(this.pathGroups.h),f=e.length,g=0;g<
f;){var d=e[g++];if(d!=a)for(var l=0;l<c.length;){var h=c[l];++l;if(-1<this.pathGroups.h[d].indexOf(h)){this.cachedAudioBuffers.h[d]=b;break}}}this.__assetLoaded(a)},loadAudioBuffer_onError:function(a,b){null!=b&&""!=b?sa.warn('Could not load "'+a+'": '+J.string(b),{fileName:"lime/utils/AssetLibrary.hx",lineNumber:865,className:"lime.utils.AssetLibrary",methodName:"loadAudioBuffer_onError"}):sa.warn('Could not load "'+a+'"',{fileName:"lime/utils/AssetLibrary.hx",lineNumber:869,className:"lime.utils.AssetLibrary",
methodName:"loadAudioBuffer_onError"});this.loadAudioBuffer_onComplete(a,new Ya)},loadBytes_onComplete:function(a,b){this.cachedBytes.h[a]=b;this.__assetLoaded(a)},loadFont_onComplete:function(a,b){this.cachedFonts.h[a]=b;this.__assetLoaded(a)},loadImage_onComplete:function(a,b){this.cachedImages.h[a]=b;this.__assetLoaded(a)},loadText_onComplete:function(a,b){this.cachedText.h[a]=b;this.__assetLoaded(a)},load_onError:function(a,b){null!=b&&""!=b?this.promise.error('Error loading asset "'+a+'": '+
J.string(b)):this.promise.error('Error loading asset "'+a+'"')},load_onProgress:function(a,b,c){if(0<b){var e=this.sizes.h[a];0<c?(b/=c,1<b&&(b=1),b=Math.floor(b*e)):b>e&&(b=e);Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)?(e=this.bytesLoadedCache.h[a],b!=e&&(this.bytesLoaded+=b-e)):this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b;this.promise.progress(this.bytesLoaded,this.bytesTotal)}},__class__:Wb};var Eb=function(){this.assets=[];this.libraryArgs=[];this.version=2};h["lime.utils.AssetManifest"]=
Eb;Eb.__name__=!0;Eb.fromBytes=function(a,b){return null!=a?Eb.parse(a.getString(0,a.length),b):null};Eb.loadFromFile=function(a,b){a=Eb.__resolvePath(a);b=Eb.__resolveRootPath(b,a);return null==a?null:hc.loadFromFile(a).then(function(a){return Ha.withValue(Eb.fromBytes(a,b))})};Eb.parse=function(a,b){if(null==a||""==a)return null;a=JSON.parse(a);var c=new Eb;Object.prototype.hasOwnProperty.call(a,"name")&&(c.name=a.name);Object.prototype.hasOwnProperty.call(a,"libraryType")&&(c.libraryType=a.libraryType);
Object.prototype.hasOwnProperty.call(a,"libraryArgs")&&(c.libraryArgs=a.libraryArgs);if(Object.prototype.hasOwnProperty.call(a,"assets")){var e=a.assets;Object.prototype.hasOwnProperty.call(a,"version")&&2>=a.version?c.assets=ob.run(e):c.assets=e}Object.prototype.hasOwnProperty.call(a,"rootPath")&&(c.rootPath=a.rootPath);null!=b&&""!=b&&(c.rootPath=null==c.rootPath||""==c.rootPath?b:b+"/"+c.rootPath);return c};Eb.__resolvePath=function(a){if(null==a)return null;var b=a.indexOf("?");var c=-1<b?z.substr(a,
0,b):a;for(c=U.replace(c,"\\","/");U.endsWith(c,"/");)c=z.substr(c,0,c.length-1);return U.endsWith(c,".bundle")?-1<b?c+"/library.json"+z.substr(a,b,null):c+"/library.json":a};Eb.__resolveRootPath=function(a,b){if(null!=a)return a;a=b.indexOf("?");a=-1<a?z.substr(b,0,a):b;for(a=U.replace(a,"\\","/");U.endsWith(a,"/");){if("/"==a)return a;a=z.substr(a,0,a.length-1)}return U.endsWith(a,".bundle")?a:yc.directory(a)};Eb.prototype={__class__:Eb};var Z=function(){};h["lime.utils.Assets"]=Z;Z.__name__=!0;
Z.getAsset=function(a,b,c){if(c&&Z.cache.enabled)switch(b){case "BINARY":case "TEXT":c=!1;break;case "FONT":var e=Z.cache.font.h[a];if(null!=e)return e;break;case "IMAGE":e=Z.cache.image.h[a];if(Z.isValidImage(e))return e;break;case "MUSIC":case "SOUND":e=Z.cache.audio.h[a];if(Z.isValidAudio(e))return e;break;case "TEMPLATE":throw A.thrown("Not sure how to get template: "+a);default:return null}var f=a.indexOf(":");e=a.substring(0,f);f=a.substring(f+1);var g=Z.getLibrary(e);if(null!=g)if(g.exists(f,
b)){if(g.isLocal(f,b))return e=g.getAsset(f,b),c&&Z.cache.enabled&&Z.cache.set(a,b,e),e;sa.error(b+' asset "'+a+'" exists, but only asynchronously',{fileName:"lime/utils/Assets.hx",lineNumber:133,className:"lime.utils.Assets",methodName:"getAsset"})}else sa.error("There is no "+b+' asset with an ID of "'+a+'"',{fileName:"lime/utils/Assets.hx",lineNumber:138,className:"lime.utils.Assets",methodName:"getAsset"});else sa.error(Z.__libraryNotFound(e),{fileName:"lime/utils/Assets.hx",lineNumber:143,className:"lime.utils.Assets",
methodName:"getAsset"});return null};Z.getBytes=function(a){return Z.getAsset(a,"BINARY",!1)};Z.getLibrary=function(a){if(null==a||""==a)a="default";return Z.libraries.h[a]};Z.isLocal=function(a,b,c){null==c&&(c=!0);if(c&&Z.cache.enabled&&Z.cache.exists(a,b))return!0;var e=a.indexOf(":");c=a.substring(0,e);a=a.substring(e+1);c=Z.getLibrary(c);return null!=c?c.isLocal(a,b):!1};Z.isValidAudio=function(a){return null!=a};Z.isValidImage=function(a){return null!=a?null!=a.buffer:!1};Z.loadLibrary=function(a){var b=
new Gb,c=Z.getLibrary(a);if(null!=c)return c.load();c=a;var e=null;if(Object.prototype.hasOwnProperty.call(Z.bundlePaths.h,a))Ub.loadFromFile(Z.bundlePaths.h[a]).onComplete(function(c){null==c?b.error('Cannot load bundle for library "'+a+'"'):(c=Wb.fromBundle(c),null==c?b.error('Cannot open library "'+a+'"'):(Z.libraries.h[a]=c,c.onChange.add((n=Z.onChange,d(n,n.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});else Object.prototype.hasOwnProperty.call(Z.libraryPaths.h,
a)?(c=Z.libraryPaths.h[a],e=yc.directory(c)):(U.endsWith(c,".bundle")?(e=c,c+="/library.json"):e=yc.directory(c),c=Z.__cacheBreak(c)),Eb.loadFromFile(c,e).onComplete(function(c){null==c?b.error('Cannot parse asset manifest for library "'+a+'"'):(c=Wb.fromManifest(c),null==c?b.error('Cannot open library "'+a+'"'):(Z.libraries.h[a]=c,c.onChange.add((n=Z.onChange,d(n,n.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});return b.future};
Z.registerLibrary=function(a,b){if(Object.prototype.hasOwnProperty.call(Z.libraries.h,a)){if(Z.libraries.h[a]==b)return;Z.unloadLibrary(a)}null!=b&&b.onChange.add(Z.library_onChange);Z.libraries.h[a]=b};Z.unloadLibrary=function(a){if(null==a||""==a)a="default";var b=Z.libraries.h[a];null!=b&&(Z.cache.clear(a+":"),b.onChange.remove(Z.library_onChange),b.unload());b=Z.libraries;Object.prototype.hasOwnProperty.call(b.h,a)&&delete b.h[a]};Z.__cacheBreak=function(a){0<Z.cache.version&&(a=-1<a.indexOf("?")?
a+("&"+Z.cache.version):a+("?"+Z.cache.version));return a};Z.__libraryNotFound=function(a){if(null==a||""==a)a="default";return null==D.current||null==D.current.__preloader||D.current.__preloader.complete?'There is no asset library named "'+a+'"':'There is no asset library named "'+a+'", or it is not yet preloaded'};Z.library_onChange=function(){Z.cache.clear();Z.onChange.dispatch()};var hc={_new:function(a,b){return new Ga(b)},decompress:function(a,b){switch(b._hx_index){case 0:return Ge.decompress(a);
case 1:return He.decompress(a);case 2:return Ie.decompress(a);case 3:return Je.decompress(a)}},fromBytes:function(a){return null==a?null:hc._new(a.length,a.b.bufferValue)},fromFile:function(a){return null},loadFromFile:function(a){return(new Rc).load(a)},ofString:function(a){a=Ga.ofString(a);return hc._new(a.length,a.b.bufferValue)}},Gd=y["lime.utils.CompressionAlgorithm"]={__ename__:!0,__constructs__:null,DEFLATE:{_hx_name:"DEFLATE",_hx_index:0,__enum__:"lime.utils.CompressionAlgorithm",toString:p},
GZIP:{_hx_name:"GZIP",_hx_index:1,__enum__:"lime.utils.CompressionAlgorithm",toString:p},LZMA:{_hx_name:"LZMA",_hx_index:2,__enum__:"lime.utils.CompressionAlgorithm",toString:p},ZLIB:{_hx_name:"ZLIB",_hx_index:3,__enum__:"lime.utils.CompressionAlgorithm",toString:p}};Gd.__constructs__=[Gd.DEFLATE,Gd.GZIP,Gd.LZMA,Gd.ZLIB];var sa=function(){};h["lime.utils.Log"]=sa;sa.__name__=!0;sa.error=function(a,b){if(1<=sa.level){a="["+b.className+"] ERROR: "+J.string(a);if(sa.throwErrors)throw A.thrown(a);console.error(a)}};
sa.verbose=function(a,b){5<=sa.level&&(a="["+b.className+"] "+J.string(a),console.log(a))};sa.warn=function(a,b){2<=sa.level&&console.warn("["+b.className+"] WARNING: "+J.string(a))};var Sd=function(){this.bytesTotalCache=new ha;this.bytesLoadedCache2=new ha;this.bytesLoadedCache=new Sb;this.onProgress=new nd;this.onComplete=new Qa;this.bytesTotal=this.bytesLoaded=0;this.libraries=[];this.libraryNames=[];this.onProgress.add(d(this,this.update))};h["lime.utils.Preloader"]=Sd;Sd.__name__=!0;Sd.prototype=
{addLibrary:function(a){this.libraries.push(a)},addLibraryName:function(a){-1==this.libraryNames.indexOf(a)&&this.libraryNames.push(a)},load:function(){for(var a=this,b=0,c=this.libraries;b<c.length;){var e=c[b];++b;this.bytesTotal+=e.bytesTotal}this.loadedLibraries=-1;this.preloadStarted=!1;b=0;for(c=this.libraries;b<c.length;)e=[c[b]],++b,sa.verbose("Preloading asset library",{fileName:"lime/utils/Preloader.hx",lineNumber:132,className:"lime.utils.Preloader",methodName:"load"}),e[0].load().onProgress(function(b){return function(c,
e){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+c:a.bytesLoaded+(c-a.bytesLoadedCache.h[b[0].__id__]);a.bytesLoadedCache.set(b[0],c);a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal)}}(e)).onComplete(function(b){return function(c){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+b[0].bytesTotal:a.bytesLoaded+(b[0].bytesTotal-a.bytesLoadedCache.h[b[0].__id__]);a.loadedAssetLibrary()}}(e)).onError(function(){return function(a){sa.error(a,
{fileName:"lime/utils/Preloader.hx",lineNumber:168,className:"lime.utils.Preloader",methodName:"load"})}}());b=0;for(c=this.libraryNames;b<c.length;)++b,this.bytesTotal+=200;this.loadedLibraries++;this.preloadStarted=!0;this.updateProgress()},loadedAssetLibrary:function(a){this.loadedLibraries++;var b=this.loadedLibraries;this.preloadStarted||++b;var c=this.libraries.length+this.libraryNames.length;null!=a?sa.verbose("Loaded asset library: "+a+" ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",
lineNumber:195,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"}):sa.verbose("Loaded asset library ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",lineNumber:199,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"});this.updateProgress()},start:function(){this.complete||this.simulateProgress||!this.preloadComplete||(this.complete=!0,this.onComplete.dispatch())},update:function(a,b){},updateProgress:function(){var a=this;this.simulateProgress||this.onProgress.dispatch(this.bytesLoaded,
this.bytesTotal);if(this.loadedLibraries==this.libraries.length&&!this.initLibraryNames){this.initLibraryNames=!0;for(var b=0,c=this.libraryNames;b<c.length;){var e=[c[b]];++b;sa.verbose("Preloading asset library: "+e[0],{fileName:"lime/utils/Preloader.hx",lineNumber:236,className:"lime.utils.Preloader",methodName:"updateProgress"});Z.loadLibrary(e[0]).onProgress(function(b){return function(c,e){0<e&&(Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])||(a.bytesTotalCache.h[b[0]]=e,a.bytesTotal+=
e-200),c>e&&(c=e),Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:a.bytesLoaded+=c,a.bytesLoadedCache2.h[b[0]]=c,a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal))}}(e)).onComplete(function(b){return function(c){c=200;Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])&&(c=a.bytesTotalCache.h[b[0]]);Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:
a.bytesLoaded+=c;a.loadedAssetLibrary(b[0])}}(e)).onError(function(){return function(a){sa.error(a,{fileName:"lime/utils/Preloader.hx",lineNumber:290,className:"lime.utils.Preloader",methodName:"updateProgress"})}}())}}this.simulateProgress||this.loadedLibraries!=this.libraries.length+this.libraryNames.length||(this.preloadComplete||(this.preloadComplete=!0,sa.verbose("Preload complete",{fileName:"lime/utils/Preloader.hx",lineNumber:301,className:"lime.utils.Preloader",methodName:"updateProgress"})),
this.start())},__class__:Sd};var Ud=function(a,b){this.drawNeedsUpdate=!1;this.totalTicksPassed=this.elapsedMsSinceLastTick=0;this.isUpdating=!1;this.window=a;this.config=null!=b?b:{framesPerSecond:60,drawOnlyWhenRequested:!1};this.setTickDuration(Math.floor(1E3/this.config.framesPerSecond));this.loop=new Hd;this.loop.onInit(this)};h["ob.gum.Gum"]=Ud;Ud.__name__=!0;Ud.prototype={setTickDuration:function(a){this.tickDurationMs=a},toggleUpdate:function(a){this.isUpdating=null!=a?a:!this.isUpdating},
changeLoop:function(a){this.loop=a;this.loop.onInit(this)},onUpdate:function(a){this.isUpdating&&(this.loop.onUpdate(a),this.elapsedMsSinceLastTick+=a,this.elapsedMsSinceLastTick>=this.tickDurationMs&&(this.elapsedMsSinceLastTick=0,this.totalTicksPassed++,this.drawNeedsUpdate=this.loop.onTick(a)),!this.config.drawOnlyWhenRequested||this.drawNeedsUpdate)&&(this.loop.onDraw(a),this.drawNeedsUpdate=!1)},onKeyDown:function(a,b){this.loop.onKeyDown(a,b)},onKeyUp:function(a,b){this.loop.onKeyUp(a,b)},onMouseMove:function(a,
b){this.loop.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.loop.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.loop.onMouseUp(a,b,c)},onMouseScroll:function(a,b,c){this.loop.onMouseScroll(a,b,c)},onWindowResize:function(a,b){this.loop.onWindowResize(a,b)},__class__:Ud};var sd=function(){};h["ob.gum.ILoop"]=sd;sd.__name__=!0;sd.__isInterface__=!0;sd.prototype={__class__:sd};var Hd=function(){};h["ob.gum.LoadingLoop"]=Hd;Hd.__name__=!0;Hd.__interfaces__=[sd];Hd.prototype={onTick:function(a){return!1},
onInit:function(a){this.gum=a;la.trace("LoadingLoop onInit",{fileName:"ob/gum/Core.hx",lineNumber:136,className:"ob.gum.LoadingLoop",methodName:"onInit"})},onUpdate:function(a){},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){},__class__:Hd};var Lc=function(){};h["ob.gum.backends.PeoteViewLoop"]=Lc;Lc.__name__=!0;Lc.__interfaces__=
[sd];Lc.prototype={onInit:function(a){this.gum=a;this.peoteView=new xe(a.window);var b=null==a.config.displayWidth?a.window.__width:a.config.displayWidth,c=null==a.config.displayHeight?a.window.__height:a.config.displayHeight;this.display=new ad(0,0,a.config.displayIsScaled?a.window.__width:b,a.config.displayIsScaled?a.window.__height:c,255);this.peoteView.addDisplay(this.display);this.peoteView.start()},onUpdate:function(a){},onTick:function(a){return!1},onDraw:function(a){},onKeyDown:function(a,
b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){this.peoteView.resize(a,b)},getFrameBufferDisplay:function(a,b,c,e,f){a=new ad(a,b,c,e);this.peoteView.addDisplay(a);this.peoteView.renderToTexture(a,0);this.peoteView.addFramebufferDisplay(a);c=new td(c,e);c.clearOnRenderInto=!f;a.setFramebuffer(c);this.peoteView.removeDisplay(a);return{display:a,texture:c}},__class__:Lc};
var Vd=function(a){this.imageCache=[];this.fontCache=[];this.paths=a};h["ob.gum.backends.Assets"]=Vd;Vd.__name__=!0;Vd.prototype={Preload:function(a){la.trace("begin loading "+J.string(this.paths),{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:125,className:"ob.gum.backends.Assets",methodName:"Preload"});this.onReady=a;this.loadFonts()},loadFonts:function(a){null==a&&(a=0);var b=this;if(a>this.paths.fonts.length-1)this.loadImages();else{var c=this.paths.fonts[a];la.trace("loading font index "+
a+" "+c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:137,className:"ob.gum.backends.Assets",methodName:"loadFonts"});(new ye(c)).load(function(c){b.fontCache.push(c);a+=1;b.loadFonts(a)})}},loadImages:function(){var a,b=this;la.trace("load images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:147,className:"ob.gum.backends.Assets",methodName:"loadImages"});var c=!1;if(0>=this.paths.images.length)la.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:150,
className:"ob.gum.backends.Assets",methodName:"loadImages"}),this.onReady();else{la.trace("loading "+this.paths.images.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:153,className:"ob.gum.backends.Assets",methodName:"loadImages"});var e=this.paths.images,f=c,g=function(a,c){la.trace(c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:156,className:"ob.gum.backends.Assets",methodName:"loadImages"});la.trace("starting without images",{fileName:"ob/gum/backends/PeoteView.hx",
lineNumber:157,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()},d=function(a){b.imageCache=a;la.trace("loaded "+b.imageCache.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:161,className:"ob.gum.backends.Assets",methodName:"loadImages"});la.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:162,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()};null==f&&(f=!1);var l=[],h=e.length;var m=0;for(a=e.length;m<
a;){var n=[m++];var t=[e[n[0]]];c=f;var x=null==g?null:function(a){return function(b){g(a[0],b)}}(n);n=null==d?null:function(a){return function(b){l[a[0]]=b;0==--h&&d(l)}}(n);null==c&&(c=!1);""!=Sa.corsServer&&(new da("^https?://","")).match(t[0])&&(t[0]="//"+Sa.corsServer+"/"+t[0]);var p=Ba.loadFromFile(t[0]);c&&(la.trace('Start loading image "'+t[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),p.onProgress(function(a){return function(b,c){Sa.onProgressDebug(b,
c,a[0])}}(t)),p.onError(Sa.onErrorDebug),p.onComplete(function(a){return function(b){Sa.onCompleteDebug(a[0])}}(t)));if(null!=x)p.onError(x);if(null!=n)p.onComplete(n)}}},__class__:Vd};var Yd=function(){};h["peote.text.FontConfig"]=Yd;Yd.__name__=!0;Yd.prototype={__class__:Yd};var vd=function(a){this.uniformFloats=[];this.uniformFloatsVertex=this.uniformFloatsFragment=null;this.hasFragmentInjection=this.ready=!1;this.fragmentFloatPrecision=null;this.formulaHasChanged=!1;this.formula=new ha;this.colorFormula=
"";this.used_by_ColorFormula=this.usedID_by_ColorFormula=0;this.textureID_Defaults=[];this.customTextureIdentifiers=[];this.activeUnits=[];this.activeTextures=[];this.textureLayers=new zb;this.textureListPicking=new ud(new Sb);this.textureList=new ud(new Sb);this.glShaderConfig={isPICKING:!1,isES3:!1,isINSTANCED:!1,isUBO:!1,IN:"attribute",VARIN:"varying",VAROUT:"varying",hasTEXTURES:!1,hasTEXTURE_FUNCTIONS:!1,hasFRAGMENT_INJECTION:!1,FRAGMENT_PROGRAM_UNIFORMS:"",FRAGMENT_CALC_LAYER:"",TEXTURES:[],
TEXTURE_DEFAULTS:[],isDISCARD:!0,DISCARD:"0.0",isPIXELSNAPPING:!1,PIXELDIVISOR:"1.0",VERTEX_FLOAT_PRECISION:null,VERTEX_INT_PRECISION:null,VERTEX_SAMPLER_PRECISION:null,FRAGMENT_FLOAT_PRECISION:null,FRAGMENT_INT_PRECISION:null,FRAGMENT_SAMPLER_PRECISION:null,VERTEX_INJECTION:"",FRAGMENT_INJECTION:"",SIZE_FORMULA:null,POS_FORMULA:null,ROTZ_FORMULA:null,PIVOT_FORMULA:null,FORMULA_VARYINGS:{},FORMULA_CONSTANTS:{},FRAGMENT_EXTENSIONS:[]};this.gl=this.glProgram=this.glProgramPicking=this.glVertexShader=
this.glFragmentShader=this.glVertexShaderPicking=this.glFragmentShaderPicking=null;this.displays=[];this.autoUpdateTextures=this.isVisible=!0;this.clearMask=!1;this.mask=0;this.colorEnabled=!0;this.buffer=a;this.alphaEnabled=a.hasAlpha();this.zIndexEnabled=a.hasZindex();this.colorIdentifiers=a.getColorIdentifiers();this.customIdentifiers=a.getCustomIdentifiers();this.customVaryings=a.getCustomVaryings();this.textureIdentifiers=a.getTextureIdentifiers();this.defaultColorFormula=a.getDefaultColorFormula();
this.defaultFormulaVars=a.getDefaultFormulaVars();var b=a.getFormulas().h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var f=b[e++],g=this.formula,d=a.getFormulas().h[f];g.h[f]=d}try{ic.resolveFormulaCyclic(a.getFormulas())}catch(l){throw ja.lastError=l,a=A.caught(l).unwrap(),A.thrown('Error: cyclic reference of "'+J.string(a.errVar)+'" inside @formula "'+J.string(a.formula)+'" for "'+J.string(a.errKey)+'"');}ic.resolveFormulaVars(a.getFormulas(),a.getAttributes());this.parseColorFormula()};h["peote.view.Program"]=
vd;vd.__name__=!0;vd.prototype={addToDisplay:function(a,b,c){null==c&&(c=!1);if(0>this.displays.indexOf(a)){this.displays.push(a);var e=a.gl;if(null!=e&&e!=this.gl){for(var f=0,g=this.displays;f<g.length;){var d=g[f];++f;if(null!=d.gl&&d.gl!=e)throw A.thrown("Error, program can not used inside different gl-contexts");}null!=this.gl&&(this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),
this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)));this.gl=e;W.isES3&&(this.glShaderConfig.isES3=!0,this.glShaderConfig.IN="in",this.glShaderConfig.VARIN="in",this.glShaderConfig.VAROUT="out");W.isUBO&&(this.glShaderConfig.isUBO=!0);W.isINSTANCED&&(this.glShaderConfig.isINSTANCED=!0);this.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=this.gl.getExtension("OES_standard_derivatives")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});
null!=this.gl.getExtension("EXT_color_buffer_float")?this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=this.gl.getExtension("OES_texture_float")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});this.buffer.setNewGLContext(this.gl);this.createProg();this.buffer.hasPicking()&&this.createProg(!0);f=0;for(g=this.activeTextures;f<g.length;){var l=g[f];++f;e=this.gl;if(null!=e&&e!=l.gl){d=0;for(var h=l.programs;d<h.length;){var m=h[d];
++d;if(null!=m.gl&&m.gl!=e)throw A.thrown("Error, texture can not used inside different gl-contexts");}h=0;for(m=l.displays;h<m.length;)if(d=m[h],++h,null!=d.gl&&d.gl!=e)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=l.gl&&(l.gl.deleteTexture(l.glTexture),l.glTexture=null,0==l.displays.length&&null!=l.framebuffer&&(l.gl.deleteFramebuffer(l.framebuffer),l.framebuffer=null,null!=l.glDepthBuffer&&l.gl.deleteRenderbuffer(l.glDepthBuffer),l.glDepthBuffer=null));l.gl=e;
if(l.width>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE)||l.height>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");l.glTexture=yb.createEmptyTexture(l.gl,l.width,l.height,l.colorChannels,l.createMipmaps,l.magFilter,l.minFilter,l.useFloat);if(0<l.displays.length&&null==l.framebuffer){l.glDepthBuffer=l.gl.createRenderbuffer();e=l.gl;d=l.glTexture;h=l.glDepthBuffer;m=l.width;var n=l.height,t=e.createFramebuffer();e.bindRenderbuffer(e.RENDERBUFFER,
h);Ia.clearGlErrorQueue(e);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT24,m,n);Ia.getLastGlError(e)==e.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,m,n));e.bindFramebuffer(e.FRAMEBUFFER,t);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,h);e.framebufferTexture2D(e.FRAMEBUFFER,
e.COLOR_ATTACHMENT0,e.TEXTURE_2D,d,0);if(e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");e.bindFramebuffer(e.FRAMEBUFFER,null);e.bindRenderbuffer(e.RENDERBUFFER,null);l.framebuffer=t;l.updated=!0}for(e=l.images.keys();e.hasNext();)d=e.next(),l.bufferImage(d,l.images.h[d.__id__])}}}}a.programList.add(this,b,c)},createProg:function(a){null==a&&(a=!1);this.glShaderConfig.isPICKING=a;if(null!=this.fragmentFloatPrecision)this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=
this.fragmentFloatPrecision;else if(this.buffer.needFragmentPrecision()&&23>Za.FragmentFloat.medium){var b=Za.FragmentFloat;this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.high?"highp":0<b.medium?"mediump":0<b.low?"lowp":null}else b=Za.FragmentFloat,this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.medium?"mediump":0<b.low?"lowp":null;this.parseAndResolveFormulas();var c=this.gl,e=this.gl.VERTEX_SHADER,f=this.buffer.getVertexShader(),g=this.glShaderConfig;f=new wa(f);var d=Ia.rStartspaces,l=Ia.rEmptylines;
g=f.execute(g).replace(l.r,"\n").replace(d.r,"");f=c.createShader(e);c.shaderSource(f,g);c.compileShader(f);if(0==c.getShaderParameter(f,c.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+J.string(c.getShaderInfoLog(f)));b=f;c=this.gl;e=this.gl.FRAGMENT_SHADER;f=this.buffer.getFragmentShader();g=this.glShaderConfig;f=new wa(f);d=Ia.rStartspaces;l=Ia.rEmptylines;g=f.execute(g).replace(l.r,"\n").replace(d.r,"");f=c.createShader(e);c.shaderSource(f,
g);c.compileShader(f);if(0==c.getShaderParameter(f,c.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+J.string(c.getShaderInfoLog(f)));e=f;g=this.gl.createProgram();this.gl.attachShader(g,b);this.gl.attachShader(g,e);this.buffer.bindAttribLocations(this.gl,g);c=this.gl;c.linkProgram(g);if(0==c.getProgramParameter(g,c.LINK_STATUS))throw A.thrown(J.string(c.getProgramInfoLog(g))+"VALIDATE_STATUS: "+J.string(c.getProgramParameter(g,c.VALIDATE_STATUS))+
"ERROR: "+J.string(c.getError()));!a&&W.isUBO?(c=this.gl.getUniformBlockIndex(g,"uboView"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(g,c,0),c=this.gl.getUniformBlockIndex(g,"uboDisplay"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(g,c,1)):a?(this.uRESOLUTION_PICK=this.gl.getUniformLocation(g,"uResolution"),this.uZOOM_PICK=this.gl.getUniformLocation(g,"uZoom"),this.uOFFSET_PICK=this.gl.getUniformLocation(g,"uOffset")):(this.uRESOLUTION=this.gl.getUniformLocation(g,"uResolution"),
this.uZOOM=this.gl.getUniformLocation(g,"uZoom"),this.uOFFSET=this.gl.getUniformLocation(g,"uOffset"));if(a)for(this.uTIME_PICK=this.gl.getUniformLocation(g,"uTime"),this.uniformFloatPickLocations=[],c=0,f=this.uniformFloats;c<f.length;)d=f[c],++c,this.uniformFloatPickLocations.push(this.gl.getUniformLocation(g,d.name));else for(this.uTIME=this.gl.getUniformLocation(g,"uTime"),this.uniformFloatLocations=[],c=0,f=this.uniformFloats;c<f.length;)d=f[c],++c,this.uniformFloatLocations.push(this.gl.getUniformLocation(g,
d.name));if(a){this.textureListPicking.clear();c=0;for(f=this.activeTextures.length;c<f;)a=c++,this.textureListPicking.add(new wd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(g,"uTexture"+a)),null,!1);this.glProgramPicking=g;this.glVertexShaderPicking=b;this.glFragmentShaderPicking=e}else{this.textureList.clear();c=0;for(f=this.activeTextures.length;c<f;)a=c++,this.textureList.add(new wd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(g,"uTexture"+a)),
null,!1);this.glProgram=g;this.glVertexShader=b;this.glFragmentShader=e}this.ready=!0},parseColorFormula:function(){var a="";if(""!=this.colorFormula)a=this.colorFormula;else if(""!=this.defaultColorFormula)a=this.defaultColorFormula;else{for(var b=this.colorIdentifiers.slice(),c=[],e=0,f=this.textureIdentifiers.length;e<f;){var g=e++;this.textureLayers.h.hasOwnProperty(g)&&c.push(this.textureIdentifiers[g])}e=0;for(f=this.customTextureIdentifiers.length;e<f;)g=e++,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+
g)&&c.push(this.customTextureIdentifiers[g]);if(0==b.length+c.length){var d=-16776961;c=""+J.string((d>>24&255)/255);var l=""+J.string((d>>16&255)/255),h=""+J.string((d>>8&255)/255);d=""+J.string((d&255)/255);a="vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")}else{0<c.length&&(a=c.shift(),0<b.length&&(a=""+b.shift()+
" * "+a));for(e=0;e<c.length;)l=c[e],++e,0<b.length&&(l=""+b.shift()+" * "+l+" "),a="mix( "+a+", "+l+", ("+l+").a )";for(;0<b.length;)a+=(""!=a?"*":"")+b.shift(),0<b.length&&(a="("+a+" + "+b.shift()+")")}}e=0;for(f=this.colorIdentifiers.length;e<f;)g=e++,b=new da("(^|.*?[^\\w.])"+this.colorIdentifiers[g]+"\\b.*?","g"),b.match(a)&&(a=a.replace(b.r,"$1c"+g));e=0;for(f=this.customIdentifiers.length;e<f;)if(g=e++,b=new da("(^|.*?[^\\w.])"+this.customIdentifiers[g]+"\\b.*?","g"),b.match(a))if(null!=this.customVaryings[g])a=
a.replace(b.r,"$1"+this.customVaryings[g]);else throw A.thrown("Error while parsing ColorFormula: custom identifier "+this.customIdentifiers[g]+" need @varying to access in fragmentshader");this.textureID_Defaults=[];e=this.usedID_by_ColorFormula=this.used_by_ColorFormula=0;for(f=this.textureIdentifiers.length;e<f;)g=e++,b=new da("(^|.*?[^\\w.])"+this.textureIdentifiers[g]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(g)&&(a=a.replace(b.r,"$1t"+g)),this.used_by_ColorFormula|=1<<g),
b=new da("(^|.*?[^\\w.])"+(this.textureIdentifiers[g]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+g),this.usedID_by_ColorFormula|=1<<g,this.textureLayers.h.hasOwnProperty(g)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[g]],c=""+J.string((d>>24&255)/255),l=""+J.string((d>>16&255)/255),h=""+J.string((d>>8&255)/255),d=""+J.string((d&255)/255),this.textureID_Defaults.push({layer:g,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?
l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=0;for(f=this.customTextureIdentifiers.length;e<f;)g=e++,b=new da("(^|.*?[^\\w.])"+this.customTextureIdentifiers[g]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+g)&&(a=a.replace(b.r,"$1t"+(this.textureIdentifiers.length+g))),this.used_by_ColorFormula|=1<<this.textureIdentifiers.length+g),b=new da("(^|.*?[^\\w.])"+(this.customTextureIdentifiers[g]+
"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+(this.textureIdentifiers.length+g)),this.usedID_by_ColorFormula|=1<<this.textureIdentifiers.length+g,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+g)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[this.textureIdentifiers.length+g]],c=""+J.string((d>>24&255)/255),l=""+J.string((d>>16&255)/255),h=""+J.string((d>>8&255)/255),d=""+J.string((d&255)/255),this.textureID_Defaults.push({layer:this.textureIdentifiers.length+g,value:"vec4("+
(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=Object.keys(this.defaultFormulaVars.h);f=e.length;for(g=0;g<f;)c=e[g++],b=new da("(^|.*?[^\\w.])"+c+"\\b.*?","g"),b.match(a)&&(d=this.defaultFormulaVars.h[c],c=""+J.string((d>>24&255)/255),l=""+J.string((d>>16&255)/255),h=""+J.string((d>>8&255)/255),d=""+J.string((d&255)/
255),a=a.replace(b.r,"$1vec4("+((-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")"))));this.glShaderConfig.FRAGMENT_CALC_LAYER=a},setColorFormula:function(a,b,c){null==a&&(a="");this.colorFormula=a;if(null!=b){a=Object.keys(b.h);for(var e=a.length,f=0;f<e;){var g=a[f++];if(!(new da("^([a-zA-z_]+\\d*)+$","g")).match(g))throw A.thrown('Error: "'+
g+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');this.defaultFormulaVars.h[g]=b.h[g]}}null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},injectIntoFragmentShader:function(a,b,c,e){null==b&&(b=!1);null==a&&(a="");this.hasFragmentInjection=""==a?!1:!0;this.uniformFloatsFragment=c;b=(b?"uniform float uTime;":"")+this.generateUniformFloatsGLSL(c);this.glShaderConfig.FRAGMENT_INJECTION=b+a;this.accumulateUniformsFloat();null!=e?
e&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},generateUniformFloatsGLSL:function(a){var b="";if(null!=a)for(var c=0;c<a.length;){var e=a[c];++c;b+="uniform float "+e.name+";"}return b},accumulateUniformsFloat:function(){if(null==this.uniformFloatsVertex)null!=this.uniformFloatsFragment&&(this.uniformFloats=this.uniformFloatsFragment);else if(null==this.uniformFloatsFragment)this.uniformFloats=this.uniformFloatsVertex;else{this.uniformFloats=this.uniformFloatsVertex;for(var a=
0,b=this.uniformFloatsFragment;a<b.length;){var c=b[a];++a;0>this.uniformFloats.indexOf(c)&&this.uniformFloats.push(c)}}},parseAndResolveFormulas:function(){var a=this;if(this.formulaHasChanged){for(var b=new ha,c=Object.keys(this.formula.h),e=c.length,f=0;f<e;){var g=c[f++];b.h[g]=this.formula.h[g]}var d=b;try{ic.resolveFormulaCyclic(d)}catch(l){throw ja.lastError=l,b=A.caught(l).unwrap(),A.thrown('Error: cyclic reference of "'+J.string(b.errVar)+'" inside formula "'+J.string(b.formula)+'" for "'+
J.string(b.errKey)+'"');}ic.resolveFormulaVars(d,this.buffer.getAttributes());b=function(b,c,e,f){var g=a.buffer.getFormulaNames().h[b];null==g&&(g="");var h=a.buffer.getFormulaNames().h[c];null==h&&(h="");var l=d.h[g],m=d.h[h];return l!=a.buffer.getFormulas().h[g]||m!=a.buffer.getFormulas().h[h]?(null==l&&(l=a.buffer.getAttributes().h[g]),null==l&&(l=e),null==m&&(m=a.buffer.getAttributes().h[h]),null==m&&(m=f),"rotation"==b&&"0.0"!=l&&(l="("+l+")/180.0*"+Math.PI),"zIndex"==c&&"0.0"!=m&&(b=""+J.string(a.buffer.getMaxZindex()),
m="clamp( "+m+"/"+(-1!=b.indexOf(".")||-1!=b.indexOf("e-")?b:b+".0")+", -1.0, 1.0)"),"vec2("+l+", "+m+")"):null};this.glShaderConfig.SIZE_FORMULA=b("sizeX","sizeY","100.0","100.0");this.glShaderConfig.POS_FORMULA=b("posX","posY","0.0","0.0");this.glShaderConfig.ROTZ_FORMULA=b("rotation","zIndex","0.0","0.0");this.glShaderConfig.PIVOT_FORMULA=b("pivotX","pivotY","0.0","0.0");b=0;for(c=this.buffer.getFormulaVaryings();b<c.length;)e=c[b],++b,f=d.h[e],f!=this.buffer.getFormulas().h[e]?(null==f&&(f=this.buffer.getAttributes().h[e]),
this.glShaderConfig.FORMULA_VARYINGS[e]=f,la.trace(" -- replacing Formula "+e+" => "+f,{fileName:"peote/view/Program.hx",lineNumber:591,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_VARYINGS[e]=null;b=0;for(c=this.buffer.getFormulaConstants();b<c.length;)e=c[b],++b,f=d.h[e],null!=f&&f!=this.buffer.getAttributes().h[e]?(this.glShaderConfig.FORMULA_CONSTANTS[e]=f,la.trace(" -- replacing Formula "+e+" => "+f,{fileName:"peote/view/Program.hx",lineNumber:601,
className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_CONSTANTS[e]=null}},getTextureIndexByIdentifier:function(a,b){null==b&&(b=!0);var c=this.textureIdentifiers.indexOf(a);if(0>c&&(c=this.customTextureIdentifiers.indexOf(a),0>c&&b)){if(!(new da("^([a-zA-z_]+\\d*)+$","g")).match(a))throw A.thrown('Error: "'+a+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');c=this.textureIdentifiers.length+this.customTextureIdentifiers.length;
this.customTextureIdentifiers.push(a)}return c},validatePrecision:function(a){if(null!=a)if(0>["low","medium","high"].indexOf(a.toLowerCase())){if(0>["lowp","mediump","highp"].indexOf(a.toLowerCase()))throw A.thrown("Error, no valid precision format. Use 'low', 'medium' or 'high' (or leave it null for default)");}else a+="p";return a},setFragmentFloatPrecision:function(a,b){a=this.validatePrecision(a);var c=Za.FragmentFloat;this.fragmentFloatPrecision=null==a?null:0<c.high&&"highp"==a?"highp":0<c.medium&&
("highp"==a||"mediump"==a)?"mediump":0<c.low?"lowp":null;null!=b?b&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},discardAtAlpha:function(a,b){null==a?this.glShaderConfig.isDISCARD=!1:(this.glShaderConfig.isDISCARD=!0,a=""+J.string(a),this.glShaderConfig.DISCARD=-1!=a.indexOf(".")||-1!=a.indexOf("e-")?a:a+".0");null!=b?b&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},addTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);if(null==a)throw A.thrown("Error, texture is null.");
var e=this.textureLayers.h[b];if(null!=e){if(0<=e.indexOf(a))throw A.thrown("Error, textureLayer already contains this texture.");e.push(a);this.textureLayers.h[b]=e}else this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},updateTextures:function(){for(var a=[],b=this.textureLayers.keys();b.hasNext();)for(var c=b.next(),e=0,f=this.textureLayers.h[c];e<f.length;)c=f[e],++e,0>a.indexOf(c)&&a.push(c);for(var g=this.activeTextures.length;0<g--;)if(0>
a.indexOf(this.activeTextures[g])){if(!z.remove(this.activeTextures[g].programs,this))throw A.thrown("Error, this texture is not used by program anymore");this.activeTextures.splice(g,1);this.activeUnits.splice(g,1)}for(e=0;e<a.length;)if(c=a[e],++e,0>this.activeTextures.indexOf(c)){this.activeTextures.push(c);for(f=0;0<=this.activeUnits.indexOf(f);)++f;this.activeUnits.push(f);if(0<=c.programs.indexOf(this))throw A.thrown("Error, texture is already used by program");b=this.gl;if(null!=b&&b!=c.gl){f=
0;for(g=c.programs;f<g.length;){var d=g[f];++f;if(null!=d.gl&&d.gl!=b)throw A.thrown("Error, texture can not used inside different gl-contexts");}f=0;for(g=c.displays;f<g.length;)if(d=g[f],++f,null!=d.gl&&d.gl!=b)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=c.gl&&(c.gl.deleteTexture(c.glTexture),c.glTexture=null,0==c.displays.length&&null!=c.framebuffer&&(c.gl.deleteFramebuffer(c.framebuffer),c.framebuffer=null,null!=c.glDepthBuffer&&c.gl.deleteRenderbuffer(c.glDepthBuffer),
c.glDepthBuffer=null));c.gl=b;if(c.width>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE)||c.height>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");c.glTexture=yb.createEmptyTexture(c.gl,c.width,c.height,c.colorChannels,c.createMipmaps,c.magFilter,c.minFilter,c.useFloat);if(0<c.displays.length&&null==c.framebuffer){c.glDepthBuffer=c.gl.createRenderbuffer();f=c.gl;b=c.glTexture;g=c.glDepthBuffer;d=c.width;var h=c.height,m=f.createFramebuffer();
f.bindRenderbuffer(f.RENDERBUFFER,g);Ia.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,d,h);Ia.getLastGlError(f)==f.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,d,h));f.bindFramebuffer(f.FRAMEBUFFER,m);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,
g);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,b,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);c.framebuffer=m;c.updated=!0}for(f=c.images.keys();f.hasNext();)b=f.next(),c.bufferImage(b,c.images.h[b.__id__])}c.programs.push(this)}this.parseColorFormula();this.glShaderConfig.hasFRAGMENT_INJECTION=this.hasFragmentInjection;
this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS="";this.glShaderConfig.TEXTURES=[];if(0==this.activeTextures.length)this.glShaderConfig.hasTEXTURES=!1;else{this.glShaderConfig.hasTEXTURES=!0;e=0;for(f=this.activeTextures.length;e<f;)g=e++,this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS+="uniform sampler2D uTexture"+g+";";for(b=this.textureLayers.keys();b.hasNext();){c=b.next();a=[];d=this.textureLayers.h[c];e=0;for(f=d.length;e<f;){g=e++;h=""+J.string(d[g].slotWidth/d[g].width);m=""+J.string(d[g].slotHeight/
d[g].height);var n=""+J.string(d[g].slotsX*d[g].slotWidth/d[g].width),x=""+J.string(d[g].slotsY*d[g].slotHeight/d[g].height);a.push({UNIT_VALUE:g+1+".0",TEXTURE:"uTexture"+this.activeTextures.indexOf(d[g]),SLOTS_X:d[g].slotsX+".0",SLOTS_Y:d[g].slotsY+".0",SLOT_WIDTH:-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0",SLOT_HEIGHT:-1!=m.indexOf(".")||-1!=m.indexOf("e-")?m:m+".0",SLOTS_WIDTH:-1!=n.indexOf(".")||-1!=n.indexOf("e-")?n:n+".0",SLOTS_HEIGHT:-1!=x.indexOf(".")||-1!=x.indexOf("e-")?x:x+".0",TILES_X:d[g].tilesX+
".0",TILES_Y:d[g].tilesY+".0",TEXTURE_WIDTH:d[g].width+".0",TEXTURE_HEIGHT:d[g].height+".0",FIRST:0==g,LAST:g==d.length-1})}this.glShaderConfig.TEXTURES.push({LAYER:c,UNITS:a,USED:0<(this.used_by_ColorFormula&1<<c),USED_ID:0<(this.usedID_by_ColorFormula&1<<c)})}}this.glShaderConfig.TEXTURE_DEFAULTS=[];e=0;for(f=this.textureID_Defaults;e<f.length;)a=f[e],++e,this.glShaderConfig.TEXTURE_DEFAULTS.push({LAYER:a.layer,DEFAULT_VALUE:a.value});this.glShaderConfig.hasTEXTURE_FUNCTIONS=0==this.usedID_by_ColorFormula&&
0==this.textureID_Defaults.length?!1:!0;null!=this.gl&&(this.ready=!1,this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)),this.createProg(),this.buffer.hasPicking()&&this.createProg(!0))},__class__:vd};var ye=function(a,b,c,e){null==e&&(e=16384);null==c&&(c=
!0);this.rHexToDec=new da('("\\s*)?(0x[0-9a-f]+)(\\s*")?',"gi");this.rComments=new da("//.*?$","gm");this.rParsePathConfig=new da("^(.*?)([^/]+)$","");this.kerning=!1;if(this.rParsePathConfig.match(a))this.path=this.rParsePathConfig.matched(1),this.jsonFilename=this.rParsePathConfig.matched(2);else throw A.thrown("Can't load font, error in path to jsonfile: \""+a+'"');this.ranges=b;this.kerning=c;this.maxTextureSize=e};h["peote.text.Font__ob_gum_backends_PeoteView_FontStyle"]=ye;ye.__name__=!0;ye.prototype=
{load:function(a,b,c){null==c&&(c=!1);var e=this,f=c,g=function(f){f=f.replace(e.rComments.r,"");f=e.rHexToDec.map(f,function(a){return J.string(J.parseInt(a.matched(2)))});var g=new ea;e.config=g.fromJson(f,e.path+e.jsonFilename);f=0;for(g=g.errors;f<g.length;){var d=g[f];++f;switch(d._hx_index){case 0:var h=d.variable;var l=d.expected;h=d.pos;break;case 1:h=d.pos;break;case 2:h=d.pos;break;case 3:h=d.pos;break;case 4:h=d.pos;break;case 5:h=d.pos;break;case 6:h=d.pos}la.trace(h.lines[0].number,{fileName:"peote/text/Font.hx",
lineNumber:246,className:"peote.text.Font__ob_gum_backends_PeoteView_FontStyle",methodName:"load"});null!=h&&la.trace(Fe.convertError(d),{fileName:h.file,lineNumber:h.lines[0].number,className:"",methodName:""})}if(e.config.packed)throw f='Error, metadata of FontStyle class has to be "@packed" for "'+e.path+e.jsonFilename+'" and "packed":true',la.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(f);e.kerning&&null!=e.config.kerning&&(e.kerning=e.config.kerning);
if(null==e.ranges&&1<e.config.ranges.length)throw f='Error, set FontStyle to @multiSlot and/or @multiTexture or define a single range while Font creation or inside "'+e.path+e.jsonFilename+'"',la.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(f);d=[];f=0;for(g=e.config.ranges;f<g.length;){var m=g[f];++f;var n=m.range.min,x=m.range.max;if(null!=e.ranges)for(h=0,l=e.ranges;h<l.length;){var v=l[h];++h;if(v.min>=n&&v.min<=x||v.max>=n&&v.max<=x){d.push(m);break}}else d.push(m);
if(1==d.length)break}if(0==d.length)throw f='Error, can not found any ranges inside font-config "'+e.path+e.jsonFilename+'" that fit '+J.string(e.ranges),la.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(f);e.config.ranges=d;e.init(a,b,c)};null==f&&(f=!1);var d=this.path+this.jsonFilename,h=null==g?null:g,m=null==g?null:function(a){g(a.toString())};null==f&&(f=!1);""!=Sa.corsServer&&(new da("^https?://","")).match(d)&&(d="//"+Sa.corsServer+"/"+d);var n=
hc.loadFromFile(d);f&&(la.trace('Start loading bytes "'+d+'"',{fileName:"utils/Loader.hx",lineNumber:81,className:"utils.Loader",methodName:"bytes"}),n.onProgress(function(a,b){Sa.onProgressDebug(a,b,d)}),n.onError(Sa.onErrorDebug),n.onComplete(function(a){Sa.onCompleteDebug(d)}));if(null!=h)n.onError(h);if(null!=m)n.onComplete(m)},init:function(a,b,c){for(var e=0,f=0,g=0,d=this.config.ranges;g<d.length;){var h=d[g];++g;h.slot.width>e&&(e=h.slot.width);h.slot.height>f&&(f=h.slot.height)}this.textureCache=
new td(e,f,this.config.ranges.length,4,!1,1,1,null,this.maxTextureSize);this.loadImages(null,a,b,c)},loadImages:function(a,b,c,e){var f=this,g=this.config.ranges;a=Array(g.length);for(var d=0,h=g.length;d<h;){var m=d++;a[m]=f.path+g[m].image}g=e;var n=function(a,b,e){null!=c&&c(b,e)},x=function(a,b){if(null!=f.config.ranges[a].tiles){var c=f.config.ranges[a].tiles.x;var e=f.config.ranges[a].tiles.y}else if(null!=f.config.tiles)c=f.config.tiles.x,e=f.config.tiles.y;else throw b='Error, can not found tiles inside font-config "'+
f.path+f.jsonFilename+'"',la.trace(b,{fileName:f.path+f.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(b);if(null!=f.config.ranges[a].line){var g=f.config.ranges[a].line.height/b.height*e;var d=f.config.ranges[a].line.base/b.height*e}else null!=f.config.line?(g=f.config.line.height/b.height*e,d=f.config.line.base/b.height*e):d=g=1;a=f.config.ranges[a].range;f.textureCache.setImage(b,0,c,e);f.rangeMapping={min:a.min,max:a.max,height:g,base:d}},t=function(a){b(f)};null==g&&(g=!1);var p=
a.length;d=0;for(h=a.length;d<h;){m=[d++];var K=[a[m[0]]];e=g;var u=null==n?null:function(a){return function(b,c){null!=n&&n(a[0],b,c)}}(m);m=null==t?null:function(a){return function(c){null!=x&&x(a[0],c);0==--p&&b(f)}}(m);null==e&&(e=!1);""!=Sa.corsServer&&(new da("^https?://","")).match(K[0])&&(K[0]="//"+Sa.corsServer+"/"+K[0]);var k=Ba.loadFromFile(K[0]);e&&(la.trace('Start loading image "'+K[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),k.onProgress(function(a){return function(b,
c){Sa.onProgressDebug(b,c,a[0])}}(K)),k.onError(Sa.onErrorDebug),k.onComplete(function(a){return function(b){Sa.onCompleteDebug(a[0])}}(K)));if(null!=u)k.onProgress(u);if(null!=m)k.onComplete(m)}},__class__:ye};var Se=function(){};h["peote.text.Gl3FontData"]=Se;Se.__name__=!0;var Zd=function(a,b){this.min=a;this.max=b};h["peote.text.Range"]=Zd;Zd.__name__=!0;Zd.prototype={__class__:Zd};var xd=function(){};h["peote.view.BufferInterface"]=xd;xd.__name__=!0;xd.__isInterface__=!0;xd.prototype={__class__:xd};
var Jd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);W.isINSTANCED?(null==ua.instanceBytes&&(ua.instanceBytes=new Zb(new ArrayBuffer(12)),ua.instanceBytes.b[0]=1,ua.instanceBytes.b[1]=1,ua.instanceBytes.b[2]=
1,ua.instanceBytes.b[3]=1,ua.instanceBytes.b[4]=0,ua.instanceBytes.b[5]=1,ua.instanceBytes.b[6]=1,ua.instanceBytes.b[7]=0,ua.instanceBytes.b[8]=0,ua.instanceBytes.b[9]=0,ua.instanceBytes.b[10]=0,ua.instanceBytes.b[11]=0),this._elemBuffSize=36):this._elemBuffSize=240;this._bytes=new Zb(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};h["peote.view.Buffer_Shape"]=Jd;Jd.__name__=!0;Jd.__interfaces__=[xd];Jd.prototype={setNewGLContext:function(a){if(null!=
a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),W.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),W.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);W.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),
a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ua.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));W.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(5),
a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,36,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,36,4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,36,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,36,16),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,36,24),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,36,32),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,40,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,8),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,40,16),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,24),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,40,32),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(W.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI;e.b_UFloat32[c.bytePos+8>>2]=c.x;e.b_UFloat32[c.bytePos+12>>2]=c.y;e.b_UFloat32[c.bytePos+16>>2]=c.px_offset;e.b_UFloat32[c.bytePos+20>>
2]=c.py_offset;e.b_UFloat32[c.bytePos+24>>2]=c.sides;e.b_UFloat32[c.bytePos+28>>2]=c.shape;e.b_Uint16[c.bytePos+32>>1]=c.w&65535;e.b_Uint16[c.bytePos+34>>1]=c.h&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+8>>2]=c.x,e.b_UFloat32[c.bytePos+12>>2]=c.y,e.b_UFloat32[c.bytePos+16>>2]=c.px_offset,e.b_UFloat32[c.bytePos+20>>2]=c.py_offset,e.b_UFloat32[c.bytePos+24>>2]=c.sides,e.b_UFloat32[c.bytePos+
28>>2]=c.shape,e.b_Uint16[c.bytePos+32>>1]=c.w&65535,e.b_Uint16[c.bytePos+34>>1]=c.h&65535,e.b[c.bytePos+36]=1,e.b[c.bytePos+37]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_UFloat32[c.bytePos+44>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+48>>2]=c.x,e.b_UFloat32[c.bytePos+52>>2]=c.y,e.b_UFloat32[c.bytePos+56>>2]=c.px_offset,e.b_UFloat32[c.bytePos+60>>2]=c.py_offset,e.b_UFloat32[c.bytePos+64>>2]=c.sides,e.b_UFloat32[c.bytePos+68>>2]=c.shape,e.b_Uint16[c.bytePos+72>>1]=c.w&65535,e.b_Uint16[c.bytePos+
74>>1]=c.h&65535,e.b[c.bytePos+76]=1,e.b[c.bytePos+77]=1,e.b_Int32[c.bytePos+80>>2]=c.color,e.b_UFloat32[c.bytePos+84>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+88>>2]=c.x,e.b_UFloat32[c.bytePos+92>>2]=c.y,e.b_UFloat32[c.bytePos+96>>2]=c.px_offset,e.b_UFloat32[c.bytePos+100>>2]=c.py_offset,e.b_UFloat32[c.bytePos+104>>2]=c.sides,e.b_UFloat32[c.bytePos+108>>2]=c.shape,e.b_Uint16[c.bytePos+112>>1]=c.w&65535,e.b_Uint16[c.bytePos+114>>1]=c.h&65535,e.b[c.bytePos+116]=0,e.b[c.bytePos+117]=1,e.b_Int32[c.bytePos+
120>>2]=c.color,e.b_UFloat32[c.bytePos+124>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+128>>2]=c.x,e.b_UFloat32[c.bytePos+132>>2]=c.y,e.b_UFloat32[c.bytePos+136>>2]=c.px_offset,e.b_UFloat32[c.bytePos+140>>2]=c.py_offset,e.b_UFloat32[c.bytePos+144>>2]=c.sides,e.b_UFloat32[c.bytePos+148>>2]=c.shape,e.b_Uint16[c.bytePos+152>>1]=c.w&65535,e.b_Uint16[c.bytePos+154>>1]=c.h&65535,e.b[c.bytePos+156]=1,e.b[c.bytePos+157]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_UFloat32[c.bytePos+164>>2]=c.rotation/
180*Math.PI,e.b_UFloat32[c.bytePos+168>>2]=c.x,e.b_UFloat32[c.bytePos+172>>2]=c.y,e.b_UFloat32[c.bytePos+176>>2]=c.px_offset,e.b_UFloat32[c.bytePos+180>>2]=c.py_offset,e.b_UFloat32[c.bytePos+184>>2]=c.sides,e.b_UFloat32[c.bytePos+188>>2]=c.shape,e.b_Uint16[c.bytePos+192>>1]=c.w&65535,e.b_Uint16[c.bytePos+194>>1]=c.h&65535,e.b[c.bytePos+196]=0,e.b[c.bytePos+197]=0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_UFloat32[c.bytePos+204>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+208>>2]=c.x,e.b_UFloat32[c.bytePos+
212>>2]=c.y,e.b_UFloat32[c.bytePos+216>>2]=c.px_offset,e.b_UFloat32[c.bytePos+220>>2]=c.py_offset,e.b_UFloat32[c.bytePos+224>>2]=c.sides,e.b_UFloat32[c.bytePos+228>>2]=c.shape,e.b_Uint16[c.bytePos+232>>1]=c.w&65535,e.b_Uint16[c.bytePos+234>>1]=c.h&65535,e.b[c.bytePos+236]=0,e.b[c.bytePos+237]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},
updateElement:function(a){if(W.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI;b.b_UFloat32[a.bytePos+8>>2]=a.x;b.b_UFloat32[a.bytePos+12>>2]=a.y;b.b_UFloat32[a.bytePos+16>>2]=a.px_offset;b.b_UFloat32[a.bytePos+20>>2]=a.py_offset;b.b_UFloat32[a.bytePos+24>>2]=a.sides;b.b_UFloat32[a.bytePos+28>>2]=a.shape;b.b_Uint16[a.bytePos+32>>1]=a.w&65535;b.b_Uint16[a.bytePos+34>>1]=a.h&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.color,b.b_UFloat32[a.bytePos+
4>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+8>>2]=a.x,b.b_UFloat32[a.bytePos+12>>2]=a.y,b.b_UFloat32[a.bytePos+16>>2]=a.px_offset,b.b_UFloat32[a.bytePos+20>>2]=a.py_offset,b.b_UFloat32[a.bytePos+24>>2]=a.sides,b.b_UFloat32[a.bytePos+28>>2]=a.shape,b.b_Uint16[a.bytePos+32>>1]=a.w&65535,b.b_Uint16[a.bytePos+34>>1]=a.h&65535,b.b[a.bytePos+36]=1,b.b[a.bytePos+37]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_UFloat32[a.bytePos+44>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+48>>2]=a.x,b.b_UFloat32[a.bytePos+
52>>2]=a.y,b.b_UFloat32[a.bytePos+56>>2]=a.px_offset,b.b_UFloat32[a.bytePos+60>>2]=a.py_offset,b.b_UFloat32[a.bytePos+64>>2]=a.sides,b.b_UFloat32[a.bytePos+68>>2]=a.shape,b.b_Uint16[a.bytePos+72>>1]=a.w&65535,b.b_Uint16[a.bytePos+74>>1]=a.h&65535,b.b[a.bytePos+76]=1,b.b[a.bytePos+77]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_UFloat32[a.bytePos+84>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+88>>2]=a.x,b.b_UFloat32[a.bytePos+92>>2]=a.y,b.b_UFloat32[a.bytePos+96>>2]=a.px_offset,b.b_UFloat32[a.bytePos+
100>>2]=a.py_offset,b.b_UFloat32[a.bytePos+104>>2]=a.sides,b.b_UFloat32[a.bytePos+108>>2]=a.shape,b.b_Uint16[a.bytePos+112>>1]=a.w&65535,b.b_Uint16[a.bytePos+114>>1]=a.h&65535,b.b[a.bytePos+116]=0,b.b[a.bytePos+117]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_UFloat32[a.bytePos+124>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+128>>2]=a.x,b.b_UFloat32[a.bytePos+132>>2]=a.y,b.b_UFloat32[a.bytePos+136>>2]=a.px_offset,b.b_UFloat32[a.bytePos+140>>2]=a.py_offset,b.b_UFloat32[a.bytePos+144>>2]=a.sides,
b.b_UFloat32[a.bytePos+148>>2]=a.shape,b.b_Uint16[a.bytePos+152>>1]=a.w&65535,b.b_Uint16[a.bytePos+154>>1]=a.h&65535,b.b[a.bytePos+156]=1,b.b[a.bytePos+157]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_UFloat32[a.bytePos+164>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+168>>2]=a.x,b.b_UFloat32[a.bytePos+172>>2]=a.y,b.b_UFloat32[a.bytePos+176>>2]=a.px_offset,b.b_UFloat32[a.bytePos+180>>2]=a.py_offset,b.b_UFloat32[a.bytePos+184>>2]=a.sides,b.b_UFloat32[a.bytePos+188>>2]=a.shape,b.b_Uint16[a.bytePos+
192>>1]=a.w&65535,b.b_Uint16[a.bytePos+194>>1]=a.h&65535,b.b[a.bytePos+196]=0,b.b[a.bytePos+197]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_UFloat32[a.bytePos+204>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+208>>2]=a.x,b.b_UFloat32[a.bytePos+212>>2]=a.y,b.b_UFloat32[a.bytePos+216>>2]=a.px_offset,b.b_UFloat32[a.bytePos+220>>2]=a.py_offset,b.b_UFloat32[a.bytePos+224>>2]=a.sides,b.b_UFloat32[a.bytePos+228>>2]=a.shape,b.b_Uint16[a.bytePos+232>>1]=a.w&65535,b.b_Uint16[a.bytePos+234>>1]=a.h&65535,
b.b[a.bytePos+236]=0,b.b[a.bytePos+237]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=
this._maxElements+this._growSize,c=new Zb(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var f=this._maxElements;c<f;){var g=c++,d=this._elements[g];e=this._bytes;var h=d.bytePos,m=this._elemBuffSize;null==m&&(m=0);null==h&&(h=0);e=0<m?new Uint8Array(e.b.bufferValue,h,m):new Uint8Array(e.b.bufferValue,h);d.bufferPointer=e;b[g]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=
this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),W.isVAO&&(this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),
b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),
b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),
b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;h=a.bytePos;m=this._elemBuffSize;null==m&&(m=0);null==h&&(h=0);e=0<m?new Uint8Array(e.b.bufferValue,h,m):new Uint8Array(e.b.bufferValue,h);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");
},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t::IN:: vec2 aPivot;\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: vec2 aFloat0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: vec2 vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\tvec2 pivot = ::if PIVOT_FORMULA::::PIVOT_FORMULA::::else::vec2((aSize.x) * 0.5 + (aPivot.x), (aSize.y) * 0.5 + (aPivot.y))::end::;\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( aRotZ, 0.0 )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + (aPosition * size - pivot) * mat2( vec2(cos(rotZ.x), -sin(rotZ.x)), vec2(sin(rotZ.x), cos(rotZ.x)) );\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\tvPack0.x = ::if FORMULA_VARYINGS.sides::::FORMULA_VARYINGS.sides::::else::aFloat0.x::end::;vPack0.y = ::if FORMULA_VARYINGS.shape::::FORMULA_VARYINGS.shape::::else::aFloat0.y::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: vec2 vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return["sides","shape"]},getCustomVaryings:function(){return["vPack0.x","vPack0.y"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ua.DEFAULT_FORMULA_VARS},getFormulas:function(){return ua.FORMULAS},getAttributes:function(){return ua.ATTRIBUTES},getFormulaNames:function(){return ua.FORMULA_NAMES},getFormulaVaryings:function(){return""==ua.FORMULA_VARYINGS?
[]:ua.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==ua.FORMULA_CONSTANTS?[]:ua.FORMULA_CONSTANTS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!0},hasZindex:function(){return!1},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,5,"aColorStart0");a.bindAttribLocation(b,4,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,
3,"aPivot");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;W.isINSTANCED?(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),
b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,
0,6,a)):(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),
b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));W.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(5),b.disableVertexAttribArray(4),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(3),b.disableVertexAttribArray(6));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Jd};
var Kd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);W.isINSTANCED?(null==ya.instanceBytes&&(ya.instanceBytes=new Zb(new ArrayBuffer(12)),ya.instanceBytes.b[0]=1,ya.instanceBytes.b[1]=1,ya.instanceBytes.b[2]=
1,ya.instanceBytes.b[3]=1,ya.instanceBytes.b[4]=0,ya.instanceBytes.b[5]=1,ya.instanceBytes.b[6]=1,ya.instanceBytes.b[7]=0,ya.instanceBytes.b[8]=0,ya.instanceBytes.b[9]=0,ya.instanceBytes.b[10]=0,ya.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new Zb(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};h["peote.view.Buffer_ViewElement"]=Kd;Kd.__name__=!0;Kd.__interfaces__=[xd];Kd.prototype={setNewGLContext:function(a){if(null!=
a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),W.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),W.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);W.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),
a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ya.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));W.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),
a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},updateElement:function(a){if(W.isINSTANCED){var b=
this._bytes;b.b_Uint16[a.bytePos>>1]=a.x&65535;b.b_Uint16[a.bytePos+2>>1]=a.y&65535;b.b_Uint16[a.bytePos+4>>1]=a.w&65535;b.b_Uint16[a.bytePos+6>>1]=a.h&65535}else b=this._bytes,b.b_Uint16[a.bytePos>>1]=a.x&65535,b.b_Uint16[a.bytePos+2>>1]=a.y&65535,b.b_Uint16[a.bytePos+4>>1]=a.w&65535,b.b_Uint16[a.bytePos+6>>1]=a.h&65535,b.b[a.bytePos+8]=1,b.b[a.bytePos+9]=1,b.b_Uint16[a.bytePos+12>>1]=a.x&65535,b.b_Uint16[a.bytePos+14>>1]=a.y&65535,b.b_Uint16[a.bytePos+16>>1]=a.w&65535,b.b_Uint16[a.bytePos+18>>1]=
a.h&65535,b.b[a.bytePos+20]=1,b.b[a.bytePos+21]=1,b.b_Uint16[a.bytePos+24>>1]=a.x&65535,b.b_Uint16[a.bytePos+26>>1]=a.y&65535,b.b_Uint16[a.bytePos+28>>1]=a.w&65535,b.b_Uint16[a.bytePos+30>>1]=a.h&65535,b.b[a.bytePos+32]=0,b.b[a.bytePos+33]=1,b.b_Uint16[a.bytePos+36>>1]=a.x&65535,b.b_Uint16[a.bytePos+38>>1]=a.y&65535,b.b_Uint16[a.bytePos+40>>1]=a.w&65535,b.b_Uint16[a.bytePos+42>>1]=a.h&65535,b.b[a.bytePos+44]=1,b.b[a.bytePos+45]=0,b.b_Uint16[a.bytePos+48>>1]=a.x&65535,b.b_Uint16[a.bytePos+50>>1]=a.y&
65535,b.b_Uint16[a.bytePos+52>>1]=a.w&65535,b.b_Uint16[a.bytePos+54>>1]=a.h&65535,b.b[a.bytePos+56]=0,b.b[a.bytePos+57]=0,b.b_Uint16[a.bytePos+60>>1]=a.x&65535,b.b_Uint16[a.bytePos+62>>1]=a.y&65535,b.b_Uint16[a.bytePos+64>>1]=a.w&65535,b.b_Uint16[a.bytePos+66>>1]=a.h&65535,b.b[a.bytePos+68]=0,b.b[a.bytePos+69]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),
b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Zb(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var f=this._maxElements;c<f;){var g=c++,d=this._elements[g];
e=this._bytes;var h=d.bytePos,m=this._elemBuffSize;null==m&&(m=0);null==h&&(h=0);e=0<m?new Uint8Array(e.b.bufferValue,h,m):new Uint8Array(e.b.bufferValue,h);d.bufferPointer=e;b[g]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null),W.isVAO&&(this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),
b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;h=a.bytePos;m=this._elemBuffSize;null==m&&(m=0);null==h&&(h=0);e=0<m?new Uint8Array(e.b.bufferValue,h,m):new Uint8Array(e.b.bufferValue,h);a.bufferPointer=e;this._elements[this._maxElements++]=
a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ya.DEFAULT_FORMULA_VARS},getFormulas:function(){return ya.FORMULAS},getAttributes:function(){return ya.ATTRIBUTES},getFormulaNames:function(){return ya.FORMULA_NAMES},getFormulaVaryings:function(){return""==ya.FORMULA_VARYINGS?[]:ya.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==ya.FORMULA_CONSTANTS?[]:ya.FORMULA_CONSTANTS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;W.isINSTANCED?(W.isVAO?this._gl.bindVertexArray(this._glVAO):
(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,
b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));W.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null)},__class__:Kd};var ad=function(a,b,c,e,f){null==f&&(f=0);this.renderFramebufferSkipFrames=this.renderFramebufferFrame=0;this._renderFramebufferEnabled=!1;this.renderFramebufferEnabled=!0;this.framebufferTextureSlot=0;this.peoteView=this.gl=this.fbTexture=null;this.alpha=1;this.red=this.green=this.blue=0;this.backgroundAlpha=this.backgroundDepth=this.backgroundEnabled=!1;this.isVisible=!0;this.xz=this.yz=1;this.width=this.height=this.x=this.y=this.xOffset=this.yOffset=0;if(W.isUBO){var g=this.uniformBuffer,
d=this.gl;null!=d&&(g.uniformBytes.b_UFloat32[0]=a+this.xOffset,d.bindBuffer(d.UNIFORM_BUFFER,g.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,0,g.xOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null))}this.x=a;W.isUBO&&(g=this.uniformBuffer,d=this.gl,null!=d&&(g.uniformBytes.b_UFloat32[1]=b+this.yOffset,d.bindBuffer(d.UNIFORM_BUFFER,g.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,4,g.yOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null)));this.y=b;this.width=c;this.height=e;this.red=(f>>
24&255)/255;this.green=(f>>16&255)/255;this.blue=(f>>8&255)/255;this.alpha=(f&255)/255;this.backgroundEnabled=0<this.alpha;this.backgroundAlpha=1>this.alpha;this.programList=new ze(new Sb);W.isUBO&&(this.uniformBuffer=new Ld,this.uniformBufferFB=new Ld,this.uniformBufferViewFB=new Md)};h["peote.view.Display"]=ad;ad.__name__=!0;ad.prototype={addToPeoteView:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.displayList.add(this,b,c)},removeFromPeoteView:function(a){if(this.peoteView!=
a)throw A.thrown("Error, display is not inside peoteView");a.framebufferDisplayList.has(this)||(this.peoteView=null);a.displayList.remove(this)},addToPeoteViewFramebuffer:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.framebufferDisplayList.add(this,b,c)},setNewGLContext:function(a){if(null!=a&&a!=this.gl){null!=this.gl&&W.isUBO&&(this.uniformBuffer.deleteGLBuffer(this.gl),this.uniformBufferFB.deleteGLBuffer(this.gl),this.uniformBufferViewFB.deleteGLBuffer(this.gl));
this.gl=a;W.isUBO&&(this.uniformBuffer.createGLBuffer(this.gl,this.x+this.xOffset,this.y+this.yOffset,this.xz,this.yz),this.uniformBufferFB.createGLBuffer(this.gl,this.xOffset,this.yOffset-this.height,this.xz,this.yz),this.uniformBufferViewFB.createGLBuffer(this.gl,this.width,-this.height,0,0,1,1));for(var b=this.programList.first;null!=b;){var c=b.value;b=b.next;if(null!=a&&a!=c.gl){for(var e=0,f=c.displays;e<f.length;){var g=f[e];++e;if(null!=g.gl&&g.gl!=a)throw A.thrown("Error, program can not used inside different gl-contexts");
}null!=c.gl&&(c.gl.deleteShader(c.glVertexShader),c.gl.deleteShader(c.glFragmentShader),c.gl.deleteProgram(c.glProgram),c.buffer.hasPicking()&&(c.gl.deleteShader(c.glVertexShaderPicking),c.gl.deleteShader(c.glFragmentShaderPicking),c.gl.deleteProgram(c.glProgramPicking)));c.gl=a;W.isES3&&(c.glShaderConfig.isES3=!0,c.glShaderConfig.IN="in",c.glShaderConfig.VARIN="in",c.glShaderConfig.VAROUT="out");W.isUBO&&(c.glShaderConfig.isUBO=!0);W.isINSTANCED&&(c.glShaderConfig.isINSTANCED=!0);c.glShaderConfig.FRAGMENT_EXTENSIONS=
[];null!=c.gl.getExtension("OES_standard_derivatives")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=c.gl.getExtension("EXT_color_buffer_float")?c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=c.gl.getExtension("OES_texture_float")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});c.buffer.setNewGLContext(c.gl);c.createProg();c.buffer.hasPicking()&&c.createProg(!0);e=0;for(f=c.activeTextures;e<
f.length;){g=f[e];++e;var d=c.gl;if(null!=d&&d!=g.gl){for(var h=0,m=g.programs;h<m.length;){var n=m[h];++h;if(null!=n.gl&&n.gl!=d)throw A.thrown("Error, texture can not used inside different gl-contexts");}n=0;for(h=g.displays;n<h.length;)if(m=h[n],++n,null!=m.gl&&m.gl!=d)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=g.gl&&(g.gl.deleteTexture(g.glTexture),g.glTexture=null,0==g.displays.length&&null!=g.framebuffer&&(g.gl.deleteFramebuffer(g.framebuffer),g.framebuffer=
null,null!=g.glDepthBuffer&&g.gl.deleteRenderbuffer(g.glDepthBuffer),g.glDepthBuffer=null));g.gl=d;if(g.width>g.gl.getParameter(g.gl.MAX_TEXTURE_SIZE)||g.height>g.gl.getParameter(g.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");g.glTexture=yb.createEmptyTexture(g.gl,g.width,g.height,g.colorChannels,g.createMipmaps,g.magFilter,g.minFilter,g.useFloat);if(0<g.displays.length&&null==g.framebuffer){g.glDepthBuffer=g.gl.createRenderbuffer();d=g.gl;n=g.glTexture;
h=g.glDepthBuffer;m=g.width;var x=g.height,t=d.createFramebuffer();d.bindRenderbuffer(d.RENDERBUFFER,h);Ia.clearGlErrorQueue(d);d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT24,m,x);Ia.getLastGlError(d)==d.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,m,x));d.bindFramebuffer(d.FRAMEBUFFER,
t);d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,h);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,n,0);if(d.checkFramebufferStatus(d.FRAMEBUFFER)!=d.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");d.bindFramebuffer(d.FRAMEBUFFER,null);d.bindRenderbuffer(d.RENDERBUFFER,null);g.framebuffer=t;g.updated=!0}for(d=g.images.keys();d.hasNext();)n=d.next(),g.bufferImage(n,g.images.h[n.__id__])}}}}if(null!=this.fbTexture&&(b=this.fbTexture,
null!=a&&a!=b.gl)){e=0;for(f=b.programs;e<f.length;)if(n=f[e],++e,null!=n.gl&&n.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");e=0;for(f=b.displays;e<f.length;)if(g=f[e],++e,null!=g.gl&&g.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),
b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=yb.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();d=b.gl;n=b.glTexture;h=b.glDepthBuffer;m=b.width;x=b.height;t=d.createFramebuffer();
d.bindRenderbuffer(d.RENDERBUFFER,h);Ia.clearGlErrorQueue(d);d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT24,m,x);Ia.getLastGlError(d)==d.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,m,x));d.bindFramebuffer(d.FRAMEBUFFER,t);d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,
h);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,n,0);if(d.checkFramebufferStatus(d.FRAMEBUFFER)!=d.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");d.bindFramebuffer(d.FRAMEBUFFER,null);d.bindRenderbuffer(d.RENDERBUFFER,null);b.framebuffer=t;b.updated=!0}for(d=b.images.keys();d.hasNext();)n=d.next(),b.bufferImage(n,b.images.h[n.__id__])}}},addProgram:function(a,b,c){null==c&&(c=!1);a.addToDisplay(this,b,c)},setFramebuffer:function(a,b,c){if(this.fbTexture==
a)throw A.thrown("Error, texture is already in use as Framebuffer for Display");if(b>=a.imageSlots)throw A.thrown("Error, maximum texture slot of framebufferTexture is"+(a.imageSlots-1));if(null==c){if(null==this.gl)throw A.thrown("Error, if the display is not added it needs the gl-context of a peoteView to set a framebuffer texture");}else this.peoteView!=c&&(this.peoteView=c,this.setNewGLContext(c.gl));null!=b&&(this.framebufferTextureSlot=b);if(null!=this.fbTexture){b=this.fbTexture;if(!z.remove(b.displays,
this))throw A.thrown("Error, this texture (Framebuffer) is not used by display anymore");0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null)}b=this.fbTexture=a;if(0<=b.displays.indexOf(this))throw A.thrown("Error, texture is already used by display");a=this.gl;if(null!=a&&a!=b.gl){c=0;for(var e=b.programs;c<e.length;){var f=e[c];++c;if(null!=f.gl&&f.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");
}c=0;for(e=b.displays;c<e.length;)if(f=e[c],++c,null!=f.gl&&f.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");
b.glTexture=yb.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;f=b.width;var g=b.height,d=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);Ia.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT24,f,g);Ia.getLastGlError(c)==c.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",
{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,f,g));c.bindFramebuffer(c.FRAMEBUFFER,d);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");c.bindFramebuffer(c.FRAMEBUFFER,
null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=d;b.updated=!0}for(a=b.images.keys();a.hasNext();)c=a.next(),b.bufferImage(c,b.images.h[c.__id__])}b.displays.push(this);if(null!=b.gl&&0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;f=b.width;g=b.height;d=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);Ia.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT24,f,g);Ia.getLastGlError(c)==
c.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,f,g));c.bindFramebuffer(c.FRAMEBUFFER,d);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");
c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=d;b.updated=!0}this.renderFramebufferEnabled&&(this._renderFramebufferEnabled=!0)},__class__:ad};var $e={fromRenderContext:function(a){if(null!=a.webgl2)return la.trace("WEBGL2 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:86,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),W.isUBO=!0,W.isINSTANCED=!0,W.isVAO=!0,W.isES3=!0,a.webgl2;if(null!=a.webgl)return la.trace("WEBGL1 detected.",
{fileName:"peote/view/PeoteGL.hx",lineNumber:91,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),a.webgl;window.alert("Error: missing webgl context");return null}},W=function(){};h["peote.view.Version"]=W;W.__name__=!0;var Za=function(){};h["peote.view.Precision"]=Za;Za.__name__=!0;var xe=function(a,b,c){null==c&&(c=!0);null==b&&(b=255);this.speed=1;this.startTime=this.stopTime=0;this.isRun=!1;this.xOffset=this.yOffset=0;this.xz=this.yz=1;this.maskState=0;this.glStateAlpha=
this.glStateDepth=!1;this.colorState=!0;this.alpha=1;this.red=this.green=this.blue=0;this.gl=$e.fromRenderContext(a.context);this.width=a.__width;this.height=a.__height;this.red=(b>>24&255)/255;this.green=(b>>16&255)/255;this.blue=(b>>8&255)/255;this.alpha=(b&255)/255;W.isUBO&&(this.uniformBuffer=new Md,this.uniformBuffer.createGLBuffer(this.gl,this.width,this.height,this.xOffset,this.yOffset,this.xz,this.yz));this.maxTextureImageUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);this.glStateTexture=
b=Array(this.maxTextureImageUnits);b=this.gl;var e=b.VERTEX_SHADER,f=Za.VertexFloat,g=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=g&&(f.high=g.precision);g=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=g&&(f.medium=g.precision);g=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=g&&(f.low=g.precision);e=b.VERTEX_SHADER;f=Za.VertexInt;g=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=g&&(f.high=g.precision);g=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=g&&(f.medium=g.precision);g=b.getShaderPrecisionFormat(e,
b.LOW_FLOAT);null!=g&&(f.low=g.precision);e=b.VERTEX_SHADER;f=Za.VertexSampler;g=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=g&&(f.high=g.precision);g=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=g&&(f.medium=g.precision);g=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=g&&(f.low=g.precision);e=b.FRAGMENT_SHADER;f=Za.FragmentFloat;g=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=g&&(f.high=g.precision);g=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=g&&(f.medium=g.precision);g=
b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=g&&(f.low=g.precision);e=b.FRAGMENT_SHADER;f=Za.FragmentInt;g=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=g&&(f.high=g.precision);g=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=g&&(f.medium=g.precision);g=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=g&&(f.low=g.precision);e=b.FRAGMENT_SHADER;f=Za.FragmentSampler;g=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=g&&(f.high=g.precision);g=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=
g&&(f.medium=g.precision);g=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=g&&(f.low=g.precision);W.isINSTANCED?(this.pickInt32=b=new Int32Array(4),this.pickTexture=yb.createPickingTexture(this.gl,!0)):(this.pickUInt8=b=new Uint8Array(4),this.pickTexture=yb.createPickingTexture(this.gl));this.pickDepthBuffer=this.gl.createRenderbuffer();b=this.gl;e=this.pickTexture;f=this.pickDepthBuffer;g=b.createFramebuffer();b.bindRenderbuffer(b.RENDERBUFFER,f);Ia.clearGlErrorQueue(b);b.renderbufferStorage(b.RENDERBUFFER,
b.DEPTH_COMPONENT24,1,1);Ia.getLastGlError(b)==b.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,1,1));b.bindFramebuffer(b.FRAMEBUFFER,g);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,f);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!=
b.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindRenderbuffer(b.RENDERBUFFER,null);this.pickFB=g;this.background=new Ae(this.gl);this.displayList=new Nd(new Sb);this.framebufferDisplayList=new Nd(new Sb);c&&(a.onRender.add(d(this,this.render)),a.onResize.add(d(this,this.resize)))};h["peote.view.PeoteView"]=xe;xe.__name__=!0;xe.prototype={isTextureStateChange:function(a,b){return b.updated?(b.updated=!1,this.glStateTexture=Array(this.maxTextureImageUnits),
this.glStateTexture[a]=b.glTexture,!0):this.glStateTexture[a]!=b.glTexture?(this.glStateTexture[a]=b.glTexture,!0):!1},start:function(){if(!this.isRun){var a=this.stopTime;this.startTime=this.stopTime=(new Date).getTime()/1E3-a;this.isRun=!0}},addDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteView(this,b,c)},removeDisplay:function(a){a.removeFromPeoteView(this)},addFramebufferDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteViewFramebuffer(this,b,c)},resize:function(a,b){this.width=a;this.height=
b;if(W.isUBO){var c=this.uniformBuffer,e=this.gl;c.uniformBytes.b_UFloat32[0]=a;c.uniformBytes.b_UFloat32[1]=b;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,0,c.resolutionBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}},renderToTexture:function(a,b){if(null!=a.fbTexture){b=null!=b?b:a.framebufferTextureSlot;null==b&&(b=a.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.fbTexture.framebuffer);this.gl.viewport(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,
a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.scissor(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);a.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);
this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(a.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=a.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=0);this.background.render(a.red,
a.green,a.blue,a.alpha)}for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),
b.textureListItem=b.textureListItem.next;W.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,a.uniformBufferViewFB.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBufferFB.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,a.width,-a.height),b.gl.uniform2f(b.uZOOM,a.xz,a.yz),b.gl.uniform2f(b.uOFFSET,(a.xOffset+this.xOffset)/a.xz,(a.yOffset+this.yOffset-a.height)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=b.uniformFloats.length;c<
e;){var f=c++;b.gl.uniform1f(b.uniformFloatLocations[f],b.uniformFloats[f].value)}c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));
c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=
c);b.buffer.render(this,a,b);b.gl.useProgram(null);a.programListItem=a.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);a.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,a.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null),a.fbTexture.updated=!0)}},render:function(a){for(this.displayListItem=this.framebufferDisplayList.first;null!=this.displayListItem;){if(this.displayListItem.value._renderFramebufferEnabled)if(this.displayListItem.value.renderFramebufferFrame==
this.displayListItem.value.renderFramebufferSkipFrames){var b=this.displayListItem.value;a=null;null==a&&(a=b.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.fbTexture.framebuffer);this.gl.viewport(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.scissor(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,
b.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);b.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(b.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=
b.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0);this.background.render(b.red,b.green,b.blue,b.alpha)}for(b.programListItem=b.programList.first;null!=b.programListItem;){a=b.programListItem.value;a.gl.useProgram(a.glProgram);for(a.textureListItem=a.textureList.first;null!=a.textureListItem;)this.isTextureStateChange(a.textureListItem.value.unit,
a.textureListItem.value.texture)&&(a.gl.activeTexture(a.gl.TEXTURE0+a.textureListItem.value.unit),a.gl.bindTexture(a.gl.TEXTURE_2D,a.textureListItem.value.texture.glTexture)),a.gl.uniform1i(a.textureListItem.value.uniformLoc,a.textureListItem.value.unit),a.textureListItem=a.textureListItem.next;W.isUBO?(a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,0,b.uniformBufferViewFB.uniformBuffer),a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,1,b.uniformBufferFB.uniformBuffer)):(a.gl.uniform2f(a.uRESOLUTION,b.width,-b.height),
a.gl.uniform2f(a.uZOOM,b.xz,b.yz),a.gl.uniform2f(a.uOFFSET,(b.xOffset+this.xOffset)/b.xz,(b.yOffset+this.yOffset-b.height)/b.yz));a.gl.uniform1f(a.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=a.uniformFloats.length;c<e;){var f=c++;a.gl.uniform1f(a.uniformFloatLocations[f],a.uniformFloats[f].value)}c=a.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=a.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):
!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=a.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=a.mask;e=a.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),
this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);a.buffer.render(this,b,a);a.gl.useProgram(null);b.programListItem=b.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);b.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,b.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),
this.gl.bindTexture(this.gl.TEXTURE_2D,null),b.fbTexture.updated=!0);this.displayListItem.value.renderFramebufferFrame=0}else this.displayListItem.value.renderFramebufferFrame++;this.displayListItem=this.displayListItem.next}b=this.width;c=this.height;this.gl.viewport(0,0,b,c);this.gl.scissor(0,0,b,c);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(this.red,this.green,this.blue,this.alpha);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);
this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);for(this.displayListItem=this.displayList.first;null!=this.displayListItem;){a=this.displayListItem.value;if(a.isVisible){b=this.width;c=this.height;var g=this.xz,d=this.yz;e=Math.floor((a.x+this.xOffset)*g);f=Math.floor((a.y+this.yOffset)*d);g=Math.floor(a.width*g);d=Math.floor(a.height*d);0>e&&(g+=e);e=Math.max(0,Math.min(b,e))|0;g=Math.max(0,Math.min(b-e,g))|0;0>f&&(d+=f);f=Math.max(0,Math.min(c,
f))|0;d=Math.max(0,Math.min(c-f,d))|0;this.gl.scissor(e,c-d-f,g,d);a.backgroundEnabled&&(1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0)),(c=a.backgroundDepth)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST)),(c=a.backgroundAlpha)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND)),
0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0),this.background.render(a.red,a.green,a.blue,a.alpha));for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;if(b.isVisible){b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),
b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;W.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,this.uniformBuffer.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBuffer.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,this.width,this.height),b.gl.uniform2f(b.uZOOM,this.xz*a.xz,this.yz*a.yz),b.gl.uniform2f(b.uOFFSET,(a.x+a.xOffset+
this.xOffset)/a.xz,(a.y+a.yOffset+this.yOffset)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(e=b.uniformFloats.length;c<e;)f=c++,b.gl.uniform1f(b.uniformFloatLocations[f],b.uniformFloats[f].value);c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));
(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=
c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null)}a.programListItem=a.programListItem.next}}this.displayListItem=this.displayListItem.next}},__class__:xe};var wd=function(a,b,c){this.unit=a;this.texture=b;this.uniformLoc=c};h["peote.view.ActiveTexture"]=wd;wd.__name__=!0;wd.prototype={__class__:wd};var td=function(a,b,c,e,f,
g,d,h,m){null==m&&(m=16384);null==h&&(h=!1);null==d&&(d=0);null==g&&(g=0);null==f&&(f=!1);null==e&&(e=4);null==c&&(c=1);this.displays=[];this.programs=[];this.useFloat=this.updated=!1;this.magFilter=this.minFilter=0;this.createMipmaps=!1;this.images=new Sb;this.imageSlots=this.freeSlots=this.slotsX=this.slotsY=this.tilesX=this.tilesY=1;this.width=this.height=0;this.colorChannels=4;this.clearOnRenderInto=!0;this.gl=this.glTexture=this.framebuffer=this.glDepthBuffer=null;this.slotWidth=a;this.slotHeight=
b;this.imageSlots=this.freeSlots=c;this.colorChannels=e;this.createMipmaps=f;this.magFilter=d;this.minFilter=g;this.useFloat=h;a=yb.optimalTextureSize(c,a,b,m);this.width=a.width;this.height=a.height;this.slotsX=a.slotsX;this.slotsY=a.slotsY};h["peote.view.Texture"]=td;td.__name__=!0;td.prototype={setImage:function(a,b,c,e){null==b&&(b=0);if(null!=this.images.h.__keys__[a.__id__])throw A.thrown("Error, image is already inside texture inside slot "+this.images.h[a.__id__].imageSlot);null!=c&&(this.tilesX=
c);null!=e&&(this.tilesY=e);this.images.set(a,{imageSlot:b});this.freeSlots--;if(null!=this.gl){if(null==this.glTexture){if(this.width>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)||this.height>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");this.glTexture=yb.createEmptyTexture(this.gl,this.width,this.height,this.colorChannels,this.createMipmaps,this.magFilter,this.minFilter,this.useFloat)}this.bufferImage(a,{imageSlot:b})}},
bufferImage:function(a,b){var c=this.gl,e=b.imageSlot%this.slotsX*this.slotWidth;b=this.slotHeight*Math.floor(b.imageSlot/this.slotsX);var f=a.width,g=a.height,d=this.createMipmaps,h=this.useFloat;null==h&&(h=!1);null==d&&(d=!1);c.bindTexture(c.TEXTURE_2D,this.glTexture);if(h){h=f*g*4;h=null!=h?new Float32Array(h):null;for(var m=0,n=f*g*4;m<n;){var x=m++;h[x]=db.toFloat(a.get_data()[x])/db.toFloat(255)}c.texSubImage2D(c.TEXTURE_2D,0,e,b,f,g,c.RGBA,c.FLOAT,h)}else c.texSubImage2D(c.TEXTURE_2D,0,e,
b,f,g,c.RGBA,c.UNSIGNED_BYTE,a.get_data());d&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null);this.updated=!0},__class__:td};var Ld=function(){var a=this.uniformBytes=new Zb(new ArrayBuffer(32)),b=0;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=4;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;
b=12;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};h["peote.view.UniformBufferDisplay"]=Ld;Ld.__name__=!0;Ld.prototype={createGLBuffer:function(a,b,c,e,f){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=f;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);
a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Ld};var Md=function(){var a=this.uniformBytes=new Zb(new ArrayBuffer(48)),b=0;null==b&&(b=0);this.resolutionBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=16;null==
b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=20;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};h["peote.view.UniformBufferView"]=Md;Md.__name__=!0;Md.prototype={createGLBuffer:function(a,b,c,e,f,g,d){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=f;this.uniformBytes.b_UFloat32[4]=g;this.uniformBytes.b_UFloat32[5]=
d;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Md};var Me=function(a,b){this.name=a;this.value=b};h["peote.view.UniformFloat"]=Me;Me.__name__=!0;Me.prototype={__class__:Me};var Ae=function(a){this.gl=a;this.createBuffer();this.createProgram()};h["peote.view.utils.Background"]=Ae;Ae.__name__=
!0;Ae.prototype={createBuffer:function(){var a=new Zb(new ArrayBuffer(32));a.b_UFloat32[0]=1;a.b_UFloat32[1]=1;a.b_UFloat32[2]=0;a.b_UFloat32[3]=1;a.b_UFloat32[4]=1;a.b_UFloat32[5]=0;a.b_UFloat32[6]=0;a.b_UFloat32[7]=0;this.buffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);a=new Uint8Array(a.b.bufferValue,0);this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},createProgram:function(){var a="",b=Za.VertexFloat;
null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Za.VertexFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;var c=this.gl.VERTEX_SHADER,e=b.createShader(c);b.shaderSource(e,a+"\t\n\t\t\tattribute vec2 aPosition;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_Position = mat4 (\n\t\t\t\t\tvec4(2.0, 0.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, -2.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, 0.0, -1.0, 0.0),\n\t\t\t\t\tvec4(-1.0, 1.0, 0.0, 1.0)\n\t\t\t\t) * vec4 (aPosition, -1.0 ,1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+J.string(b.getShaderInfoLog(e)));var f=e;b=Za.FragmentFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Za.FragmentFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;c=this.gl.FRAGMENT_SHADER;e=b.createShader(c);b.shaderSource(e,a+"\n\t\t\tuniform vec4 uRGBA;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_FragColor = uRGBA;\n\t\t\t\t\n\t\t\t\t// TODO: Fix for old FF\n\t\t\t\tgl_FragColor.w = clamp(uRGBA.w, 0.003, 1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+J.string(b.getShaderInfoLog(e)));a=e;this.glProgram=this.gl.createProgram();this.gl.attachShader(this.glProgram,f);this.gl.attachShader(this.glProgram,a);this.gl.deleteShader(f);this.gl.deleteShader(a);this.gl.bindAttribLocation(this.glProgram,0,"aPosition");b=this.gl;f=this.glProgram;b.linkProgram(f);if(0==b.getProgramParameter(f,b.LINK_STATUS))throw A.thrown(J.string(b.getProgramInfoLog(f))+
"VALIDATE_STATUS: "+J.string(b.getProgramParameter(f,b.VALIDATE_STATUS))+"ERROR: "+J.string(b.getError()));this.uRGBA=this.gl.getUniformLocation(this.glProgram,"uRGBA")},render:function(a,b,c,e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);this.gl.enableVertexAttribArray(0);this.gl.vertexAttribPointer(0,2,this.gl.FLOAT,!1,8,0);this.gl.useProgram(this.glProgram);this.gl.uniform4f(this.uRGBA,a,b,c,e);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);this.gl.disableVertexAttribArray(0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
null)},__class__:Ae};var Zb=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b;this.b_UFloat32=new Float32Array(a);this.b_Int32=new Int32Array(a);this.b_Uint16=new Uint16Array(a)};h["peote.view.utils.BufferBytes"]=Zb;Zb.__name__=!0;Zb.prototype={blit:function(a,b,c,e){0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},fill:function(a,b,c){for(var e=0;e<b;)e++,this.b[a++]=c},__class__:Zb};var Ia=function(){};h["peote.view.utils.GLTool"]=
Ia;Ia.__name__=!0;Ia.clearGlErrorQueue=function(a){for(;a.getError()!=a.NO_ERROR;);};Ia.getLastGlError=function(a){var b=a.getError();b!=a.NO_ERROR&&(b==a.INVALID_ENUM?la.trace("(GL-Error: INVALID_ENUM)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:22,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.INVALID_VALUE?la.trace("(GL-Error: INVALID_VALUE)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:23,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==
a.INVALID_OPERATION?la.trace("(GL-Error: INVALID_OPERATION)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:24,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.OUT_OF_MEMORY?la.trace("(GL-Error: OUT_OF_MEMORY)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:25,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):la.trace("GL-Error: "+b,{fileName:"peote/view/utils/GLTool.hx",lineNumber:26,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}));return b};
var $b=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};h["peote.view.utils.RenderListItem_peote_view_ActiveTexture"]=$b;$b.__name__=!0;$b.prototype={__class__:$b};var lc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};h["peote.view.utils.RenderListItem_peote_view_Display"]=lc;lc.__name__=!0;lc.prototype={__class__:lc};var mc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=
this);null!=c&&(c.prev=this)};h["peote.view.utils.RenderListItem_peote_view_Program"]=mc;mc.__name__=!0;mc.prototype={__class__:mc};var ud=function(a){this.first=this.last=null;this.itemMap=a};h["peote.view.utils.RenderList_peote_view_ActiveTexture"]=ud;ud.__name__=!0;ud.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new $b(a,null,null);else if(null==b)b=this.first=new $b(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new $b(a,c.prev,c),c==this.first&&(this.first=
b);else throw A.thrown("Error on add: "+J.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new $b(a,null,null);else if(null==b)b=this.last=new $b(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new $b(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+J.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=
c.prev));this.itemMap.set(a,b)},clear:function(){for(;null!=this.first;){null!=this.last.value&&this.itemMap.remove(this.last.value);var a=this.last;a==this.first&&(this.first=a.next);a==this.last&&(this.last=a.prev);null!=a.prev&&(a.prev.next=a.next);null!=a.next&&(a.next.prev=a.prev)}},__class__:ud};var Nd=function(a){this.first=this.last=null;this.itemMap=a};h["peote.view.utils.RenderList_peote_view_Display"]=Nd;Nd.__name__=!0;Nd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=
this.last=new lc(a,null,null);else if(null==b)b=this.first=new lc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new lc(a,c.prev,c),c==this.first&&(this.first=b);else throw A.thrown("Error on add: "+J.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new lc(a,null,null);else if(null==b)b=this.last=new lc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new lc(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+J.string(b)+" is not in list.");
c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},remove:function(a){var b=this.itemMap.get(a);if(null!=b)this.itemMap.remove(a),b==this.first&&(this.first=b.next),b==this.last&&(this.last=b.prev),null!=b.prev&&(b.prev.next=b.next),null!=b.next&&(b.next.prev=b.prev);else throw A.thrown("Error on remove: "+J.string(a)+" is not in list.");},has:function(a){return this.itemMap.exists(a)},
__class__:Nd};var ze=function(a){this.first=this.last=null;this.itemMap=a};h["peote.view.utils.RenderList_peote_view_Program"]=ze;ze.__name__=!0;ze.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new mc(a,null,null);else if(null==b)b=this.first=new mc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new mc(a,c.prev,c),c==this.first&&(this.first=b);else throw A.thrown("Error on add: "+J.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=
new mc(a,null,null);else if(null==b)b=this.last=new mc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new mc(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+J.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:ze};var yb=function(){};h["peote.view.utils.TexUtils"]=yb;yb.__name__=
!0;yb.createEmptyTexture=function(a,b,c,e,f,g,d,h){null==h&&(h=!1);null==d&&(d=0);null==g&&(g=0);null==f&&(f=!1);e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);Ia.clearGlErrorQueue(a);if(h){h=a.TEXTURE_2D;var m=a.RGBA32F,l=a.RGBA,n=a.FLOAT,x=0;0==x?a.texImage2D(h,0,m,b,c,0,l,n,null):a.texImage2D(h,0,m,b,c,0,l,n,x);Ia.getLastGlError(a)==a.INVALID_VALUE&&(la.trace("switching to RGBA16F for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:25,className:"peote.view.utils.TexUtils",
methodName:"createEmptyTexture"}),h=a.TEXTURE_2D,m=a.RGBA16F,l=a.RGBA,n=a.FLOAT,x=0,0==x?a.texImage2D(h,0,m,b,c,0,l,n,null):a.texImage2D(h,0,m,b,c,0,l,n,x),Ia.getLastGlError(a)==a.INVALID_VALUE&&(la.trace("switching to RGBA for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:28,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),h=a.TEXTURE_2D,l=m=a.RGBA,n=a.FLOAT,x=0,0==x?a.texImage2D(h,0,m,b,c,0,l,n,null):a.texImage2D(h,0,m,b,c,0,l,n,x)))}else h=
a.TEXTURE_2D,l=m=a.RGBA,n=a.UNSIGNED_BYTE,x=0,0==x?a.texImage2D(h,0,m,b,c,0,l,n,null):a.texImage2D(h,0,m,b,c,0,l,n,x);if(Ia.getLastGlError(a)==a.OUT_OF_MEMORY)throw A.thrown("OUT OF GPU MEMORY while texture creation");1==g?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);if(f)switch(d){case 1:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);break;case 2:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST_MIPMAP_NEAREST);break;case 3:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST)}else 1==d?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);f&&a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,
null);return e};yb.createPickingTexture=function(a,b){null==b&&(b=!1);var c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);if(b){b=a.TEXTURE_2D;var e=a.RGBA32I,f=a.RGBA_INTEGER,g=a.INT,d=0}else b=a.TEXTURE_2D,f=e=a.RGBA,g=a.UNSIGNED_BYTE,d=0;0==d?a.texImage2D(b,0,e,1,1,0,f,g,null):a.texImage2D(b,0,e,1,1,0,f,g,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);return c};yb.optimalTextureSize=function(a,b,c,e,f,g){null==f&&(f=!0);g=Math.ceil(Math.log(e)/Math.log(2));for(var d=Math.ceil(Math.log(a*b*c)/Math.log(2)),h,m=1,n=d-1,x=Math.floor(Math.abs(m-n)),t=(1<<g)*(1<<g),p=!1,K=Math.floor(Math.min(g,d)),u;1<<K>=b;){for(u=Math.floor(Math.min(g,d-K+1));1<<u>=c&&!(Math.floor((1<<K)/b)*Math.floor((1<<u)/c)<a);){h=(1<<K)*(1<<u)-a*b*c;if(0>h)break;h<=t&&(h==t?Math.abs(K-u)<x&&(x=Math.floor(Math.abs(K-
u)),m=K,n=u,p=!0):(m=K,n=u,t=h,p=!0));--u}--K}if(p)m=1<<m,n=1<<n;else{if(f)throw A.thrown("Error: max texture-size ("+e+") is to small for "+a+" images ("+b+" x "+c+")");if(b>e||c>e)throw A.thrown("Error: max texture-size ("+e+") is to small for image ("+b+" x "+c+")");m=n=e}return{width:m,height:n,slotsX:m/b|0,slotsY:n/c|0,imageSlots:(m/b|0)*(n/c|0)}};var ic=function(){};h["peote.view.utils.Util"]=ic;ic.__name__=!0;ic.resolveFormulaCyclic=function(a){for(var b=[],c=a.h,e=Object.keys(c),f=e.length,
g=0;g<f;)if(c=e[g++],c=ic.resolveFormulaKey(c,a,b),null!=c.errKey)throw A.thrown(c);c=a.h;b=Object.keys(c);e=b.length;for(f=0;f<e;)c=b[f++],g=a.h[c].replace(/___:::___/g,""),a.h[c]=g};ic.resolveFormulaKey=function(a,b,c,e){null==e&&(e=[a]);null==c&&(c=[]);var f=b.h[a];if(0<=c.indexOf(a))return{formula:f,errKey:null,errVar:null};for(var g=Object.keys(b.h),d=g.length,h=0;h<d;){var m=g[h++];if(m!=a){var n=new da("(^|.*?[^\\w.])"+m+"\\b.*?","g");if(n.match(f)){if(0<=e.indexOf(m))return{formula:f,errKey:a,
errVar:m};m=ic.resolveFormulaKey(m,b,c,e.concat([m]));if(null!=m.errKey)return m;f=f.replace(n.r,"$1(___:::___"+m.formula+"___:::___)")}}}b.h[a]=f;c.push(a);return{formula:f,errKey:null,errVar:null}};ic.resolveFormulaVars=function(a,b){for(var c=a.h,e=Object.keys(c),f=e.length,g=0;g<f;){var d=e[g++],h=a.h[d];c=b.h;c=Object.keys(c);for(var m=c.length,n=0;n<m;){var x=c[n++],t=new da("(^|.*?[^\\w.])"+x+"\\b.*?","g");t.match(h)&&(h=h.replace(t.r,"$1("+b.h[x]+")"))}a.h[d]=h}};var vc=function(a){this.alwaysDraw=
!1;this.onInitComplete=function(){throw A.thrown("You must set onInitComplete function!");};this.assets=a;this.keyboard=new Be([])};h["tyke.PhysicalStageLoop"]=vc;vc.__name__=!0;vc.__super__=Lc;vc.prototype=H(Lc.prototype,{onInit:function(a){var b=this;Lc.prototype.onInit.call(this,a);this.assets.Preload(function(){b.initWorldAndStage();b.onInitComplete()})},initWorldAndStage:function(){this.stage=new Ce(this.display,this);this.world=V.start({width:this.display.width,height:this.display.height,gravity_y:100,
iterations:2})},onTick:function(a){return this.alwaysDraw?!0:!1},onDraw:function(a){V.step(this.world,a/1E3);this.stage.updateGraphicsBuffers()},onKeyDown:function(a,b){this.keyboard.handle(a,this)},__class__:vc});var Ac=function(a){var b=this;vc.call(this,a);this.onInitComplete=function(){b.initWorldAndStage();b.begin()}};h["samples.ShapesDemo"]=Ac;Ac.__name__=!0;Ac.__super__=vc;Ac.prototype=H(vc.prototype,{begin:function(){this.shapes=new De(this.world,this.stage);V.listen(this.world);this.alwaysDraw=
!0;this.gum.toggleUpdate(!0)},onTick:function(a){this.shapes.onTick(a);return vc.prototype.onTick.call(this,a)},onDraw:function(a){vc.prototype.onDraw.call(this,a)},onMouseMove:function(a,b){vc.prototype.onMouseMove.call(this,a,b);if(null!=this.shapes)this.shapes.onMouseMove(a,b)},__class__:Ac});var De=function(a,b){this.polygonSides=[3,3,3,3,5,7,11];this.timer=0;this.body_count=16;this.elapsedTicks=0;this.world=a;this.stage=b;this.shapesLayer=this.stage.createShapeRenderLayer();this.mouseBody=new zc(null,
{x:.5*b.get_width(),y:.5*b.get_height(),kinematic:!0,rotational_velocity:10,shape:{type:2,sides:3,radius:100,width:200,height:200,solid:!0}},this.world,this.shapesLayer,1157579946);new zc(null,{mass:0,elasticity:.3,x:.5*b.get_width(),y:.5*b.get_height(),shape:{type:0,width:.3*b.get_width(),height:.03*b.get_height()}},this.world,this.shapesLayer,-48043);V.listen(a,null,null,{enter:function(a,b,f){a.hardlight.collide(a,b,f);b.hardlight.collide(a,b,f)}})};h["samples.ShapeShaker"]=De;De.__name__=!0;De.prototype=
{onTick:function(a){this.elapsedTicks++;this.timer+=a;if(360<this.timer){a=q(68,102);var b=w();if(this.world.members.length<this.body_count){var c=w()?0:w()?2:1,e=b?-103:1145372569;2!=c||b||(e=-13369447);var f=1;1!=c&&(f=2==c?this.polygonSides[Math.ceil((this.polygonSides.length-1)*Math.random())]:4);new zc(null,{x:q(0,this.world.width),y:100,velocity_y:20,mass:4,elasticity:.3,rotational_velocity:q(-30,30),shape:{type:c,radius:.5*a,width:a,height:a,solid:b,sides:f}},this.world,this.shapesLayer,e)}this.timer=
0}a=0;for(b=this.world.members;a<b.length;)c=b[a],++a,this.isOutOfBounds(c)&&(e=c.velocity,e.x=0,e.y=0,c.set_position(q(0,this.world.width),0))},onMouseMove:function(a,b){this.mouseBody.body.set_position(a,b)},isOutOfBounds:function(a){a=a.bounds();var b=a.min_y>this.world.height||0>a.max_x||a.min_x>this.world.width;a.put();return b},__class__:De};var Ne=function(){};h["tyke.Collidable"]=Ne;Ne.__name__=!0;Ne.__isInterface__=!0;var zc=function(a,b,c,e,f){null==f&&(f=-855703297);this.debounceDelay=
50;this.body=V.make(c,b);this.body.on_move=d(this,this.onMove);this.body.on_rotate=d(this,this.onRotate);this.body.hardlight=this;this.entity=null==a?this:a;switch(this.body.shapes[0].type){case 1:a=Vc.CIRCLE;break;case 2:a=Vc.POLYGON(b.shape.sides);break;default:a=Vc.RECT}this.graphic=e.makeShape(b.x|0,b.y|0,b.shape.width|0,b.shape.height|0,a,f)};h["tyke.HardLight"]=zc;zc.__name__=!0;zc.__interfaces__=[Ne];zc.prototype={collide:function(a,b,c){a=(new Date).getTime();a-this.lastCollideTime>this.debounceDelay&&
(this.lastCollideTime=a,this.lit=!this.lit,this.graphic.color=this.graphic.color&-256|(this.lit?170:153))},onMove:function(a,b){this.graphic.setPosition(a,b)},onRotate:function(a){this.graphic.rotation=a},__class__:zc};var Od=function(){};h["tyke.IHaveGraphicsBuffer"]=Od;Od.__name__=!0;Od.__isInterface__=!0;Od.prototype={__class__:Od,__properties__:{get_program:"get_program"}};var Vc=y["tyke.Geometry"]={__ename__:!0,__constructs__:null,RECT:{_hx_name:"RECT",_hx_index:0,__enum__:"tyke.Geometry",toString:p},
CIRCLE:{_hx_name:"CIRCLE",_hx_index:1,__enum__:"tyke.Geometry",toString:p},POLYGON:(n=function(a){return{_hx_index:2,numSides:a,__enum__:"tyke.Geometry",toString:p}},n._hx_name="POLYGON",n.__params__=["numSides"],n)};Vc.__constructs__=[Vc.RECT,Vc.CIRCLE,Vc.POLYGON];var Ee=function(a){this.frameBuffer=a;this.buffers=[]};h["tyke.Layer"]=Ee;Ee.__name__=!0;Ee.prototype={updateGraphicsBuffers:function(){for(var a=0,b=this.buffers;a<b.length;){var c=b[a];++a;c.updateGraphicsBuffers()}},registerGraphicsBuffer:function(a){this.buffers.push(a)},
addProgramToFrameBuffer:function(a){this.frameBuffer.display.addProgram(a)},__class__:Ee};var ua=function(a,b,c,e,f,g,d){null==d&&(d=-1);null==g&&(g=3);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.shape=0;this.sides=3;this.x=this.y=0;this.color=-1430585089;this.w=this.h=100;this.px_offset=this.py_offset=this.rotation=0;this.x=a;this.y=b;this.w=c;this.h=e;this.shape=f;this.color=d;this.sides=g};h["tyke.Shape"]=ua;ua.__name__=!0;ua.prototype={setPosition:function(a,b){this.x=a;this.y=b},__class__:ua};
var Pd=function(a){null==a&&(a=256);this.buffer=new Jd(a,a,!0);this._program=new vd(this.buffer);this._program.setFragmentFloatPrecision("high");this._program.discardAtAlpha(null);this._program.injectIntoFragmentShader(ua.InjectFragment,!1);this._program.setColorFormula(ua.ColorFormula)};h["tyke.ShapeRenderer"]=Pd;Pd.__name__=!0;Pd.__interfaces__=[Od];Pd.prototype={get_program:function(){return this._program},makeShape:function(a,b,c,e,f,g){null==g&&(g=-855703297);switch(f._hx_index){case 0:var d=
0;break;case 1:d=1;break;default:d=2}switch(f._hx_index){case 1:f=1;break;case 2:f=f.numSides;break;default:f=4}f=new ua(a|0,b|0,c,e,d,f,g);this.buffer.addElement(f);return f},updateGraphicsBuffers:function(){this.buffer.update()},__class__:Pd,__properties__:{get_program:"get_program"}};var Be=function(a){this.sortOrder=[];this.bindings=new zb;for(var b=0;b<a.length;){var c=a[b];++b;this._bind(c)}};h["tyke.KeyPresses_tyke_PhysicalStageLoop"]=Be;Be.__name__=!0;Be.prototype={handle:function(a,b){this.lastHandled=
a;this.bindings.exists(a)&&this.bindings.get(a).handle(b)},_bind:function(a){this.sortOrder.push(a.code);this.bindings.set(a.code,a)},__class__:Be};var Ce=function(a,b){this.layers=new ha;this.display=a;this.coreLoop=b;b=new Kd(1);this.program=new vd(b);this.program.setFragmentFloatPrecision("high");this.program.alphaEnabled=!0;this.program.discardAtAlpha(null);a.addProgram(this.program);a=new ya(0,0,a.width,a.height);b.addElement(a);this.globalFrameBuffer=this.makeFrameBuffer("globalFramebuffer",
!1)};h["tyke.Stage"]=Ce;Ce.__name__=!0;Ce.prototype={chainFrameBuffer:function(a,b){this.program.addTexture(a.texture,b,!0)},makeFrameBuffer:function(a,b){b=this.coreLoop.getFrameBufferDisplay(this.display.x,this.display.y,this.display.width,this.display.height,b);this.chainFrameBuffer(b,a);return b},createLayer:function(a,b,c){null==c&&(c=!0);b=c?this.globalFrameBuffer:this.makeFrameBuffer(a,b);b=new Ee(b);return this.layers.h[a]=b},initGraphicsBuffer:function(a,b,c,e){c=this.createLayer(a,c,!e);
c.registerGraphicsBuffer(b);c.addProgramToFrameBuffer(b.get_program());this.layers.h[a]=c},createShapeRenderLayer:function(a,b){null==b&&(b=!1);null==a&&(a=!1);var c=new Pd;this.initGraphicsBuffer("echo",c,a,b);return c},updateGraphicsBuffers:function(){for(var a=this.layers.h,b=Object.keys(a),c=b.length,e=0;e<c;)a[b[e++]].updateGraphicsBuffers()},get_width:function(){return this.display.width},get_height:function(){return this.display.height},__class__:Ce,__properties__:{get_height:"get_height",
get_width:"get_width"}};var ya=function(a,b,c,e){null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.w=this.h=100;this.x=this.y=0;this.x=a;this.y=b;this.w=c;this.h=e};h["tyke.ViewElement"]=ya;ya.__name__=!0;ya.prototype={__class__:ya};var Sa=function(){};h["utils.Loader"]=Sa;Sa.__name__=!0;Sa.onProgressDebug=function(a,b,c){la.trace("...loading "+a+"/"+b+' of "'+c+'"',{fileName:"utils/Loader.hx",lineNumber:11,className:"utils.Loader",methodName:"onProgressDebug"})};Sa.onErrorDebug=function(a){la.trace("Error - "+
a,{fileName:"utils/Loader.hx",lineNumber:15,className:"utils.Loader",methodName:"onErrorDebug"})};Sa.onCompleteDebug=function(a){la.trace('Loading complete "'+a+'"',{fileName:"utils/Loader.hx",lineNumber:19,className:"utils.Loader",methodName:"onCompleteDebug"})};var Vb=y["utils._MultipassTemplate.TemplateExpr"]={__ename__:!0,__constructs__:null,OpVar:(n=function(a){return{_hx_index:0,v:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:p}},n._hx_name="OpVar",n.__params__=["v"],n),OpExpr:(n=
function(a){return{_hx_index:1,expr:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:p}},n._hx_name="OpExpr",n.__params__=["expr"],n),OpIf:(n=function(a,b,c){return{_hx_index:2,expr:a,eif:b,eelse:c,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:p}},n._hx_name="OpIf",n.__params__=["expr","eif","eelse"],n),OpStr:(n=function(a){return{_hx_index:3,str:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:p}},n._hx_name="OpStr",n.__params__=["str"],n),OpBlock:(n=function(a){return{_hx_index:4,
l:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:p}},n._hx_name="OpBlock",n.__params__=["l"],n),OpForeach:(n=function(a,b){return{_hx_index:5,expr:a,loop:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:p}},n._hx_name="OpForeach",n.__params__=["expr","loop"],n),OpMacro:(n=function(a,b){return{_hx_index:6,name:a,params:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:p}},n._hx_name="OpMacro",n.__params__=["name","params"],n)};Vb.__constructs__=[Vb.OpVar,Vb.OpExpr,
Vb.OpIf,Vb.OpStr,Vb.OpBlock,Vb.OpForeach,Vb.OpMacro];var wa=function(a){a=this.parseTokens(a);this.expr=this.parseBlock(a);if(!a.isEmpty())throw A.thrown("Unexpected '"+J.string(a.first().s)+"'");};h["utils.MultipassTemplate"]=wa;wa.__name__=!0;wa.prototype={execute:function(a,b){this.macros=null==b?{}:b;this.context=a;this.stack=new Tb;this.buf=new Fa;this.run(this.expr);return this.buf.b},resolve:function(a){if("__current__"==a)return this.context;var b=B.getProperty(this.context,a);if(null!=b||
Object.prototype.hasOwnProperty.call(this.context,a))return b;for(var c=this.stack.h;null!=c;){b=c.item;c=c.next;var e=b;b=B.getProperty(e,a);if(null!=b||Object.prototype.hasOwnProperty.call(e,a))return b}if(!Object.prototype.hasOwnProperty.call(wa.globals,a))throw A.thrown(a);return B.field(wa.globals,a)},parseTokens:function(a){for(var b=new Tb;wa.splitter.match(a);){var c=wa.splitter.matchedPos();0<c.pos&&b.add({p:z.substr(a,0,c.pos),s:!0,l:null});if(58==z.cca(a,c.pos))b.add({p:z.substr(a,c.pos+
2,c.len-4),s:!1,l:null}),a=wa.splitter.matchedRight();else{c=c.pos+c.len;for(var e=1,f=[],g="";;){var d=z.cca(a,c);++c;if(40==d)++e;else if(41==d){if(--e,0>=e)break}else if(null==d)throw A.thrown("Unclosed macro parenthesis");44==d&&1==e?(f.push(g),g=""):g+=String.fromCodePoint(d)}f.push(g);b.add({p:wa.splitter.matched(2),s:!1,l:f});a=z.substr(a,c,a.length-c)}}0<a.length&&b.add({p:a,s:!0,l:null});return b},parseBlock:function(a){for(var b=new Tb;;){var c=a.first();if(null==c)break;if(!c.s&&("end"==
c.p||"else"==c.p||"elseif "==z.substr(c.p,0,7)))break;b.add(this.parse(a))}return 1==b.length?b.first():Vb.OpBlock(b)},parse:function(a){var b=a.pop(),c=b.p;if(b.s)return Vb.OpStr(c);if(null!=b.l){a=new Tb;var e=0;for(b=b.l;e<b.length;){var f=b[e];++e;a.add(this.parseBlock(this.parseTokens(f)))}return Vb.OpMacro(c,a)}if("if "==z.substr(c,0,3)){c=z.substr(c,3,c.length-3);e=null;try{e=this.parseExpr(c)}catch(g){ja.lastError=g;b=A.caught(g).unwrap();if("string"==typeof b)throw la.trace(b,{fileName:"utils/MultipassTemplate.hx",
lineNumber:211,className:"utils.MultipassTemplate",methodName:"parse"}),A.thrown(b);throw g;}c=this.parseBlock(a);b=a.first();if(null==b)throw A.thrown("Unclosed 'if'");if("end"==b.p)a.pop(),f=null;else if("else"==b.p){if(a.pop(),f=this.parseBlock(a),b=a.pop(),null==b||"end"!=b.p)throw A.thrown("Unclosed 'else'");}else b.p=z.substr(b.p,4,b.p.length-4),f=this.parse(a);return Vb.OpIf(e,c,f)}if("foreach "==z.substr(c,0,8)){c=z.substr(c,8,c.length-8);e=this.parseExpr(c);c=this.parseBlock(a);b=a.pop();
if(null==b||"end"!=b.p)throw A.thrown("Unclosed 'foreach'");return Vb.OpForeach(e,c)}return wa.expr_splitter.match(c)?Vb.OpExpr(this.parseExpr(c)):Vb.OpVar(c)},parseExpr:function(a){for(var b=new Tb,c=a;wa.expr_splitter.match(a);){var e=wa.expr_splitter.matchedPos();0!=e.pos&&b.add({p:z.substr(a,0,e.pos),s:!0});a=wa.expr_splitter.matched(0);b.add({p:a,s:0<=a.indexOf('"')});a=wa.expr_splitter.matchedRight()}0!=a.length&&b.add({p:a,s:!0});try{var f=this.makeExpr(b);if(!b.isEmpty())throw A.thrown(b.first().p);
}catch(g){ja.lastError=g;b=A.caught(g).unwrap();if("string"==typeof b)throw A.thrown("Unexpected '"+b+"' in "+c);throw g;}return function(){try{return f()}catch(v){ja.lastError=v;var a=A.caught(v).unwrap();throw A.thrown({v:a,expr:c});}}},makeConst:function(a){wa.expr_trim.match(a);a=wa.expr_trim.matched(1);if(34==z.cca(a,0)){var b=z.substr(a,1,a.length-2);return function(){return b}}if(wa.expr_int.match(a)){var c=J.parseInt(a);return function(){return c}}if(wa.expr_float.match(a)){var e=parseFloat(a);
return function(){return e}}var f=this;return function(){return f.resolve(a)}},makePath:function(a,b){var c=b.first();if(null==c||"."!=c.p)return a;b.pop();c=b.pop();if(null==c||!c.s)throw A.thrown(c.p);var e=c.p;wa.expr_trim.match(e);e=wa.expr_trim.matched(1);return this.makePath(function(){return B.field(a(),e)},b)},makeExpr:function(a){return this.makePath(this.makeExpr2(a),a)},makeExpr2:function(a){var b=a.pop();if(null==b)throw A.thrown("<eof>");if(b.s)return this.makeConst(b.p);switch(b.p){case "!":var c=
this.makeExpr(a);return function(){var a=c();return null!=a?0==a:!0};case "(":var e=this.makeExpr(a);b=a.pop();if(null==b||b.s)throw A.thrown(b);if(")"==b.p)return e;var f=this.makeExpr(a);a=a.pop();if(null==a||")"!=a.p)throw A.thrown(a);switch(b.p){case "!=":return function(){return e()!=f()};case "&&":return function(){return e()&&f()};case "*":return function(){return e()*f()};case "+":return function(){return e()+f()};case "-":return function(){return e()-f()};case "/":return function(){return e()/
f()};case "<":return function(){return e()<f()};case "<=":return function(){return e()<=f()};case "==":return function(){return e()==f()};case ">":return function(){return e()>f()};case ">=":return function(){return e()>=f()};case "||":return function(){return e()||f()};default:throw A.thrown("Unknown operation "+b.p);}case "-":var d=this.makeExpr(a);return function(){return-d()}}throw A.thrown(b.p);},run:function(a){switch(a._hx_index){case 0:var b=a.v;try{var c=this.buf,e=J.string(this.resolve(b));
c.b+=J.string(e)}catch(oc){ja.lastError=oc,this.buf.b+=J.string("::"+b+"::")}break;case 1:var f=a.expr;try{c=this.buf,e=J.string(f()),c.b+=J.string(e)}catch(oc){ja.lastError=oc,b=A.caught(oc).unwrap(),this.buf.b+=J.string("::("+J.string(b.expr)+")::")}break;case 2:f=a.expr;e=a.eif;c=a.eelse;try{b=f(),null==b||0==b?null!=c&&this.run(c):this.run(e)}catch(oc){ja.lastError=oc,b=A.caught(oc).unwrap(),this.buf.b+=J.string("::if "+J.string(b.expr)+"::"),this.run(e),null!=c&&(this.buf.b+="::else::",this.run(c)),
this.buf.b+="::end::"}break;case 3:b=a.str;this.buf.b+=null==b?"null":""+b;break;case 4:for(a=a.l.h;null!=a;){var g=a.item;a=a.next;f=g;this.run(f)}break;case 5:f=a.expr;c=a.loop;try{b=f();try{e=E(b);if(null==e.hasNext)throw A.thrown(null);b=e}catch(oc){ja.lastError=oc;try{if(null==b.hasNext)throw A.thrown(null);}catch(N){throw A.thrown("Cannot iter on "+J.string(b));}}for(this.stack.push(this.context);b.hasNext();)this.context=b.next(),this.run(c);this.context=this.stack.pop()}catch(oc){ja.lastError=
oc,b=A.caught(oc).unwrap(),this.buf.b+=J.string("::foreach "+J.string(b.v)+"::"),this.run(c),this.buf.b+="::end::"}break;case 6:f=a.name;a=a.params;b=B.field(this.macros,f);var h=[],m=this.buf;h.push(d(this,this.resolve));for(a=a.h;null!=a;)g=a.item,a=a.next,0==g._hx_index?(g=g.v,h.push(this.resolve(g))):(this.buf=new Fa,this.run(g),h.push(this.buf.b));this.buf=m;try{c=this.buf,e=J.string(b.apply(this.macros,h)),c.b+=J.string(e)}catch(oc){ja.lastError=oc;a=A.caught(oc).unwrap();try{var n=h.join(",")}catch(N){n=
"???"}b="Macro call "+f+"("+n+") failed ("+J.string(a)+")";throw A.thrown(b);}}},__class__:wa};r.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(z.now=performance.now.bind(performance));h.Math=Math;null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=h.String=String;String.__name__=!0;h.Array=Array;Array.__name__=!0;Date.prototype.__class__=
h.Date=Date;Date.__name__="Date";var We={},Ue={},Ve=Number,Te=Boolean,Xe={},Ye={};Sb.count=0;ra.__toStr={}.toString;var Qe=new Uint32Array(256);Hb.__alpha16=Qe;for(var wc=0;256>wc;){var Wc=wc++;Hb.__alpha16[Wc]=Math.ceil(257.00392156862745*Wc)}Qe=new Uint8Array(511);Hb.__clamp=Qe;for(wc=0;255>wc;)Wc=wc++,Hb.__clamp[Wc]=Wc;for(wc=255;511>wc;)Wc=wc++,Hb.__clamp[Wc]=255;sa.level=3;"undefined"==typeof console&&(console={});null==console.log&&(console.log=function(){});x.default_mass=-1;x.minimum_mass=
1E-4;x.ids=0;na.qr=[];na.sqr=[];V.cached_listeners=new xa;V.cached_collisions=[];V.cached_body=new x({mass:1});Jb.pool=new jb(Jb);fc.global=new fc(null,null,null,null,null);pc.pool=new Tc(pc);qc.pool=new cd(qc);Rb.pool=new yd(Rb);Fb.pool=new dd(Fb);ac.pool=new ed(ac);Ra.pool=new zd(Ra);Kb.pool=new Ec(Kb);hb.pool=new fd(hb);Ma.pool=new Mc(Ma);ta.norm=new P(0,0);ta.closest=new P(0,0);ob.DEFAULT_RESOLVER=new id;ob.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";bb.LEN_EXTRA_BITS_TBL=
[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];bb.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];bb.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1];bb.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];bb.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];R.activeRequests=0;R.requestLimit=
17;R.requestQueue=new Tb;kd.windowID=0;vb.DICTIONARY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");vb.EXTENDED_DICTIONARY=function(a){a=[];for(var b=0,c=vb.DICTIONARY;b<c.length;){var e=c[b];++b;for(var f=0,d=vb.DICTIONARY;f<d.length;){var h=d[f];++f;a.push(e+h)}}return a}(this);Cb.sensorByID=new zb;Cb.sensors=[];cb.devices=new zb;cb.onConnect=new se;Pa.devices=new zb;Pa.onConnect=new te;Ib.onCancel=new Kc;Ib.onEnd=new Kc;Ib.onMove=new Kc;Ib.onStart=new Kc;Z.cache=new we;
Z.onChange=new Qa;Z.bundlePaths=new ha;Z.libraries=new ha;Z.libraryPaths=new ha;sa.throwErrors=!0;W.isES3=!1;W.isUBO=!1;W.isINSTANCED=!1;W.isVAO=!1;Za.VertexFloat={high:0,medium:0,low:0};Za.VertexInt={high:0,medium:0,low:0};Za.VertexSampler={high:0,medium:0,low:0};Za.FragmentFloat={high:0,medium:0,low:0};Za.FragmentInt={high:0,medium:0,low:0};Za.FragmentSampler={high:0,medium:0,low:0};Ia.rEmptylines=new da("([ \t]*\r?\n)+","g");Ia.rStartspaces=new da("^([ \t]*\r?\n)+","g");ua.__meta__={fields:{px_offset:{pivotX:null,
formula:["w * 0.5 + px_offset"]},py_offset:{pivotY:null,formula:["h * 0.5 + py_offset"]},rotation:{rotation:null},w:{sizeX:null,varying:null},h:{sizeY:null,varying:null},color:{color:null},x:{posX:null,set:["Position"]},y:{posY:null,set:["Position"]},sides:{custom:null,varying:null},shape:{custom:null,varying:null}}};ua.InjectFragment="\n    #define PI 3.14159265359\n    #define TWO_PI 6.28318530718\n    \n    // from the book of shaders https://thebookofshaders.com/07/\n\t// only triangle is correct at the moment\n\t// todo ! calculate r for n sided polygons\n\t// or use vertices data from echo shape\n    vec4 polygon(vec4 c, float sides){\n        // Remap the coord for\n        vec2 coord = vTexCoord;\n        coord.y = (1.0 - coord.y);\n\n        // Remap the space to -1. to 1.\n        vec2 st = coord * 2.0-1.0;\n\n        // Angle and radius from the current pixel\n        float r = TWO_PI/sides;\n        float a = atan(st.x,st.y) + PI;\n\n        // Shaping function that modulate the distance\n        float d = cos(floor(.5+a/r)*r-a)*length(st);\n        float A = 1.0-smoothstep(.5,.51,d) == 1.0 ? c.a : 0.0;\n        return vec4(c.rgb, A);\n    }\n\n    // // https://github.com/ayamflow/glsl-2d-primitives/blob/master/polygon.glsl\n    // vec4 polygon(vec4 c, float sides){\n    //     vec2 st = vTexCoord * 2.0 - 1.0;\n    //     st.y  = (1.0 - st.y);\n    //     float angle = atan(st.x,st.y) + PI;\n    //     float slice = TWO_PI / sides;\n    //     // float radius = 0.4;\n    //     float radius = 0.5;//1.0;//0.7;//sides / 10.0;\n    //     // float x = vSize.x; \n    //     // float radius = 1.0 / cos(x) * (180.0 / sides);\n    //     float s = step(radius, cos(floor(0.5 + angle / slice ) * slice - angle) * length(st));\n    //     float A = 1.0 - s == 1.0 ? c.a : 0.0;\n    //     return vec4(c.rgb, A);\n    // }\n\n    float circle(vec2 st, float radius)\n    {\n        vec2 dist = st-vec2(0.5);\n        return 1.-smoothstep(radius-(radius*0.01),\n                             radius+(radius*0.01),\n                             dot(dist,dist)*4.0\n                            );\n    }\n\n    vec4 compose(vec4 c, float shapeType, float numSides){\n        // return vec4(0.8,0.8,0.8,1.0);\n        if(shapeType <= 0.0 ){\n            return c;\n        }\n        // circle\n        if(shapeType == 1.0){\n            float a = circle(vTexCoord, 1.0) == 1.0 ? c.a : 0.0;\n\t\t\treturn vec4(c.rgb, a);\n        }\n        // polygon\n        return polygon(c, numSides);\n    }\n    ";
ua.ColorFormula="compose(color, shape, sides)";ua.FORMULAS=function(a){a=new ha;a.h.py_offset="h * 0.5 + py_offset";a.h.px_offset="w * 0.5 + px_offset";return a}(this);ua.ATTRIBUTES=function(a){a=new ha;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.sidesStart="aFloat0.x";a.h.sidesEnd="aFloat0.x";a.h.sides="aFloat0.x";a.h.shapeStart="aFloat0.y";a.h.shapeEnd="aFloat0.y";a.h.shape=
"aFloat0.y";a.h.rotationStart="aRotZ";a.h.rotationEnd="aRotZ";a.h.rotation="aRotZ";a.h.py_offsetStart="aPivot.y";a.h.py_offsetEnd="aPivot.y";a.h.py_offset="aPivot.y";a.h.px_offsetStart="aPivot.x";a.h.px_offsetEnd="aPivot.x";a.h.px_offset="aPivot.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);ua.FORMULA_NAMES=function(a){a=new ha;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.rotation="rotation";a.h.pivotX="px_offset";a.h.pivotY="py_offset";return a}(this);ua.FORMULA_VARYINGS=
"sides,shape";ua.FORMULA_CONSTANTS="";ua.DEFAULT_FORMULA_VARS=new ha;ya.__meta__={fields:{x:{posX:null},y:{posY:null},w:{sizeX:null},h:{sizeY:null}}};ya.FORMULAS=new ha;ya.ATTRIBUTES=function(a){a=new ha;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);ya.FORMULA_NAMES=function(a){a=new ha;a.h.sizeX="w";a.h.sizeY="h";
a.h.posX="x";a.h.posY="y";return a}(this);ya.FORMULA_VARYINGS="";ya.FORMULA_CONSTANTS="";ya.DEFAULT_FORMULA_VARS=new ha;Sa.corsServer="";wa.splitter=new da('(::[A-Za-z0-9_ ()&|!+=/><*."-]+::|\\$\\$([A-Za-z0-9_-]+)\\()',"");wa.expr_splitter=new da('(\\(|\\)|[ \r\n\t]*"[^"]*"[ \r\n\t]*|[!+=/><*.&|-]+)',"");wa.expr_trim=new da("^[ ]*([^ ]+)[ ]*$","");wa.expr_int=new da("^[0-9]+$","");wa.expr_float=new da("^([+-]?)(?=\\d|,\\d)\\d*(,\\d*)?([Ee]([+-]?\\d+))?$","");wa.globals={};O.main()})("undefined"!=
typeof k?k:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof q?q:"undefined"!=typeof self?self:this)};I.lime.embed=function(r){var q={},w=I.lime.$scripts[r];if(!w)throw Error('Cannot find project name "'+r+'"');w(q,k);for(var D in q)I[D]=I[D]||q[D];(w=q.lime||window.lime)&&w.embed&&this!=w.embed&&w.embed.apply(w,arguments);return q};"function"==typeof define&&define.amd&&(define([],function(){return I.lime}),define.__amd=define.amd,
define.amd=null)})("undefined"!=typeof exports?exports:"function"==typeof define&&define.amd?{}:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
!function(){var I=function(){this.init()};I.prototype={init:function(){var d=this||k;return d._counter=1E3,d._html5AudioPool=[],d.html5PoolSize=10,d._codecs={},d._howls=[],d._muted=!1,d._volume=1,d._canPlayEvent="canplaythrough",d._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,d.masterGain=null,d.noAudio=!1,d.usingWebAudio=!0,d.autoSuspend=!0,d.ctx=null,d.autoUnlock=!0,d._setup(),d},volume:function(d){var h=this||k;if(d=parseFloat(d),h.ctx||E(),void 0!==d&&0<=d&&1>=
d){if(h._volume=d,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(d,k.ctx.currentTime);for(var p=0;p<h._howls.length;p++)if(!h._howls[p]._webAudio)for(var y=h._howls[p]._getSoundIds(),n=0;n<y.length;n++){var q=h._howls[p]._soundById(y[n]);q&&q._node&&(q._node.volume=q._volume*d)}return h}return h._volume},mute:function(d){var h=this||k;h.ctx||E();h._muted=d;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(d?0:h._volume,k.ctx.currentTime);for(var p=0;p<h._howls.length;p++)if(!h._howls[p]._webAudio)for(var y=
h._howls[p]._getSoundIds(),n=0;n<y.length;n++){var q=h._howls[p]._soundById(y[n]);q&&q._node&&(q._node.muted=!!d||q._muted)}return h},unload:function(){for(var d=this||k,h=d._howls.length-1;0<=h;h--)d._howls[h].unload();return d.usingWebAudio&&d.ctx&&void 0!==d.ctx.close&&(d.ctx.close(),d.ctx=null,E()),d},codecs:function(d){return(this||k)._codecs[d.replace(/^x-/,"")]},_setup:function(){var d=this||k;if(d.state=d.ctx?d.ctx.state||"suspended":"suspended",d._autoSuspend(),!d.usingWebAudio)if("undefined"!=
typeof Audio)try{var h=new Audio;void 0===h.oncanplaythrough&&(d._canPlayEvent="canplay")}catch(p){d.noAudio=!0}else d.noAudio=!0;try{h=new Audio,h.muted&&(d.noAudio=!0)}catch(p){}return d.noAudio||d._setupCodecs(),d},_setupCodecs:function(){var d=this||k,h=null;try{h="undefined"!=typeof Audio?new Audio:null}catch(n){return d}if(!h||"function"!=typeof h.canPlayType)return d;var p=h.canPlayType("audio/mpeg;").replace(/^no$/,""),y=d._navigator&&d._navigator.userAgent.match(/OPR\/([0-6].)/g);y=y&&33>
parseInt(y[0].split("/")[1],10);return d._codecs={mp3:!(y||!p&&!h.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!p,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!h.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||
h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},d},_unlockAudio:function(){var d=
this||k,h=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(d._navigator&&d._navigator.userAgent);if(!d._audioUnlocked&&d.ctx&&h){d._audioUnlocked=!1;d.autoUnlock=!1;d._mobileUnloaded||44100===d.ctx.sampleRate||(d._mobileUnloaded=!0,d.unload());d._scratchBuffer=d.ctx.createBuffer(1,1,22050);var p=function(h){for(h=0;h<d.html5PoolSize;h++){var n=new Audio;n._unlocked=!0;d._releaseHtml5Audio(n)}for(h=0;h<d._howls.length;h++)if(!d._howls[h]._webAudio){n=d._howls[h]._getSoundIds();
for(var k=0;k<n.length;k++){var q=d._howls[h]._soundById(n[k]);q&&q._node&&!q._node._unlocked&&(q._node._unlocked=!0,q._node.load())}}d._autoResume();var y=d.ctx.createBufferSource();y.buffer=d._scratchBuffer;y.connect(d.ctx.destination);void 0===y.start?y.noteOn(0):y.start(0);"function"==typeof d.ctx.resume&&d.ctx.resume();y.onended=function(){y.disconnect(0);d._audioUnlocked=!0;document.removeEventListener("touchstart",p,!0);document.removeEventListener("touchend",p,!0);document.removeEventListener("click",
p,!0);for(var h=0;h<d._howls.length;h++)d._howls[h]._emit("unlock")}};return document.addEventListener("touchstart",p,!0),document.addEventListener("touchend",p,!0),document.addEventListener("click",p,!0),d}},_obtainHtml5Audio:function(){var d=this||k;if(d._html5AudioPool.length)return d._html5AudioPool.pop();d=(new Audio).play();return d&&"undefined"!=typeof Promise&&(d instanceof Promise||"function"==typeof d.then)&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),
new Audio},_releaseHtml5Audio:function(d){var h=this||k;return d._unlocked&&h._html5AudioPool.push(d),h},_autoSuspend:function(){var d=this;if(d.autoSuspend&&d.ctx&&void 0!==d.ctx.suspend&&k.usingWebAudio){for(var h=0;h<d._howls.length;h++)if(d._howls[h]._webAudio)for(var p=0;p<d._howls[h]._sounds.length;p++)if(!d._howls[h]._sounds[p]._paused)return d;return d._suspendTimer&&clearTimeout(d._suspendTimer),d._suspendTimer=setTimeout(function(){d.autoSuspend&&(d._suspendTimer=null,d.state="suspending",
d.ctx.suspend().then(function(){d.state="suspended";d._resumeAfterSuspend&&(delete d._resumeAfterSuspend,d._autoResume())}))},3E4),d}},_autoResume:function(){var d=this;if(d.ctx&&void 0!==d.ctx.resume&&k.usingWebAudio)return"running"===d.state&&d._suspendTimer?(clearTimeout(d._suspendTimer),d._suspendTimer=null):"suspended"===d.state?(d.ctx.resume().then(function(){d.state="running";for(var h=0;h<d._howls.length;h++)d._howls[h]._emit("resume")}),d._suspendTimer&&(clearTimeout(d._suspendTimer),d._suspendTimer=
null)):"suspending"===d.state&&(d._resumeAfterSuspend=!0),d}};var k=new I,r=function(d){if(!d.src||0===d.src.length)return void console.error("An array of source files must be passed with any new Howl.");this.init(d)};r.prototype={init:function(d){var h=this;return k.ctx||E(),h._autoplay=d.autoplay||!1,h._format="string"!=typeof d.format?d.format:[d.format],h._html5=d.html5||!1,h._muted=d.mute||!1,h._loop=d.loop||!1,h._pool=d.pool||5,h._preload="boolean"!=typeof d.preload||d.preload,h._rate=d.rate||
1,h._sprite=d.sprite||{},h._src="string"!=typeof d.src?d.src:[d.src],h._volume=void 0!==d.volume?d.volume:1,h._xhrWithCredentials=d.xhrWithCredentials||!1,h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=d.onend?[{fn:d.onend}]:[],h._onfade=d.onfade?[{fn:d.onfade}]:[],h._onload=d.onload?[{fn:d.onload}]:[],h._onloaderror=d.onloaderror?[{fn:d.onloaderror}]:[],h._onplayerror=d.onplayerror?[{fn:d.onplayerror}]:[],h._onpause=d.onpause?[{fn:d.onpause}]:[],
h._onplay=d.onplay?[{fn:d.onplay}]:[],h._onstop=d.onstop?[{fn:d.onstop}]:[],h._onmute=d.onmute?[{fn:d.onmute}]:[],h._onvolume=d.onvolume?[{fn:d.onvolume}]:[],h._onrate=d.onrate?[{fn:d.onrate}]:[],h._onseek=d.onseek?[{fn:d.onseek}]:[],h._onunlock=d.onunlock?[{fn:d.onunlock}]:[],h._onresume=[],h._webAudio=k.usingWebAudio&&!h._html5,void 0!==k.ctx&&k.ctx&&k.autoUnlock&&k._unlockAudio(),k._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&h.load(),h},load:function(){var d=
null;if(k.noAudio)return void this._emit("loaderror",null,"No audio support.");"string"==typeof this._src&&(this._src=[this._src]);for(var h=0;h<this._src.length;h++){var p;if(this._format&&this._format[h])var y=this._format[h];else{if("string"!=typeof(p=this._src[h])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(y=/^data:audio\/([^;,]+);/i.exec(p))||(y=/\.([^.]+)$/.exec(p.split("?",1)[0]));y&&(y=y[1].toLowerCase())}if(y||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),
y&&k.codecs(y)){d=this._src[h];break}}return d?(this._src=d,this._state="loading","https:"===window.location.protocol&&"http:"===d.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new q(this),this._webAudio&&D(this),this):void this._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(d,h){var p=this,q=null;if("number"==typeof d)q=d,d=null;else{if("string"==typeof d&&"loaded"===p._state&&!p._sprite[d])return null;if(void 0===d&&(d="__default",!p._playLock)){for(var n=
0,w=0;w<p._sounds.length;w++)p._sounds[w]._paused&&!p._sounds[w]._ended&&(n++,q=p._sounds[w]._id);1===n?d=null:q=null}}var r=q?p._soundById(q):p._inactiveSound();if(!r)return null;if(q&&!d&&(d=r._sprite||"__default"),"loaded"!==p._state){r._sprite=d;r._ended=!1;var H=r._id;return p._queue.push({event:"play",action:function(){p.play(H)}}),H}if(q&&!r._paused)return h||p._loadQueue("play"),r._id;p._webAudio&&k._autoResume();var E=Math.max(0,0<r._seek?r._seek:p._sprite[d][0]/1E3),F=Math.max(0,(p._sprite[d][0]+
p._sprite[d][1])/1E3-E),D=1E3*F/Math.abs(r._rate),I=p._sprite[d][0]/1E3,M=(p._sprite[d][0]+p._sprite[d][1])/1E3,da=!(!r._loop&&!p._sprite[d][2]);r._sprite=d;r._ended=!1;var z=function(){r._paused=!1;r._seek=E;r._start=I;r._stop=M;r._loop=da};if(E>=M)return void p._ended(r);var C=r._node;if(p._webAudio)q=function(){p._playLock=!1;z();p._refreshBuffer(r);C.gain.setValueAtTime(r._muted||p._muted?0:r._volume,k.ctx.currentTime);r._playStart=k.ctx.currentTime;void 0===C.bufferSource.start?r._loop?C.bufferSource.noteGrainOn(0,
E,86400):C.bufferSource.noteGrainOn(0,E,F):r._loop?C.bufferSource.start(0,E,86400):C.bufferSource.start(0,E,F);D!==1/0&&(p._endTimers[r._id]=setTimeout(p._ended.bind(p,r),D));h||setTimeout(function(){p._emit("play",r._id);p._loadQueue()},0)},"running"===k.state?q():(p._playLock=!0,p.once("resume",q),p._clearTimer(r._id));else{var ea=function(){C.currentTime=E;C.muted=r._muted||p._muted||k._muted||C.muted;C.volume=r._volume*k.volume();C.playbackRate=r._rate;try{var n=C.play();if(n&&"undefined"!=typeof Promise&&
(n instanceof Promise||"function"==typeof n.then)?(p._playLock=!0,z(),n.then(function(){p._playLock=!1;C._unlocked=!0;h||(p._emit("play",r._id),p._loadQueue())}).catch(function(){p._playLock=!1;p._emit("playerror",r._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");r._ended=!0;r._paused=!0})):h||(p._playLock=!1,z(),p._emit("play",r._id),p._loadQueue()),C.playbackRate=r._rate,C.paused)return void p._emit("playerror",
r._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==d||r._loop?p._endTimers[r._id]=setTimeout(p._ended.bind(p,r),D):(p._endTimers[r._id]=function(){p._ended(r);C.removeEventListener("ended",p._endTimers[r._id],!1)},C.addEventListener("ended",p._endTimers[r._id],!1))}catch(Na){p._emit("playerror",r._id,Na)}};q=window&&window.ejecta||!C.readyState&&k._navigator.isCocoonJS;if(3<=C.readyState||
q)ea();else{p._playLock=!0;var S=function(){ea();C.removeEventListener(k._canPlayEvent,S,!1)};C.addEventListener(k._canPlayEvent,S,!1);p._clearTimer(r._id)}}return r._id},pause:function(d,h){var p=this;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"pause",action:function(){p.pause(d)}}),p;for(var k=p._getSoundIds(d),n=0;n<k.length;n++){p._clearTimer(k[n]);var q=p._soundById(k[n]);if(q&&!q._paused&&(q._seek=p.seek(k[n]),q._rateSeek=0,q._paused=!0,p._stopFade(k[n]),q._node))if(p._webAudio){if(!q._node.bufferSource)continue;
void 0===q._node.bufferSource.stop?q._node.bufferSource.noteOff(0):q._node.bufferSource.stop(0);p._cleanBuffer(q._node)}else isNaN(q._node.duration)&&q._node.duration!==1/0||q._node.pause();h||p._emit("pause",q?q._id:null)}return p},stop:function(d,h){var p=this;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(d)}}),p;for(var k=p._getSoundIds(d),n=0;n<k.length;n++){p._clearTimer(k[n]);var q=p._soundById(k[n]);q&&(q._seek=q._start||0,q._rateSeek=0,q._paused=
!0,q._ended=!0,p._stopFade(k[n]),q._node&&(p._webAudio?q._node.bufferSource&&(void 0===q._node.bufferSource.stop?q._node.bufferSource.noteOff(0):q._node.bufferSource.stop(0),p._cleanBuffer(q._node)):isNaN(q._node.duration)&&q._node.duration!==1/0||(q._node.currentTime=q._start||0,q._node.pause())),h||p._emit("stop",q._id))}return p},mute:function(d,h){var p=this;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(d,h)}}),p;if(void 0===h){if("boolean"!=typeof d)return p._muted;
p._muted=d}for(var q=p._getSoundIds(h),n=0;n<q.length;n++){var r=p._soundById(q[n]);r&&(r._muted=d,r._interval&&p._stopFade(r._id),p._webAudio&&r._node?r._node.gain.setValueAtTime(d?0:r._volume,k.ctx.currentTime):r._node&&(r._node.muted=!!k._muted||d),p._emit("mute",r._id))}return p},volume:function(){var d,h,p=this,q=arguments;if(0===q.length)return p._volume;1===q.length||2===q.length&&void 0===q[1]?0<=p._getSoundIds().indexOf(q[0])?h=parseInt(q[0],10):d=parseFloat(q[0]):2<=q.length&&(d=parseFloat(q[0]),
h=parseInt(q[1],10));var n;if(!(void 0!==d&&0<=d&&1>=d))return n=h?p._soundById(h):p._sounds[0],n?n._volume:0;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"volume",action:function(){p.volume.apply(p,q)}}),p;void 0===h&&(p._volume=d);h=p._getSoundIds(h);for(var r=0;r<h.length;r++)(n=p._soundById(h[r]))&&(n._volume=d,q[2]||p._stopFade(h[r]),p._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(d,k.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=d*k.volume()),p._emit("volume",
n._id));return p},fade:function(d,h,p,q){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"fade",action:function(){n.fade(d,h,p,q)}}),n;d=parseFloat(d);h=parseFloat(h);p=parseFloat(p);n.volume(d,q);for(var r=n._getSoundIds(q),y=0;y<r.length;y++){var w=n._soundById(r[y]);if(w){if(q||n._stopFade(r[y]),n._webAudio&&!w._muted){var H=k.ctx.currentTime,E=H+p/1E3;w._volume=d;w._node.gain.setValueAtTime(d,H);w._node.gain.linearRampToValueAtTime(h,E)}n._startFadeInterval(w,d,h,p,
r[y],void 0===q)}}return n},_startFadeInterval:function(d,h,p,k,n,q){var r=this,y=h,w=p-h;n=Math.abs(w/.01);n=Math.max(4,0<n?k/n:k);var H=Date.now();d._fadeTo=p;d._interval=setInterval(function(){var n=(Date.now()-H)/k;H=Date.now();y+=w*n;y=Math.max(0,y);y=Math.min(1,y);y=Math.round(100*y)/100;r._webAudio?d._volume=y:r.volume(y,d._id,!0);q&&(r._volume=y);(p<h&&y<=p||p>h&&y>=p)&&(clearInterval(d._interval),d._interval=null,d._fadeTo=null,r.volume(p,d._id),r._emit("fade",d._id))},n)},_stopFade:function(d){var h=
this._soundById(d);return h&&h._interval&&(this._webAudio&&h._node.gain.cancelScheduledValues(k.ctx.currentTime),clearInterval(h._interval),h._interval=null,this.volume(h._fadeTo,d),h._fadeTo=null,this._emit("fade",d)),this},loop:function(){var d,h,p,k=arguments;if(0===k.length)return this._loop;if(1===k.length){if("boolean"!=typeof k[0])return!!(p=this._soundById(parseInt(k[0],10)))&&p._loop;this._loop=d=k[0]}else 2===k.length&&(d=k[0],h=parseInt(k[1],10));h=this._getSoundIds(h);for(k=0;k<h.length;k++)(p=
this._soundById(h[k]))&&(p._loop=d,this._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=d,d&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop)));return this},rate:function(){var d,h,p=this,q=arguments;0===q.length?h=p._sounds[0]._id:1===q.length?0<=p._getSoundIds().indexOf(q[0])?h=parseInt(q[0],10):d=parseFloat(q[0]):2===q.length&&(d=parseFloat(q[0]),h=parseInt(q[1],10));var n;if("number"!=typeof d)return n=p._soundById(h),n?n._rate:p._rate;if("loaded"!==
p._state||p._playLock)return p._queue.push({event:"rate",action:function(){p.rate.apply(p,q)}}),p;void 0===h&&(p._rate=d);h=p._getSoundIds(h);for(var r=0;r<h.length;r++)if(n=p._soundById(h[r])){p.playing(h[r])&&(n._rateSeek=p.seek(h[r]),n._playStart=p._webAudio?k.ctx.currentTime:n._playStart);n._rate=d;p._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(d,k.ctx.currentTime):n._node&&(n._node.playbackRate=d);var w=p.seek(h[r]);w=1E3*((p._sprite[n._sprite][0]+
p._sprite[n._sprite][1])/1E3-w)/Math.abs(n._rate);!p._endTimers[h[r]]&&n._paused||(p._clearTimer(h[r]),p._endTimers[h[r]]=setTimeout(p._ended.bind(p,n),w));p._emit("rate",n._id)}return p},seek:function(){var d,h,p=this,q=arguments;0===q.length?h=p._sounds[0]._id:1===q.length?0<=p._getSoundIds().indexOf(q[0])?h=parseInt(q[0],10):p._sounds.length&&(h=p._sounds[0]._id,d=parseFloat(q[0])):2===q.length&&(d=parseFloat(q[0]),h=parseInt(q[1],10));if(void 0===h)return p;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"seek",
action:function(){p.seek.apply(p,q)}}),p;var n=p._soundById(h);if(n){if(!("number"==typeof d&&0<=d))return p._webAudio?(d=p.playing(h)?k.ctx.currentTime-n._playStart:0,n._seek+((n._rateSeek?n._rateSeek-n._seek:0)+d*Math.abs(n._rate))):n._node.currentTime;var r=p.playing(h);r&&p.pause(h,!0);n._seek=d;n._ended=!1;p._clearTimer(h);p._webAudio||!n._node||isNaN(n._node.duration)||(n._node.currentTime=d);var w=function(){p._emit("seek",h);r&&p.play(h,!0)};if(r&&!p._webAudio){var H=function(){p._playLock?
setTimeout(H,0):w()};setTimeout(H,0)}else w()}return p},playing:function(d){if("number"==typeof d)return d=this._soundById(d),!!d&&!d._paused;for(d=0;d<this._sounds.length;d++)if(!this._sounds[d]._paused)return!0;return!1},duration:function(d){var h=this._duration;d=this._soundById(d);return d&&(h=this._sprite[d._sprite][1]/1E3),h},state:function(){return this._state},unload:function(){for(var d=this._sounds,h=0;h<d.length;h++)(d[h]._paused||this.stop(d[h]._id),this._webAudio)||(/MSIE |Trident\//.test(k._navigator&&
k._navigator.userAgent)||(d[h]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),d[h]._node.removeEventListener("error",d[h]._errorFn,!1),d[h]._node.removeEventListener(k._canPlayEvent,d[h]._loadFn,!1),k._releaseHtml5Audio(d[h]._node)),delete d[h]._node,this._clearTimer(d[h]._id);h=k._howls.indexOf(this);0<=h&&k._howls.splice(h,1);d=!0;for(h=0;h<k._howls.length;h++)if(k._howls[h]._src===this._src||0<=this._src.indexOf(k._howls[h]._src)){d=!1;break}return w&&
d&&delete w[this._src],k.noAudio=!1,this._state="unloaded",this._sounds=[],null},on:function(d,h,p,k){d=this["_on"+d];return"function"==typeof h&&d.push(k?{id:p,fn:h,once:k}:{id:p,fn:h}),this},off:function(d,h,p){var k=this["_on"+d];if("number"==typeof h&&(p=h,h=null),h||p)for(d=0;d<k.length;d++){var n=p===k[d].id;if(h===k[d].fn&&n||!h&&n){k.splice(d,1);break}}else if(d)this["_on"+d]=[];else for(h=Object.keys(this),d=0;d<h.length;d++)0===h[d].indexOf("_on")&&Array.isArray(this[h[d]])&&(this[h[d]]=
[]);return this},once:function(d,h,p){return this.on(d,h,p,1),this},_emit:function(d,h,p){for(var k=this["_on"+d],n=k.length-1;0<=n;n--)k[n].id&&k[n].id!==h&&"load"!==d||(setTimeout(function(d){d.call(this,h,p)}.bind(this,k[n].fn),0),k[n].once&&this.off(d,k[n].fn,k[n].id));return this._loadQueue(d),this},_loadQueue:function(d){if(0<this._queue.length){var h=this._queue[0];h.event===d&&(this._queue.shift(),this._loadQueue());d||h.action()}return this},_ended:function(d){var h=d._sprite;if(!this._webAudio&&
d._node&&!d._node.paused&&!d._node.ended&&d._node.currentTime<d._stop)return setTimeout(this._ended.bind(this,d),100),this;h=!(!d._loop&&!this._sprite[h][2]);if(this._emit("end",d._id),!this._webAudio&&h&&this.stop(d._id,!0).play(d._id),this._webAudio&&h){this._emit("play",d._id);d._seek=d._start||0;d._rateSeek=0;d._playStart=k.ctx.currentTime;var p=1E3*(d._stop-d._start)/Math.abs(d._rate);this._endTimers[d._id]=setTimeout(this._ended.bind(this,d),p)}return this._webAudio&&!h&&(d._paused=!0,d._ended=
!0,d._seek=d._start||0,d._rateSeek=0,this._clearTimer(d._id),this._cleanBuffer(d._node),k._autoSuspend()),this._webAudio||h||this.stop(d._id,!0),this},_clearTimer:function(d){if(this._endTimers[d]){if("function"!=typeof this._endTimers[d])clearTimeout(this._endTimers[d]);else{var h=this._soundById(d);h&&h._node&&h._node.removeEventListener("ended",this._endTimers[d],!1)}delete this._endTimers[d]}return this},_soundById:function(d){for(var h=0;h<this._sounds.length;h++)if(d===this._sounds[h]._id)return this._sounds[h];
return null},_inactiveSound:function(){this._drain();for(var d=0;d<this._sounds.length;d++)if(this._sounds[d]._ended)return this._sounds[d].reset();return new q(this)},_drain:function(){var d=this._pool,h=0,p;if(!(this._sounds.length<d)){for(p=0;p<this._sounds.length;p++)this._sounds[p]._ended&&h++;for(p=this._sounds.length-1;0<=p&&!(h<=d);p--)this._sounds[p]._ended&&(this._webAudio&&this._sounds[p]._node&&this._sounds[p]._node.disconnect(0),this._sounds.splice(p,1),h--)}},_getSoundIds:function(d){if(void 0===
d){d=[];for(var h=0;h<this._sounds.length;h++)d.push(this._sounds[h]._id);return d}return[d]},_refreshBuffer:function(d){return d._node.bufferSource=k.ctx.createBufferSource(),d._node.bufferSource.buffer=w[this._src],d._panner?d._node.bufferSource.connect(d._panner):d._node.bufferSource.connect(d._node),d._node.bufferSource.loop=d._loop,d._loop&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop||0),d._node.bufferSource.playbackRate.setValueAtTime(d._rate,k.ctx.currentTime),
this},_cleanBuffer:function(d){var h=k._navigator&&0<=k._navigator.vendor.indexOf("Apple");if(k._scratchBuffer&&d.bufferSource&&(d.bufferSource.onended=null,d.bufferSource.disconnect(0),h))try{d.bufferSource.buffer=k._scratchBuffer}catch(p){}return d.bufferSource=null,this}};var q=function(d){this._parent=d;this.init()};q.prototype={init:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._paused=!0,this._ended=!0,
this._sprite="__default",this._id=++k._counter,d._sounds.push(this),this.create(),this},create:function(){var d=this._parent,h=k._muted||this._muted||this._parent._muted?0:this._volume;return d._webAudio?(this._node=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),this._node.gain.setValueAtTime(h,k.ctx.currentTime),this._node.paused=!0,this._node.connect(k.masterGain)):(this._node=k._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",
this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(k._canPlayEvent,this._loadFn,!1),this._node.src=d._src,this._node.preload="auto",this._node.volume=h*k.volume(),this._node.load()),this},reset:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++k._counter,this},_errorListener:function(){this._parent._emit("loaderror",
this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var d=this._parent;d._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue());this._node.removeEventListener(k._canPlayEvent,this._loadFn,!1)}};var w={},D=function(d){var h=d._src;if(w[h])return d._duration=w[h].duration,void F(d);
if(/^data:[^;]+;base64,/.test(h)){for(var p=atob(h.split(",")[1]),k=new Uint8Array(p.length),n=0;n<p.length;++n)k[n]=p.charCodeAt(n);M(k.buffer,d)}else{var q=new XMLHttpRequest;q.open("GET",h,!0);q.withCredentials=d._xhrWithCredentials;q.responseType="arraybuffer";q.onload=function(){var h=(q.status+"")[0];if("0"!==h&&"2"!==h&&"3"!==h)return void d._emit("loaderror",null,"Failed loading audio file with status: "+q.status+".");M(q.response,d)};q.onerror=function(){d._webAudio&&(d._html5=!0,d._webAudio=
!1,d._sounds=[],delete w[h],d.load())};H(q)}},H=function(d){try{d.send()}catch(h){d.onerror()}},M=function(d,h){var p=function(){h._emit("loaderror",null,"Decoding audio data failed.")},q=function(d){d&&0<h._sounds.length?(w[h._src]=d,F(h,d)):p()};"undefined"!=typeof Promise&&1===k.ctx.decodeAudioData.length?k.ctx.decodeAudioData(d).then(q).catch(p):k.ctx.decodeAudioData(d,q,p)},F=function(d,h){h&&!d._duration&&(d._duration=h.duration);0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*
d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue())},E=function(){if(k.usingWebAudio){try{"undefined"!=typeof AudioContext?k.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?k.ctx=new webkitAudioContext:k.usingWebAudio=!1}catch(p){k.usingWebAudio=!1}k.ctx||(k.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(k._navigator&&k._navigator.platform),h=k._navigator&&k._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);h=h?parseInt(h[1],10):null;d&&h&&9>h&&(d=
/safari/.test(k._navigator&&k._navigator.userAgent.toLowerCase()),(k._navigator&&k._navigator.standalone&&!d||k._navigator&&!k._navigator.standalone&&!d)&&(k.usingWebAudio=!1));k.usingWebAudio&&(k.masterGain=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),k.masterGain.gain.setValueAtTime(k._muted?0:1,k.ctx.currentTime),k.masterGain.connect(k.ctx.destination));k._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:k,Howl:r}});"undefined"!=typeof exports&&
(exports.Howler=k,exports.Howl=r);"undefined"!=typeof window?(window.HowlerGlobal=I,window.Howler=k,window.Howl=r,window.Sound=q):"undefined"!=typeof global&&(global.HowlerGlobal=I,global.Howler=k,global.Howl=r,global.Sound=q)}();
!function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(k){if(!this.ctx||!this.ctx.listener)return this;for(var r=this._howls.length-1;0<=r;r--)this._howls[r].stereo(k);return this};HowlerGlobal.prototype.pos=function(k,r,q){return this.ctx&&this.ctx.listener?(r="number"!=typeof r?this._pos[1]:r,q="number"!=typeof q?this._pos[2]:q,"number"!=typeof k?this._pos:(this._pos=[k,r,q],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],
Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this};HowlerGlobal.prototype.orientation=function(k,r,q,w,D,H){if(!this.ctx||!this.ctx.listener)return this;var I=this._orientation;return r="number"!=typeof r?I[1]:r,q="number"!=typeof q?I[2]:q,w="number"!=typeof w?I[3]:w,D="number"!=
typeof D?I[4]:D,H="number"!=typeof H?I[5]:H,"number"!=typeof k?I:(this._orientation=[k,r,q,w,D,H],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(q,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(q,
Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(k,r,q,w,D,H),this)};Howl.prototype.init=function(k){return function(r){return this._orientation=r.orientation||[1,0,0],this._stereo=r.stereo||null,this._pos=r.pos||null,this._pannerAttr={coneInnerAngle:void 0!==r.coneInnerAngle?r.coneInnerAngle:360,coneOuterAngle:void 0!==r.coneOuterAngle?r.coneOuterAngle:360,coneOuterGain:void 0!==r.coneOuterGain?r.coneOuterGain:0,distanceModel:void 0!==r.distanceModel?r.distanceModel:"inverse",maxDistance:void 0!==
r.maxDistance?r.maxDistance:1E4,panningModel:void 0!==r.panningModel?r.panningModel:"HRTF",refDistance:void 0!==r.refDistance?r.refDistance:1,rolloffFactor:void 0!==r.rolloffFactor?r.rolloffFactor:1},this._onstereo=r.onstereo?[{fn:r.onstereo}]:[],this._onpos=r.onpos?[{fn:r.onpos}]:[],this._onorientation=r.onorientation?[{fn:r.onorientation}]:[],k.call(this,r)}}(Howl.prototype.init);Howl.prototype.stereo=function(k,r){var q=this;if(!q._webAudio)return q;if("loaded"!==q._state)return q._queue.push({event:"stereo",
action:function(){q.stereo(k,r)}}),q;var w=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===r){if("number"!=typeof k)return q._stereo;q._stereo=k;q._pos=[k,0,0]}for(var D=q._getSoundIds(r),H=0;H<D.length;H++){var M=q._soundById(D[H]);if(M){if("number"!=typeof k)return M._stereo;M._stereo=k;M._pos=[k,0,0];M._node&&(M._pannerAttr.panningModel="equalpower",M._panner&&M._panner.pan||I(M,w),"spatial"===w?void 0!==M._panner.positionX?(M._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),
M._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),M._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):M._panner.setPosition(k,0,0):M._panner.pan.setValueAtTime(k,Howler.ctx.currentTime));q._emit("stereo",M._id)}}return q};Howl.prototype.pos=function(k,r,q,w){var D=this;if(!D._webAudio)return D;if("loaded"!==D._state)return D._queue.push({event:"pos",action:function(){D.pos(k,r,q,w)}}),D;if(r="number"!=typeof r?0:r,q="number"!=typeof q?-.5:q,void 0===w){if("number"!=typeof k)return D._pos;
D._pos=[k,r,q]}for(var H=D._getSoundIds(w),M=0;M<H.length;M++){var F=D._soundById(H[M]);if(F){if("number"!=typeof k)return F._pos;F._pos=[k,r,q];F._node&&(F._panner&&!F._panner.pan||I(F,"spatial"),void 0!==F._panner.positionX?(F._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),F._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),F._panner.positionZ.setValueAtTime(q,Howler.ctx.currentTime)):F._panner.setPosition(k,r,q));D._emit("pos",F._id)}}return D};Howl.prototype.orientation=function(k,
r,q,w){var D=this;if(!D._webAudio)return D;if("loaded"!==D._state)return D._queue.push({event:"orientation",action:function(){D.orientation(k,r,q,w)}}),D;if(r="number"!=typeof r?D._orientation[1]:r,q="number"!=typeof q?D._orientation[2]:q,void 0===w){if("number"!=typeof k)return D._orientation;D._orientation=[k,r,q]}for(var H=D._getSoundIds(w),M=0;M<H.length;M++){var F=D._soundById(H[M]);if(F){if("number"!=typeof k)return F._orientation;F._orientation=[k,r,q];F._node&&(F._panner||(F._pos||(F._pos=
D._pos||[0,0,-.5]),I(F,"spatial")),void 0!==F._panner.orientationX?(F._panner.orientationX.setValueAtTime(k,Howler.ctx.currentTime),F._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),F._panner.orientationZ.setValueAtTime(q,Howler.ctx.currentTime)):F._panner.setOrientation(k,r,q));D._emit("orientation",F._id)}}return D};Howl.prototype.pannerAttr=function(){var k,r,q=arguments;if(!this._webAudio)return this;if(0===q.length)return this._pannerAttr;if(1===q.length){if("object"!=typeof q[0])return r=
this._soundById(parseInt(q[0],10)),r?r._pannerAttr:this._pannerAttr;var w=q[0];void 0===k&&(w.pannerAttr||(w.pannerAttr={coneInnerAngle:w.coneInnerAngle,coneOuterAngle:w.coneOuterAngle,coneOuterGain:w.coneOuterGain,distanceModel:w.distanceModel,maxDistance:w.maxDistance,refDistance:w.refDistance,rolloffFactor:w.rolloffFactor,panningModel:w.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==w.pannerAttr.coneInnerAngle?w.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==w.pannerAttr.coneOuterAngle?
w.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==w.pannerAttr.coneOuterGain?w.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==w.pannerAttr.distanceModel?w.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==w.pannerAttr.maxDistance?w.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==w.pannerAttr.refDistance?w.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==w.pannerAttr.rolloffFactor?w.pannerAttr.rolloffFactor:this._rolloffFactor,
panningModel:void 0!==w.pannerAttr.panningModel?w.pannerAttr.panningModel:this._panningModel})}else 2===q.length&&(w=q[0],k=parseInt(q[1],10));k=this._getSoundIds(k);for(q=0;q<k.length;q++)if(r=this._soundById(k[q])){var D=r._pannerAttr;D={coneInnerAngle:void 0!==w.coneInnerAngle?w.coneInnerAngle:D.coneInnerAngle,coneOuterAngle:void 0!==w.coneOuterAngle?w.coneOuterAngle:D.coneOuterAngle,coneOuterGain:void 0!==w.coneOuterGain?w.coneOuterGain:D.coneOuterGain,distanceModel:void 0!==w.distanceModel?w.distanceModel:
D.distanceModel,maxDistance:void 0!==w.maxDistance?w.maxDistance:D.maxDistance,refDistance:void 0!==w.refDistance?w.refDistance:D.refDistance,rolloffFactor:void 0!==w.rolloffFactor?w.rolloffFactor:D.rolloffFactor,panningModel:void 0!==w.panningModel?w.panningModel:D.panningModel};var H=r._panner;H?(H.coneInnerAngle=D.coneInnerAngle,H.coneOuterAngle=D.coneOuterAngle,H.coneOuterGain=D.coneOuterGain,H.distanceModel=D.distanceModel,H.maxDistance=D.maxDistance,H.refDistance=D.refDistance,H.rolloffFactor=
D.rolloffFactor,H.panningModel=D.panningModel):(r._pos||(r._pos=this._pos||[0,0,-.5]),I(r,"spatial"))}return this};Sound.prototype.init=function(k){return function(){var r=this._parent;this._orientation=r._orientation;this._stereo=r._stereo;this._pos=r._pos;this._pannerAttr=r._pannerAttr;k.call(this);this._stereo?r.stereo(this._stereo):this._pos&&r.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init);Sound.prototype.reset=function(k){return function(){var r=this._parent;return this._orientation=
r._orientation,this._stereo=r._stereo,this._pos=r._pos,this._pannerAttr=r._pannerAttr,this._stereo?r.stereo(this._stereo):this._pos?r.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,r._refreshBuffer(this)),k.call(this)}}(Sound.prototype.reset);var I=function(k,r){"spatial"===(r||"spatial")?(k._panner=Howler.ctx.createPanner(),k._panner.coneInnerAngle=k._pannerAttr.coneInnerAngle,k._panner.coneOuterAngle=k._pannerAttr.coneOuterAngle,
k._panner.coneOuterGain=k._pannerAttr.coneOuterGain,k._panner.distanceModel=k._pannerAttr.distanceModel,k._panner.maxDistance=k._pannerAttr.maxDistance,k._panner.refDistance=k._pannerAttr.refDistance,k._panner.rolloffFactor=k._pannerAttr.rolloffFactor,k._panner.panningModel=k._pannerAttr.panningModel,void 0!==k._panner.positionX?(k._panner.positionX.setValueAtTime(k._pos[0],Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(k._pos[1],Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(k._pos[2],
Howler.ctx.currentTime)):k._panner.setPosition(k._pos[0],k._pos[1],k._pos[2]),void 0!==k._panner.orientationX?(k._panner.orientationX.setValueAtTime(k._orientation[0],Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(k._orientation[1],Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(k._orientation[2],Howler.ctx.currentTime)):k._panner.setOrientation(k._orientation[0],k._orientation[1],k._orientation[2])):(k._panner=Howler.ctx.createStereoPanner(),k._panner.pan.setValueAtTime(k._stereo,
Howler.ctx.currentTime));k._panner.connect(k._node);k._paused||k._parent.pause(k._id,!0).play(k._id,!0)}}();
!function(I){"object"==typeof exports&&"undefined"!=typeof module?module.exports=I():"function"==typeof define&&define.amd?define([],I):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=I()}(function(){return function w(k,r,q){function D(F,E){if(!r[F]){if(!k[F]){var d="function"==typeof require&&require;if(!E&&d)return d(F,!0);if(H)return H(F,!0);E=Error("Cannot find module '"+F+"'");throw E.code="MODULE_NOT_FOUND",E;}E=r[F]={exports:{}};
k[F][0].call(E.exports,function(d){var h=k[F][1][d];return D(h?h:d)},E,E.exports,w,k,r,q)}return r[F].exports}for(var H="function"==typeof require&&require,M=0;M<q.length;M++)D(q[M]);return D}({1:[function(k,r,q){function w(k){if(!(this instanceof w))return new w(k);k=this.options=M.assign({level:y,method:Q,chunkSize:16384,windowBits:15,memLevel:8,strategy:n,to:""},k||{});k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&16>k.windowBits&&(k.windowBits+=16);this.err=0;this.msg=
"";this.ended=!1;this.chunks=[];this.strm=new d;this.strm.avail_out=0;var q=H.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(q!==p)throw Error(E[q]);if(k.header&&H.deflateSetHeader(this.strm,k.header),k.dictionary){var r;if(r="string"==typeof k.dictionary?F.string2buf(k.dictionary):"[object ArrayBuffer]"===h.call(k.dictionary)?new Uint8Array(k.dictionary):k.dictionary,q=H.deflateSetDictionary(this.strm,r),q!==p)throw Error(E[q]);this._dict_set=!0}}function D(d,h){h=
new w(h);if(h.push(d,!0),h.err)throw h.msg;return h.result}var H=k("./zlib/deflate"),M=k("./utils/common"),F=k("./utils/strings"),E=k("./zlib/messages"),d=k("./zlib/zstream"),h=Object.prototype.toString,p=0,y=-1,n=0,Q=8;w.prototype.push=function(d,n){var k,q=this.strm,r=this.options.chunkSize;if(this.ended)return!1;n=n===~~n?n:!0===n?4:0;"string"==typeof d?q.input=F.string2buf(d):"[object ArrayBuffer]"===h.call(d)?q.input=new Uint8Array(d):q.input=d;q.next_in=0;q.avail_in=q.input.length;do{if(0===
q.avail_out&&(q.output=new M.Buf8(r),q.next_out=0,q.avail_out=r),k=H.deflate(q,n),1!==k&&k!==p)return this.onEnd(k),this.ended=!0,!1;0!==q.avail_out&&(0!==q.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(F.buf2binstring(M.shrinkBuf(q.output,q.next_out))):this.onData(M.shrinkBuf(q.output,q.next_out)))}while((0<q.avail_in||0===q.avail_out)&&1!==k);return 4===n?(k=H.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===p):2!==n||(this.onEnd(p),q.avail_out=0,!0)};w.prototype.onData=
function(d){this.chunks.push(d)};w.prototype.onEnd=function(d){d===p&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=M.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};q.Deflate=w;q.deflate=D;q.deflateRaw=function(d,h){return h=h||{},h.raw=!0,D(d,h)};q.gzip=function(d,h){return h=h||{},h.gzip=!0,D(d,h)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(k,r,q){function w(n){if(!(this instanceof
w))return new w(n);var k=this.options=M.assign({chunkSize:16384,windowBits:0,to:""},n||{});k.raw&&0<=k.windowBits&&16>k.windowBits&&(k.windowBits=-k.windowBits,0===k.windowBits&&(k.windowBits=-15));!(0<=k.windowBits&&16>k.windowBits)||n&&n.windowBits||(k.windowBits+=32);15<k.windowBits&&48>k.windowBits&&0===(15&k.windowBits)&&(k.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new h;this.strm.avail_out=0;n=H.inflateInit2(this.strm,k.windowBits);if(n!==E.Z_OK)throw Error(d[n]);
this.header=new p;H.inflateGetHeader(this.strm,this.header)}function D(d,h){h=new w(h);if(h.push(d,!0),h.err)throw h.msg;return h.result}var H=k("./zlib/inflate"),M=k("./utils/common"),F=k("./utils/strings"),E=k("./zlib/constants"),d=k("./zlib/messages"),h=k("./zlib/zstream"),p=k("./zlib/gzheader"),y=Object.prototype.toString;w.prototype.push=function(d,h){var n,p,k,q,r,w=this.strm,D=this.options.chunkSize,Q=this.options.dictionary,z=!1;if(this.ended)return!1;h=h===~~h?h:!0===h?E.Z_FINISH:E.Z_NO_FLUSH;
"string"==typeof d?w.input=F.binstring2buf(d):"[object ArrayBuffer]"===y.call(d)?w.input=new Uint8Array(d):w.input=d;w.next_in=0;w.avail_in=w.input.length;do{if(0===w.avail_out&&(w.output=new M.Buf8(D),w.next_out=0,w.avail_out=D),n=H.inflate(w,E.Z_NO_FLUSH),n===E.Z_NEED_DICT&&Q&&(r="string"==typeof Q?F.string2buf(Q):"[object ArrayBuffer]"===y.call(Q)?new Uint8Array(Q):Q,n=H.inflateSetDictionary(this.strm,r)),n===E.Z_BUF_ERROR&&!0===z&&(n=E.Z_OK,z=!1),n!==E.Z_STREAM_END&&n!==E.Z_OK)return this.onEnd(n),
this.ended=!0,!1;w.next_out&&(0!==w.avail_out&&n!==E.Z_STREAM_END&&(0!==w.avail_in||h!==E.Z_FINISH&&h!==E.Z_SYNC_FLUSH)||("string"===this.options.to?(p=F.utf8border(w.output,w.next_out),k=w.next_out-p,q=F.buf2string(w.output,p),w.next_out=k,w.avail_out=D-k,k&&M.arraySet(w.output,w.output,p,k,0),this.onData(q)):this.onData(M.shrinkBuf(w.output,w.next_out))));0===w.avail_in&&0===w.avail_out&&(z=!0)}while((0<w.avail_in||0===w.avail_out)&&n!==E.Z_STREAM_END);return n===E.Z_STREAM_END&&(h=E.Z_FINISH),
h===E.Z_FINISH?(n=H.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===E.Z_OK):h!==E.Z_SYNC_FLUSH||(this.onEnd(E.Z_OK),w.avail_out=0,!0)};w.prototype.onData=function(d){this.chunks.push(d)};w.prototype.onEnd=function(d){d===E.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=M.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};q.Inflate=w;q.inflate=D;q.inflateRaw=function(d,h){return h=h||{},h.raw=!0,D(d,h)};q.ungzip=D},{"./utils/common":3,
"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(k,r,q){k="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;q.assign=function(k){for(var q=Array.prototype.slice.call(arguments,1);q.length;){var r=q.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var w in r)r.hasOwnProperty(w)&&(k[w]=r[w])}}return k};q.shrinkBuf=function(k,q){return k.length===
q?k:k.subarray?k.subarray(0,q):(k.length=q,k)};var w={arraySet:function(k,q,r,w,d){if(q.subarray&&k.subarray)return void k.set(q.subarray(r,r+w),d);for(var h=0;h<w;h++)k[d+h]=q[r+h]},flattenChunks:function(k){var q,r;var w=r=0;for(q=k.length;w<q;w++)r+=k[w].length;var d=new Uint8Array(r);w=r=0;for(q=k.length;w<q;w++){var h=k[w];d.set(h,r);r+=h.length}return d}},D={arraySet:function(k,q,r,w,d){for(var h=0;h<w;h++)k[d+h]=q[r+h]},flattenChunks:function(k){return[].concat.apply([],k)}};q.setTyped=function(k){k?
(q.Buf8=Uint8Array,q.Buf16=Uint16Array,q.Buf32=Int32Array,q.assign(q,w)):(q.Buf8=Array,q.Buf16=Array,q.Buf32=Array,q.assign(q,D))};q.setTyped(k)},{}],4:[function(k,r,q){function w(k,d){if(65537>d&&(k.subarray&&M||!k.subarray&&H))return String.fromCharCode.apply(null,D.shrinkBuf(k,d));for(var h="",p=0;p<d;p++)h+=String.fromCharCode(k[p]);return h}var D=k("./common"),H=!0,M=!0;try{String.fromCharCode.apply(null,[0])}catch(E){H=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(E){M=!1}var F=
new D.Buf8(256);for(k=0;256>k;k++)F[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;F[254]=F[254]=1;q.string2buf=function(k){var d,h,p,q=k.length,n=0;for(h=0;h<q;h++){var r=k.charCodeAt(h);55296===(64512&r)&&h+1<q&&(d=k.charCodeAt(h+1),56320===(64512&d)&&(r=65536+(r-55296<<10)+(d-56320),h++));n+=128>r?1:2048>r?2:65536>r?3:4}var w=new D.Buf8(n);for(h=p=0;p<n;h++)r=k.charCodeAt(h),55296===(64512&r)&&h+1<q&&(d=k.charCodeAt(h+1),56320===(64512&d)&&(r=65536+(r-55296<<10)+(d-56320),h++)),128>r?w[p++]=
r:2048>r?(w[p++]=192|r>>>6,w[p++]=128|63&r):65536>r?(w[p++]=224|r>>>12,w[p++]=128|r>>>6&63,w[p++]=128|63&r):(w[p++]=240|r>>>18,w[p++]=128|r>>>12&63,w[p++]=128|r>>>6&63,w[p++]=128|63&r);return w};q.buf2binstring=function(k){return w(k,k.length)};q.binstring2buf=function(k){for(var d=new D.Buf8(k.length),h=0,p=d.length;h<p;h++)d[h]=k.charCodeAt(h);return d};q.buf2string=function(k,d){var h,p,q,n=d||k.length,r=Array(2*n);for(d=h=0;d<n;)if(p=k[d++],128>p)r[h++]=p;else if(q=F[p],4<q)r[h++]=65533,d+=q-
1;else{for(p&=2===q?31:3===q?15:7;1<q&&d<n;)p=p<<6|63&k[d++],q--;1<q?r[h++]=65533:65536>p?r[h++]=p:(p-=65536,r[h++]=55296|p>>10&1023,r[h++]=56320|1023&p)}return w(r,h)};q.utf8border=function(k,d){var h;d=d||k.length;d>k.length&&(d=k.length);for(h=d-1;0<=h&&128===(192&k[h]);)h--;return 0>h?d:0===h?d:h+F[k[h]]>d?h:d}},{"./common":3}],5:[function(k,r,q){r.exports=function(k,q,r,M){var w=65535&k|0;k=k>>>16&65535|0;for(var H;0!==r;){H=2E3<r?2E3:r;r-=H;do w=w+q[M++]|0,k=k+w|0;while(--H);w%=65521;k%=65521}return w|
k<<16|0}},{}],6:[function(k,r,q){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(k,r,q){var w=function(){for(var k,q=[],r=0;256>r;r++){k=r;
for(var w=0;8>w;w++)k=1&k?3988292384^k>>>1:k>>>1;q[r]=k}return q}();r.exports=function(k,q,r,F){r=F+r;for(k^=-1;F<r;F++)k=k>>>8^w[255&(k^q[F])];return k^-1}},{}],8:[function(k,r,q){function w(d,h){return d.msg=da[h],h}function D(d){for(var h=d.length;0<=--h;)d[h]=0}function H(d){var h=d.state,m=h.pending;m>d.avail_out&&(m=d.avail_out);0!==m&&(ca.arraySet(d.output,h.pending_buf,h.pending_out,m,d.next_out),d.next_out+=m,h.pending_out+=m,d.total_out+=m,d.avail_out-=m,h.pending-=m,0===h.pending&&(h.pending_out=
0))}function M(d,h){pa._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,h);d.block_start=d.strstart;H(d.strm)}function F(d,h){d.pending_buf[d.pending++]=h}function E(d,h){d.pending_buf[d.pending++]=h>>>8&255;d.pending_buf[d.pending++]=255&h}function d(d,h){var m,n,k=d.max_chain_length,p=d.strstart,q=d.prev_length,u=d.nice_match,r=d.strstart>d.w_size-fa?d.strstart-(d.w_size-fa):0,z=d.window,w=d.w_mask,y=d.prev,C=d.strstart+ba,B=z[p+q-1],H=z[p+q];d.prev_length>=d.good_match&&
(k>>=2);u>d.lookahead&&(u=d.lookahead);do if(m=h,z[m+q]===H&&z[m+q-1]===B&&z[m]===z[p]&&z[++m]===z[p+1]){p+=2;for(m++;z[++p]===z[++m]&&z[++p]===z[++m]&&z[++p]===z[++m]&&z[++p]===z[++m]&&z[++p]===z[++m]&&z[++p]===z[++m]&&z[++p]===z[++m]&&z[++p]===z[++m]&&p<C;);if(n=ba-(C-p),p=C-ba,n>q){if(d.match_start=h,q=n,n>=u)break;B=z[p+q-1];H=z[p+q]}}while((h=y[h&w])>r&&0!==--k);return q<=d.lookahead?q:d.lookahead}function h(d){var h,m,n=d.w_size;do{if(m=d.window_size-d.lookahead-d.strstart,d.strstart>=n+(n-
fa)){ca.arraySet(d.window,d.window,n,n,0);d.match_start-=n;d.strstart-=n;d.block_start-=n;var k=h=d.hash_size;do{var p=d.head[--k];d.head[k]=p>=n?p-n:0}while(--h);k=h=n;do p=d.prev[--k],d.prev[k]=p>=n?p-n:0;while(--h);m+=n}if(0===d.strm.avail_in)break;k=d.strm;p=d.window;var q=d.strstart+d.lookahead,u=k.avail_in;if(h=(u>m&&(u=m),0===u?0:(k.avail_in-=u,ca.arraySet(p,k.input,k.next_in,u,q),1===k.state.wrap?k.adler=Y(k.adler,p,u,q):2===k.state.wrap&&(k.adler=O(k.adler,p,u,q)),k.next_in+=u,k.total_in+=
u,u)),d.lookahead+=h,d.lookahead+d.insert>=aa)for(m=d.strstart-d.insert,d.ins_h=d.window[m],d.ins_h=(d.ins_h<<d.hash_shift^d.window[m+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[m+aa-1])&d.hash_mask,d.prev[m&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=m,m++,d.insert--,!(d.lookahead+d.insert<aa)););}while(d.lookahead<fa&&0!==d.strm.avail_in)}function p(m,n){for(var k,x;;){if(m.lookahead<fa){if(h(m),m.lookahead<fa&&n===z)return B;if(0===m.lookahead)break}if(k=0,m.lookahead>=aa&&
(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+aa-1])&m.hash_mask,k=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),0!==k&&m.strstart-k<=m.w_size-fa&&(m.match_length=d(m,k)),m.match_length>=aa)if(x=pa._tr_tally(m,m.strstart-m.match_start,m.match_length-aa),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=aa){m.match_length--;do m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+aa-1])&m.hash_mask,k=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],
m.head[m.ins_h]=m.strstart;while(0!==--m.match_length);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else x=pa._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(x&&(M(m,!1),0===m.strm.avail_out))return B}return m.insert=m.strstart<aa-1?m.strstart:aa-1,n===C?(M(m,!0),0===m.strm.avail_out?qa:Fa):m.last_lit&&(M(m,!1),0===m.strm.avail_out)?B:J}function y(m,n){for(var k,x,p;;){if(m.lookahead<
fa){if(h(m),m.lookahead<fa&&n===z)return B;if(0===m.lookahead)break}if(k=0,m.lookahead>=aa&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+aa-1])&m.hash_mask,k=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=aa-1,0!==k&&m.prev_length<m.max_lazy_match&&m.strstart-k<=m.w_size-fa&&(m.match_length=d(m,k),5>=m.match_length&&(m.strategy===Na||m.match_length===aa&&4096<m.strstart-m.match_start)&&(m.match_length=
aa-1)),m.prev_length>=aa&&m.match_length<=m.prev_length){p=m.strstart+m.lookahead-aa;x=pa._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-aa);m.lookahead-=m.prev_length-1;m.prev_length-=2;do++m.strstart<=p&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+aa-1])&m.hash_mask,k=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart);while(0!==--m.prev_length);if(m.match_available=0,m.match_length=aa-1,m.strstart++,x&&(M(m,!1),0===m.strm.avail_out))return B}else if(m.match_available){if(x=
pa._tr_tally(m,0,m.window[m.strstart-1]),x&&M(m,!1),m.strstart++,m.lookahead--,0===m.strm.avail_out)return B}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(pa._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<aa-1?m.strstart:aa-1,n===C?(M(m,!0),0===m.strm.avail_out?qa:Fa):m.last_lit&&(M(m,!1),0===m.strm.avail_out)?B:J}function n(d,h,n,k,p){this.good_length=d;this.max_lazy=h;this.nice_length=n;this.max_chain=k;this.func=p}function Q(){this.strm=
null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=Ja;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=
this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new ca.Buf16(2*Aa);this.dyn_dtree=new ca.Buf16(2*(2*Wa+1));this.bl_tree=new ca.Buf16(2*(2*u+1));D(this.dyn_ltree);D(this.dyn_dtree);D(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new ca.Buf16(Ca+1);this.heap=new ca.Buf16(2*Da+1);D(this.heap);this.heap_max=this.heap_len=0;this.depth=new ca.Buf16(2*Da+1);D(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=
this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function ia(d){var h;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=Xa,h=d.state,h.pending=0,h.pending_out=0,0>h.wrap&&(h.wrap=-h.wrap),h.status=h.wrap?L:G,d.adler=2===h.wrap?0:1,h.last_flush=z,pa._tr_init(h),ea):w(d,S)}function Ta(d){var h=ia(d);h===ea&&(d=d.state,d.window_size=2*d.w_size,D(d.head),d.max_lazy_match=U[d.level].max_lazy,d.good_match=U[d.level].good_length,d.nice_match=U[d.level].nice_length,d.max_chain_length=U[d.level].max_chain,
d.strstart=0,d.block_start=0,d.lookahead=0,d.insert=0,d.match_length=d.prev_length=aa-1,d.match_available=0,d.ins_h=0);return h}function gb(d,h,n,k,p,q){if(!d)return S;var m=1;if(h===T&&(h=6),0>k?(m=0,k=-k):15<k&&(m=2,k-=16),1>p||p>Ua||n!==Ja||8>k||15<k||0>h||9<h||0>q||q>Oa)return w(d,S);8===k&&(k=9);var x=new Q;return d.state=x,x.strm=d,x.wrap=m,x.gzhead=null,x.w_bits=k,x.w_size=1<<x.w_bits,x.w_mask=x.w_size-1,x.hash_bits=p+7,x.hash_size=1<<x.hash_bits,x.hash_mask=x.hash_size-1,x.hash_shift=~~((x.hash_bits+
aa-1)/aa),x.window=new ca.Buf8(2*x.w_size),x.head=new ca.Buf16(x.hash_size),x.prev=new ca.Buf16(x.w_size),x.lit_bufsize=1<<p+6,x.pending_buf_size=4*x.lit_bufsize,x.pending_buf=new ca.Buf8(x.pending_buf_size),x.d_buf=1*x.lit_bufsize,x.l_buf=3*x.lit_bufsize,x.level=h,x.strategy=q,x.method=n,Ta(d)}var ca=k("../utils/common"),pa=k("./trees"),Y=k("./adler32"),O=k("./crc32"),da=k("./messages"),z=0,C=4,ea=0,S=-2,T=-1,Na=1,Oa=4,Xa=2,Ja=8,Ua=9,Da=286,Wa=30,u=19,Aa=2*Da+1,Ca=15,aa=3,ba=258,fa=ba+aa+1,L=42,
G=113,B=1,J=2,qa=3,Fa=4;var U=[new n(0,0,0,0,function(d,n){var m=65535;for(m>d.pending_buf_size-5&&(m=d.pending_buf_size-5);;){if(1>=d.lookahead){if(h(d),0===d.lookahead&&n===z)return B;if(0===d.lookahead)break}d.strstart+=d.lookahead;d.lookahead=0;var k=d.block_start+m;if((0===d.strstart||d.strstart>=k)&&(d.lookahead=d.strstart-k,d.strstart=k,M(d,!1),0===d.strm.avail_out)||d.strstart-d.block_start>=d.w_size-fa&&(M(d,!1),0===d.strm.avail_out))return B}return d.insert=0,n===C?(M(d,!0),0===d.strm.avail_out?
qa:Fa):(d.strstart>d.block_start&&M(d,!1),B)}),new n(4,4,8,4,p),new n(4,5,16,8,p),new n(4,6,32,32,p),new n(4,4,16,16,y),new n(8,16,32,32,y),new n(8,16,128,128,y),new n(8,32,128,256,y),new n(32,128,258,1024,y),new n(32,258,258,4096,y)];q.deflateInit=function(d,h){return gb(d,h,Ja,15,8,0)};q.deflateInit2=gb;q.deflateReset=Ta;q.deflateResetKeep=ia;q.deflateSetHeader=function(d,h){return d&&d.state?2!==d.state.wrap?S:(d.state.gzhead=h,ea):S};q.deflate=function(d,n){var m,k;if(!d||!d.state||5<n||0>n)return d?
w(d,S):S;if(k=d.state,!d.output||!d.input&&0!==d.avail_in||666===k.status&&n!==C)return w(d,0===d.avail_out?-5:S);if(k.strm=d,m=k.last_flush,k.last_flush=n,k.status===L)if(2===k.wrap)d.adler=0,F(k,31),F(k,139),F(k,8),k.gzhead?(F(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),F(k,255&k.gzhead.time),F(k,k.gzhead.time>>8&255),F(k,k.gzhead.time>>16&255),F(k,k.gzhead.time>>24&255),F(k,9===k.level?2:2<=k.strategy||2>k.level?4:0),F(k,255&k.gzhead.os),
k.gzhead.extra&&k.gzhead.extra.length&&(F(k,255&k.gzhead.extra.length),F(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(d.adler=O(d.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(F(k,0),F(k,0),F(k,0),F(k,0),F(k,0),F(k,9===k.level?2:2<=k.strategy||2>k.level?4:0),F(k,3),k.status=G);else{var p=Ja+(k.w_bits-8<<4)<<8;p|=(2<=k.strategy||2>k.level?0:6>k.level?1:6===k.level?2:3)<<6;0!==k.strstart&&(p|=32);k.status=G;E(k,p+(31-p%31));0!==k.strstart&&(E(k,d.adler>>>16),E(k,65535&d.adler));d.adler=
1}if(69===k.status)if(k.gzhead.extra){for(p=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>p&&(d.adler=O(d.adler,k.pending_buf,k.pending-p,p)),H(d),p=k.pending,k.pending!==k.pending_buf_size));)F(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>p&&(d.adler=O(d.adler,k.pending_buf,k.pending-p,p));k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(73===k.status)if(k.gzhead.name){p=k.pending;
do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>p&&(d.adler=O(d.adler,k.pending_buf,k.pending-p,p)),H(d),p=k.pending,k.pending===k.pending_buf_size)){var q=1;break}q=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0;F(k,q)}while(0!==q);k.gzhead.hcrc&&k.pending>p&&(d.adler=O(d.adler,k.pending_buf,k.pending-p,p));0===q&&(k.gzindex=0,k.status=91)}else k.status=91;if(91===k.status)if(k.gzhead.comment){p=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&
k.pending>p&&(d.adler=O(d.adler,k.pending_buf,k.pending-p,p)),H(d),p=k.pending,k.pending===k.pending_buf_size)){q=1;break}q=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0;F(k,q)}while(0!==q);k.gzhead.hcrc&&k.pending>p&&(d.adler=O(d.adler,k.pending_buf,k.pending-p,p));0===q&&(k.status=103)}else k.status=103;if(103===k.status&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&H(d),k.pending+2<=k.pending_buf_size&&(F(k,255&d.adler),F(k,d.adler>>8&255),d.adler=0,k.status=
G)):k.status=G),0!==k.pending){if(H(d),0===d.avail_out)return k.last_flush=-1,ea}else if(0===d.avail_in&&(n<<1)-(4<n?9:0)<=(m<<1)-(4<m?9:0)&&n!==C)return w(d,-5);if(666===k.status&&0!==d.avail_in)return w(d,-5);if(0!==d.avail_in||0!==k.lookahead||n!==z&&666!==k.status){if(2===k.strategy)a:{for(var u;;){if(0===k.lookahead&&(h(k),0===k.lookahead)){if(n===z){var r=B;break a}break}if(k.match_length=0,u=pa._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,u&&(M(k,!1),0===k.strm.avail_out)){r=
B;break a}}r=(k.insert=0,n===C?(M(k,!0),0===k.strm.avail_out?qa:Fa):k.last_lit&&(M(k,!1),0===k.strm.avail_out)?B:J)}else if(3===k.strategy)a:{var y,T;for(u=k.window;;){if(k.lookahead<=ba){if(h(k),k.lookahead<=ba&&n===z){r=B;break a}if(0===k.lookahead)break}if(k.match_length=0,k.lookahead>=aa&&0<k.strstart&&(T=k.strstart-1,y=u[T],y===u[++T]&&y===u[++T]&&y===u[++T])){for(m=k.strstart+ba;y===u[++T]&&y===u[++T]&&y===u[++T]&&y===u[++T]&&y===u[++T]&&y===u[++T]&&y===u[++T]&&y===u[++T]&&T<m;);k.match_length=
ba-(m-T);k.match_length>k.lookahead&&(k.match_length=k.lookahead)}if(k.match_length>=aa?(r=pa._tr_tally(k,1,k.match_length-aa),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(r=pa._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),r&&(M(k,!1),0===k.strm.avail_out)){r=B;break a}}r=(k.insert=0,n===C?(M(k,!0),0===k.strm.avail_out?qa:Fa):k.last_lit&&(M(k,!1),0===k.strm.avail_out)?B:J)}else r=U[k.level].func(k,n);if(r!==qa&&r!==Fa||(k.status=666),r===B||r===qa)return 0===
d.avail_out&&(k.last_flush=-1),ea;if(r===J&&(1===n?pa._tr_align(k):5!==n&&(pa._tr_stored_block(k,0,0,!1),3===n&&(D(k.head),0===k.lookahead&&(k.strstart=0,k.block_start=0,k.insert=0))),H(d),0===d.avail_out))return k.last_flush=-1,ea}return n!==C?ea:0>=k.wrap?1:(2===k.wrap?(F(k,255&d.adler),F(k,d.adler>>8&255),F(k,d.adler>>16&255),F(k,d.adler>>24&255),F(k,255&d.total_in),F(k,d.total_in>>8&255),F(k,d.total_in>>16&255),F(k,d.total_in>>24&255)):(E(k,d.adler>>>16),E(k,65535&d.adler)),H(d),0<k.wrap&&(k.wrap=
-k.wrap),0!==k.pending?ea:1)};q.deflateEnd=function(d){var h;return d&&d.state?(h=d.state.status,h!==L&&69!==h&&73!==h&&91!==h&&103!==h&&h!==G&&666!==h?w(d,S):(d.state=null,h===G?w(d,-3):ea)):S};q.deflateSetDictionary=function(d,k){var m,n,p;var q=k.length;if(!d||!d.state||(m=d.state,n=m.wrap,2===n||1===n&&m.status!==L||m.lookahead))return S;1===n&&(d.adler=Y(d.adler,k,q,0));m.wrap=0;q>=m.w_size&&(0===n&&(D(m.head),m.strstart=0,m.block_start=0,m.insert=0),p=new ca.Buf8(m.w_size),ca.arraySet(p,k,q-
m.w_size,m.w_size,0),k=p,q=m.w_size);p=d.avail_in;var u=d.next_in;var r=d.input;d.avail_in=q;d.next_in=0;d.input=k;for(h(m);m.lookahead>=aa;){k=m.strstart;q=m.lookahead-(aa-1);do m.ins_h=(m.ins_h<<m.hash_shift^m.window[k+aa-1])&m.hash_mask,m.prev[k&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=k,k++;while(--q);m.strstart=k;m.lookahead=aa-1;h(m)}return m.strstart+=m.lookahead,m.block_start=m.strstart,m.insert=m.lookahead,m.lookahead=0,m.match_length=m.prev_length=aa-1,m.match_available=0,d.next_in=u,d.input=
r,d.avail_in=p,m.wrap=n,ea};q.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(k,r,q){r.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],10:[function(k,r,q){r.exports=function(k,q){var r,w,D;var E=k.state;var d=k.next_in;var h=k.input;var p=d+(k.avail_in-5);var y=k.next_out;var n=k.output;q=y-(q-k.avail_out);
var Q=y+(k.avail_out-257);var ia=E.dmax;var Ta=E.wsize;var gb=E.whave;var ca=E.wnext;var pa=E.window;var Y=E.hold;var O=E.bits;var da=E.lencode;var z=E.distcode;var C=(1<<E.lenbits)-1;var ea=(1<<E.distbits)-1;a:do{15>O&&(Y+=h[d++]<<O,O+=8,Y+=h[d++]<<O,O+=8);var S=da[Y&C];b:for(;;){if(r=S>>>24,Y>>>=r,O-=r,r=S>>>16&255,0===r)n[y++]=65535&S;else{if(!(16&r)){if(0===(64&r)){S=da[(65535&S)+(Y&(1<<r)-1)];continue b}if(32&r){E.mode=12;break a}k.msg="invalid literal/length code";E.mode=30;break a}var T=65535&
S;(r&=15)&&(O<r&&(Y+=h[d++]<<O,O+=8),T+=Y&(1<<r)-1,Y>>>=r,O-=r);15>O&&(Y+=h[d++]<<O,O+=8,Y+=h[d++]<<O,O+=8);S=z[Y&ea];c:for(;;){if(r=S>>>24,Y>>>=r,O-=r,r=S>>>16&255,!(16&r)){if(0===(64&r)){S=z[(65535&S)+(Y&(1<<r)-1)];continue c}k.msg="invalid distance code";E.mode=30;break a}if(w=65535&S,r&=15,O<r&&(Y+=h[d++]<<O,O+=8,O<r&&(Y+=h[d++]<<O,O+=8)),w+=Y&(1<<r)-1,w>ia){k.msg="invalid distance too far back";E.mode=30;break a}if(Y>>>=r,O-=r,r=y-q,w>r){if(r=w-r,r>gb&&E.sane){k.msg="invalid distance too far back";
E.mode=30;break a}if(S=0,D=pa,0===ca){if(S+=Ta-r,r<T){T-=r;do n[y++]=pa[S++];while(--r);S=y-w;D=n}}else if(ca<r){if(S+=Ta+ca-r,r-=ca,r<T){T-=r;do n[y++]=pa[S++];while(--r);if(S=0,ca<T){r=ca;T-=r;do n[y++]=pa[S++];while(--r);S=y-w;D=n}}}else if(S+=ca-r,r<T){T-=r;do n[y++]=pa[S++];while(--r);S=y-w;D=n}for(;2<T;)n[y++]=D[S++],n[y++]=D[S++],n[y++]=D[S++],T-=3;T&&(n[y++]=D[S++],1<T&&(n[y++]=D[S++]))}else{S=y-w;do n[y++]=n[S++],n[y++]=n[S++],n[y++]=n[S++],T-=3;while(2<T);T&&(n[y++]=n[S++],1<T&&(n[y++]=
n[S++]))}break}}break}}while(d<p&&y<Q);T=O>>3;d-=T;O-=T<<3;k.next_in=d;k.next_out=y;k.avail_in=d<p?5+(p-d):5-(d-p);k.avail_out=y<Q?257+(Q-y):257-(y-Q);E.hold=Y&(1<<O)-1;E.bits=O}},{}],11:[function(k,r,q){function w(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)}function D(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=
this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new y.Buf16(320);this.work=new y.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function H(d){var h;return d&&d.state?(h=d.state,d.total_in=d.total_out=h.total=0,d.msg="",h.wrap&&(d.adler=1&h.wrap),h.mode=pa,h.last=0,h.havedict=0,h.dmax=32768,h.head=null,h.hold=0,h.bits=0,h.lencode=h.lendyn=new y.Buf32(Y),h.distcode=h.distdyn=
new y.Buf32(O),h.sane=1,h.back=-1,gb):ca}function M(d){var h;return d&&d.state?(h=d.state,h.wsize=0,h.whave=0,h.wnext=0,H(d)):ca}function F(d,h){var k,n;return d&&d.state?(n=d.state,0>h?(k=0,h=-h):(k=(h>>4)+1,48>h&&(h&=15)),h&&(8>h||15<h)?ca:(null!==n.window&&n.wbits!==h&&(n.window=null),n.wrap=k,n.wbits=h,M(d))):ca}function E(d,h){var k,n;return d?(n=new D,d.state=n,n.window=null,k=F(d,h),k!==gb&&(d.state=null),k):ca}function d(d,h,k,n){var p;d=d.state;return null===d.window&&(d.wsize=1<<d.wbits,
d.wnext=0,d.whave=0,d.window=new y.Buf8(d.wsize)),n>=d.wsize?(y.arraySet(d.window,h,k-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(p=d.wsize-d.wnext,p>n&&(p=n),y.arraySet(d.window,h,k-n,p,d.wnext),n-=p,n?(y.arraySet(d.window,h,k-n,n,0),d.wnext=n,d.whave=d.wsize):(d.wnext+=p,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=p))),0}var h,p,y=k("../utils/common"),n=k("./adler32"),Q=k("./crc32"),ia=k("./inffast"),Ta=k("./inftrees"),gb=0,ca=-2,pa=1,Y=852,O=592,da=!0;q.inflateReset=M;q.inflateReset2=
F;q.inflateResetKeep=H;q.inflateInit=function(d){return E(d,15)};q.inflateInit2=E;q.inflate=function(k,q){var r,z,C,D,E,F,H,M=0,O=new y.Buf8(4),Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&0!==k.avail_in)return ca;var u=k.state;12===u.mode&&(u.mode=13);var Aa=k.next_out;var Ca=k.output;var aa=k.avail_out;var ba=k.next_in;var fa=k.input;var L=k.avail_in;var G=u.hold;var B=u.bits;var J=L;var qa=aa;var Fa=gb;a:for(;;)switch(u.mode){case pa:if(0===u.wrap){u.mode=
13;break}for(;16>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(2&u.wrap&&35615===G){u.check=0;O[0]=255&G;O[1]=G>>>8&255;u.check=Q(u.check,O,2,0);B=G=0;u.mode=2;break}if(u.flags=0,u.head&&(u.head.done=!1),!(1&u.wrap)||(((255&G)<<8)+(G>>8))%31){k.msg="incorrect header check";u.mode=30;break}if(8!==(15&G)){k.msg="unknown compression method";u.mode=30;break}if(G>>>=4,B-=4,F=(15&G)+8,0===u.wbits)u.wbits=F;else if(F>u.wbits){k.msg="invalid window size";u.mode=30;break}u.dmax=1<<F;k.adler=u.check=1;u.mode=
512&G?10:12;B=G=0;break;case 2:for(;16>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(u.flags=G,8!==(255&u.flags)){k.msg="unknown compression method";u.mode=30;break}if(57344&u.flags){k.msg="unknown header flags set";u.mode=30;break}u.head&&(u.head.text=G>>8&1);512&u.flags&&(O[0]=255&G,O[1]=G>>>8&255,u.check=Q(u.check,O,2,0));B=G=0;u.mode=3;case 3:for(;32>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}u.head&&(u.head.time=G);512&u.flags&&(O[0]=255&G,O[1]=G>>>8&255,O[2]=G>>>16&255,O[3]=G>>>24&255,u.check=
Q(u.check,O,4,0));B=G=0;u.mode=4;case 4:for(;16>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}u.head&&(u.head.xflags=255&G,u.head.os=G>>8);512&u.flags&&(O[0]=255&G,O[1]=G>>>8&255,u.check=Q(u.check,O,2,0));B=G=0;u.mode=5;case 5:if(1024&u.flags){for(;16>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}u.length=G;u.head&&(u.head.extra_len=G);512&u.flags&&(O[0]=255&G,O[1]=G>>>8&255,u.check=Q(u.check,O,2,0));B=G=0}else u.head&&(u.head.extra=null);u.mode=6;case 6:if(1024&u.flags&&(r=u.length,r>L&&(r=L),r&&(u.head&&
(F=u.head.extra_len-u.length,u.head.extra||(u.head.extra=Array(u.head.extra_len)),y.arraySet(u.head.extra,fa,ba,r,F)),512&u.flags&&(u.check=Q(u.check,fa,r,ba)),L-=r,ba+=r,u.length-=r),u.length))break a;u.length=0;u.mode=7;case 7:if(2048&u.flags){if(0===L)break a;r=0;do F=fa[ba+r++],u.head&&F&&65536>u.length&&(u.head.name+=String.fromCharCode(F));while(F&&r<L);if(512&u.flags&&(u.check=Q(u.check,fa,r,ba)),L-=r,ba+=r,F)break a}else u.head&&(u.head.name=null);u.length=0;u.mode=8;case 8:if(4096&u.flags){if(0===
L)break a;r=0;do F=fa[ba+r++],u.head&&F&&65536>u.length&&(u.head.comment+=String.fromCharCode(F));while(F&&r<L);if(512&u.flags&&(u.check=Q(u.check,fa,r,ba)),L-=r,ba+=r,F)break a}else u.head&&(u.head.comment=null);u.mode=9;case 9:if(512&u.flags){for(;16>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(G!==(65535&u.check)){k.msg="header crc mismatch";u.mode=30;break}B=G=0}u.head&&(u.head.hcrc=u.flags>>9&1,u.head.done=!0);k.adler=u.check=0;u.mode=12;break;case 10:for(;32>B;){if(0===L)break a;L--;G+=fa[ba++]<<
B;B+=8}k.adler=u.check=w(G);B=G=0;u.mode=11;case 11:if(0===u.havedict)return k.next_out=Aa,k.avail_out=aa,k.next_in=ba,k.avail_in=L,u.hold=G,u.bits=B,2;k.adler=u.check=1;u.mode=12;case 12:if(5===q||6===q)break a;case 13:if(u.last){G>>>=7&B;B-=7&B;u.mode=27;break}for(;3>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}switch(u.last=1&G,G>>>=1,--B,3&G){case 0:u.mode=14;break;case 1:var U=u;if(da){h=new y.Buf32(512);p=new y.Buf32(32);for(C=0;144>C;)U.lens[C++]=8;for(;256>C;)U.lens[C++]=9;for(;280>C;)U.lens[C++]=
7;for(;288>C;)U.lens[C++]=8;Ta(1,U.lens,0,288,h,0,U.work,{bits:9});for(C=0;32>C;)U.lens[C++]=5;Ta(2,U.lens,0,32,p,0,U.work,{bits:5});da=!1}U.lencode=h;U.lenbits=9;U.distcode=p;U.distbits=5;if(u.mode=20,6===q){G>>>=2;B-=2;break a}break;case 2:u.mode=17;break;case 3:k.msg="invalid block type",u.mode=30}G>>>=2;B-=2;break;case 14:G>>>=7&B;for(B-=7&B;32>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if((65535&G)!==(G>>>16^65535)){k.msg="invalid stored block lengths";u.mode=30;break}if(u.length=65535&G,G=
0,B=0,u.mode=15,6===q)break a;case 15:u.mode=16;case 16:if(r=u.length){if(r>L&&(r=L),r>aa&&(r=aa),0===r)break a;y.arraySet(Ca,fa,ba,r,Aa);L-=r;ba+=r;aa-=r;Aa+=r;u.length-=r;break}u.mode=12;break;case 17:for(;14>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(u.nlen=(31&G)+257,G>>>=5,B-=5,u.ndist=(31&G)+1,G>>>=5,B-=5,u.ncode=(15&G)+4,G>>>=4,B-=4,286<u.nlen||30<u.ndist){k.msg="too many length or distance symbols";u.mode=30;break}u.have=0;u.mode=18;case 18:for(;u.have<u.ncode;){for(;3>B;){if(0===L)break a;
L--;G+=fa[ba++]<<B;B+=8}u.lens[Y[u.have++]]=7&G;G>>>=3;B-=3}for(;19>u.have;)u.lens[Y[u.have++]]=0;if(u.lencode=u.lendyn,u.lenbits=7,H={bits:u.lenbits},Fa=Ta(0,u.lens,0,19,u.lencode,0,u.work,H),u.lenbits=H.bits,Fa){k.msg="invalid code lengths set";u.mode=30;break}u.have=0;u.mode=19;case 19:for(;u.have<u.nlen+u.ndist;){for(;M=u.lencode[G&(1<<u.lenbits)-1],D=M>>>24,U=65535&M,!(D<=B);){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(16>U)G>>>=D,B-=D,u.lens[u.have++]=U;else{if(16===U){for(C=D+2;B<C;){if(0===
L)break a;L--;G+=fa[ba++]<<B;B+=8}if(G>>>=D,B-=D,0===u.have){k.msg="invalid bit length repeat";u.mode=30;break}F=u.lens[u.have-1];r=3+(3&G);G>>>=2;B-=2}else if(17===U){for(C=D+3;B<C;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}G>>>=D;B-=D;F=0;r=3+(7&G);G>>>=3;B-=3}else{for(C=D+7;B<C;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}G>>>=D;B-=D;F=0;r=11+(127&G);G>>>=7;B-=7}if(u.have+r>u.nlen+u.ndist){k.msg="invalid bit length repeat";u.mode=30;break}for(;r--;)u.lens[u.have++]=F}}if(30===u.mode)break;if(0===
u.lens[256]){k.msg="invalid code -- missing end-of-block";u.mode=30;break}if(u.lenbits=9,H={bits:u.lenbits},Fa=Ta(1,u.lens,0,u.nlen,u.lencode,0,u.work,H),u.lenbits=H.bits,Fa){k.msg="invalid literal/lengths set";u.mode=30;break}if(u.distbits=6,u.distcode=u.distdyn,H={bits:u.distbits},Fa=Ta(2,u.lens,u.nlen,u.ndist,u.distcode,0,u.work,H),u.distbits=H.bits,Fa){k.msg="invalid distances set";u.mode=30;break}if(u.mode=20,6===q)break a;case 20:u.mode=21;case 21:if(6<=L&&258<=aa){k.next_out=Aa;k.avail_out=
aa;k.next_in=ba;k.avail_in=L;u.hold=G;u.bits=B;ia(k,qa);Aa=k.next_out;Ca=k.output;aa=k.avail_out;ba=k.next_in;fa=k.input;L=k.avail_in;G=u.hold;B=u.bits;12===u.mode&&(u.back=-1);break}for(u.back=0;M=u.lencode[G&(1<<u.lenbits)-1],D=M>>>24,C=M>>>16&255,U=65535&M,!(D<=B);){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(C&&0===(240&C)){var m=D;var db=C;for(E=U;M=u.lencode[E+((G&(1<<m+db)-1)>>m)],D=M>>>24,C=M>>>16&255,U=65535&M,!(m+D<=B);){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}G>>>=m;B-=m;u.back+=m}if(G>>>=
D,B-=D,u.back+=D,u.length=U,0===C){u.mode=26;break}if(32&C){u.back=-1;u.mode=12;break}if(64&C){k.msg="invalid literal/length code";u.mode=30;break}u.extra=15&C;u.mode=22;case 22:if(u.extra){for(C=u.extra;B<C;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}u.length+=G&(1<<u.extra)-1;G>>>=u.extra;B-=u.extra;u.back+=u.extra}u.was=u.length;u.mode=23;case 23:for(;M=u.distcode[G&(1<<u.distbits)-1],D=M>>>24,C=M>>>16&255,U=65535&M,!(D<=B);){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(0===(240&C)){m=D;db=C;for(E=
U;M=u.distcode[E+((G&(1<<m+db)-1)>>m)],D=M>>>24,C=M>>>16&255,U=65535&M,!(m+D<=B);){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}G>>>=m;B-=m;u.back+=m}if(G>>>=D,B-=D,u.back+=D,64&C){k.msg="invalid distance code";u.mode=30;break}u.offset=U;u.extra=15&C;u.mode=24;case 24:if(u.extra){for(C=u.extra;B<C;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}u.offset+=G&(1<<u.extra)-1;G>>>=u.extra;B-=u.extra;u.back+=u.extra}if(u.offset>u.dmax){k.msg="invalid distance too far back";u.mode=30;break}u.mode=25;case 25:if(0===
aa)break a;if(r=qa-aa,u.offset>r){if(r=u.offset-r,r>u.whave&&u.sane){k.msg="invalid distance too far back";u.mode=30;break}r>u.wnext?(r-=u.wnext,z=u.wsize-r):z=u.wnext-r;r>u.length&&(r=u.length);C=u.window}else C=Ca,z=Aa-u.offset,r=u.length;r>aa&&(r=aa);aa-=r;u.length-=r;do Ca[Aa++]=C[z++];while(--r);0===u.length&&(u.mode=21);break;case 26:if(0===aa)break a;Ca[Aa++]=u.length;aa--;u.mode=21;break;case 27:if(u.wrap){for(;32>B;){if(0===L)break a;L--;G|=fa[ba++]<<B;B+=8}if(qa-=aa,k.total_out+=qa,u.total+=
qa,qa&&(k.adler=u.check=u.flags?Q(u.check,Ca,qa,Aa-qa):n(u.check,Ca,qa,Aa-qa)),qa=aa,(u.flags?G:w(G))!==u.check){k.msg="incorrect data check";u.mode=30;break}B=G=0}u.mode=28;case 28:if(u.wrap&&u.flags){for(;32>B;){if(0===L)break a;L--;G+=fa[ba++]<<B;B+=8}if(G!==(4294967295&u.total)){k.msg="incorrect length check";u.mode=30;break}B=G=0}u.mode=29;case 29:Fa=1;break a;case 30:Fa=-3;break a;case 31:return-4;default:return ca}return k.next_out=Aa,k.avail_out=aa,k.next_in=ba,k.avail_in=L,u.hold=G,u.bits=
B,(u.wsize||qa!==k.avail_out&&30>u.mode&&(27>u.mode||4!==q))&&d(k,k.output,k.next_out,qa-k.avail_out)?(u.mode=31,-4):(J-=k.avail_in,qa-=k.avail_out,k.total_in+=J,k.total_out+=qa,u.total+=qa,u.wrap&&qa&&(k.adler=u.check=u.flags?Q(u.check,Ca,qa,k.next_out-qa):n(u.check,Ca,qa,k.next_out-qa)),k.data_type=u.bits+(u.last?64:0)+(12===u.mode?128:0)+(20===u.mode||15===u.mode?256:0),(0===J&&0===qa||4===q)&&Fa===gb&&(Fa=-5),Fa)};q.inflateEnd=function(d){if(!d||!d.state)return ca;var h=d.state;return h.window&&
(h.window=null),d.state=null,gb};q.inflateGetHeader=function(d,h){var k;return d&&d.state?(k=d.state,0===(2&k.wrap)?ca:(k.head=h,h.done=!1,gb)):ca};q.inflateSetDictionary=function(h,k){var p,q,r=k.length;return h&&h.state?(p=h.state,0!==p.wrap&&11!==p.mode?ca:11===p.mode&&(q=1,q=n(q,k,r,0),q!==p.check)?-3:d(h,k,r,r)?(p.mode=31,-4):(p.havedict=1,gb)):ca};q.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(k,
r,q){var w=k("../utils/common"),D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],H=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],F=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(k,d,h,p,q,n,r,ia){var y,E,Q,pa,Y,O,da=ia.bits,
z,C,ea,S,T,Na=0,Oa,Xa=null,Ja=0,Ua=new w.Buf16(16);var Da=new w.Buf16(16);var Wa=null,u=0;for(z=0;15>=z;z++)Ua[z]=0;for(C=0;C<p;C++)Ua[d[h+C]]++;var Aa=da;for(ea=15;1<=ea&&0===Ua[ea];ea--);if(Aa>ea&&(Aa=ea),0===ea)return q[n++]=20971520,q[n++]=20971520,ia.bits=1,0;for(da=1;da<ea&&0===Ua[da];da++);Aa<da&&(Aa=da);for(z=y=1;15>=z;z++)if(y<<=1,y-=Ua[z],0>y)return-1;if(0<y&&(0===k||1!==ea))return-1;Da[1]=0;for(z=1;15>z;z++)Da[z+1]=Da[z]+Ua[z];for(C=0;C<p;C++)0!==d[h+C]&&(r[Da[d[h+C]]++]=C);if(0===k?(Xa=
Wa=r,pa=19):1===k?(Xa=D,Ja-=257,Wa=H,u-=257,pa=256):(Xa=M,Wa=F,pa=-1),Oa=0,C=0,z=da,Da=n,S=Aa,T=0,Q=-1,Na=1<<Aa,p=Na-1,1===k&&852<Na||2===k&&592<Na)return 1;for(var Ca=0;;){Ca++;var aa=z-T;r[C]<pa?(Y=0,O=r[C]):r[C]>pa?(Y=Wa[u+r[C]],O=Xa[Ja+r[C]]):(Y=96,O=0);y=1<<z-T;da=E=1<<S;do E-=y,q[Da+(Oa>>T)+E]=aa<<24|Y<<16|O|0;while(0!==E);for(y=1<<z-1;Oa&y;)y>>=1;if(0!==y?(Oa&=y-1,Oa+=y):Oa=0,C++,0===--Ua[z]){if(z===ea)break;z=d[h+r[C]]}if(z>Aa&&(Oa&p)!==Q){0===T&&(T=Aa);Da+=da;S=z-T;for(y=1<<S;S+T<ea&&(y-=
Ua[S+T],!(0>=y));)S++,y<<=1;if(Na+=1<<S,1===k&&852<Na||2===k&&592<Na)return 1;Q=Oa&p;q[Q]=Aa<<24|S<<16|Da-n|0}}return 0!==Oa&&(q[Da+Oa]=z-T<<24|4194304),ia.bits=Aa,0}},{"../utils/common":3}],13:[function(k,r,q){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(k,r,q){function w(d){for(var h=d.length;0<=--h;)d[h]=0}function D(d,h,k,m,n){this.static_tree=
d;this.extra_bits=h;this.extra_base=k;this.elems=m;this.max_length=n;this.has_stree=d&&d.length}function H(d,h){this.dyn_tree=d;this.max_code=0;this.stat_desc=h}function M(d,h){d.pending_buf[d.pending++]=255&h;d.pending_buf[d.pending++]=h>>>8&255}function F(d,h,k){d.bi_valid>Ja-k?(d.bi_buf|=h<<d.bi_valid&65535,M(d,d.bi_buf),d.bi_buf=h>>Ja-d.bi_valid,d.bi_valid+=k-Ja):(d.bi_buf|=h<<d.bi_valid&65535,d.bi_valid+=k)}function E(d,h,k){F(d,k[2*h],k[2*h+1])}function d(d,h){var k=0;do k|=1&d,d>>>=1,k<<=1;
while(0<--h);return k>>>1}function h(h,k,m){var n,p=Array(Xa+1),q=0;for(n=1;n<=Xa;n++)p[n]=q=q+m[n-1]<<1;for(m=0;m<=k;m++)n=h[2*m+1],0!==n&&(h[2*m]=d(p[n]++,n))}function p(d){var h;for(h=0;h<S;h++)d.dyn_ltree[2*h]=0;for(h=0;h<T;h++)d.dyn_dtree[2*h]=0;for(h=0;h<Na;h++)d.bl_tree[2*h]=0;d.dyn_ltree[2*Ua]=1;d.opt_len=d.static_len=0;d.last_lit=d.matches=0}function y(d){8<d.bi_valid?M(d,d.bi_buf):0<d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf);d.bi_buf=0;d.bi_valid=0}function n(d,h,k,m){var n=2*h,p=
2*k;return d[n]<d[p]||d[n]===d[p]&&m[h]<=m[k]}function Q(d,h,k){for(var m=d.heap[k],p=k<<1;p<=d.heap_len&&(p<d.heap_len&&n(h,d.heap[p+1],d.heap[p],d.depth)&&p++,!n(h,m,d.heap[p],d.depth));)d.heap[k]=d.heap[p],k=p,p<<=1;d.heap[k]=m}function ia(d,h,k){var m,n,p=0;if(0!==d.last_lit){do{var q=d.pending_buf[d.d_buf+2*p]<<8|d.pending_buf[d.d_buf+2*p+1];var r=d.pending_buf[d.l_buf+p];p++;0===q?E(d,r,h):(m=B[r],E(d,m+ea+1,h),n=Aa[m],0!==n&&(r-=J[m],F(d,r,n)),q--,m=256>q?G[q]:G[256+(q>>>7)],E(d,m,k),n=Ca[m],
0!==n&&(q-=qa[m],F(d,q,n)))}while(p<d.last_lit)}E(d,Ua,h)}function Ta(d,k){var m,n=k.dyn_tree;var p=k.stat_desc.static_tree;var q=k.stat_desc.has_stree,r=k.stat_desc.elems,u=-1;d.heap_len=0;d.heap_max=Oa;for(m=0;m<r;m++)0!==n[2*m]?(d.heap[++d.heap_len]=u=m,d.depth[m]=0):n[2*m+1]=0;for(;2>d.heap_len;){var w=d.heap[++d.heap_len]=2>u?++u:0;n[2*w]=1;d.depth[w]=0;d.opt_len--;q&&(d.static_len-=p[2*w+1])}k.max_code=u;for(m=d.heap_len>>1;1<=m;m--)Q(d,n,m);w=r;do m=d.heap[1],d.heap[1]=d.heap[d.heap_len--],
Q(d,n,1),p=d.heap[1],d.heap[--d.heap_max]=m,d.heap[--d.heap_max]=p,n[2*w]=n[2*m]+n[2*p],d.depth[w]=(d.depth[m]>=d.depth[p]?d.depth[m]:d.depth[p])+1,n[2*m+1]=n[2*p+1]=w,d.heap[1]=w++,Q(d,n,1);while(2<=d.heap_len);d.heap[--d.heap_max]=d.heap[1];var x,y;m=k.dyn_tree;w=k.max_code;r=k.stat_desc.static_tree;var K=k.stat_desc.has_stree,z=k.stat_desc.extra_bits,B=k.stat_desc.extra_base,C=k.stat_desc.max_length,D=0;for(q=0;q<=Xa;q++)d.bl_count[q]=0;m[2*d.heap[d.heap_max]+1]=0;for(k=d.heap_max+1;k<Oa;k++)p=
d.heap[k],q=m[2*m[2*p+1]+1]+1,q>C&&(q=C,D++),m[2*p+1]=q,p>w||(d.bl_count[q]++,x=0,p>=B&&(x=z[p-B]),y=m[2*p],d.opt_len+=y*(q+x),K&&(d.static_len+=y*(r[2*p+1]+x)));if(0!==D){do{for(q=C-1;0===d.bl_count[q];)q--;d.bl_count[q]--;d.bl_count[q+1]+=2;d.bl_count[C]--;D-=2}while(0<D);for(q=C;0!==q;q--)for(p=d.bl_count[q];0!==p;)x=d.heap[--k],x>w||(m[2*x+1]!==q&&(d.opt_len+=(q-m[2*x+1])*m[2*x],m[2*x+1]=q),p--)}h(n,u,d.bl_count)}function gb(d,h,k){var m,n=-1,p=h[1],q=0,r=7,w=4;0===p&&(r=138,w=3);h[2*(k+1)+1]=
65535;for(m=0;m<=k;m++){var x=p;p=h[2*(m+1)+1];++q<r&&x===p||(q<w?d.bl_tree[2*x]+=q:0!==x?(x!==n&&d.bl_tree[2*x]++,d.bl_tree[2*Da]++):10>=q?d.bl_tree[2*Wa]++:d.bl_tree[2*u]++,q=0,n=x,0===p?(r=138,w=3):x===p?(r=6,w=3):(r=7,w=4))}}function ca(d,h,k){var m,n,p=-1,q=h[1],r=0,w=7,x=4;0===q&&(w=138,x=3);for(m=0;m<=k;m++)if(n=q,q=h[2*(m+1)+1],!(++r<w&&n===q)){if(r<x){do E(d,n,d.bl_tree);while(0!==--r)}else 0!==n?(n!==p&&(E(d,n,d.bl_tree),r--),E(d,Da,d.bl_tree),F(d,r-3,2)):10>=r?(E(d,Wa,d.bl_tree),F(d,r-
3,3)):(E(d,u,d.bl_tree),F(d,r-11,7));r=0;p=n;0===q?(w=138,x=3):n===q?(w=6,x=3):(w=7,x=4)}}function pa(d){var h,k=4093624447;for(h=0;31>=h;h++,k>>>=1)if(1&k&&0!==d.dyn_ltree[2*h])return da;if(0!==d.dyn_ltree[18]||0!==d.dyn_ltree[20]||0!==d.dyn_ltree[26])return z;for(h=32;h<ea;h++)if(0!==d.dyn_ltree[2*h])return z;return da}function Y(d,h,k,m){F(d,(C<<1)+(m?1:0),3);y(d);M(d,k);M(d,~k);O.arraySet(d.pending_buf,d.window,h,k,d.pending);d.pending+=k}var O=k("../utils/common"),da=0,z=1,C=0,ea=256,S=ea+1+
29,T=30,Na=19,Oa=2*S+1,Xa=15,Ja=16,Ua=256,Da=16,Wa=17,u=18,Aa=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ca=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],aa=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ba=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fa=Array(2*(S+2));w(fa);var L=Array(2*T);w(L);var G=Array(512);w(G);var B=Array(256);w(B);var J=Array(29);w(J);var qa=Array(T);w(qa);var Fa,U,m,db=!1;q._tr_init=function(k){if(!db){var n,q,r,u=Array(Xa+1);for(r=
q=0;28>r;r++)for(J[r]=q,n=0;n<1<<Aa[r];n++)B[q++]=r;B[q-1]=r;for(r=q=0;16>r;r++)for(qa[r]=q,n=0;n<1<<Ca[r];n++)G[q++]=r;for(q>>=7;r<T;r++)for(qa[r]=q<<7,n=0;n<1<<Ca[r]-7;n++)G[256+q++]=r;for(n=0;n<=Xa;n++)u[n]=0;for(n=0;143>=n;)fa[2*n+1]=8,n++,u[8]++;for(;255>=n;)fa[2*n+1]=9,n++,u[9]++;for(;279>=n;)fa[2*n+1]=7,n++,u[7]++;for(;287>=n;)fa[2*n+1]=8,n++,u[8]++;h(fa,S+1,u);for(n=0;n<T;n++)L[2*n+1]=5,L[2*n]=d(n,5);Fa=new D(fa,Aa,ea+1,S,Xa);U=new D(L,Ca,0,T,Xa);m=new D([],aa,0,Na,7);db=!0}k.l_desc=new H(k.dyn_ltree,
Fa);k.d_desc=new H(k.dyn_dtree,U);k.bl_desc=new H(k.bl_tree,m);k.bi_buf=0;k.bi_valid=0;p(k)};q._tr_stored_block=Y;q._tr_flush_block=function(d,h,k,m){var n=0;if(0<d.level){2===d.strm.data_type&&(d.strm.data_type=pa(d));Ta(d,d.l_desc);Ta(d,d.d_desc);gb(d,d.dyn_ltree,d.l_desc.max_code);gb(d,d.dyn_dtree,d.d_desc.max_code);Ta(d,d.bl_desc);for(n=Na-1;3<=n&&0===d.bl_tree[2*ba[n]+1];n--);n=(d.opt_len+=3*(n+1)+14,n);var q=d.opt_len+3+7>>>3;var r=d.static_len+3+7>>>3;r<=q&&(q=r)}else q=r=k+5;if(k+4<=q&&-1!==
h)Y(d,h,k,m);else if(4===d.strategy||r===q)F(d,2+(m?1:0),3),ia(d,fa,L);else{F(d,4+(m?1:0),3);h=d.l_desc.max_code+1;k=d.d_desc.max_code+1;n+=1;F(d,h-257,5);F(d,k-1,5);F(d,n-4,4);for(q=0;q<n;q++)F(d,d.bl_tree[2*ba[q]+1],3);ca(d,d.dyn_ltree,h-1);ca(d,d.dyn_dtree,k-1);ia(d,d.dyn_ltree,d.dyn_dtree)}p(d);m&&y(d)};q._tr_tally=function(d,h,k){return d.pending_buf[d.d_buf+2*d.last_lit]=h>>>8&255,d.pending_buf[d.d_buf+2*d.last_lit+1]=255&h,d.pending_buf[d.l_buf+d.last_lit]=255&k,d.last_lit++,0===h?d.dyn_ltree[2*
k]++:(d.matches++,h--,d.dyn_ltree[2*(B[k]+ea+1)]++,d.dyn_dtree[2*(256>h?G[h]:G[256+(h>>>7)])]++),d.last_lit===d.lit_bufsize-1};q._tr_align=function(d){F(d,2,3);E(d,Ua,fa);16===d.bi_valid?(M(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}},{"../utils/common":3}],15:[function(k,r,q){r.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg=
"";this.state=null;this.data_type=2;this.adler=0}},{}],"/":[function(k,r,q){q=k("./lib/utils/common").assign;var w=k("./lib/deflate"),D=k("./lib/inflate");k=k("./lib/zlib/constants");var H={};q(H,w,D,k);r.exports=H},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});
var saveAs=saveAs||function(I){if(!("undefined"===typeof I||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var k=I.document.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in k,q=/constructor/i.test(I.HTMLElement)||I.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent),D=function(d){(I.setImmediate||I.setTimeout)(function(){throw d;},0)},H=function(d){setTimeout(function(){"string"===typeof d?(I.URL||I.webkitURL||I).revokeObjectURL(d):d.remove()},4E4)},M=function(d){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?
new Blob([String.fromCharCode(65279),d],{type:d.type}):d},F=function(d,h,p){p||(d=M(d));var y=this,n="application/octet-stream"===d.type,F=function(){var d=["writestart","progress","write","writeend"];d=[].concat(d);for(var h=d.length;h--;){var k=y["on"+d[h]];if("function"===typeof k)try{k.call(y,y)}catch(pa){D(pa)}}};y.readyState=y.INIT;if(r){var E=(I.URL||I.webkitURL||I).createObjectURL(d);setTimeout(function(){k.href=E;k.download=h;var d=new MouseEvent("click");k.dispatchEvent(d);F();H(E);y.readyState=
y.DONE})}else(function(){if((w||n&&q)&&I.FileReader){var h=new FileReader;h.onloadend=function(){var d=w?h.result:h.result.replace(/^data:[^;]*;/,"data:attachment/file;");I.open(d,"_blank")||(I.location.href=d);y.readyState=y.DONE;F()};h.readAsDataURL(d);y.readyState=y.INIT}else E||(E=(I.URL||I.webkitURL||I).createObjectURL(d)),n?I.location.href=E:I.open(E,"_blank")||(I.location.href=E),y.readyState=y.DONE,F(),H(E)})()},E=F.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(d,
h,k){h=h||d.name||"download";k||(d=M(d));return navigator.msSaveOrOpenBlob(d,h)};E.abort=function(){};E.readyState=E.INIT=0;E.WRITING=1;E.DONE=2;E.error=E.onwritestart=E.onprogress=E.onwrite=E.onabort=E.onerror=E.onwriteend=null;return function(d,h,k){return new F(d,h||d.name||"download",k)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});"function"==typeof define&&define.__amd&&(define.amd=define.__amd,delete define.__amd);
