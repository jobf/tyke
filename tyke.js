/*
 howler.js v2.1.1 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com  Spatial Plugin  @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(H){var m=0;return function(){return m<H.length?{done:!1,value:H[m++]}:{done:!0}}};$jscomp.arrayIterator=function(H){return{next:$jscomp.arrayIteratorImpl(H)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(H,m,t){H!=Array.prototype&&H!=Object.prototype&&(H[m]=t.value)};$jscomp.getGlobal=function(H){H=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,H];for(var m=0;m<H.length;++m){var t=H[m];if(t&&t.Math==Math)return t}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(H,m){this.$jscomp$symbol$id_=H;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:m})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function H(t){if(this instanceof H)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(t||"")+"_"+m++,t)}var m=0;return H}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var H=$jscomp.global.Symbol.iterator;H||(H=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[H]&&$jscomp.defineProperty(Array.prototype,H,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var H=$jscomp.global.Symbol.asyncIterator;H||(H=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(H){$jscomp.initSymbolIterator();H={next:H};H[$jscomp.global.Symbol.iterator]=function(){return this};return H};
$jscomp.iteratorFromArray=function(H,m){$jscomp.initSymbolIterator();H instanceof String&&(H+="");var t=0,p={next:function(){if(t<H.length){var C=t++;return{value:m(C,H[C]),done:!1}}p.next=function(){return{done:!0,value:void 0}};return p.next()}};p[Symbol.iterator]=function(){return p};return p};
$jscomp.polyfill=function(H,m,t,p){if(m){t=$jscomp.global;H=H.split(".");for(p=0;p<H.length-1;p++){var C=H[p];C in t||(t[C]={});t=t[C]}H=H[H.length-1];p=t[H];m=m(p);m!=p&&null!=m&&$jscomp.defineProperty(t,H,{configurable:!0,writable:!0,value:m})}};$jscomp.polyfill("Array.prototype.values",function(H){return H?H:function(){return $jscomp.iteratorFromArray(this,function(m,t){return t})}},"es8","es3");
$jscomp.checkStringArgs=function(H,m,t){if(null==H)throw new TypeError("The 'this' value for String.prototype."+t+" must not be null or undefined");if(m instanceof RegExp)throw new TypeError("First argument to String.prototype."+t+" must not be a regular expression");return H+""};
$jscomp.polyfill("String.prototype.startsWith",function(H){return H?H:function(m,t){var p=$jscomp.checkStringArgs(this,m,"startsWith");m+="";var C=p.length,B=m.length;t=Math.max(0,Math.min(t|0,p.length));for(var G=0;G<B&&t<C;)if(p[t++]!=m[G++])return!1;return G>=B}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(H){return H?H:function(){return $jscomp.iteratorFromArray(this,function(m){return m})}},"es6","es3");
$jscomp.polyfill("String.fromCodePoint",function(H){return H?H:function(m){for(var t="",p=0;p<arguments.length;p++){var C=Number(arguments[p]);if(0>C||1114111<C||C!==Math.floor(C))throw new RangeError("invalid_code_point "+C);65535>=C?t+=String.fromCharCode(C):(C-=65536,t+=String.fromCharCode(C>>>10&1023|55296),t+=String.fromCharCode(C&1023|56320))}return t}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(H){return H?H:function(m,t){var p=$jscomp.checkStringArgs(this,m,"endsWith");m+="";void 0===t&&(t=p.length);t=Math.max(0,Math.min(t|0,p.length));for(var C=m.length;0<C&&0<t;)if(p[--t]!=m[--C])return!1;return 0>=C}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(H){return H?H:function(m,t,p){var C=this.length||0;0>t&&(t=Math.max(0,C+t));if(null==p||p>C)p=C;p=Number(p);0>p&&(p=Math.max(0,C+p));for(t=Number(t||0);t<p;t++)this[t]=m;return this}},"es6","es3");
(function(H,m){H.lime=H.lime||{};H.lime.$scripts=H.lime.$scripts||{};H.lime.$scripts.tyke=function(m,p){(function(m,t){function G(a,b){a=Object.create(a);for(var c in b)a[c]=b[c];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function p(a){return Math.ceil(a*Math.random())}function C(a){return a instanceof Array?new Dc(a):a.iterator()}function n(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=t.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];
null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}m.echo=m.echo||{};m.lime=m.lime||{};var d={},k=function(){return Aa.__string_rec(this,"")},u=u||{},f,ha=function(){};d["lime.app.IModule"]=ha;ha.__name__=!0;ha.__isInterface__=!0;var V=function(){this.onExit=new rc};d["lime.app.Module"]=V;V.__name__=!0;V.__interfaces__=[ha];V.prototype={__class__:V};var ka=function(a){this.gameDeviceCache=new Gb;this.parent=a;this.nextUpdate=this.lastUpdate=this.currentUpdate=0;this.framePeriod=-1;lc.init();
this.accelerometer=mc.registerSensor(kf.ACCELEROMETER,0)};d["lime._internal.backend.html5.HTML5Application"]=ka;ka.__name__=!0;ka.prototype={convertKeyCode:function(a){if(65<=a&&90>=a)return a+32;switch(a){case 12:return 1073741980;case 16:return 1073742049;case 17:return 1073742048;case 18:return 1073742050;case 19:return 1073741896;case 20:return 1073741881;case 33:return 1073741899;case 34:return 1073741902;case 35:return 1073741901;case 36:return 1073741898;case 37:return 1073741904;case 38:return 1073741906;
case 39:return 1073741903;case 40:return 1073741905;case 41:return 1073741943;case 43:return 1073741940;case 44:return 1073741894;case 45:return 1073741897;case 46:return 127;case 91:return 1073742051;case 92:return 1073742055;case 93:return 1073742055;case 95:return 1073742106;case 96:return 1073741922;case 97:return 1073741913;case 98:return 1073741914;case 99:return 1073741915;case 100:return 1073741916;case 101:return 1073741917;case 102:return 1073741918;case 103:return 1073741919;case 104:return 1073741920;
case 105:return 1073741921;case 106:return 1073741909;case 107:return 1073741911;case 108:return 1073741923;case 109:return 1073741910;case 110:return 1073741923;case 111:return 1073741908;case 112:return 1073741882;case 113:return 1073741883;case 114:return 1073741884;case 115:return 1073741885;case 116:return 1073741886;case 117:return 1073741887;case 118:return 1073741888;case 119:return 1073741889;case 120:return 1073741890;case 121:return 1073741891;case 122:return 1073741892;case 123:return 1073741893;
case 124:return 1073741928;case 125:return 1073741929;case 126:return 1073741930;case 127:return 1073741931;case 128:return 1073741932;case 129:return 1073741933;case 130:return 1073741934;case 131:return 1073741935;case 132:return 1073741936;case 133:return 1073741937;case 134:return 1073741938;case 135:return 1073741939;case 144:return 1073741907;case 145:return 1073741895;case 160:return 94;case 161:return 33;case 163:return 35;case 164:return 36;case 166:return 1073742094;case 167:return 1073742095;
case 168:return 1073742097;case 169:return 41;case 170:return 42;case 171:return 96;case 172:return 1073741898;case 173:return 45;case 174:return 1073741953;case 175:return 1073741952;case 176:return 1073742082;case 177:return 1073742083;case 178:return 1073742084;case 179:return 1073742085;case 180:return 1073742089;case 181:return 1073742086;case 182:return 1073741953;case 183:return 1073741952;case 186:return 59;case 187:return 61;case 188:return 44;case 189:return 45;case 190:return 46;case 191:return 47;
case 192:return 96;case 193:return 63;case 194:return 1073741923;case 219:return 91;case 220:return 92;case 221:return 93;case 222:return 39;case 223:return 96;case 224:return 1073742051;case 226:return 92}return a},exec:function(){window.addEventListener("keydown",n(this,this.handleKeyEvent),!1);window.addEventListener("keyup",n(this,this.handleKeyEvent),!1);window.addEventListener("focus",n(this,this.handleWindowEvent),!1);window.addEventListener("blur",n(this,this.handleWindowEvent),!1);window.addEventListener("resize",
n(this,this.handleWindowEvent),!1);window.addEventListener("beforeunload",n(this,this.handleWindowEvent),!1);window.addEventListener("devicemotion",n(this,this.handleSensorEvent),!1);CanvasRenderingContext2D.prototype.isPointInStroke||(CanvasRenderingContext2D.prototype.isPointInStroke=function(a,b,c){return!1});CanvasRenderingContext2D.prototype.isPointInPath||(CanvasRenderingContext2D.prototype.isPointInPath=function(a,b,c){return!1});0=="performance"in window&&(window.performance={});if(0=="now"in
window.performance){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart);window.performance.now=function(){return Date.now()-a}}for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=
function(a,c){var e=(new Date).getTime(),g=Math.max(0,16-(e-b));c=window.setTimeout(function(){a(e+g)},g);b=e+g;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});window.requestAnimFrame=window.requestAnimationFrame;this.lastUpdate=(new Date).getTime();this.handleApplicationEvent();return 0},exit:function(){},handleApplicationEvent:function(a){a=0;for(var b=this.parent.__windows;a<b.length;){var c=b[a];++a;c.__backend.updateSize()}this.updateGameDevices();
this.currentUpdate=(new Date).getTime();if(this.currentUpdate>=this.nextUpdate){this.deltaTime=this.currentUpdate-this.lastUpdate;a=0;for(b=this.parent.__windows;a<b.length;)c=b[a],++a,this.parent.onUpdate.dispatch(this.deltaTime|0),null!=c.context&&c.onRender.dispatch(c.context);this.nextUpdate=0>this.framePeriod?this.currentUpdate:this.currentUpdate-this.currentUpdate%this.framePeriod+this.framePeriod;this.lastUpdate=this.currentUpdate}window.requestAnimationFrame(n(this,this.handleApplicationEvent))},
handleKeyEvent:function(a){if(null!=this.parent.__window){var b=this.convertKeyCode(null!=a.keyCode?a.keyCode:a.which),c=(a.shiftKey?3:0)|(a.ctrlKey?192:0)|(a.altKey?768:0)|(a.metaKey?3072:0);"keydown"==a.type?(this.parent.__window.onKeyDown.dispatch(b,c),this.parent.__window.onKeyDown.canceled&&a.cancelable&&a.preventDefault()):(this.parent.__window.onKeyUp.dispatch(b,c),this.parent.__window.onKeyUp.canceled&&a.cancelable&&a.preventDefault())}},handleSensorEvent:function(a){this.accelerometer.onUpdate.dispatch(a.accelerationIncludingGravity.x,
a.accelerationIncludingGravity.y,a.accelerationIncludingGravity.z)},handleWindowEvent:function(a){if(null!=this.parent.__window)switch(a.type){case "blur":this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0);break;case "focus":this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1);break;case "resize":this.parent.__window.__backend.handleResizeEvent(a);break;case "visibilitychange":window.document.hidden?
this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0):this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1)}},updateGameDevices:function(){var a=jb.__getDeviceData();if(null!=a)for(var b,c,e,g,h,w=0,l=a.length;w<l;)if(b=w++,g=a[b],null!=g){if(!this.gameDeviceCache.h.hasOwnProperty(b)){h=new be;h.id=b;h.connected=g.connected;c=0;for(e=g.buttons.length;c<e;){var d=c++;h.buttons.push(g.buttons[d].value)}c=
0;for(e=g.axes.length;c<e;)d=c++,h.axes.push(g.axes[d]);"standard"==g.mapping&&(h.isGamepad=!0);this.gameDeviceCache.h[b]=h;g.connected&&(jb.__connect(b),h.isGamepad&&Ya.__connect(b))}h=this.gameDeviceCache.h[b];e=jb.devices.h[b];c=Ya.devices.h[b];if(g.connected){for(var ba=0,P=g.buttons.length;ba<P;){var r=ba++;d=g.buttons[r].value;if(d!=h.buttons[r]){if(6==r)e.onAxisMove.dispatch(g.axes.length,d),null!=c&&c.onAxisMove.dispatch(4,d);else if(7==r)e.onAxisMove.dispatch(g.axes.length+1,d),null!=c&&
c.onAxisMove.dispatch(5,d);else if(0<d?e.onButtonDown.dispatch(r):e.onButtonUp.dispatch(r),null!=c){switch(r){case 0:b=0;break;case 1:b=1;break;case 2:b=2;break;case 3:b=3;break;case 4:b=9;break;case 5:b=10;break;case 8:b=4;break;case 9:b=6;break;case 10:b=7;break;case 11:b=8;break;case 12:b=11;break;case 13:b=12;break;case 14:b=13;break;case 15:b=14;break;case 16:b=5;break;default:continue}0<d?c.onButtonDown.dispatch(b):c.onButtonUp.dispatch(b)}h.buttons[r]=d}}b=0;for(d=g.axes.length;b<d;)ba=b++,
g.axes[ba]!=h.axes[ba]&&(e.onAxisMove.dispatch(ba,g.axes[ba]),null!=c&&c.onAxisMove.dispatch(ba,g.axes[ba]),h.axes[ba]=g.axes[ba])}else h.connected&&(h.connected=!1,jb.__disconnect(b),Ya.__disconnect(b))}},__class__:ka};var ca=function(){this.onCreateWindow=new ce;this.onUpdate=new rc;this.onExit=new rc;null==ca.current&&(ca.current=this);this.meta=new Y;this.modules=[];this.__windowByID=new Gb;this.__windows=[];this.__backend=new ka(this);this.__registerLimeModule(this);this.__preloader=new de;this.__preloader.onProgress.add(n(this,
this.onPreloadProgress));this.__preloader.onComplete.add(n(this,this.onPreloadComplete))};d["lime.app.Application"]=ca;ca.__name__=!0;ca.__super__=V;ca.prototype=G(V.prototype,{createWindow:function(a){a=this.__createWindow(a);this.__addWindow(a);return a},exec:function(){ca.current=this;return this.__backend.exec()},onGamepadAxisMove:function(a,b,c){},onGamepadButtonDown:function(a,b){},onGamepadButtonUp:function(a,b){},onGamepadConnect:function(a){},onGamepadDisconnect:function(a){},onJoystickAxisMove:function(a,
b,c){},onJoystickButtonDown:function(a,b){},onJoystickButtonUp:function(a,b){},onJoystickConnect:function(a){},onJoystickDisconnect:function(a){},onJoystickHatMove:function(a,b,c){},onJoystickTrackballMove:function(a,b,c,e){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onModuleExit:function(a){},onMouseDown:function(a,b,c){},onMouseMove:function(a,b){},onMouseMoveRelative:function(a,b){},onMouseUp:function(a,b,c){},onMouseWheel:function(a,b,c){},onPreloadComplete:function(){},onPreloadProgress:function(a,
b){},onRenderContextLost:function(){},onRenderContextRestored:function(a){},onTextEdit:function(a,b,c){},onTextInput:function(a){},onTouchCancel:function(a){},onTouchEnd:function(a){},onTouchMove:function(a){},onTouchStart:function(a){},onWindowActivate:function(){},onWindowClose:function(){},onWindowCreate:function(){},onWindowDeactivate:function(){},onWindowDropFile:function(a){},onWindowEnter:function(){},onWindowExpose:function(){},onWindowFocusIn:function(){},onWindowFocusOut:function(){},onWindowFullscreen:function(){},
onWindowLeave:function(){},onWindowMove:function(a,b){},onWindowMinimize:function(){},onWindowResize:function(a,b){},onWindowRestore:function(){},render:function(a){},update:function(a){},__addWindow:function(a){if(null!=a){this.__windows.push(a);this.__windowByID.h[a.id]=a;var b=n(this,this.__onWindowClose);a.onClose.add(function(){b(a)},!1,-1E4);null==this.__window&&(this.__window=a,a.onActivate.add(n(this,this.onWindowActivate)),a.onRenderContextLost.add(n(this,this.onRenderContextLost)),a.onRenderContextRestored.add(n(this,
this.onRenderContextRestored)),a.onDeactivate.add(n(this,this.onWindowDeactivate)),a.onDropFile.add(n(this,this.onWindowDropFile)),a.onEnter.add(n(this,this.onWindowEnter)),a.onExpose.add(n(this,this.onWindowExpose)),a.onFocusIn.add(n(this,this.onWindowFocusIn)),a.onFocusOut.add(n(this,this.onWindowFocusOut)),a.onFullscreen.add(n(this,this.onWindowFullscreen)),a.onKeyDown.add(n(this,this.onKeyDown)),a.onKeyUp.add(n(this,this.onKeyUp)),a.onLeave.add(n(this,this.onWindowLeave)),a.onMinimize.add(n(this,
this.onWindowMinimize)),a.onMouseDown.add(n(this,this.onMouseDown)),a.onMouseMove.add(n(this,this.onMouseMove)),a.onMouseMoveRelative.add(n(this,this.onMouseMoveRelative)),a.onMouseUp.add(n(this,this.onMouseUp)),a.onMouseWheel.add(n(this,this.onMouseWheel)),a.onMove.add(n(this,this.onWindowMove)),a.onRender.add(n(this,this.render)),a.onResize.add(n(this,this.onWindowResize)),a.onRestore.add(n(this,this.onWindowRestore)),a.onTextEdit.add(n(this,this.onTextEdit)),a.onTextInput.add(n(this,this.onTextInput)),
this.onWindowCreate());this.onCreateWindow.dispatch(a)}},__createWindow:function(a){a=new ee(this,a);return-1==a.id?null:a},__registerLimeModule:function(a){a.onUpdate.add(n(this,this.update));a.onExit.add(n(this,this.onModuleExit),!1,0);a.onExit.add(n(this,this.__onModuleExit),!1,0);for(a=Ya.devices.iterator();a.hasNext();){var b=a.next();this.__onGamepadConnect(b)}Ya.onConnect.add(n(this,this.__onGamepadConnect));for(a=jb.devices.iterator();a.hasNext();)b=a.next(),this.__onJoystickConnect(b);jb.onConnect.add(n(this,
this.__onJoystickConnect));ub.onCancel.add(n(this,this.onTouchCancel));ub.onStart.add(n(this,this.onTouchStart));ub.onMove.add(n(this,this.onTouchMove));ub.onEnd.add(n(this,this.onTouchEnd))},__removeWindow:function(a){null!=a&&this.__windowByID.h.hasOwnProperty(a.id)&&(this.__window==a&&(this.__window=null),I.remove(this.__windows,a),this.__windowByID.remove(a.id),a.close(),0==this.__windows.length&&Qb.exit(0))},__onGamepadConnect:function(a){this.onGamepadConnect(a);var b=n(this,this.onGamepadAxisMove),
c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=n(this,this.onGamepadButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);var g=n(this,this.onGamepadButtonUp);c=function(b){g(a,b)};a.onButtonUp.add(c);var h=n(this,this.onGamepadDisconnect);a.onDisconnect.add(function(){h(a)})},__onJoystickConnect:function(a){this.onJoystickConnect(a);var b=n(this,this.onJoystickAxisMove),c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=n(this,this.onJoystickButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);
var g=n(this,this.onJoystickButtonUp);c=function(b){g(a,b)};a.onButtonUp.add(c);var h=n(this,this.onJoystickDisconnect);a.onDisconnect.add(function(){h(a)});var w=n(this,this.onJoystickHatMove);c=function(b,c){w(a,b,c)};a.onHatMove.add(c);var l=n(this,this.onJoystickTrackballMove);c=function(b,c,e){l(a,b,c,e)};a.onTrackballMove.add(c)},__onModuleExit:function(a){this.__backend.exit()},__onWindowClose:function(a){if(this.__window==a)this.onWindowClose();this.__removeWindow(a)},__class__:ca});var B=
function(){this.isReadyForUpdate=!1;ca.call(this)};d["ob.gum.backends.App"]=B;B.__name__=!0;B.__super__=ca;B.prototype=G(ca.prototype,{init:function(a,b){this.gum=new fe(a,b);this.isReadyForUpdate=!0},onWindowCreate:function(){ia.trace("App onWindowCreate",{fileName:"ob/gum/backends/Lime.hx",lineNumber:22,className:"ob.gum.backends.App",methodName:"onWindowCreate"});switch(this.__window.context.type){case "opengl":case "opengles":case "webgl":try{this.init(this.__window)}catch(b){var a=A.caught(b);
ia.trace(yc.toString(yc.exceptionStack()),{fileName:"ob/gum/backends/Lime.hx",lineNumber:28,className:"ob.gum.backends.App",methodName:"onWindowCreate",customParams:[a]})}break;default:throw A.thrown("Sorry, only works with OpenGL.");}},update:function(a){if(this.isReadyForUpdate)this.gum.onUpdate(a)},onKeyDown:function(a,b){this.gum.onKeyDown(a,b)},onKeyUp:function(a,b){this.gum.onKeyUp(a,b)},onMouseMove:function(a,b){this.gum.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.gum.onMouseDown(a,
b,c)},onMouseUp:function(a,b,c){this.gum.onMouseUp(a,b,c)},onMouseWheel:function(a,b,c){this.gum.onMouseScroll(a,b,c)},onWindowResize:function(a,b){ca.prototype.onWindowResize.call(this,a,b);this.gum.onWindowResize(a,b)},__class__:B});var H=function(){this.config=new ge(40,40);B.call(this)};d.SampleApp=H;H.__name__=!0;H.__super__=B;H.prototype=G(B.prototype,{init:function(a,b){B.prototype.init.call(this,a,{framesPerSecond:30,drawOnlyWhenRequested:!0,displayWidth:800,displayHeight:600,displayIsScaled:!0});
this.initLoop()},initLoop:function(){},__class__:H});var ta=function(){H.call(this)};d.TApp=ta;ta.__name__=!0;ta.__super__=H;ta.prototype=G(H.prototype,{initLoop:function(){H.prototype.initLoop.call(this);this.gum.changeLoop(new dd(this.config,new he({fonts:["assets/fonts/tiled/hack_ascii.json"],images:["assets/images/bit-bonanza-food.png"]})))},__class__:ta});var la=function(){};d.ApplicationMain=la;la.__name__=!0;la.main=function(){Qb.__registerEntryPoint("tyke",la.create)};la.create=function(a){L.init(a);
var b=new ta;b.meta.h.build="1";b.meta.h.company="ob";b.meta.h.file="tyke";b.meta.h.name="tyke";b.meta.h.packageName="tyke";b.meta.h.version="0.0.1";var c={allowHighDPI:!1,alwaysOnTop:!1,borderless:!1,element:null,frameRate:61,height:0,hidden:!1,maximized:!1,minimized:!1,parameters:{},resizable:!0,title:"tyke",width:0,x:null,y:null,context:{antialiasing:0,background:16777215,colorDepth:32,depth:!0,hardware:!0,stencil:!0,type:null,vsync:!1}};if(null==b.__window&&null!=a)for(var e=0,g=F.fields(a);e<
g.length;){var h=g[e];++e;Object.prototype.hasOwnProperty.call(c,h)?c[h]=F.field(a,h):Object.prototype.hasOwnProperty.call(c.context,h)&&(c.context[h]=F.field(a,h))}b.createWindow(c);e=0;for(g=L.preloadLibraries;e<g.length;)a=g[e],++e,b.__preloader.addLibrary(a);e=0;for(g=L.preloadLibraryNames;e<g.length;)a=g[e],++e,b.__preloader.addLibraryName(a);b.__preloader.load();la.start(b)};la.start=function(a){a.exec()};var M=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};d.EReg=M;M.__name__=!0;
M.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw A.thrown("EReg::matched");},matchedRight:function(){if(null==this.r.m)throw A.thrown("No string matched");var a=this.r.m.index+this.r.m[0].length;return I.substr(this.r.s,a,this.r.s.length-a)},matchedPos:function(){if(null==this.r.m)throw A.thrown("No string matched");return{pos:this.r.m.index,
len:this.r.m[0].length}},matchSub:function(a,b,c){null==c&&(c=-1);if(this.r.global){if(this.r.lastIndex=b,this.r.m=this.r.exec(0>c?a:I.substr(a,0,b+c)),c=null!=this.r.m)this.r.s=a}else if(c=this.match(0>c?I.substr(a,b,null):I.substr(a,b,c)))this.r.s=a,this.r.m.index+=b;return c},map:function(a,b){for(var c=0,e="";!(c>=a.length);){if(!this.matchSub(a,c)){e+=x.string(I.substr(a,c,null));break}var g=this.matchedPos();e+=x.string(I.substr(a,c,g.pos-c));e+=x.string(b(this));0==g.len?(e+=x.string(I.substr(a,
g.pos,1)),c=g.pos+1):c=g.pos+g.len;if(!this.r.global)break}!this.r.global&&0<c&&c<a.length&&(e+=x.string(I.substr(a,c,null)));return e},__class__:M};var I=function(){};d.HxOverrides=I;I.__name__=!0;I.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return a=a.split(" "),b=a[0].split("-"),a=a[1].split(":"),new Date(b[0],
b[1]-1,b[2],a[0],a[1],a[2]);default:throw A.thrown("Invalid date format : "+a);}};I.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};I.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};I.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};I.now=function(){return Date.now()};var z=function(a,b,c){this.errors=a;this.putils=b;this.errorType=c};d["json2object.reader.BaseParser"]=z;z.__name__=!0;z.prototype=
{fromJson:function(a,b){null==b&&(b="");this.putils=new ie(a);this.errors=[];try{var c=(new je(a,b)).doParse();this.loadJson(c)}catch(e){if(oa.lastError=e,a=A.caught(e).unwrap(),a instanceof zc)this.errors.push(ra.ParserError(a.message,this.putils.convertPosition(a.pos)));else throw e;}return this.value},loadJson:function(a,b){null==b&&(b="");var c=this.putils.convertPosition(a.pos);a=a.value;switch(a._hx_index){case 0:this.loadJsonString(a.s,c,b);break;case 1:this.loadJsonNumber(a.s,c,b);break;case 2:this.loadJsonObject(a.fields,
c,b);break;case 3:this.loadJsonArray(a.values,c,b);break;case 4:this.loadJsonBool(a.b,c,b);break;case 5:this.loadJsonNull(c,b)}return this.value},loadJsonNull:function(a,b){this.onIncorrectType(a,b)},loadJsonString:function(a,b,c){this.onIncorrectType(b,c)},loadJsonNumber:function(a,b,c){this.onIncorrectType(b,c)},loadJsonUInt:function(a,b,c,e){var g=0;a=Z.trim(a);"-"==a.charAt(0)&&(a=I.substr(a,1,null));var h=Z.startsWith(a,"0x");h&&(a=I.substr(a,2,null));for(var w=h?16:10,l=1,d=a.length-1;0<=d;){var ba=
h?x.parseInt("0x"+a.charAt(d)):x.parseInt(a.charAt(d));if(null==ba)return this.onIncorrectType(b,c),e;g+=l*ba;l*=w;--d}return g},loadJsonInt:function(a,b,c,e){if(null!=x.parseInt(a)&&x.parseInt(a)==parseFloat(a))return x.parseInt(a);this.onIncorrectType(b,c);return e},loadJsonFloat:function(a,b,c,e){if(null!=x.parseInt(a))return parseFloat(a);this.onIncorrectType(b,c);return e},loadJsonBool:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArray:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArrayValue:function(a,
b,c){for(var e=[],g=0;g<a.length;){var h=a[g];++g;try{var w=b(h,c)}catch(l){if(oa.lastError=l,h=A.caught(l).unwrap(),Aa.__instanceof(h,Hb)){if(h!=Hb.ParsingThrow)throw A.thrown(h);continue}else throw l;}e.push(w)}return e},loadJsonObject:function(a,b,c){this.onIncorrectType(b,c)},loadObjectField:function(a,b,c,e,g,h){try{var w=a(b.value,b.name);this.mapSet(e,c,!0);return w}catch(l){if(oa.lastError=l,a=A.caught(l).unwrap(),Aa.__instanceof(a,Hb)){if(a!=Hb.ParsingThrow)throw A.thrown(a);}else this.errors.push(ra.CustomFunctionException(a,
h))}return g},objectSetupAssign:function(a,b,c){for(var e=0,g=b.length;e<g;){var h=e++;this.mapSet(a,b[h],c[h])}},objectErrors:function(a,b){b=this.putils.convertPosition(new Ea(b.file,b.max-1,b.max-1));for(var c=Object.keys(a.h),e=c.length,g=0;g<e;){var h=c[g++];a.h[h]||this.errors.push(ra.UninitializedVariable(h,b))}},onIncorrectType:function(a,b){this.parsingThrow()},parsingThrow:function(){if(0!=this.errorType)throw A.thrown(Hb.ParsingThrow);},mapSet:function(a,b,c){a.h[b]=c},__class__:z};var O=
function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_0=O;O.__name__=!0;O.__super__=z;O.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"peote.text.FontConfig",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,"packed distancefield kerning width height color bgColor line tiles rangeSplitSize ranges".split(" "),[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,
!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "bgColor":this.value.bgColor=this.loadObjectField((f=new Ra(this.errors,this.putils,1),n(f,f.loadJson)),g,"bgColor",c,this.value.bgColor,b);break;case "color":this.value.color=this.loadObjectField((f=new Ra(this.errors,this.putils,1),n(f,f.loadJson)),g,"color",c,this.value.color,b);break;case "distancefield":this.value.distancefield=this.loadObjectField((f=new Oa(this.errors,this.putils,1),n(f,f.loadJson)),
g,"distancefield",c,this.value.distancefield,b);break;case "height":this.value.height=this.loadObjectField((f=new wa(this.errors,this.putils,1),n(f,f.loadJson)),g,"height",c,this.value.height,b);break;case "kerning":this.value.kerning=this.loadObjectField((f=new q(this.errors,this.putils,1),n(f,f.loadJson)),g,"kerning",c,this.value.kerning,b);break;case "line":this.value.line=this.loadObjectField((f=new W(this.errors,this.putils,1),n(f,f.loadJson)),g,"line",c,this.value.line,b);break;case "packed":this.value.packed=
this.loadObjectField((f=new Oa(this.errors,this.putils,1),n(f,f.loadJson)),g,"packed",c,this.value.packed,b);break;case "rangeSplitSize":this.value.rangeSplitSize=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"rangeSplitSize",c,this.value.rangeSplitSize,b);break;case "ranges":this.value.ranges=this.loadObjectField((f=new ya(this.errors,this.putils,1),n(f,f.loadJson)),g,"ranges",c,this.value.ranges,b);break;case "tiles":this.value.tiles=this.loadObjectField((f=new aa(this.errors,
this.putils,1),n(f,f.loadJson)),g,"tiles",c,this.value.tiles,b);break;case "width":this.value.width=this.loadObjectField((f=new wa(this.errors,this.putils,1),n(f,f.loadJson)),g,"width",c,this.value.width,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(ke.prototype);a.packed=!1;a.distancefield=!1;a.kerning=null;a.width=16;a.height=16;a.color=-1;a.bgColor=0;a.line=null;a.tiles=null;a.rangeSplitSize=
4096;a.ranges=(new ya([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)));return a},__class__:O});var ya=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_1=ya;ya.__name__=!0;ya.__super__=z;ya.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Array<{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }>",
a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonArray:function(a,b,c){this.value=this.loadJsonArrayValue(a,(f=new ma(this.errors,this.putils,2),n(f,f.loadJson)),c)},__class__:ya});var S=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c);this.value=0};d.JsonParser_10=S;S.__name__=!0;S.__super__=z;S.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"UInt",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,
b,c){this.value=this.loadJsonUInt(a,b,c,this.value)},__class__:S});var ma=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_11=ma;ma.__name__=!0;ma.__super__=z;ma.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }",a));z.prototype.onIncorrectType.call(this,
a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,"data image line range slot tiles".split(" "),[!0,!1,!0,!1,!1,!0]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "data":this.value.data=this.loadObjectField((f=new ua(this.errors,this.putils,1),n(f,f.loadJson)),g,"data",c,this.value.data,b);break;case "image":this.value.image=this.loadObjectField((f=new Sa(this.errors,this.putils,1),n(f,f.loadJson)),
g,"image",c,this.value.image,b);break;case "line":this.value.line=this.loadObjectField((f=new Za(this.errors,this.putils,1),n(f,f.loadJson)),g,"line",c,this.value.line,b);break;case "range":this.value.range=this.loadObjectField((f=new Ga(this.errors,this.putils,1),n(f,f.loadJson)),g,"range",c,this.value.range,b);break;case "slot":this.value.slot=this.loadObjectField((f=new Va(this.errors,this.putils,1),n(f,f.loadJson)),g,"slot",c,this.value.slot,b);break;case "tiles":this.value.tiles=this.loadObjectField((f=
new gb(this.errors,this.putils,1),n(f,f.loadJson)),g,"tiles",c,this.value.tiles,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{data:(new ua([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1))),image:(new Sa([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1))),line:(new Za([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1))),range:(new Ga([],this.putils,0)).loadJson(new sa(Ba.JNull,
new Ea("",0,1))),slot:(new Va([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1))),tiles:(new gb([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)))}},__class__:ma});var ua=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_13=ua;ua.__name__=!0;ua.__super__=z;ua.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"String",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,
b,c){this.value=a},__class__:ua});var Sa=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_14=Sa;Sa.__name__=!0;Sa.__super__=z;Sa.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"String",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,b,c){this.value=a},__class__:Sa});var Za=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_16=Za;Za.__name__=!0;Za.__super__=
z;Za.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ height : Float, base : Float }",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "base":this.value.base=this.loadObjectField((f=new wa(this.errors,this.putils,1),n(f,f.loadJson)),g,"base",
c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((f=new wa(this.errors,this.putils,1),n(f,f.loadJson)),g,"height",c,this.value.height,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new wa([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1))),height:(new wa([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)))}},__class__:Za});var Ga=function(a,
b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_17=Ga;Ga.__name__=!0;Ga.__super__=z;Ga.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"peote.text.Range",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,["min","max"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "max":this.value.max=this.loadObjectField((f=
new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"max",c,this.value.max,b);break;case "min":this.value.min=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"min",c,this.value.min,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(le.prototype);a.min=(new N([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)));a.max=(new N([],this.putils,0)).loadJson(new sa(Ba.JNull,
new Ea("",0,1)));return a},__class__:Ga});var Va=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_18=Va;Va.__name__=!0;Va.__super__=z;Va.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ width : Int, height : Int }",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,["height","width"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=
a[e];++e;switch(g.name){case "height":this.value.height=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"height",c,this.value.height,b);break;case "width":this.value.width=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"width",c,this.value.width,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{height:(new N([],this.putils,0)).loadJson(new sa(Ba.JNull,
new Ea("",0,1))),width:(new N([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)))}},__class__:Va});var Oa=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c);this.value=!1};d.JsonParser_2=Oa;Oa.__name__=!0;Oa.__super__=z;Oa.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Bool",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonBool:function(a,b,c){this.value=a},__class__:Oa});var gb=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_20=
gb;gb.__name__=!0;gb.__super__=z;gb.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ y : Int, x : Int }",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "x":this.value.x=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),
g,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"y",c,this.value.y,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new N([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1))),y:(new N([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)))}},__class__:gb});var q=function(a,b,c){null==c&&(c=0);z.call(this,
a,b,c)};d.JsonParser_4=q;q.__name__=!0;q.__super__=z;q.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Bool",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonBool:function(a,b,c){this.value=a},__class__:q});var wa=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c);this.value=0};d.JsonParser_5=wa;wa.__name__=!0;wa.__super__=z;wa.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,
"Float",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonFloat(a,b,c,this.value)},__class__:wa});var Ra=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_6=Ra;Ra.__name__=!0;Ra.__super__=z;Ra.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"peote.view.Color",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=(new S(this.errors,this.putils,0)).loadJson(new sa(Ba.JNumber(a),
new Ea(b.file,b.min-1,b.max-1)),c)},__class__:Ra});var W=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_7=W;W.__name__=!0;W.__super__=z;W.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ height : Float, base : Float }",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<
a.length;){var g=a[e];++e;switch(g.name){case "base":this.value.base=this.loadObjectField((f=new wa(this.errors,this.putils,1),n(f,f.loadJson)),g,"base",c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((f=new wa(this.errors,this.putils,1),n(f,f.loadJson)),g,"height",c,this.value.height,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new wa([],this.putils,0)).loadJson(new sa(Ba.JNull,
new Ea("",0,1))),height:(new wa([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)))}},__class__:W});var aa=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c)};d.JsonParser_8=aa;aa.__name__=!0;aa.__super__=z;aa.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ y : Int, x : Int }",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new Y;this.objectSetupAssign(c,["x","y"],[!1,
!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "x":this.value.x=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((f=new N(this.errors,this.putils,1),n(f,f.loadJson)),g,"y",c,this.value.y,b);break;default:this.errors.push(ra.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new N([],this.putils,
0)).loadJson(new sa(Ba.JNull,new Ea("",0,1))),y:(new N([],this.putils,0)).loadJson(new sa(Ba.JNull,new Ea("",0,1)))}},__class__:aa});var N=function(a,b,c){null==c&&(c=0);z.call(this,a,b,c);this.value=0};d.JsonParser_9=N;N.__name__=!0;N.__super__=z;N.prototype=G(z.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Int",a));z.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonInt(a,b,c,this.value)},__class__:N});var L=function(){};
d.ManifestResources=L;L.__name__=!0;L.init=function(a){L.preloadLibraries=[];L.preloadLibraryNames=[];L.rootPath=null;null!=a&&Object.prototype.hasOwnProperty.call(a,"rootPath")&&(L.rootPath=F.field(a,"rootPath"));null==L.rootPath&&(L.rootPath="./");a=Jb.parse('{"name":null,"assets":"aoy4:pathy39:assets%2Ffonts%2Ftiled%2Fhack_ascii.pngy4:sizei12425y4:typey5:IMAGEy2:idR1y7:preloadtgoR0y40:assets%2Ffonts%2Ftiled%2Fhack_ascii.jsonR2i1258R3y4:TEXTR5R7R6tgoR0y27:assets%2Fimages%2Freadme.mdR2i225R3R8R5R9R6tgoR0y38:assets%2Fimages%2Fbit-bonanza-food.pngR2i25790R3R4R5R10R6tgh","rootPath":null,"version":2,"libraryArgs":[],"libraryType":null}',
L.rootPath);a=qb.fromManifest(a);R.registerLibrary("default",a);a=R.getLibrary("default");null!=a?L.preloadLibraries.push(a):L.preloadLibraryNames.push("default")};Math.__name__=!0;var F=function(){};d.Reflect=F;F.__name__=!0;F.field=function(a,b){try{return a[b]}catch(c){return oa.lastError=c,null}};F.getProperty=function(a,b){var c;if(null==a)return null;var e=a.__properties__?c=a.__properties__["get_"+b]:!1;return e?a[c]():a[b]};F.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,
e;for(e in a)"__id__"!=e&&"hx__closures__"!=e&&c.call(a,e)&&b.push(e)}return b};F.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};F.compareMethods=function(a,b){return a==b?!0:F.isFunction(a)&&F.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};F.copy=function(a){if(null==a)return null;for(var b={},c=0,e=F.fields(a);c<e.length;){var g=e[c];++c;b[g]=F.field(a,g)}return b};var x=function(){};d.Std=x;x.__name__=!0;x.string=function(a){return Aa.__string_rec(a,
"")};x.parseInt=function(a){if(null!=a)for(var b=0,c=a.length;b<c;){var e=b++,g=a.charCodeAt(e);if(8>=g||14<=g&&32!=g&&45!=g)if(b=a.charCodeAt(e+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};var pb=function(){};d["_String.String_Impl_"]=pb;pb.__name__=!0;pb.fromCharCode=function(a){return String.fromCodePoint(a)};var va=function(){this.b=""};d.StringBuf=va;va.__name__=!0;va.prototype={__class__:va};var Z=function(){};d.StringTools=Z;Z.__name__=!0;Z.startsWith=function(a,
b){return a.length>=b.length?0==a.lastIndexOf(b,0):!1};Z.endsWith=function(a,b){var c=b.length,e=a.length;return e>=c?a.indexOf(b,e-c)==e-c:!1};Z.isSpace=function(a,b){a=I.cca(a,b);return 8<a&&14>a?!0:32==a};Z.ltrim=function(a){for(var b=a.length,c=0;c<b&&Z.isSpace(a,c);)++c;return 0<c?I.substr(a,c,b-c):a};Z.rtrim=function(a){for(var b=a.length,c=0;c<b&&Z.isSpace(a,b-c-1);)++c;return 0<c?I.substr(a,0,b-c):a};Z.trim=function(a){return Z.ltrim(Z.rtrim(a))};Z.replace=function(a,b,c){return a.split(b).join(c)};
var ea=function(){};d.Type=ea;ea.__name__=!0;ea.createInstance=function(a,b){return new (Function.prototype.bind.apply(a,[null].concat(b)))};ea.createEnum=function(a,b,c){var e=F.field(a,b);if(null==e)throw A.thrown("No such constructor "+b);if(F.isFunction(e)){if(null==c)throw A.thrown("Constructor "+b+" need parameters");return e.apply(a,c)}if(null!=c&&0!=c.length)throw A.thrown("Constructor "+b+" does not need parameters");return e};var y={toFloat:function(a){return 0>a?4294967296+a:a+0}},Ha=function(){};
d["echo.util.Disposable"]=Ha;Ha.__name__=!0;Ha.__isInterface__=!0;var E=function(a){this.transform=new Xc;this.layer_mask=nf._new();this.layers=nf._new();var b=new Q(0,0);this.drag=b;this.max_velocity=b=new Q(0,0);this.torque=0;this.acceleration=b=new Q(0,0);this.velocity=b=new Q(0,0);this.material=Bb.global;this.id=++E.ids;this.active=!0;this.shapes=[];this.data={};this.disposed=!1;this.transform.on_dirty=n(this,this.on_dirty);this.load_options(a)};d["echo.Body"]=E;E.__name__=!0;E.__interfaces__=
[Ha];E.__properties__={get_defaults:"get_defaults"};E.get_defaults=function(){return{kinematic:!1,mass:E.default_mass,x:0,y:0,rotation:0,scale_x:1,scale_y:1,velocity_x:0,velocity_y:0,rotational_velocity:0,max_velocity_x:0,max_velocity_y:0,max_velocity_length:0,max_rotational_velocity:1E4,drag_x:0,drag_y:0,drag_length:0,rotational_drag:0}};E.prototype={load_options:function(a){a=ed.copy_fields(a,E.get_defaults());for(var b=0,c=this.shapes;b<c.length;){var e=c[b];++b;e.put()}this.shapes.length=0;c=
a.x;b=this.transform;b.dirty||b.set_dirty();b.local_x=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);c=a.y;b=this.transform;b.dirty||b.set_dirty();b.local_y=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);b=this.transform;c=Math.PI/180*a.rotation;b.dirty||b.set_dirty();b.local_radians=c;if(null!=this.on_rotate)this.on_rotate(180/Math.PI*this.transform.local_radians);c=a.scale_x;b=this.transform;b.dirty||b.set_dirty();b.local_scale_x=
c;c=a.scale_y;b=this.transform;b.dirty||b.set_dirty();b.local_scale_y=c;this.kinematic=a.kinematic;this.material=null!=a.material?a.material:null!=a.gravity_scale||null!=a.elasticity?new Bb(a.elasticity,null,null,null,a.gravity_scale):Bb.global;c=this.velocity;c.x=a.velocity_x;c.y=a.velocity_y;this.rotational_velocity=a.rotational_velocity;c=this.max_velocity;c.x=a.max_velocity_x;c.y=a.max_velocity_y;this.max_velocity_length=a.max_velocity_length;this.max_rotational_velocity=a.max_rotational_velocity;
c=this.drag;c.x=a.drag_x;c.y=a.drag_y;this.drag_length=a.drag_length;this.rotational_drag=a.rotational_drag;this.last_rotation=this.last_y=this.last_x=NaN;this.dirty=!0;if(null!=a.shape){e=Wa.get(a.shape);var g=-1;null==g&&(g=-1);-1==this.shapes.indexOf(e)&&(-1<g?this.shapes[g]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)))}if(null!=a.shapes)for(b=0,c=a.shapes;b<
c.length;)e=c[b],++b,e=Wa.get(e),g=-1,null==g&&(g=-1),-1==this.shapes.indexOf(e)&&(-1<g?this.shapes[g]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));null!=a.shape_instance&&(e=a.shape_instance,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))));
if(null!=a.shape_instances)for(b=0,c=a.shape_instances;b<c.length;)e=c[b],++b,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));b=a.mass;if(null==b)c=a.mass,c<E.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&
null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);else switch(b){case -1:b=a=0;for(c=this.shapes;b<c.length;)e=c[b],++b,a+=e.volume()*this.material.density;a<E.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=a,this.inverse_mass=
1/this.mass);break;case 0:c=0;c<E.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);break;default:c=a.mass,c<E.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):
(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass)}},set_position:function(a,b){null==b&&(b=0);null==a&&(a=0);var c=this.transform;null==b&&(b=0);null==a&&(a=0);c.dirty||c.set_dirty();c.local_x=a;c.dirty||c.set_dirty();c.local_y=b},bounds:function(a){if(0==this.shapes.length){var b=this.transform.local_x,c=this.transform.local_y,e=1,g=1;null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);a=$a.pool.get();var h=b;
null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==h&&(h=0);e*=.5;g*=.5;a.min_x=h-e;a.min_y=c-g;a.max_x=h+e;a.max_y=c+g;a.pooled=!1;return a}h=this.shapes[0].bounds();if(1<this.shapes.length)for(g=1,e=this.shapes.length;g<e;)c=g++,c=this.shapes[c].bounds(),h.min_x>c.min_x&&(h.min_x=c.min_x),h.min_y>c.min_y&&(h.min_y=c.min_y),h.max_x<c.max_x&&(h.max_x=c.max_x),h.max_y<c.max_y&&(h.max_y=c.max_y),c.put();null==a&&(a=$a.pool.get(),c=b=0,g=e=1,null==g&&(g=1),null==e&&(e=1),null==c&&(c=0),null==b&&(b=0),
e*=.5,g*=.5,a.min_x=b-e,a.min_y=c-g,a.max_x=b+e,a.max_y=c+g,a.pooled=!1);a.min_x=h.min_x;a.max_x=h.max_x;a.min_y=h.min_y;a.max_y=h.max_y;h.put();return a},on_dirty:function(a){this.dirty=!0;0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))},__class__:E};var v=function(){};d["echo.Collisions"]=v;v.__name__=!0;v.update_quadtree=function(a){for(var b=0,c=a.members;b<c.length;){var e=c[b];++b;if(!e.disposed){e.collided=!1;for(var g=
0,h=e.shapes;g<h.length;){var w=h[g];++g;w.collided=!1}e.active&&0<e.mass&&e.dirty&&0<e.shapes.length&&(null==e.quadtree_data.bounds?e.quadtree_data.bounds=e.bounds():e.bounds(e.quadtree_data.bounds),a.quadtree.update(e.quadtree_data,!1),e.dirty=!1)}}a.quadtree.shake()};v.query=function(a,b){v.update_quadtree(a);b=null==b?a.listeners.members:b.members;for(var c=0;c<b.length;){var e=b[c];++c;e.quadtree_results.length=0;var g=e.a;switch(g._hx_index){case 0:g=g.v;var h=e.b;switch(h._hx_index){case 0:g=
v.overlap_body_and_body_bounds(g,h.v);null!=g&&e.quadtree_results.push(g);break;case 1:v.overlap_body_and_bodies_bounds(g,h.v,a,e.quadtree_results)}break;case 1:switch(g=g.v,h=e.b,h._hx_index){case 0:v.overlap_body_and_bodies_bounds(h.v,g,a,e.quadtree_results);break;case 1:h=h.v,v.overlap_bodies_and_bodies_bounds(g,h,a,e.quadtree_results),g!=h&&v.overlap_bodies_and_bodies_bounds(h,g,a,e.quadtree_results)}}g=0;for(h=e.last_collisions;g<h.length;){var w=h[g];++g;w.put()}e.last_collisions.length=e.collisions.length;
g=0;for(h=e.collisions.length;g<h;)w=g++,e.last_collisions[w]=e.collisions[w];g=e.collisions.length=0;for(h=e.quadtree_results;g<h.length;)if(w=h[g],++g,w.a.disposed||w.b.disposed)w.put();else if(w.a.id==w.b.id)w.put();else{for(var l=!1,d=0,ba=e.collisions;d<ba.length;){var P=ba[d];++d;if(P.a.id==w.a.id&&P.b.id==w.b.id||P.b.id==w.a.id&&P.a.id==w.b.id){l=!0;break}}if(l)w.put();else{if(1==w.a.shapes.length&&1==w.b.shapes.length)l=w.a.shapes[0].collides(w.b.shapes[0]),null!=l&&w.data.push(l);else for(l=
w.a.shapes,d=0,ba=l.length;d<ba;){P=d++;for(var r=w.b.shapes,f=l[P].bounds(),k=0,y=r.length;k<y;){var E=k++,u=r[E].bounds();f.min_x<u.max_x&&f.max_x>=u.min_x&&f.min_y<u.max_y&&f.max_y>=u.min_y&&(E=l[P].collides(r[E]),null!=E&&w.data.push(E));u.put()}f.put()}if(0==w.data.length)w.put();else if(null==e.condition||e.condition(w.a,w.b,w.data)&&!w.a.disposed&&!w.b.disposed){l=0;for(d=w.data;l<d.length;)ba=d[l],++l,ba.sa.collided=ba.sb.collided=!0;w.a.collided=w.b.collided=!0;e.collisions.push(w)}else w.put()}}}};
v.notify=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(null!=c.enter||null!=c.stay)for(var e=0,g=c.collisions;e<g.length;){var h=g[e];++e;if(!h.a.disposed&&!h.b.disposed){if(null!=c.enter){var w=!1;for(var l=0,d=c.last_collisions;l<d.length;){var ba=d[l];++l;if(ba.a==h.a&&ba.b==h.b||ba.a==h.b&&ba.b==h.a){w=!0;break}}w=!w}else w=!1;w?c.enter(h.a,h.b,h.data):null!=c.stay&&c.stay(h.a,h.b,h.data)}}if(null!=c.exit)for(e=0,g=c.last_collisions;e<g.length;){h=
g[e];++e;if(h.a.disposed||h.b.disposed)w=!1;else{w=!1;l=0;for(d=c.collisions;l<d.length;)if(ba=d[l],++l,ba.a==h.a&&ba.b==h.b||ba.a==h.b&&ba.b==h.a){w=!0;break}w=!w}w&&c.exit(h.a,h.b)}}};v.overlap_bodies_and_bodies_bounds=function(a,b,c,e){if(0!=a.length&&0!=b.length)for(var g=0;g<a.length;){var h=a[g];++g;v.overlap_body_and_bodies_bounds(h,b,c,e)}};v.overlap_body_and_bodies_bounds=function(a,b,c,e){if(!(a.disposed||0==a.shapes.length||!a.active||0>=a.mass)){var g=a.bounds();v.qr.length=0;v.sqr.length=
0;c.quadtree.query(g,v.qr);c.static_quadtree.query(g,v.sqr);for(c=0;c<b.length;){var h=b[c];++c;if(!h.disposed&&0!=h.shapes.length&&h.active&&(0==a.layer_mask||0==h.layer_mask||0!=(a.layer_mask&h.layers)&&0!=(h.layer_mask&a.layers)))for(var w=0,l=0<h.mass?v.qr:v.sqr;w<l.length;){var d=l[w];++w;d.id==h.id&&(d=Vb.pool.get(),d.a=a,d.b=h,d.data.length=0,d.pooled=!1,e.push(d))}}g.put()}};v.overlap_body_and_body_bounds=function(a,b){if(a.disposed||b.disposed||0==a.shapes.length||0==b.shapes.length||!a.active||
!b.active||a==b||0!=a.layer_mask&&0!=b.layer_mask&&(0==(a.layer_mask&b.layers)||0==(b.layer_mask&a.layers))||0>=a.mass&&0>=b.mass)return null;var c=a.bounds(),e=b.bounds(),g=c.min_x<e.max_x&&c.max_x>=e.min_x&&c.min_y<e.max_y&&c.max_y>=e.min_y;c.put();e.put();return g?(c=Vb.pool.get(),c.a=a,c.b=b,c.data.length=0,c.pooled=!1,c):null};var Ca=function(a){this.members=null==a?[]:a};d["echo.Listeners"]=Ca;Ca.__name__=!0;Ca.__interfaces__=[Ha];Ca.prototype={add:function(a,b,c){c=ed.copy_fields(c,vb.get_defaults());
a=new vb(a,b,c.separate,[],[],null,null,null,null,[],c.percent_correction,c.correction_threshold);null!=c.enter&&(a.enter=c.enter);null!=c.stay&&(a.stay=c.stay);null!=c.exit&&(a.exit=c.exit);null!=c.condition&&(a.condition=c.condition);this.members.push(a);return a},clear:function(){this.members.length=0},__class__:Ca};var T=m.echo.Echo=function(){};d["echo.Echo"]=T;T.__name__=!0;T.start=function(a){return new sc(a)};T.make=function(a,b){return a.add(new E(b))};T.listen=function(a,b,c,e){return null==
b?null==c?a.listeners.add(Yc.Right(a.members),Yc.Right(a.members),e):a.listeners.add(c,c,e):null==c?a.listeners.add(b,b,e):a.listeners.add(b,c,e)};T.check=function(a,b,c,e){T.cached_listeners.clear();null==b&&null==c?T.cached_listeners.add(Yc.Right(a.members),Yc.Right(a.members),e):null==b?T.cached_listeners.add(c,c,e):null==c?T.cached_listeners.add(b,b,e):T.cached_listeners.add(b,c,e);v.query(a,T.cached_listeners);nc.separate(a,T.cached_listeners);v.notify(a,T.cached_listeners)};T.step=function(a,
b){if(null!=a.history){for(var c=a.history,e=[],g=0,h=a.members;g<h.length;){var w=h[g];++g;e.push(new Sc(w.id,w.transform.local_x,w.transform.local_y,180/Math.PI*w.transform.local_radians,w.velocity.x,w.velocity.y,w.acceleration.x,w.acceleration.y,w.rotational_velocity))}c.add(e)}b/=a.iterations;e=0;for(g=a.iterations;e<g;)e++,nc.step(a,b),v.query(a),nc.separate(a),v.notify(a)};T.linecast_floats=function(a,b,c,e,g,h,w){null==w&&(w=!0);null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=
Fb.pool.get();null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=l.start;d.x=a;d.y=b;d=l.end;d.x=c;d.y=e;l.pooled=!1;g=T.linecast(l,g,h,w);l.pooled||(l.pooled=!0,Fb.pool.put_unsafe(l));return g};T.linecast_vector=function(a,b,c,e,g,h){null==h&&(h=!0);var w=Fb.pool.get();w.set_from_vector(a,b,c);w.pooled=!1;a=T.linecast(w,e,g,h);w.pooled||(w.pooled=!0,Fb.pool.put_unsafe(w));return a};T.linecast_vectors=function(a,b,c,e,g){g=a.x;var h=a.y;a=b.x;var w=b.y;null==w&&(w=1);null==a&&(a=1);
null==h&&(h=0);null==g&&(g=0);b=Fb.pool.get();null==w&&(w=1);null==a&&(a=1);null==h&&(h=0);null==g&&(g=0);var l=b.start;l.x=g;l.y=h;l=b.end;l.x=a;l.y=w;b.pooled=!1;c=T.linecast(b,c,e);b.pooled||(b.pooled=!0,Fb.pool.put_unsafe(b));return c};T.linecast=function(a,b,c,e){null==e&&(e=!0);var g=null,h=Math.min(a.start.x,a.end.x),w=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),ba=$a.pool.get();ba.min_x=h;ba.max_x=l;ba.min_y=w;ba.max_y=d;ba.pooled=!1;var P=b;switch(P._hx_index){case 0:var r=
P.v;if(!r.disposed&&r.active){var f=r.bounds();if(ba.min_x<f.max_x&&ba.max_x>=f.min_x&&ba.min_y<f.max_y&&ba.max_y>=f.min_y){var k=0;for(e=r.shapes.length;k<e;)w=k++,h=r.shapes[w].intersect(a),null!=h&&(null==g&&(w=Kb.pool.get(),w.line=a,w.body=r,w.data.length=0,w.pooled=!1,g=w),g.data.push(h))}f.put()}break;case 1:if(b=P.v,null==c)for(P=0;P<b.length;){if(r=b[P],++P,null!=r&&!r.disposed&&r.active){f=r.bounds();w=Kb.pool.get();w.line=a;w.body=r;w.data.length=0;w.pooled=!1;c=w;if(ba.min_x<f.max_x&&ba.max_x>=
f.min_x&&ba.min_y<f.max_y&&ba.max_y>=f.min_y)for(k=0,e=r.shapes.length;k<e;)w=k++,h=r.shapes[w].intersect(a),null!=h&&c.data.push(h);f.put();if(0<c.data.length)if(null!=g){if(0==g.data.length)h=null;else if(1==g.data.length)h=g.data[0];else{f=g.data[0];r=1;for(h=g.data.length;r<h;)w=r++,null!=g.data[w]&&g.data[w].distance<f.distance&&(f=g.data[w]);h=f}f=h.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];e=1;for(h=c.data.length;e<h;)w=e++,null!=c.data[w]&&c.data[w].distance<
r.distance&&(r=c.data[w]);e=r}h=f>e.distance}else h=!0;else h=!1;h?(null!=g&&g.put(),g=c):c.put()}}else{P=0;for(k=T.cached_collisions;P<k.length;)f=k[P],++P,f.put();T.cached_collisions.length=0;f=T.cached_body;h=ba.min_x;w=ba.min_y;l=ba.max_x;d=ba.max_y;r=wb.pool.get();P=.5*(h+l);k=.5*(w+d);h=l-h;d-=w;null==d&&(d=0);null==h&&(h=1);null==k&&(k=0);null==P&&(P=0);l=r.transform;l.dirty||l.set_dirty();l.local_x=P;l=r.transform;l.dirty||l.set_dirty();l.local_y=k;P=.5*h;l=r.transform;null==l.parent?k=l.local_scale_x:
(l.sync(),k=l._scale_x);r.local_ex=P/k;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;P=0;for(k=l.count;P<k;)if(w=P++,null==l.local_vertices[w]){var y=l.local_vertices,E=new Q(0,0);y[w]=E}P=l.local_vertices[0];P.x=-(r.local_ex*r.transform.local_scale_x);P.y=-(r.local_ey*r.transform.local_scale_y);P=l.local_vertices[1];P.x=r.local_ex*r.transform.local_scale_x;P.y=-(r.local_ey*r.transform.local_scale_y);P=l.local_vertices[2];P.x=r.local_ex*r.transform.local_scale_x;P.y=r.local_ey*r.transform.local_scale_y;
P=l.local_vertices[3];P.x=-(r.local_ex*r.transform.local_scale_x);P.y=r.local_ey*r.transform.local_scale_y;P=r.transform.local_x;y=l.transform;y.dirty||y.set_dirty();y.local_x=P;P=r.transform.local_y;y=l.transform;y.dirty||y.set_dirty();y.local_y=P;y=l.transform;P=Math.PI/180*(180/Math.PI)*r.transform.local_radians;y.dirty||y.set_dirty();y.local_radians=P;P=r.transform.local_scale_x;y=l.transform;y.dirty||y.set_dirty();y.local_scale_x=P;P=r.transform.local_scale_y;y=l.transform;y.dirty||y.set_dirty();
y.local_scale_y=P;l.dirty_vertices=!0;l.dirty_bounds=!0}P=.5*(0>=d?h:d);l=r.transform;null==l.parent?k=l.local_scale_y:(l.sync(),k=l._scale_y);r.local_ey=P/k;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;P=0;for(k=l.count;P<k;)w=P++,null==l.local_vertices[w]&&(y=l.local_vertices,E=new Q(0,0),y[w]=E);P=l.local_vertices[0];P.x=-(r.local_ex*r.transform.local_scale_x);P.y=-(r.local_ey*r.transform.local_scale_y);P=l.local_vertices[1];P.x=r.local_ex*r.transform.local_scale_x;P.y=-(r.local_ey*
r.transform.local_scale_y);P=l.local_vertices[2];P.x=r.local_ex*r.transform.local_scale_x;P.y=r.local_ey*r.transform.local_scale_y;P=l.local_vertices[3];P.x=-(r.local_ex*r.transform.local_scale_x);P.y=r.local_ey*r.transform.local_scale_y;P=r.transform.local_x;y=l.transform;y.dirty||y.set_dirty();y.local_x=P;P=r.transform.local_y;y=l.transform;y.dirty||y.set_dirty();y.local_y=P;y=l.transform;P=Math.PI/180*(180/Math.PI)*r.transform.local_radians;y.dirty||y.set_dirty();y.local_radians=P;P=r.transform.local_scale_x;
y=l.transform;y.dirty||y.set_dirty();y.local_scale_x=P;P=r.transform.local_scale_y;y=l.transform;y.dirty||y.set_dirty();y.local_scale_y=P;l.dirty_vertices=!0;l.dirty_bounds=!0}l=r.transform;P=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=P;l=r.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=r.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==r.transformed_rect?(l=r.transform,null==l.parent?h=180/Math.PI*l.local_radians:(l.sync(),h=180/Math.PI*l._radians),h=0!=h):h=!1;if(h){h=db.pool.get();
h.count=4;P=0;for(k=h.count;P<k;)w=P++,null==h.local_vertices[w]&&(d=h.local_vertices,E=new Q(0,0),d[w]=E);P=h.local_vertices[0];P.x=-(r.local_ex*r.transform.local_scale_x);P.y=-(r.local_ey*r.transform.local_scale_y);P=h.local_vertices[1];P.x=r.local_ex*r.transform.local_scale_x;P.y=-(r.local_ey*r.transform.local_scale_y);P=h.local_vertices[2];P.x=r.local_ex*r.transform.local_scale_x;P.y=r.local_ey*r.transform.local_scale_y;P=h.local_vertices[3];P.x=-(r.local_ex*r.transform.local_scale_x);P.y=r.local_ey*
r.transform.local_scale_y;P=r.transform.local_x;l=h.transform;l.dirty||l.set_dirty();l.local_x=P;P=r.transform.local_y;l=h.transform;l.dirty||l.set_dirty();l.local_y=P;l=h.transform;P=Math.PI/180*(180/Math.PI)*r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=P;P=r.transform.local_scale_x;l=h.transform;l.dirty||l.set_dirty();l.local_scale_x=P;P=r.transform.local_scale_y;l=h.transform;l.dirty||l.set_dirty();l.local_scale_y=P;h.dirty_vertices=!0;h.dirty_bounds=!0;h.pooled=!1;r.transformed_rect=
h;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(P=r.transform.local_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_x=P,P=r.transform.local_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=P,l=r.transformed_rect.transform,P=Math.PI/180*(180/Math.PI)*r.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=P,P=r.transform.local_scale_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_x=P,P=r.transform.local_scale_y,
l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=P);r.pooled=!1;null!=f.shapes[0]&&f.shapes[0].put();f.shapes[0]=r;f.shapes[0].set_parent(f);f.dirty=!0;0>=f.mass&&null!=f.world&&(f.bounds(f.quadtree_data.bounds),f.world.static_quadtree.update(f.quadtree_data));e&&v.update_quadtree(c);v.overlap_body_and_bodies_bounds(T.cached_body,b,c,T.cached_collisions);P=0;for(k=T.cached_collisions;P<k.length;){f=k[P];++P;r=f.b;w=Kb.pool.get();w.line=a;w.body=r;w.data.length=0;w.pooled=!1;c=
w;e=0;for(r=f.b.shapes.length;e<r;)w=e++,h=f.b.shapes[w].intersect(a),null!=h&&c.data.push(h);if(0<c.data.length)if(null!=g){if(0==g.data.length)h=null;else if(1==g.data.length)h=g.data[0];else{f=g.data[0];h=1;for(e=g.data.length;h<e;)w=h++,null!=g.data[w]&&g.data[w].distance<f.distance&&(f=g.data[w]);h=f}f=h.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];h=1;for(b=c.data.length;h<b;)w=h++,null!=c.data[w]&&c.data[w].distance<r.distance&&(r=c.data[w]);e=r}h=
f>e.distance}else h=!0;else h=!1;h?(null!=g&&g.put(),g=c):c.put()}T.cached_body.shapes[0].put()}}ba.put();return g};T.linecast_all=function(a,b,c,e){null==e&&(e=!0);var g=[],h=Math.min(a.start.x,a.end.x),w=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),ba=$a.pool.get();ba.min_x=h;ba.max_x=l;ba.min_y=w;ba.max_y=d;ba.pooled=!1;var f=b;switch(f._hx_index){case 0:var r=f.v;w=Kb.pool.get();w.line=a;w.body=r;w.data.length=0;w.pooled=!1;c=w;var k=r.bounds();if(ba.min_x<
k.max_x&&ba.max_x>=k.min_x&&ba.min_y<k.max_y&&ba.max_y>=k.min_y){var y=0;for(e=r.shapes.length;y<e;)w=y++,w=r.shapes[w].intersect(a),null!=w&&c.data.push(w)}k.put();0<c.data.length?g.push(c):c.put();break;case 1:if(b=f.v,null==c)for(f=0;f<b.length;){if(r=b[f],++f,null!=r){k=r.bounds();w=Kb.pool.get();w.line=a;w.body=r;w.data.length=0;w.pooled=!1;c=w;if(ba.min_x<k.max_x&&ba.max_x>=k.min_x&&ba.min_y<k.max_y&&ba.max_y>=k.min_y)for(y=0,e=r.shapes.length;y<e;)w=y++,w=r.shapes[w].intersect(a),null!=w&&
c.data.push(w);k.put();0<c.data.length?g.push(c):c.put()}}else{f=0;for(y=T.cached_collisions;f<y.length;)k=y[f],++f,k.put();T.cached_collisions.length=0;k=T.cached_body;h=ba.min_x;w=ba.min_y;l=ba.max_x;d=ba.max_y;r=wb.pool.get();f=.5*(h+l);y=.5*(w+d);h=l-h;d-=w;null==d&&(d=0);null==h&&(h=1);null==y&&(y=0);null==f&&(f=0);l=r.transform;l.dirty||l.set_dirty();l.local_x=f;l=r.transform;l.dirty||l.set_dirty();l.local_y=y;f=.5*h;l=r.transform;null==l.parent?y=l.local_scale_x:(l.sync(),y=l._scale_x);r.local_ex=
f/y;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;f=0;for(y=l.count;f<y;)if(w=f++,null==l.local_vertices[w]){var E=l.local_vertices,u=new Q(0,0);E[w]=u}f=l.local_vertices[0];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=-(r.local_ey*r.transform.local_scale_y);f=l.local_vertices[1];f.x=r.local_ex*r.transform.local_scale_x;f.y=-(r.local_ey*r.transform.local_scale_y);f=l.local_vertices[2];f.x=r.local_ex*r.transform.local_scale_x;f.y=r.local_ey*r.transform.local_scale_y;f=l.local_vertices[3];
f.x=-(r.local_ex*r.transform.local_scale_x);f.y=r.local_ey*r.transform.local_scale_y;f=r.transform.local_x;E=l.transform;E.dirty||E.set_dirty();E.local_x=f;f=r.transform.local_y;E=l.transform;E.dirty||E.set_dirty();E.local_y=f;E=l.transform;f=Math.PI/180*(180/Math.PI)*r.transform.local_radians;E.dirty||E.set_dirty();E.local_radians=f;f=r.transform.local_scale_x;E=l.transform;E.dirty||E.set_dirty();E.local_scale_x=f;f=r.transform.local_scale_y;E=l.transform;E.dirty||E.set_dirty();E.local_scale_y=f;
l.dirty_vertices=!0;l.dirty_bounds=!0}f=.5*(0>=d?h:d);l=r.transform;null==l.parent?y=l.local_scale_y:(l.sync(),y=l._scale_y);r.local_ey=f/y;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;f=0;for(y=l.count;f<y;)w=f++,null==l.local_vertices[w]&&(E=l.local_vertices,u=new Q(0,0),E[w]=u);f=l.local_vertices[0];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=-(r.local_ey*r.transform.local_scale_y);f=l.local_vertices[1];f.x=r.local_ex*r.transform.local_scale_x;f.y=-(r.local_ey*r.transform.local_scale_y);
f=l.local_vertices[2];f.x=r.local_ex*r.transform.local_scale_x;f.y=r.local_ey*r.transform.local_scale_y;f=l.local_vertices[3];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=r.local_ey*r.transform.local_scale_y;f=r.transform.local_x;E=l.transform;E.dirty||E.set_dirty();E.local_x=f;f=r.transform.local_y;E=l.transform;E.dirty||E.set_dirty();E.local_y=f;E=l.transform;f=Math.PI/180*(180/Math.PI)*r.transform.local_radians;E.dirty||E.set_dirty();E.local_radians=f;f=r.transform.local_scale_x;E=l.transform;
E.dirty||E.set_dirty();E.local_scale_x=f;f=r.transform.local_scale_y;E=l.transform;E.dirty||E.set_dirty();E.local_scale_y=f;l.dirty_vertices=!0;l.dirty_bounds=!0}l=r.transform;f=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=f;l=r.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=r.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==r.transformed_rect?(l=r.transform,null==l.parent?f=180/Math.PI*l.local_radians:(l.sync(),f=180/Math.PI*l._radians),f=0!=f):f=!1;if(f){h=db.pool.get();h.count=
4;f=0;for(y=h.count;f<y;)w=f++,null==h.local_vertices[w]&&(d=h.local_vertices,u=new Q(0,0),d[w]=u);f=h.local_vertices[0];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=-(r.local_ey*r.transform.local_scale_y);f=h.local_vertices[1];f.x=r.local_ex*r.transform.local_scale_x;f.y=-(r.local_ey*r.transform.local_scale_y);f=h.local_vertices[2];f.x=r.local_ex*r.transform.local_scale_x;f.y=r.local_ey*r.transform.local_scale_y;f=h.local_vertices[3];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=r.local_ey*
r.transform.local_scale_y;f=r.transform.local_x;l=h.transform;l.dirty||l.set_dirty();l.local_x=f;f=r.transform.local_y;l=h.transform;l.dirty||l.set_dirty();l.local_y=f;l=h.transform;f=Math.PI/180*(180/Math.PI)*r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=f;f=r.transform.local_scale_x;l=h.transform;l.dirty||l.set_dirty();l.local_scale_x=f;f=r.transform.local_scale_y;l=h.transform;l.dirty||l.set_dirty();l.local_scale_y=f;h.dirty_vertices=!0;h.dirty_bounds=!0;h.pooled=!1;r.transformed_rect=
h;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(f=r.transform.local_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_x=f,f=r.transform.local_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=f,l=r.transformed_rect.transform,f=Math.PI/180*(180/Math.PI)*r.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=f,f=r.transform.local_scale_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_x=f,f=r.transform.local_scale_y,
l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=f);r.pooled=!1;null!=k.shapes[0]&&k.shapes[0].put();k.shapes[0]=r;k.shapes[0].set_parent(k);k.dirty=!0;0>=k.mass&&null!=k.world&&(k.bounds(k.quadtree_data.bounds),k.world.static_quadtree.update(k.quadtree_data));e&&v.update_quadtree(c);v.overlap_body_and_bodies_bounds(T.cached_body,b,c,T.cached_collisions);f=0;for(y=T.cached_collisions;f<y.length;){k=y[f];++f;r=k.b;w=Kb.pool.get();w.line=a;w.body=r;w.data.length=0;w.pooled=!1;c=
w;e=0;for(b=k.b.shapes.length;e<b;)w=e++,w=k.b.shapes[w].intersect(a),null!=w&&c.data.push(w);0<c.data.length?g.push(c):c.put()}T.cached_body.shapes[0].put()}}ba.put();return g};T.undo=function(a){if(null!=a.history){var b=a.history.undo();if(null!=b){for(var c=0;c<b.length;){var e=b[c];++c;for(var g=0,h=a.members;g<h.length;){var w=h[g];++g;if(e.id==w.id){var l=e.x,d=w.transform;d.dirty||d.set_dirty();d.local_x=l;if(null!=w.on_move)w.on_move(w.transform.local_x,w.transform.local_y);l=e.y;d=w.transform;
d.dirty||d.set_dirty();d.local_y=l;if(null!=w.on_move)w.on_move(w.transform.local_x,w.transform.local_y);l=w.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();l.local_radians=d;if(null!=w.on_rotate)w.on_rotate(180/Math.PI*w.transform.local_radians);l=w.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=w.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;w.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}}return a};T.redo=function(a){if(null!=a.history){var b=a.history.redo();
if(null!=b)for(var c=0;c<b.length;){var e=b[c];++c;for(var g=0,h=a.members;g<h.length;){var w=h[g];++g;if(e.id==w.id){var l=e.x,d=w.transform;d.dirty||d.set_dirty();d.local_x=l;if(null!=w.on_move)w.on_move(w.transform.local_x,w.transform.local_y);l=e.y;d=w.transform;d.dirty||d.set_dirty();d.local_y=l;if(null!=w.on_move)w.on_move(w.transform.local_x,w.transform.local_y);l=w.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();l.local_radians=d;if(null!=w.on_rotate)w.on_rotate(180/Math.PI*w.transform.local_radians);
l=w.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=w.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;w.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}return a};var kb=function(){};d["echo.util.Poolable"]=kb;kb.__name__=!0;kb.__isInterface__=!0;var pa=function(){};d["echo.util.Pool"]=pa;pa.__name__=!0;pa.__isInterface__=!0;var ib=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_Line"]=ib;ib.__name__=!0;ib.__interfaces__=[pa];ib.prototype={get:function(){return 0==
this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:ib};var Fb=function(a,b,c,e){null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.pooled=!1;this.start=a=new Q(a,b);this.end=a=new Q(c,e)};d["echo.Line"]=Fb;Fb.__name__=!0;Fb.__interfaces__=[kb];Fb.prototype={set_from_vector:function(a,b,c){var e=Math.PI/180*b;b=a.x;var g=a.y,h=a.x+c*Math.cos(e);a=a.y+c*Math.sin(e);null==a&&(a=1);null==h&&(h=
1);null==g&&(g=0);null==b&&(b=0);c=this.start;c.x=b;c.y=g;c=this.end;c.x=h;c.y=a;return this},get_x:function(){return this.start.x},get_y:function(){return this.start.y},get_dx:function(){return this.end.x},get_dy:function(){return this.end.y},__class__:Fb,__properties__:{get_dy:"get_dy",get_dx:"get_dx",get_y:"get_y",get_x:"get_x"}};var vb=function(a,b,c,e,g,h,w,l,d,f,k,r){this.a=a;this.b=b;this.separate=c;this.collisions=e;this.last_collisions=g;this.enter=h;this.stay=w;this.exit=l;this.condition=
d;this.quadtree_results=f;this.percent_correction=k;this.correction_threshold=r};d["echo.Listener"]=vb;vb.__name__=!0;vb.__properties__={get_defaults:"get_defaults"};vb.get_defaults=function(){return{separate:!0,percent_correction:.9,correction_threshold:.013}};vb.prototype={__class__:vb};var Bb=function(a,b,c,e,g){this.gravity_scale=1;this.friction=this.static_friction=0;this.density=1;this.elasticity=0;null!=a&&(this.elasticity=a);null!=b&&(this.density=b);null!=c&&(this.friction=c);null!=e&&(this.static_friction=
e);null!=g&&(this.gravity_scale=g)};d["echo.Material"]=Bb;Bb.__name__=!0;Bb.prototype={__class__:Bb};var nc=function(){};d["echo.Physics"]=nc;nc.__name__=!0;nc.step=function(a,b){for(var c=0,e=a.members;c<e.length;){var g=e[c];++c;if(0<g.mass&&!g.disposed&&g.active){g.last_x=g.transform.local_x;g.last_y=g.transform.local_y;g.last_rotation=180/Math.PI*g.transform.local_radians;var h=g.acceleration.x*g.inverse_mass,w=g.acceleration.y*g.inverse_mass;g.kinematic||(h+=a.gravity.x*g.material.gravity_scale,
w+=a.gravity.y*g.material.gravity_scale);var l=g.velocity.x,d=g.drag.x,f=g.max_velocity.x;1E-5>=Math.abs(h)?1E-5>=Math.abs(d)||(d*=b,l=0<l-d?l-d:0>l+d?l+d:0):l+=h*b;1E-5>=Math.abs(f)||(h=-f,l<h?l=h:l>f&&(l=f));g.velocity.x=l;l=g.velocity.y;h=g.drag.y;f=g.max_velocity.y;1E-5>=Math.abs(w)?1E-5>=Math.abs(h)||(h*=b,l=0<l-h?l-h:0>l+h?l+h:0):l+=w*b;1E-5>=Math.abs(f)||(w=-f,l<w?l=w:l>f&&(l=f));g.velocity.y=l;0<g.drag_length?(w=g.acceleration,w=0==w.x&&0==w.y):w=!1;w?(w=g.velocity,w=!(0==w.x&&0==w.y)):w=
!1;w&&(w=f=g.velocity,w=Math.sqrt(w.x*w.x+w.y*w.y)-g.drag_length*b,h=l=f,h=h.x*h.x+h.y*h.y,h=0==h?1:Math.sqrt(h),d=f.y/h*w,l.x=f.x/h*w,l.y=d);0<g.max_velocity_length?(w=g.velocity,w=Math.sqrt(w.x*w.x+w.y*w.y)>g.max_velocity_length):w=!1;w&&(f=g.velocity,w=g.max_velocity_length,h=l=f,h=h.x*h.x+h.y*h.y,h=0==h?1:Math.sqrt(h),d=f.y/h*w,l.x=f.x/h*w,l.y=d);w=g.transform.local_x+g.velocity.x*b;l=g.transform;l.dirty||l.set_dirty();l.local_x=w;if(null!=g.on_move)g.on_move(g.transform.local_x,g.transform.local_y);
w=g.transform.local_y+g.velocity.y*b;l=g.transform;l.dirty||l.set_dirty();l.local_y=w;if(null!=g.on_move)g.on_move(g.transform.local_x,g.transform.local_y);w=g.rotational_velocity;f=g.rotational_drag;h=g.torque*g.inverse_mass;l=g.max_rotational_velocity;1E-5>=Math.abs(f)?1E-5>=Math.abs(h)||(h*=b,w=0<w-h?w-h:0>w+h?w+h:0):w+=f*b;1E-5>=Math.abs(l)||(f=-l,w<f?w=f:w>l&&(w=l));g.rotational_velocity=w;w=g.transform;l=Math.PI/180*(180/Math.PI*g.transform.local_radians+g.rotational_velocity*b);w.dirty||w.set_dirty();
w.local_radians=l;if(null!=g.on_rotate)g.on_rotate(180/Math.PI*g.transform.local_radians)}}};nc.separate=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(c.separate)for(var e=0,g=c.collisions;e<g.length;){var h=g[e];++e;for(var w=0,l=h.data.length;w<l;){var d=w++,f=h.a,k=h.b;d=h.data[d];var r=c.correction_threshold,y=c.percent_correction;null==y&&(y=.9);null==r&&(r=.013);if(d.sa.solid&&d.sb.solid&&f.active&&k.active&&!f.disposed&&!k.disposed&&!(0>=f.mass&&
0>=k.mass)){var E=(f.velocity.x-k.velocity.x)*d.normal.x+(f.velocity.y-k.velocity.y)*d.normal.y,v=f.inverse_mass+k.inverse_mass;if(0<E){var u=-(1+.5*(f.material.elasticity+k.material.elasticity))*E/v;E=-u*d.normal.x;u=-u*d.normal.y;f.kinematic||(f.velocity.x-=E*f.inverse_mass,f.velocity.y-=u*f.inverse_mass);k.kinematic||(k.velocity.x+=E*k.inverse_mass,k.velocity.y+=u*k.inverse_mass)}y*=Math.max(d.overlap-r,0)/v;r=y*d.normal.x;d=y*d.normal.y;if(!f.kinematic){y=f.transform.local_x-f.inverse_mass*r;
v=f.transform;v.dirty||v.set_dirty();v.local_x=y;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);y=f.transform.local_y-f.inverse_mass*d;v=f.transform;v.dirty||v.set_dirty();v.local_y=y;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y)}if(!k.kinematic){f=k.transform.local_x+k.inverse_mass*r;r=k.transform;r.dirty||r.set_dirty();r.local_x=f;if(null!=k.on_move)k.on_move(k.transform.local_x,k.transform.local_y);f=k.transform.local_y+k.inverse_mass*d;d=k.transform;
d.dirty||d.set_dirty();d.local_y=f;if(null!=k.on_move)k.on_move(k.transform.local_x,k.transform.local_y)}}}}}};var Wa=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.solid=!0;var e=this.transform=new Xc;e.dirty||e.set_dirty();e.local_x=a;e=this.transform;e.dirty||e.set_dirty();e.local_y=b;e=this.transform;a=Math.PI/180*c;e.dirty||e.set_dirty();e.local_radians=a};d["echo.Shape"]=Wa;Wa.__name__=!0;Wa.__properties__={get_defaults:"get_defaults"};Wa.get=function(a){a=ed.copy_fields(a,
Wa.get_defaults());switch(a.type){case 0:var b=a.offset_x,c=a.offset_y,e=a.width,g=a.height,h=a.rotation,w=a.scale_x,l=a.scale_y;null==l&&(l=1);null==w&&(w=1);null==h&&(h=0);null==g&&(g=0);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);var d=wb.pool.get();var f=b,k=c;b=g;null==l&&(l=1);null==w&&(w=1);null==h&&(h=0);null==b&&(b=0);null==e&&(e=1);null==k&&(k=0);null==f&&(f=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=f;c=d.transform;c.dirty||c.set_dirty();c.local_y=k;f=.5*e;c=d.transform;null==c.parent?
k=c.local_scale_x:(c.sync(),k=c._scale_x);d.local_ex=f/k;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;f=0;for(k=c.count;f<k;)if(g=f++,null==c.local_vertices[g]){var r=c.local_vertices,y=new Q(0,0);r[g]=y}f=c.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=
d.local_ey*d.transform.local_scale_y;f=c.local_vertices[3];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=f;f=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=f;r=c.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=f;f=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=f;f=d.transform.local_scale_y;
r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=f;c.dirty_vertices=!0;c.dirty_bounds=!0}f=.5*(0>=b?e:b);c=d.transform;null==c.parent?k=c.local_scale_y:(c.sync(),k=c._scale_y);d.local_ey=f/k;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;f=0;for(k=c.count;f<k;)g=f++,null==c.local_vertices[g]&&(r=c.local_vertices,y=new Q(0,0),r[g]=y);f=c.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;
f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=d.local_ey*d.transform.local_scale_y;f=c.local_vertices[3];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=f;f=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=f;r=c.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=
f;f=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=f;f=d.transform.local_scale_y;r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=f;c.dirty_vertices=!0;c.dirty_bounds=!0}c=d.transform;f=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=f;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=w;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;null==d.transformed_rect?(c=d.transform,null==c.parent?l=180/Math.PI*c.local_radians:(c.sync(),l=180/Math.PI*c._radians),
l=0!=l):l=!1;if(l){e=db.pool.get();e.count=4;f=0;for(k=e.count;f<k;)g=f++,null==e.local_vertices[g]&&(l=e.local_vertices,y=new Q(0,0),l[g]=y);f=e.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=e.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;f.y=-(d.local_ey*d.transform.local_scale_y);f=e.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=d.local_ey*d.transform.local_scale_y;f=e.local_vertices[3];f.x=-(d.local_ex*
d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;c=e.transform;c.dirty||c.set_dirty();c.local_x=f;f=d.transform.local_y;c=e.transform;c.dirty||c.set_dirty();c.local_y=f;c=e.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;c.dirty||c.set_dirty();c.local_radians=f;f=d.transform.local_scale_x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=f;f=d.transform.local_scale_y;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=f;e.dirty_vertices=
!0;e.dirty_bounds=!0;e.pooled=!1;d.transformed_rect=e;d.transformed_rect.set_parent(d.parent)}else null!=d.transformed_rect&&(f=d.transform.local_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_x=f,f=d.transform.local_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_y=f,c=d.transformed_rect.transform,f=Math.PI/180*(180/Math.PI)*d.transform.local_radians,c.dirty||c.set_dirty(),c.local_radians=f,f=d.transform.local_scale_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),
c.local_scale_x=f,f=d.transform.local_scale_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_y=f);d.pooled=!1;break;case 1:b=a.offset_x;c=a.offset_y;r=a.radius;h=a.rotation;w=a.scale_x;l=a.scale_y;null==l&&(l=1);null==w&&(w=1);null==h&&(h=0);null==r&&(r=1);null==c&&(c=0);null==b&&(b=0);d=fc.pool.get();f=b;k=c;e=r;null==l&&(l=1);null==w&&(w=1);null==h&&(h=0);null==e&&(e=1);null==k&&(k=0);null==f&&(f=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=f;c=d.transform;c.dirty||c.set_dirty();
c.local_y=k;c=d.transform;f=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=f;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=w;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;c=d.transform;null==c.parent?l=c.local_scale_x:(c.sync(),l=c._scale_x);d.local_radius=e/l;d.pooled=!1;break;case 2:if(null!=a.vertices)b=a.offset_x,c=a.offset_y,h=a.rotation,d=a.vertices,w=a.scale_x,l=a.scale_y,null==l&&(l=1),null==w&&(w=1),null==h&&(h=0),null==c&&(c=0),null==b&&(b=0),e=db.pool.get(),f=b,k=
c,null==l&&(l=1),null==w&&(w=1),null==h&&(h=0),null==k&&(k=0),null==f&&(f=0),c=e.transform,c.dirty||c.set_dirty(),c.local_x=f,c=e.transform,c.dirty||c.set_dirty(),c.local_y=k,c=e.transform,f=Math.PI/180*h,c.dirty||c.set_dirty(),c.local_radians=f,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_x=w,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_y=l,l=null,e.local_vertices=null==d?[]:d;else{b=a.offset_x;c=a.offset_y;k=a.sides;r=a.radius;h=a.rotation;w=a.scale_x;l=a.scale_y;null==l&&(l=1);null==
w&&(w=1);null==h&&(h=0);null==r&&(r=1);null==k&&(k=3);null==c&&(c=0);null==b&&(b=0);if(3>k)throw A.thrown("Polygons require 3 sides as a minimum");e=db.pool.get();var E=2*Math.PI/k;d=[];for(f=0;f<k;)g=f++,g=g*E+.5*(Math.PI-E),y=new Q(Math.cos(g)*r,Math.sin(g)*r),d.push(y);f=b;k=c;null==l&&(l=1);null==w&&(w=1);null==h&&(h=0);null==k&&(k=0);null==f&&(f=0);c=e.transform;c.dirty||c.set_dirty();c.local_x=f;c=e.transform;c.dirty||c.set_dirty();c.local_y=k;c=e.transform;f=Math.PI/180*h;c.dirty||c.set_dirty();
c.local_radians=f;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=w;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=l;l=null;e.local_vertices=null==d?[]:d}e.count=null!=l&&0<=l?l:e.local_vertices.length;if(l>e.local_vertices.length)for(f=e.local_vertices.length,k=l;f<k;)g=f++,l=e.local_vertices,y=new Q(0,0),l[g]=y;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d=e}d.solid=a.solid;return d};Wa.get_defaults=function(){return{type:0,radius:1,width:1,height:0,sides:3,rotation:0,scale_x:1,
scale_y:1,offset_x:0,offset_y:0,solid:!0}};Wa.prototype={put:function(){this.transform.set_parent(null);this.parent=null;this.collided=!1},set_parent:function(a){this.parent!=a&&(this.parent=a,this.transform.set_parent(null==a?null:a.transform))},bounds:function(a){if(null==a){var b=this.transform;if(null==b.parent)var c=b.local_x;else b.sync(),c=b._x;b=this.transform;if(null==b.parent)var e=b.local_y;else b.sync(),e=b._y;var g=0;b=0;null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);a=$a.pool.get();
null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;b*=.5;a.min_x=c-g;a.min_y=e-b;a.max_x=c+g;a.max_y=e+b;a.pooled=!1;return a}b=this.transform;null==b.parent?c=b.local_x:(b.sync(),c=b._x);b=this.transform;null==b.parent?e=b.local_y:(b.sync(),e=b._y);b=g=0;null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;b*=.5;a.min_x=c-g;a.min_y=e-b;a.max_x=c+g;a.max_y=e+b;return a},volume:function(){return 0},intersect:function(a){return null},collides:function(a){return null},collide_rect:function(a){return null},
collide_circle:function(a){return null},collide_polygon:function(a){return null},__class__:Wa};var sc=function(a){this.members=null==a.members?[]:a.members;this.init=!1;var b;if(1>a.width)throw A.thrown("World must have a width of at least 1");this.width=b=a.width;this.init&&this.reset_quadtrees();if(1>a.height)throw A.thrown("World must have a width of at least 1");this.height=b=a.height;this.init&&this.reset_quadtrees();this.x=null==a.x?0:a.x;this.init&&this.reset_quadtrees();this.y=null==a.y?0:
a.y;this.init&&this.reset_quadtrees();this.gravity=new Q(null==a.gravity_x?0:a.gravity_x,null==a.gravity_y?0:a.gravity_y);this.reset_quadtrees();this.listeners=new Ca(a.listeners);this.iterations=null==a.iterations?5:a.iterations;null!=a.history&&(this.history=new me(a.history))};d["echo.World"]=sc;sc.__name__=!0;sc.__interfaces__=[Ha];sc.prototype={add:function(a){if(a.world==this)return a;null!=a.world&&(null!=a.world&&a.world.remove(a),null!=a.quadtree_data&&null!=a.quadtree_data.bounds&&a.quadtree_data.bounds.put());
a.world=this;a.dirty=!0;this.members.push(a);a.quadtree_data=new ne(a.id,a.bounds(),!1);0>=a.mass?this.static_quadtree.insert(a.quadtree_data):this.quadtree.insert(a.quadtree_data);return a},remove:function(a){this.quadtree.remove(a.quadtree_data);this.static_quadtree.remove(a.quadtree_data);I.remove(this.members,a);a.world=null;return a},reset_quadtrees:function(){this.init=!0;if(null!=this.quadtree){var a=this.quadtree;if(!a.pooled){a.pooled=!0;for(var b=0,c=a.children.length;b<c;){var e=b++;if(null!=
a.children[e]){a.children[e].clear_children();var g=a.children[e];g.pooled||(g.pooled=!0,g.clear_children(),g.contents.length=0,g.contents_count=0,g.nodes_list.length=0,eb.pool.put_unsafe(g));a.children[e]=null}}a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;eb.pool.put_unsafe(a)}}var h=eb.pool.get();c=b=0;var d=1,l=1;null==l&&(l=1);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);d*=.5;l*=.5;h.min_x=b-d;h.min_y=c-l;h.max_x=b+d;h.max_y=c+l;b=0;for(c=h.children.length;b<c;)e=b++,null!=h.children[e]&&
(h.children[e].clear_children(),a=h.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=0,eb.pool.put_unsafe(a)),h.children[e]=null);h.contents.length=0;h.contents_count=0;h.pooled=!1;this.quadtree=h;if(null!=this.static_quadtree&&(a=this.static_quadtree,!a.pooled)){a.pooled=!0;b=0;for(c=a.children.length;b<c;)e=b++,null!=a.children[e]&&(a.children[e].clear_children(),g=a.children[e],g.pooled||(g.pooled=!0,g.clear_children(),g.contents.length=
0,g.contents_count=0,g.nodes_list.length=0,eb.pool.put_unsafe(g)),a.children[e]=null);a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;eb.pool.put_unsafe(a)}h=eb.pool.get();c=b=0;l=d=1;null==l&&(l=1);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);d*=.5;l*=.5;h.min_x=b-d;h.min_y=c-l;h.max_x=b+d;h.max_y=c+l;b=0;for(c=h.children.length;b<c;)e=b++,null!=h.children[e]&&(h.children[e].clear_children(),a=h.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=
0,a.nodes_list.length=0,eb.pool.put_unsafe(a)),h.children[e]=null);h.contents.length=0;h.contents_count=0;h.pooled=!1;this.static_quadtree=h;h=null;if(null!=h){b=this.x+.5*this.width;c=this.y+.5*this.height;d=this.width;l=this.height;null==l&&(l=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*d;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=
h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)if(e=b++,null==a.local_vertices[e]){g=a.local_vertices;var f=new Q(0,0);g[e]=f}b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);
b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*
(0>=l?d:l);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,f=new Q(0,0),g[e]=f);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*
h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=
b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;b=Math.PI/180*0;a.dirty||a.set_dirty();a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();a.local_scale_x=1;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=1;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=db.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==
l.local_vertices[e]&&(a=l.local_vertices,f=new Q(0,0),a[e]=f);b=l.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=l.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=l.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=l.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;
a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=h.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;h.transformed_rect=l;h.transformed_rect.set_parent(h.parent)}else null!=
h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),
a.local_scale_y=b)}else{b=this.x+.5*this.width;c=this.y+.5*this.height;d=this.width;l=this.height;null==l&&(l=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);h=wb.pool.get();var k=0,y=1,r=1;null==r&&(r=1);null==y&&(y=1);null==k&&(k=0);null==l&&(l=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*d;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=
h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,f=new Q(0,0),g[e]=f);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);
b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*
(0>=l?d:l);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,f=new Q(0,0),g[e]=f);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*
h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=
b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;b=Math.PI/180*k;a.dirty||a.set_dirty();a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();a.local_scale_x=y;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=r;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=db.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==
l.local_vertices[e]&&(a=l.local_vertices,f=new Q(0,0),a[e]=f);b=l.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=l.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=l.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=l.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;
a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=h.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;h.transformed_rect=l;h.transformed_rect.set_parent(h.parent)}else null!=
h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),
a.local_scale_y=b);h.pooled=!1}b=h.to_aabb(!0);a=this.quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;a=this.static_quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;b=0;for(c=this.members;b<c.length;)h=c[b],++b,0<h.mass?h.dirty=!0:(h.bounds(h.quadtree_data.bounds),this.static_quadtree.update(h.quadtree_data))},__class__:sc};var Sc=function(a,b,c,e,g,h,d,l,f){this.id=a;this.x=b;this.y=c;this.rotation=e;this.velocity_x=g;this.velocity_y=h;this.acceleration_x=
d;this.acceleration_y=l;this.rotational_velocity=f};d["echo.data.BodyState"]=Sc;Sc.__name__=!0;Sc.prototype={__class__:Sc};var Zb=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Collision"]=Zb;Zb.__name__=!0;Zb.__interfaces__=[pa];Zb.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Zb};var Vb=function(){this.pooled=!1;this.data=
[]};d["echo.data.Collision"]=Vb;Vb.__name__=!0;Vb.__interfaces__=[kb];Vb.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;Vb.pool.put_unsafe(this)}},__class__:Vb};var zd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_CollisionData"]=zd;zd.__name__=!0;zd.__interfaces__=[pa];zd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=
a&&(this.members[this.count++]=a)},__class__:zd};var tc=function(){this.pooled=!1;var a=new Q(0,0);this.normal=a;a=new Q(0,0);var b=new Q(0,0);this.contacts=[a,b].slice(0);this.overlap=this.contact_count=0};d["echo.data.CollisionData"]=tc;tc.__name__=!0;tc.__interfaces__=[kb];tc.prototype={put:function(){this.pooled||(this.pooled=!0,tc.pool.put_unsafe(this))},__class__:tc};var Ec=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Intersection"]=Ec;Ec.__name__=
!0;Ec.__interfaces__=[pa];Ec.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ec};var Kb=function(){this.pooled=!1;this.data=[]};d["echo.data.Intersection"]=Kb;Kb.__name__=!0;Kb.__interfaces__=[kb];Kb.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;Kb.pool.put_unsafe(this)}},__class__:Kb};var fd=function(a){this.type=
a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_IntersectionData"]=fd;fd.__name__=!0;fd.__interfaces__=[pa];fd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:fd};var Rb=function(){this.inverse_normal=this.pooled=!1;var a=new Q(0,0);this.normal=a;this.distance=this.overlap=0;this.hit=a=new Q(0,0);this.hit=a=new Q(0,0);this.normal=a=new Q(0,0)};d["echo.data.IntersectionData"]=
Rb;Rb.__name__=!0;Rb.__interfaces__=[kb];Rb.prototype={put:function(){this.pooled||(this.pooled=!0,Rb.pool.put_unsafe(this))},__class__:Rb};var ne=function(a,b,c){this.flag=!1;this.bounds=null;this.id=a;null!=b&&(this.bounds=b);null!=c&&(this.flag=c)};d["echo.data.QuadTreeData"]=ne;ne.__name__=!0;ne.prototype={__class__:ne};var oe=function(a,b,c,e,g,h,d,l,f){this.m00=a;this.m10=b;this.m20=c;this.m01=e;this.m11=g;this.m21=h;this.m02=d;this.m12=l;this.m22=f};d["echo.math.Matrix3Default"]=oe;oe.__name__=
!0;oe.prototype={__class__:oe};var Q=function(a,b){this.x=a;this.y=b};d["echo.math.Vector2Default"]=Q;Q.__name__=!0;Q.prototype={__class__:Q};var Mc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Circle"]=Mc;Mc.__name__=!0;Mc.__interfaces__=[pa];Mc.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Mc};var fc=function(){this.pooled=
!1;Wa.call(this);this.type=1;var a=this.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);this.local_radius=0/a};d["echo.shape.Circle"]=fc;fc.__name__=!0;fc.__interfaces__=[kb];fc.get=function(a,b,c,e,g,h){null==h&&(h=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=fc.pool.get();null==h&&(h=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=d.transform;l.dirty||l.set_dirty();l.local_x=a;l=d.transform;l.dirty||l.set_dirty();
l.local_y=b;l=d.transform;a=Math.PI/180*e;l.dirty||l.set_dirty();l.local_radians=a;l=d.transform;l.dirty||l.set_dirty();l.local_scale_x=g;l=d.transform;l.dirty||l.set_dirty();l.local_scale_y=h;l=d.transform;null==l.parent?a=l.local_scale_x:(l.sync(),a=l._scale_x);d.local_radius=c/a;d.pooled=!1;return d};fc.__super__=Wa;fc.prototype=G(Wa.prototype,{put:function(){Wa.prototype.put.call(this);this.pooled||(this.pooled=!0,fc.pool.put_unsafe(this))},bounds:function(a){var b=this.local_radius,c=this.transform;
null==c.parent?c=c.local_scale_x:(c.sync(),c=c._scale_x);b=b*c*2;if(null==a){c=this.transform;if(null==c.parent)var e=c.local_x;else c.sync(),e=c._x;c=this.transform;if(null==c.parent)var g=c.local_y;else c.sync(),g=c._y;c=b;null==b&&(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);a=$a.pool.get();null==b&&(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=g-b;a.max_x=e+c;a.max_y=g+b;a.pooled=!1;return a}c=this.transform;null==c.parent?e=c.local_x:(c.sync(),e=c._x);
c=this.transform;null==c.parent?g=c.local_y:(c.sync(),g=c._y);c=b;null==b&&(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=g-b;a.max_x=e+c;a.max_y=g+b;return a},volume:function(){var a=this.local_radius,b=this.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);a*=b;return Math.PI*a*a},intersect:function(a){return za.line_intersects_circle(a,this)},collides:function(a){return a.collide_circle(this)},collide_rect:function(a){return za.rect_and_circle(a,
this,!0)},collide_circle:function(a){return za.circle_and_circle(a,this)},collide_polygon:function(a){return za.circle_and_polygon(this,a,!0)},__class__:fc});var Fc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Polygon"]=Fc;Fc.__name__=!0;Fc.__interfaces__=[pa];Fc.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Fc};var db=
function(a){this.pooled=!1;Wa.call(this);this.type=2;this._vertices=[];this._normals=[];var b=$a.pool.get(),c=0,e=0,g=1,h=1;null==h&&(h=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;h*=.5;b.min_x=c-g;b.min_y=e-h;b.max_x=c+g;b.max_y=e+h;b.pooled=!1;this._bounds=b;this.transform.on_dirty=n(this,this.on_dirty);this.local_vertices=null==a?[]:a;this.count=this.local_vertices.length;if(null>this.local_vertices.length)for(a=this.local_vertices.length;null>a;)b=a++,c=this.local_vertices,e=new Q(0,
0),c[b]=e;this.dirty_bounds=this.dirty_vertices=!0};d["echo.shape.Polygon"]=db;db.__name__=!0;db.__interfaces__=[kb];db.get=function(a,b,c,e,g,h,d){null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==e&&(e=1);null==c&&(c=3);null==b&&(b=0);null==a&&(a=0);if(3>c)throw A.thrown("Polygons require 3 sides as a minimum");for(var l=db.pool.get(),w=2*Math.PI/c,f,k=[],r=0;r<c;){f=r++;f=f*w+.5*(Math.PI-w);var y=new Q(Math.cos(f)*e,Math.sin(f)*e);k.push(y)}r=a;null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==
b&&(b=0);null==r&&(r=0);a=l.transform;a.dirty||a.set_dirty();a.local_x=r;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;g*=Math.PI/180;a.dirty||a.set_dirty();a.local_radians=g;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=h;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=d;l.local_vertices=null==k?[]:k;l.count=l.local_vertices.length;if(null>l.local_vertices.length)for(r=l.local_vertices.length,c=null;r<c;)f=r++,k=l.local_vertices,y=new Q(0,0),k[f]=y;l.dirty_vertices=!0;
l.dirty_bounds=!0;l.pooled=!1;return l};db.__super__=Wa;db.prototype=G(Wa.prototype,{put:function(){Wa.prototype.put.call(this);this.pooled||(this.pooled=!0,db.pool.put_unsafe(this))},bounds:function(a){if(this.dirty_bounds){this.dirty_bounds=!1;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var g=this._vertices,h=new Q(0,0);g[e]=h}var d=
this.local_vertices[e].x,l=this.local_vertices[e].y;null==l&&(l=0);null==d&&(d=0);g=this.transform.get_local_to_world_matrix();h=d;d=g.m01*h+g.m11*l+1*g.m21;var f=this._vertices[e];f.x=g.m00*h+g.m10*l+1*g.m20;f.y=d}}b=0;for(c=this.count;b<c;)e=b++,f=this._vertices[(e+1)%this.count],h=f.x,l=f.y,g=this._vertices[e],l-=g.y,h-=g.x,d=-l,l=h,h=d,null==this._normals[e]?(g=this._normals,h=new Q(h,l),g[e]=h):(g=this._normals[e],g.x=h,g.y=l),l=e=h=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),g=
h.y/l,e.x=h.x/l,e.y=g}f=this._vertices;h=f[0].x;l=f[0].y;g=f[0].x;d=f[0].y;b=1;for(c=this.count;b<c;)e=b++,f[e].x<h&&(h=f[e].x),f[e].y<l&&(l=f[e].y),f[e].x>g&&(g=f[e].x),f[e].y>d&&(d=f[e].y);b=this._bounds;b.min_x=h;b.max_x=g;b.min_y=l;b.max_y=d}if(null==a)return b=this._bounds,a=b.min_x,c=b.min_y,e=b.max_x,h=b.max_y,b=$a.pool.get(),b.min_x=a,b.max_x=e,b.min_y=c,b.max_y=h,b.pooled=!1,b;b=this._bounds;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;return a},volume:function(){var a=
0;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var g=this._vertices,h=new Q(0,0);g[e]=h}var d=this.local_vertices[e].x,l=this.local_vertices[e].y;null==l&&(l=0);null==d&&(d=0);g=this.transform.get_local_to_world_matrix();h=d;var f=g.m01*h+g.m11*l+1*g.m21;d=this._vertices[e];d.x=g.m00*h+g.m10*l+1*g.m20;d.y=f}}b=0;for(c=this.count;b<c;)e=
b++,d=this._vertices[(e+1)%this.count],h=d.x,l=d.y,g=this._vertices[e],l-=g.y,h-=g.x,d=-l,l=h,h=d,null==this._normals[e]?(g=this._normals,h=new Q(h,l),g[e]=h):(g=this._normals[e],g.x=h,g.y=l),l=e=h=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),g=h.y/l,e.x=h.x/l,e.y=g}h=this._vertices;d=h[h.length-1];b=0;for(c=this.count;b<c;)e=b++,e=h[e],a+=e.x*d.y-d.x*e.y,d=e;return.5*Math.abs(a)},intersect:function(a){return za.line_intersects_polygon(a,this)},collides:function(a){return a.collide_polygon(this)},
collide_rect:function(a){return za.rect_and_polygon(a,this,!0)},collide_circle:function(a){return za.circle_and_polygon(a,this)},collide_polygon:function(a){return za.polygon_and_polygon(a,this,!0)},on_dirty:function(a){this.dirty_bounds=this.dirty_vertices=!0},__class__:db});var gd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Rect"]=gd;gd.__name__=!0;gd.__interfaces__=[pa];gd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):
this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:gd};var wb=function(){this.pooled=!1;Wa.call(this);this.local_ex=0;if(null!=this.transformed_rect){var a=this.transformed_rect;a.count=4;for(var b=0,c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var g=a.local_vertices,h=new Q(0,0);g[e]=h}}b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*
this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=this.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*
this.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=this.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=this.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.local_ey=0;if(null!=this.transformed_rect){a=this.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,h=new Q(0,0),g[e]=h);b=a.local_vertices[0];b.x=-(this.local_ex*
this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=
b;b=this.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=this.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=this.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.type=0;this.transform.on_dirty=n(this,this.on_dirty)};d["echo.shape.Rect"]=wb;wb.__name__=!0;wb.__interfaces__=
[kb];wb.get=function(a,b,c,e,g,h,d){null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=wb.pool.get(),w=b;null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==e&&(e=0);null==c&&(c=1);null==w&&(w=0);null==a&&(a=0);b=l.transform;b.dirty||b.set_dirty();b.local_x=a;b=l.transform;b.dirty||b.set_dirty();b.local_y=w;a=.5*c;b=l.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);l.local_ex=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;
b.count=4;a=0;for(w=b.count;a<w;){var f=a++;if(null==b.local_vertices[f]){var k=b.local_vertices,r=new Q(0,0);k[f]=r}}a=b.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);
a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;k=b.transform;k.dirty||k.set_dirty();k.local_x=a;a=l.transform.local_y;k=b.transform;k.dirty||k.set_dirty();k.local_y=a;k=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;k.dirty||k.set_dirty();k.local_radians=a;a=l.transform.local_scale_x;k=b.transform;k.dirty||k.set_dirty();k.local_scale_x=a;a=l.transform.local_scale_y;k=b.transform;k.dirty||k.set_dirty();k.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}a=.5*
(0>=e?c:e);b=l.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);l.local_ey=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;b.count=4;a=0;for(w=b.count;a<w;)f=a++,null==b.local_vertices[f]&&(k=b.local_vertices,r=new Q(0,0),k[f]=r);a=b.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*
l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;k=b.transform;k.dirty||k.set_dirty();k.local_x=a;a=l.transform.local_y;k=b.transform;k.dirty||k.set_dirty();k.local_y=a;k=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;k.dirty||k.set_dirty();k.local_radians=a;a=l.transform.local_scale_x;k=b.transform;k.dirty||k.set_dirty();k.local_scale_x=
a;a=l.transform.local_scale_y;k=b.transform;k.dirty||k.set_dirty();k.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}b=l.transform;a=Math.PI/180*g;b.dirty||b.set_dirty();b.local_radians=a;b=l.transform;b.dirty||b.set_dirty();b.local_scale_x=h;b=l.transform;b.dirty||b.set_dirty();b.local_scale_y=d;null==l.transformed_rect?(b=l.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c){c=db.pool.get();c.count=4;a=0;for(w=c.count;a<w;)f=a++,null==
c.local_vertices[f]&&(e=c.local_vertices,r=new Q(0,0),e[f]=r);a=c.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=c.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=c.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=c.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;
b=c.transform;b.dirty||b.set_dirty();b.local_x=a;a=l.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=a;b=c.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=a;a=l.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=a;a=l.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=a;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;l.transformed_rect=c;l.transformed_rect.set_parent(l.parent)}else null!=
l.transformed_rect&&(a=l.transform.local_x,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=a,a=l.transform.local_y,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=a,b=l.transformed_rect.transform,a=Math.PI/180*(180/Math.PI)*l.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=a,a=l.transform.local_scale_x,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=a,a=l.transform.local_scale_y,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),
b.local_scale_y=a);l.pooled=!1;return l};wb.__super__=Wa;wb.prototype=G(Wa.prototype,{put:function(){Wa.prototype.put.call(this);null!=this.transformed_rect&&(this.transformed_rect.put(),this.transformed_rect=null);this.pooled||(this.pooled=!0,wb.pool.put_unsafe(this))},to_aabb:function(a){null==a&&(a=!1);if(a){a=null;if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;b=0!=c}else b=!1;if(b)a=this.transformed_rect.bounds(a);
else if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var g=2*this.local_ex;b=this.transform;if(null==b.parent)var h=b.local_scale_x;else b.sync(),h=b._scale_x;g*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);b=$a.pool.get();null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;
h*=.5;b.min_x=e-g;b.min_y=c-h;b.max_x=e+g;b.max_y=c+h;b.pooled=!1;a=b}else b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),g=2*this.local_ex,b=this.transform,null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x),g*=h,h=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),h*=b,null==h&&(h=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),g*=.5,h*=.5,a.min_x=e-g,a.min_y=c-h,a.max_x=e+g,
a.max_y=c+h;this.put();return a}a=null;null!=this.transformed_rect?(b=this.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a)return b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),g=2*this.local_ex,b=this.transform,null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x),g*=h,h=2*this.local_ey,b=this.transform,null==
b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),h*=b,null==h&&(h=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),a=$a.pool.get(),null==h&&(h=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),g*=.5,h*=.5,a.min_x=e-g,a.min_y=c-h,a.max_x=e+g,a.max_y=c+h,a.pooled=!1,a;b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);g=2*this.local_ex;b=this.transform;null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x);g*=h;h=2*this.local_ey;
b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;h*=.5;a.min_x=e-g;a.min_y=c-h;a.max_x=e+g;a.max_y=c+h;return a},bounds:function(a){if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),
e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var g=2*this.local_ex;b=this.transform;if(null==b.parent)var h=b.local_scale_x;else b.sync(),h=b._scale_x;g*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);a=$a.pool.get();null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;h*=.5;a.min_x=e-g;a.min_y=c-h;a.max_x=e+g;a.max_y=c+h;a.pooled=!1;return a}b=this.transform;
null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);g=2*this.local_ex;b=this.transform;null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x);g*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;h*=.5;a.min_x=e-g;a.min_y=c-h;a.max_x=e+g;a.max_y=c+h;return a},volume:function(){var a=2*this.local_ex,b=this.transform;if(null==b.parent)var c=
b.local_scale_x;else b.sync(),c=b._scale_x;var e=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);return a*c*e*b},intersect:function(a){return za.line_intersects_rect(a,this)},collides:function(a){return a.collide_rect(this)},collide_rect:function(a){return za.rect_and_rect(a,this)},collide_circle:function(a){return za.rect_and_circle(this,a)},collide_polygon:function(a){return za.rect_and_polygon(this,a)},set_parent:function(a){Wa.prototype.set_parent.call(this,
a);if(null==this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c){c=db.pool.get();c.count=4;b=0;for(var e=c.count;b<e;){var g=b++;if(null==c.local_vertices[g]){var h=c.local_vertices,d=new Q(0,0);h[g]=d}}e=c.local_vertices[0];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[1];e.x=this.local_ex*this.transform.local_scale_x;e.y=
-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[2];e.x=this.local_ex*this.transform.local_scale_x;e.y=this.local_ey*this.transform.local_scale_y;e=c.local_vertices[3];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=this.local_ey*this.transform.local_scale_y;e=this.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=e;e=this.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=e;b=c.transform;e=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||
b.set_dirty();b.local_radians=e;e=this.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=e;e=this.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=e;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;this.transformed_rect=c;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(e=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=e,e=this.transform.local_y,b=this.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_y=e,b=this.transformed_rect.transform,e=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=e,e=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=e,e=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=e);null!=this.transformed_rect&&this.transformed_rect.set_parent(a)},on_dirty:function(a){if(null==this.transformed_rect){var b=
this.transform;null==b.parent?a=180/Math.PI*b.local_radians:(b.sync(),a=180/Math.PI*b._radians);a=0!=a}else a=!1;if(a){a=db.pool.get();a.count=4;b=0;for(var c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var g=a.local_vertices,h=new Q(0,0);g[e]=h}}c=a.local_vertices[0];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[1];c.x=this.local_ex*this.transform.local_scale_x;c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[2];
c.x=this.local_ex*this.transform.local_scale_x;c.y=this.local_ey*this.transform.local_scale_y;c=a.local_vertices[3];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=this.local_ey*this.transform.local_scale_y;c=this.transform.local_x;b=a.transform;b.dirty||b.set_dirty();b.local_x=c;c=this.transform.local_y;b=a.transform;b.dirty||b.set_dirty();b.local_y=c;b=a.transform;c=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=c;c=this.transform.local_scale_x;
b=a.transform;b.dirty||b.set_dirty();b.local_scale_x=c;c=this.transform.local_scale_y;b=a.transform;b.dirty||b.set_dirty();b.local_scale_y=c;a.dirty_vertices=!0;a.dirty_bounds=!0;a.pooled=!1;this.transformed_rect=a;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(c=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=c,c=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=c,b=this.transformed_rect.transform,
c=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=c,c=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=c,c=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=c)},__class__:wb});var Ad=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_util_AABB"]=Ad;Ad.__name__=!0;Ad.__interfaces__=[pa];Ad.prototype={get:function(){return 0==
this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ad};var $a=function(){this.pooled=!1;this.min_x=0;this.max_x=1;this.min_y=0;this.max_y=1};d["echo.util.AABB"]=$a;$a.__name__=!0;$a.__interfaces__=[kb];$a.prototype={put:function(){this.pooled||(this.pooled=!0,$a.pool.put_unsafe(this))},__class__:$a};var nf={_new:function(a){null==a&&(a=0);return a}},Bd=function(a){this.type=a;this.members=[];this.count=0};
d["echo.util.GenericPool_echo_util_QuadTree"]=Bd;Bd.__name__=!0;Bd.__interfaces__=[pa];Bd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Bd};var me=function(a){this.re=new Cd(a);this.un=new Cd(a)};d["echo.util.History_Array_echo_data_BodyState"]=me;me.__name__=!0;me.prototype={redo:function(){var a=this.re.pop();null!=a&&this.un.push(a);return a},undo:function(){var a=
this.un.pop();null!=a&&this.re.push(a);return a},add:function(a){this.un.push(a);this.re.reset()},__class__:me};var ed=function(){};d["echo.util.JSON"]=ed;ed.__name__=!0;ed.copy_fields=function(a,b){if(null==a)return b;if(null==b)b=F.copy(a);else for(var c=0,e=F.fields(a);c<e.length;){var g=e[c];++c;b[g]=F.field(a,g)}return b};var eb=function(a,b){null==b&&(b=0);this.nodes_list=[];this.max_contents=10;this.max_depth=5;$a.call(this);null!=a&&(this.min_x=a.min_x,this.max_x=a.max_x,this.min_y=a.min_y,
this.max_y=a.max_y);this.depth=b;this.children=Array(4);this.contents=[];this.contents_count=0};d["echo.util.QuadTree"]=eb;eb.__name__=!0;eb.__super__=$a;eb.prototype=G($a.prototype,{put:function(){if(!this.pooled){this.pooled=!0;for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,eb.pool.put_unsafe(e));this.children[c]=
null}}this.contents_count=this.contents.length=0;this.nodes_list.length=0;eb.pool.put_unsafe(this)}},insert:function(a){if(null!=a.bounds){var b=a.bounds;if(b.min_x<this.max_x&&b.max_x>=this.min_x&&b.min_y<this.max_y&&b.max_y>=this.min_y)if(null==this.children[0]&&this.contents_count+1>this.max_contents&&this.split(),null==this.children[0])b=this.get_first_null(this.contents),-1==b?this.contents.push(a):this.contents[b]=a,this.contents_count++;else{b=0;for(var c=this.children;b<c.length;){var e=c[b];
++b;e.insert(a)}}}},remove:function(a,b){null==b&&(b=!0);if(null==this.children[0]){for(b=0;b<this.contents.length;){if(null!=this.contents[b]&&this.contents[b].id==a.id)return this.contents[b]=null,this.contents_count--,!0;++b}return!1}for(var c=!1,e=0,g=this.children;e<g.length;){var h=g[e];++e;null!=h&&h.remove(a)&&(c=!0)}b&&c&&this.shake();return c},update:function(a,b){null==b&&(b=!0);this.remove(a,b);this.insert(a)},query:function(a,b){if(this.min_x<a.max_x&&this.max_x>=a.min_x&&this.min_y<
a.max_y&&this.max_y>=a.min_y)if(null==this.children[0])for(var c=0,e=this.contents;c<e.length;){var g=e[c];++c;if(null!=g){var h=g.bounds;h=h.min_x<a.max_x&&h.max_x>=a.min_x&&h.min_y<a.max_y&&h.max_y>=a.min_y}else h=!1;h&&b.push(g)}else for(c=0,e=this.children;c<e.length;)g=e[c],++c,g.query(a,b)},shake:function(){if(null==this.children[0])return!1;var a=this.get_count();if(0==a){a=0;for(var b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){for(var e=this.children[c],g=0,h=e.children.length;g<
h;){var d=g++;if(null!=e.children[d]){e.children[d].clear_children();var l=e.children[d];l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,eb.pool.put_unsafe(l));e.children[d]=null}}g=this.children[c];if(!g.pooled){g.pooled=!0;h=0;for(e=g.children.length;h<e;)d=h++,null!=g.children[d]&&(g.children[d].clear_children(),l=g.children[d],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,eb.pool.put_unsafe(l)),
g.children[d]=null);g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;eb.pool.put_unsafe(g)}this.children[c]=null}}}else if(a<this.max_contents){this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;)if(b=this.nodes_list.shift(),b!=this&&null==b.children[0])for(a=0,b=b.contents;a<b.length;)c=b[a],++a,-1==this.contents.indexOf(c)&&(g=this.get_first_null(this.contents),-1==g?this.contents.push(c):this.contents[g]=c,this.contents_count++);else for(g=0,h=b.children;g<
h.length;)a=h[g],++g,this.nodes_list.push(a);a=0;for(b=this.children.length;a<b;)if(c=a++,null!=this.children[c]){e=this.children[c];g=0;for(h=e.children.length;g<h;)d=g++,null!=e.children[d]&&(e.children[d].clear_children(),l=e.children[d],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,eb.pool.put_unsafe(l)),e.children[d]=null);g=this.children[c];if(!g.pooled){g.pooled=!0;h=0;for(e=g.children.length;h<e;)d=h++,null!=g.children[d]&&(g.children[d].clear_children(),
l=g.children[d],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,eb.pool.put_unsafe(l)),g.children[d]=null);g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;eb.pool.put_unsafe(g)}this.children[c]=null}return!0}return!1},split:function(){if(!(this.depth+1>=this.max_depth)){for(var a=.5*(this.max_x-this.min_x),b=.5*(this.max_y-this.min_y),c=0;4>c;){var e=c++,g=eb.pool.get(),h=0,d=0,l=1,f=1;null==f&&(f=1);null==l&&(l=1);null==d&&(d=0);
null==h&&(h=0);l*=.5;f*=.5;g.min_x=h-l;g.min_y=d-f;g.max_x=h+l;g.max_y=d+f;h=0;for(d=g.children.length;h<d;)l=h++,null!=g.children[l]&&(g.children[l].clear_children(),f=g.children[l],f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=0,f.contents_count=0,f.nodes_list.length=0,eb.pool.put_unsafe(f)),g.children[l]=null);g.contents.length=0;g.contents_count=0;g.pooled=!1;switch(e){case 0:h=this.min_x+a;d=this.min_y+b;g.min_x=this.min_x;g.max_x=h;g.min_y=this.min_y;g.max_y=d;break;case 1:h=this.min_y+
b;g.min_x=this.min_x+a;g.max_x=this.max_x;g.min_y=this.min_y;g.max_y=h;break;case 2:h=this.min_x+a;g.min_x=this.min_x;g.max_x=h;g.min_y=this.min_y+b;g.max_y=this.max_y;break;case 3:g.min_x=this.min_x+a,g.max_x=this.max_x,g.min_y=this.min_y+b,g.max_y=this.max_y}g.depth=this.depth+1;h=this.max_depth;d=0;for(l=g.children.length;d<l;)if(f=d++,null!=g.children[f]){f=g.children[f];for(var k=0,y=f.children.length;k<y;){var r=k++;null!=f.children[r]&&f.children[r].set_max_depth(h)}f.max_depth=h}g.max_depth=
h;h=this.max_contents;d=0;for(l=g.children.length;d<l;)if(f=d++,null!=g.children[f]){f=g.children[f];k=0;for(y=f.children.length;k<y;)if(r=k++,null!=f.children[r]){r=f.children[r];for(var E=0,v=r.children.length;E<v;){var u=E++;null!=r.children[u]&&r.children[u].set_max_depth(h)}r.max_depth=h}f.max_depth=h}g.max_contents=h;g.shake();h=0;for(d=this.contents.length;h<d;)l=h++,null!=this.contents[l]&&g.insert(this.contents[l]);this.children[e]=g}this.contents_count=this.contents.length=0}},clear_children:function(){for(var a=
0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,eb.pool.put_unsafe(e));this.children[c]=null}}},reset_data_flags:function(){for(var a=0,b=this.contents.length;a<b;){var c=a++;null!=this.contents[c]&&(this.contents[c].flag=!1)}a=0;for(b=this.children.length;a<b;)c=a++,null!=this.children[c]&&this.children[c].reset_data_flags()},
get_count:function(){this.reset_data_flags();for(var a=0,b=0,c=this.contents.length;b<c;){var e=b++;null!=this.contents[e]&&(this.contents[e].flag=!0,++a)}this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;){var g=this.nodes_list.shift();if(null==g.children[0])for(b=0,c=g.contents.length;b<c;)e=b++,null==g.contents[e]||g.contents[e].flag||(++a,g.contents[e].flag=!0);else for(b=0,c=g.children.length;b<c;)e=b++,this.nodes_list.push(g.children[e])}return a},get_first_null:function(a){for(var b=
0,c=a.length;b<c;){var e=b++;if(null==a[e])return e}return-1},set_max_depth:function(a){for(var b=0,c=this.children.length;b<c;){var e=b++;null!=this.children[e]&&this.children[e].set_max_depth(a)}return this.max_depth=a},__class__:eb,__properties__:{get_count:"get_count",set_max_depth:"set_max_depth"}});var Cd=function(a){this.a=Array(a);this.reset()};d["echo.util.Ring_Array_echo_data_BodyState"]=Cd;Cd.__name__=!0;Cd.prototype={pop:function(){if(0>=this.i+this.left-this.start)return null;0==this.i&&
(this.i=this.a.length,this.left=0);return this.a[--this.i]},push:function(a){this.i==this.a.length&&(0<this.left&&this.start==this.i&&(this.start=0),this.i=0,this.left=this.a.length);this.i+this.left-this.start==this.a.length&&this.start++;this.a[this.i++]=a},reset:function(){this.left=this.start=this.i=0},__class__:Cd};var za=function(){};d["echo.util.SAT"]=za;za.__name__=!0;za.line_intersects_rect=function(a,b){if(null!=b.transformed_rect){var c=b.transform;if(null==c.parent)var e=180/Math.PI*c.local_radians;
else c.sync(),e=180/Math.PI*c._radians;var g=0!=e}else g=!1;if(g)return b.transformed_rect.intersect(a);var h=null;if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var d=180/Math.PI*c.local_radians;else c.sync(),d=180/Math.PI*c._radians;var l=0==d}else l=!0;if(l){c=b.transform;null==c.parent?l=c.local_x:(c.sync(),l=c._x);var f=l-b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();
for(var k=0,y=c.count;k<y;){var r=k++;if(null!=c.local_vertices[r]){if(null==c._vertices[r]){var E=c._vertices,v=new Q(0,0);E[r]=v}var u=c.local_vertices[r].x,m=c.local_vertices[r].y;null==m&&(m=0);null==u&&(u=0);var q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[r];t.x=ha;t.y=G}}k=0;for(y=c.count;k<y;){r=k++;t=c._vertices[(r+1)%c.count];n=t.x;z=t.y;var p=c._vertices[r],C=n-p.x,ka=z-p.y;n=C;z=ka;u=-z;z=n;n=u;null==c._normals[r]?
(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z);var F=c._normals[r],T=F,Ca=F,D=Ca,pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha;T.x=H;T.y=J}}l=null==c._vertices[0]}else l=!0;if(l)E=c.transform,null==E.parent?f=E.local_x:(E.sync(),f=E._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();k=0;for(y=c.count;k<y;)r=k++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(E=c._vertices,v=new Q(0,0),E[r]=v),u=c.local_vertices[r].x,
m=c.local_vertices[r].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[r],t.x=ha,t.y=G);k=0;for(y=c.count;k<y;)r=k++,t=c._vertices[(r+1)%c.count],n=t.x,z=t.y,p=c._vertices[r],C=n-p.x,ka=z-p.y,n=C,z=ka,u=-z,z=n,n=u,null==c._normals[r]?(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z),D=Ca=T=F=c._normals[r],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=
B,J=Ha,T.x=H,T.y=J}l=c._vertices[0].x;k=1;for(y=c.count;k<y;){r=k++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var kb=0,ya=c.count;kb<ya;){var O=kb++;null!=c.local_vertices[O]&&(null==c._vertices[O]&&(E=c._vertices,v=new Q(0,0),E[O]=v),u=c.local_vertices[O].x,m=c.local_vertices[O].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[O],t.x=
ha,t.y=G)}for(var K=0,ma=c.count;K<ma;){var S=K++;F=c._vertices[(S+1)%c.count];var I=F.x,L=F.y;p=c._vertices[S];C=I-p.x;ka=L-p.y;I=C;L=ka;var M=-L;L=I;I=M;if(null==c._normals[S]){var qa=c._normals,U=new Q(I,L);qa[S]=U}else{var N=c._normals[S];N.x=I;N.y=L}var Y=c._normals[S];D=Ca=T=Y;pa=D.x*D.x+D.y*D.y;ca=0==pa?1:Math.sqrt(pa);B=Ca.x/ca;Ha=Ca.y/ca;H=B;J=Ha;T.x=H;T.y=J}}if(c._vertices[r].x<l){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var la=0,W=c.count;la<
W;){var R=la++;if(null!=c.local_vertices[R]){if(null==c._vertices[R]){var lb=c._vertices,ea=new Q(0,0);lb[R]=ea}var Z=c.local_vertices[R].x,aa=c.local_vertices[R].y;null==aa&&(aa=0);null==Z&&(Z=0);var ua=c.transform.get_local_to_world_matrix(),ia=Z,ib=aa,ta=1,oa=ua.m00*ia+ua.m10*ib+ua.m20*ta,wa=ua.m01*ia+ua.m11*ib+ua.m21*ta,va=oa,Za=wa,Oa=c._vertices[R];Oa.x=va;Oa.y=Za}}for(var Va=0,na=c.count;Va<na;){var da=Va++,xa=c._vertices[(da+1)%c.count],ja=xa.x,fa=xa.y,Aa=c._vertices[da],Ea=ja-Aa.x,Bb=fa-Aa.y;
ja=Ea;fa=Bb;var ra=-fa;fa=ja;ja=ra;if(null==c._normals[da]){var Ba=c._normals,vb=new Q(ja,fa);Ba[da]=vb}else{var Da=c._normals[da];Da.x=ja;Da.y=fa}var Fa=c._normals[da],sa=Fa,Ja=Fa,Ga=Ja,La=Ga.x*Ga.x+Ga.y*Ga.y,Sa=0==La?1:Math.sqrt(La),Wa=Ja.x/Sa,Ia=Ja.y/Sa,Ma=Wa,Ra=Ia;sa.x=Ma;sa.y=Ra}}l=c._vertices[r].x}}f=l}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var eb=180/Math.PI*c.local_radians;else c.sync(),eb=180/Math.PI*c._radians;var Ka=0==eb}else Ka=!0;if(Ka){c=b.transform;null==c.parent?
Ka=c.local_x:(c.sync(),Ka=c._x);var Ua=Ka+b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();k=0;for(y=c.count;k<y;)r=k++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(E=c._vertices,v=new Q(0,0),E[r]=v),u=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+
q.m21*x,ha=V,G=A,t=c._vertices[r],t.x=ha,t.y=G);k=0;for(y=c.count;k<y;)r=k++,t=c._vertices[(r+1)%c.count],n=t.x,z=t.y,p=c._vertices[r],C=n-p.x,ka=z-p.y,n=C,z=ka,u=-z,z=n,n=u,null==c._normals[r]?(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z),D=Ca=T=F=c._normals[r],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}Ka=null==c._vertices[0]}else Ka=!0;if(Ka)E=c.transform,null==E.parent?Ua=E.local_x:(E.sync(),Ua=E._x);else{if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();k=0;for(y=c.count;k<y;)r=k++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(E=c._vertices,v=new Q(0,0),E[r]=v),u=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[r],t.x=ha,t.y=G);k=0;for(y=c.count;k<y;)r=k++,t=c._vertices[(r+1)%c.count],n=t.x,z=t.y,p=c._vertices[r],C=n-p.x,ka=z-p.y,n=C,z=ka,
u=-z,z=n,n=u,null==c._normals[r]?(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z),D=Ca=T=F=c._normals[r],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}Ka=c._vertices[0].x;k=1;for(y=c.count;k<y;){r=k++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();kb=0;for(ya=c.count;kb<ya;)O=kb++,null!=c.local_vertices[O]&&(null==c._vertices[O]&&(E=c._vertices,v=new Q(0,0),E[O]=v),u=c.local_vertices[O].x,m=c.local_vertices[O].y,
null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[O],t.x=ha,t.y=G);K=0;for(ma=c.count;K<ma;)S=K++,F=c._vertices[(S+1)%c.count],I=F.x,L=F.y,p=c._vertices[S],C=I-p.x,ka=L-p.y,I=C,L=ka,M=-L,L=I,I=M,null==c._normals[S]?(qa=c._normals,U=new Q(I,L),qa[S]=U):(N=c._normals[S],N.x=I,N.y=L),D=Ca=T=Y=c._normals[S],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}if(c._vertices[r].x>
Ka){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();la=0;for(W=c.count;la<W;)R=la++,null!=c.local_vertices[R]&&(null==c._vertices[R]&&(lb=c._vertices,ea=new Q(0,0),lb[R]=ea),Z=c.local_vertices[R].x,aa=c.local_vertices[R].y,null==aa&&(aa=0),null==Z&&(Z=0),ua=c.transform.get_local_to_world_matrix(),ia=Z,ib=aa,ta=1,oa=ua.m00*ia+ua.m10*ib+ua.m20*ta,wa=ua.m01*ia+ua.m11*ib+ua.m21*ta,va=oa,Za=wa,Oa=c._vertices[R],Oa.x=va,Oa.y=Za);Va=0;for(na=c.count;Va<na;)da=Va++,
xa=c._vertices[(da+1)%c.count],ja=xa.x,fa=xa.y,Aa=c._vertices[da],Ea=ja-Aa.x,Bb=fa-Aa.y,ja=Ea,fa=Bb,ra=-fa,fa=ja,ja=ra,null==c._normals[da]?(Ba=c._normals,vb=new Q(ja,fa),Ba[da]=vb):(Da=c._normals[da],Da.x=ja,Da.y=fa),Ga=Ja=sa=Fa=c._normals[da],La=Ga.x*Ga.x+Ga.y*Ga.y,Sa=0==La?1:Math.sqrt(La),Wa=Ja.x/Sa,Ia=Ja.y/Sa,Ma=Wa,Ra=Ia,sa.x=Ma,sa.y=Ra}Ka=c._vertices[r].x}}Ua=Ka}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var fb=180/Math.PI*c.local_radians;else c.sync(),fb=180/Math.PI*c._radians;
var Nc=0==fb}else Nc=!0;if(Nc){c=b.transform;null==c.parent?Nc=c.local_y:(c.sync(),Nc=c._y);var Ta=Nc-b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();k=0;for(y=c.count;k<y;)r=k++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(E=c._vertices,v=new Q(0,0),E[r]=v),u=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),
n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[r],t.x=ha,t.y=G);k=0;for(y=c.count;k<y;)r=k++,t=c._vertices[(r+1)%c.count],n=t.x,z=t.y,p=c._vertices[r],C=n-p.x,ka=z-p.y,n=C,z=ka,u=-z,z=n,n=u,null==c._normals[r]?(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z),D=Ca=T=F=c._normals[r],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}Nc=null==c._vertices[0]}else Nc=!0;if(Nc)E=c.transform,null==E.parent?Ta=E.local_y:
(E.sync(),Ta=E._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();k=0;for(y=c.count;k<y;)r=k++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(E=c._vertices,v=new Q(0,0),E[r]=v),u=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[r],t.x=ha,t.y=G);k=0;for(y=c.count;k<y;)r=k++,t=c._vertices[(r+1)%
c.count],n=t.x,z=t.y,p=c._vertices[r],C=n-p.x,ka=z-p.y,n=C,z=ka,u=-z,z=n,n=u,null==c._normals[r]?(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z),D=Ca=T=F=c._normals[r],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}Nc=c._vertices[0].y;k=1;for(y=c.count;k<y;){r=k++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();kb=0;for(ya=c.count;kb<ya;)O=kb++,null!=c.local_vertices[O]&&(null==c._vertices[O]&&(E=c._vertices,
v=new Q(0,0),E[O]=v),u=c.local_vertices[O].x,m=c.local_vertices[O].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[O],t.x=ha,t.y=G);K=0;for(ma=c.count;K<ma;)S=K++,F=c._vertices[(S+1)%c.count],I=F.x,L=F.y,p=c._vertices[S],C=I-p.x,ka=L-p.y,I=C,L=ka,M=-L,L=I,I=M,null==c._normals[S]?(qa=c._normals,U=new Q(I,L),qa[S]=U):(N=c._normals[S],N.x=I,N.y=L),D=Ca=T=Y=c._normals[S],pa=D.x*D.x+D.y*D.y,
ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}if(c._vertices[r].y<Nc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();la=0;for(W=c.count;la<W;)R=la++,null!=c.local_vertices[R]&&(null==c._vertices[R]&&(lb=c._vertices,ea=new Q(0,0),lb[R]=ea),Z=c.local_vertices[R].x,aa=c.local_vertices[R].y,null==aa&&(aa=0),null==Z&&(Z=0),ua=c.transform.get_local_to_world_matrix(),ia=Z,ib=aa,ta=1,oa=ua.m00*ia+ua.m10*ib+ua.m20*ta,wa=ua.m01*ia+ua.m11*ib+ua.m21*
ta,va=oa,Za=wa,Oa=c._vertices[R],Oa.x=va,Oa.y=Za);Va=0;for(na=c.count;Va<na;)da=Va++,xa=c._vertices[(da+1)%c.count],ja=xa.x,fa=xa.y,Aa=c._vertices[da],Ea=ja-Aa.x,Bb=fa-Aa.y,ja=Ea,fa=Bb,ra=-fa,fa=ja,ja=ra,null==c._normals[da]?(Ba=c._normals,vb=new Q(ja,fa),Ba[da]=vb):(Da=c._normals[da],Da.x=ja,Da.y=fa),Ga=Ja=sa=Fa=c._normals[da],La=Ga.x*Ga.x+Ga.y*Ga.y,Sa=0==La?1:Math.sqrt(La),Wa=Ja.x/Sa,Ia=Ja.y/Sa,Ma=Wa,Ra=Ia,sa.x=Ma,sa.y=Ra}Nc=c._vertices[r].y}}Ta=Nc}}if(null!=b.transformed_rect){c=b.transform;if(null==
c.parent)var jb=180/Math.PI*c.local_radians;else c.sync(),jb=180/Math.PI*c._radians;var Oc=0==jb}else Oc=!0;if(Oc){c=b.transform;null==c.parent?Oc=c.local_y:(c.sync(),Oc=c._y);var $a=Oc+b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();k=0;for(y=c.count;k<y;)r=k++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(E=c._vertices,v=new Q(0,0),E[r]=v),u=c.local_vertices[r].x,m=c.local_vertices[r].y,
null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[r],t.x=ha,t.y=G);k=0;for(y=c.count;k<y;)r=k++,t=c._vertices[(r+1)%c.count],n=t.x,z=t.y,p=c._vertices[r],C=n-p.x,ka=z-p.y,n=C,z=ka,u=-z,z=n,n=u,null==c._normals[r]?(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z),D=Ca=T=F=c._normals[r],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}Oc=null==
c._vertices[0]}else Oc=!0;if(Oc)E=c.transform,null==E.parent?$a=E.local_y:(E.sync(),$a=E._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();k=0;for(y=c.count;k<y;)r=k++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(E=c._vertices,v=new Q(0,0),E[r]=v),u=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[r],
t.x=ha,t.y=G);k=0;for(y=c.count;k<y;)r=k++,t=c._vertices[(r+1)%c.count],n=t.x,z=t.y,p=c._vertices[r],C=n-p.x,ka=z-p.y,n=C,z=ka,u=-z,z=n,n=u,null==c._normals[r]?(E=c._normals,v=new Q(n,z),E[r]=v):(q=c._normals[r],q.x=n,q.y=z),D=Ca=T=F=c._normals[r],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}Oc=c._vertices[0].y;k=1;for(y=c.count;k<y;){r=k++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();kb=0;for(ya=c.count;kb<ya;)O=
kb++,null!=c.local_vertices[O]&&(null==c._vertices[O]&&(E=c._vertices,v=new Q(0,0),E[O]=v),u=c.local_vertices[O].x,m=c.local_vertices[O].y,null==m&&(m=0),null==u&&(u=0),q=c.transform.get_local_to_world_matrix(),n=u,z=m,x=1,V=q.m00*n+q.m10*z+q.m20*x,A=q.m01*n+q.m11*z+q.m21*x,ha=V,G=A,t=c._vertices[O],t.x=ha,t.y=G);K=0;for(ma=c.count;K<ma;)S=K++,F=c._vertices[(S+1)%c.count],I=F.x,L=F.y,p=c._vertices[S],C=I-p.x,ka=L-p.y,I=C,L=ka,M=-L,L=I,I=M,null==c._normals[S]?(qa=c._normals,U=new Q(I,L),qa[S]=U):(N=
c._normals[S],N.x=I,N.y=L),D=Ca=T=Y=c._normals[S],pa=D.x*D.x+D.y*D.y,ca=0==pa?1:Math.sqrt(pa),B=Ca.x/ca,Ha=Ca.y/ca,H=B,J=Ha,T.x=H,T.y=J}if(c._vertices[r].y>Oc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();la=0;for(W=c.count;la<W;)R=la++,null!=c.local_vertices[R]&&(null==c._vertices[R]&&(lb=c._vertices,ea=new Q(0,0),lb[R]=ea),Z=c.local_vertices[R].x,aa=c.local_vertices[R].y,null==aa&&(aa=0),null==Z&&(Z=0),ua=c.transform.get_local_to_world_matrix(),ia=Z,
ib=aa,ta=1,oa=ua.m00*ia+ua.m10*ib+ua.m20*ta,wa=ua.m01*ia+ua.m11*ib+ua.m21*ta,va=oa,Za=wa,Oa=c._vertices[R],Oa.x=va,Oa.y=Za);Va=0;for(na=c.count;Va<na;)da=Va++,xa=c._vertices[(da+1)%c.count],ja=xa.x,fa=xa.y,Aa=c._vertices[da],Ea=ja-Aa.x,Bb=fa-Aa.y,ja=Ea,fa=Bb,ra=-fa,fa=ja,ja=ra,null==c._normals[da]?(Ba=c._normals,vb=new Q(ja,fa),Ba[da]=vb):(Da=c._normals[da],Da.x=ja,Da.y=fa),Ga=Ja=sa=Fa=c._normals[da],La=Ga.x*Ga.x+Ga.y*Ga.y,Sa=0==La?1:Math.sqrt(La),Wa=Ja.x/Sa,Ia=Ja.y/Sa,Ma=Wa,Ra=Ia,sa.x=Ma,sa.y=Ra}Oc=
c._vertices[r].y}}$a=Oc}}u=f;m=Ta;var mb=Ua,uc=Ta;null==uc&&(uc=1);null==mb&&(mb=1);null==m&&(m=0);null==u&&(u=0);var X=Fb.pool.get();M=u;aa=m;var db=mb,Xa=uc;null==Xa&&(Xa=1);null==db&&(db=1);null==aa&&(aa=0);null==M&&(M=0);t=X.start;t.x=M;t.y=aa;t=X.end;t.x=db;t.y=Xa;X.pooled=!1;var hb=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(hb))var ob=null;else{var jc=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-
X.get_x()))/hb,Tc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/hb;if(0>jc||1<jc||0>Tc||1<Tc)ob=null;else{q=a.start;var Na=jc;N=a.end;p=a.start;var Id=N.x-p.x,Ya=N.y-p.y;C=Id*Na;ka=Ya*Na;var Qa=q.x+C,Wb=q.y+ka;q=a.start;var Pa=Qa-q.x,ab=Wb-q.y,rb=Math.sqrt(Pa*Pa+ab*ab);q=a.start;p=a.end;Pa=p.x-q.x;ab=p.y-q.y;var cb=Math.sqrt(Pa*Pa+ab*ab)-rb,nb=0<=hb;q=X.start;p=X.end;Pa=p.x-q.x;ab=p.y-q.y;var xb=Math.sqrt(Pa*Pa+ab*ab)*(nb?-1:1);t=za.norm;u=(X.get_dy()-
X.get_y())/xb;m=-(X.get_dx()-X.get_x())/xb;t.x=u;t.y=m;var gb=za.norm.x,bb=za.norm.y,$b=nb;null==$b&&($b=!1);r=Rb.pool.get();r.line=null;r.shape=null;r.line2=null;var Cb=$b;null==Cb&&(Cb=!1);r.distance=rb;r.overlap=cb;r.inverse_normal=Cb;t=r.hit;t.x=Qa;t.y=Wb;t=r.normal;t.x=gb;t.y=bb;r.pooled=!1;var ac=r;ac.line=a;ac.line2=X;ob=ac}}null!=ob&&(h=ob);u=Ua;m=Ta;mb=Ua;uc=$a;null==uc&&(uc=1);null==mb&&(mb=1);null==m&&(m=0);null==u&&(u=0);t=X.start;t.x=u;t.y=m;t=X.end;t.x=mb;t.y=uc;hb=(X.get_dy()-X.get_y())*
(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(hb)?ob=null:(jc=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/hb,Tc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/hb,0>jc||1<jc||0>Tc||1<Tc?ob=null:(q=a.start,Na=jc,N=a.end,p=a.start,Id=N.x-p.x,Ya=N.y-p.y,C=Id*Na,ka=Ya*Na,Qa=q.x+C,Wb=q.y+ka,q=a.start,Pa=Qa-q.x,ab=Wb-q.y,rb=Math.sqrt(Pa*Pa+ab*ab),q=a.start,p=a.end,Pa=p.x-q.x,
ab=p.y-q.y,cb=Math.sqrt(Pa*Pa+ab*ab)-rb,nb=0<=hb,q=X.start,p=X.end,Pa=p.x-q.x,ab=p.y-q.y,xb=Math.sqrt(Pa*Pa+ab*ab)*(nb?-1:1),t=za.norm,u=(X.get_dy()-X.get_y())/xb,m=-(X.get_dx()-X.get_x())/xb,t.x=u,t.y=m,gb=za.norm.x,bb=za.norm.y,$b=nb,null==$b&&($b=!1),r=Rb.pool.get(),r.line=null,r.shape=null,r.line2=null,Cb=$b,null==Cb&&(Cb=!1),r.distance=rb,r.overlap=cb,r.inverse_normal=Cb,t=r.hit,t.x=Qa,t.y=Wb,t=r.normal,t.x=gb,t.y=bb,r.pooled=!1,ac=r,ac.line=a,ac.line2=X,ob=ac));null!=ob&&(null==h||h.distance>
ob.distance)&&(h=ob);u=Ua;m=$a;mb=f;uc=$a;null==uc&&(uc=1);null==mb&&(mb=1);null==m&&(m=0);null==u&&(u=0);t=X.start;t.x=u;t.y=m;t=X.end;t.x=mb;t.y=uc;hb=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(hb)?ob=null:(jc=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/hb,Tc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/hb,0>jc||1<jc||0>Tc||1<Tc?ob=null:(q=
a.start,Na=jc,N=a.end,p=a.start,Id=N.x-p.x,Ya=N.y-p.y,C=Id*Na,ka=Ya*Na,Qa=q.x+C,Wb=q.y+ka,q=a.start,Pa=Qa-q.x,ab=Wb-q.y,rb=Math.sqrt(Pa*Pa+ab*ab),q=a.start,p=a.end,Pa=p.x-q.x,ab=p.y-q.y,cb=Math.sqrt(Pa*Pa+ab*ab)-rb,nb=0<=hb,q=X.start,p=X.end,Pa=p.x-q.x,ab=p.y-q.y,xb=Math.sqrt(Pa*Pa+ab*ab)*(nb?-1:1),t=za.norm,u=(X.get_dy()-X.get_y())/xb,m=-(X.get_dx()-X.get_x())/xb,t.x=u,t.y=m,gb=za.norm.x,bb=za.norm.y,$b=nb,null==$b&&($b=!1),r=Rb.pool.get(),r.line=null,r.shape=null,r.line2=null,Cb=$b,null==Cb&&(Cb=
!1),r.distance=rb,r.overlap=cb,r.inverse_normal=Cb,t=r.hit,t.x=Qa,t.y=Wb,t=r.normal,t.x=gb,t.y=bb,r.pooled=!1,ac=r,ac.line=a,ac.line2=X,ob=ac));null!=ob&&(null==h||h.distance>ob.distance)&&(h=ob);u=f;m=$a;mb=f;uc=Ta;null==uc&&(uc=1);null==mb&&(mb=1);null==m&&(m=0);null==u&&(u=0);t=X.start;t.x=u;t.y=m;t=X.end;t.x=mb;t.y=uc;hb=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(hb)?ob=null:(jc=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-
X.get_y())*(a.get_x()-X.get_x()))/hb,Tc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/hb,0>jc||1<jc||0>Tc||1<Tc?ob=null:(q=a.start,Na=jc,N=a.end,p=a.start,Id=N.x-p.x,Ya=N.y-p.y,C=Id*Na,ka=Ya*Na,Qa=q.x+C,Wb=q.y+ka,q=a.start,Pa=Qa-q.x,ab=Wb-q.y,rb=Math.sqrt(Pa*Pa+ab*ab),q=a.start,p=a.end,Pa=p.x-q.x,ab=p.y-q.y,cb=Math.sqrt(Pa*Pa+ab*ab)-rb,nb=0<=hb,q=X.start,p=X.end,Pa=p.x-q.x,ab=p.y-q.y,xb=Math.sqrt(Pa*Pa+ab*ab)*(nb?-1:1),t=za.norm,u=(X.get_dy()-X.get_y())/
xb,m=-(X.get_dx()-X.get_x())/xb,t.x=u,t.y=m,gb=za.norm.x,bb=za.norm.y,$b=nb,null==$b&&($b=!1),r=Rb.pool.get(),r.line=null,r.shape=null,r.line2=null,Cb=$b,null==Cb&&(Cb=!1),r.distance=rb,r.overlap=cb,r.inverse_normal=Cb,t=r.hit,t.x=Qa,t.y=Wb,t=r.normal,t.x=gb,t.y=bb,r.pooled=!1,ac=r,ac.line=a,ac.line2=X,ob=ac));null!=ob&&(null==h||h.distance>ob.distance)&&(h=ob);null!=h&&(h.line=a,h.shape=b);return h};za.line_intersects_circle=function(a,b){var c=a.end,e=a.start,g=c.x-e.x,h=c.y-e.y;c=a.start;var d=
b.transform;d.sync();var l=d._x,f=d._y,k=c.x-l;l=c.y-f;f=b.local_radius;d=b.transform;null==d.parent?c=d.local_scale_x:(d.sync(),c=d._scale_x);f*=c;c=g*g+h*h;e=2*(k*g+l*h);h=e*e-4*c*(k*k+l*l-f*f);if(0>h)return null;h=Math.sqrt(h);g=(-e-h)/(2*c);h=(-e+h)/(2*c);return 0<=g&&1>=g?(c=a.start,h=g,d=a.end,e=a.start,g=d.x-e.x,k=d.y-e.y,g=c.x+g*h,h=c.y+k*h,c=a.start,d=g-c.x,c=h-c.y,k=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-k,c=za.norm,d=b.transform,null==d.parent?l=d.local_x:
(d.sync(),l=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=g-l,c.y=h-d,c=za.norm,l=c.x/f,f=c.y/f,c.x=l,c.y=f,f=za.norm.x,d=za.norm.y,l=Rb.pool.get(),l.line=null,l.shape=null,l.line2=null,c=!1,null==c&&(c=!1),l.distance=k,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=g,c.y=h,c=l.normal,c.x=f,c.y=d,l.pooled=!1,f=l,f.line=a,f.shape=b,f):0<=h&&1>=h?(c=a.start,d=a.end,e=a.start,g=d.x-e.x,k=d.y-e.y,g=c.x+g*h,h=c.y+k*h,c=a.start,d=g-c.x,c=h-c.y,k=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=
e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-k,c=za.norm,d=b.transform,null==d.parent?l=d.local_x:(d.sync(),l=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=g-l,c.y=h-d,d=c=za.norm,l=-d.y,c.x=-d.x/f,c.y=l/f,f=za.norm.x,d=za.norm.y,c=!0,null==c&&(c=!1),l=Rb.pool.get(),l.line=null,l.shape=null,l.line2=null,null==c&&(c=!1),l.distance=k,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=g,c.y=h,c=l.normal,c.x=f,c.y=d,l.pooled=!1,f=l,f.line=a,f.shape=b,f):null};za.line_intersects_polygon=function(a,
b){var c=null,e=Fb.pool.get(),g=0,h=0,d=1,l=1;null==l&&(l=1);null==d&&(d=1);null==h&&(h=0);null==g&&(g=0);var f=e.start;f.x=g;f.y=h;f=e.end;f.x=d;f.y=l;e.pooled=!1;for(var k=0,y=b.count;k<y;){var r=k++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var E=0,v=b.count;E<v;){var q=E++;if(null!=b.local_vertices[q]){if(null==b._vertices[q]){var u=b._vertices,m=new Q(0,0);u[q]=m}g=b.local_vertices[q].x;h=b.local_vertices[q].y;null==h&&(h=0);null==g&&(g=0);
var n=b.transform.get_local_to_world_matrix(),z=g,t=h,x=n.m00*z+n.m10*t+1*n.m20,p=n.m01*z+n.m11*t+1*n.m21;f=b._vertices[q];f.x=x;f.y=p}}for(var V=0,A=b.count;V<A;){var ha=V++,G=b._vertices[(ha+1)%b.count],C=G.x,D=G.y,ka=b._vertices[ha],T=D-ka.y;C-=ka.x;D=T;var Ca=-D;D=C;C=Ca;if(null==b._normals[ha]){var F=b._normals,pa=new Q(C,D);F[ha]=pa}else{var ca=b._normals[ha];ca.x=C;ca.y=D}var B=b._normals[ha],Ha=B,H=B,J=H,O=J.x*J.x+J.y*J.y,kb=0==O?1:Math.sqrt(O),S=H.y/kb;Ha.x=H.x/kb;Ha.y=S}}var ya=b._vertices[r];
if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var K=0,I=b.count;K<I;){var L=K++;if(null!=b.local_vertices[L]){if(null==b._vertices[L]){var ma=b._vertices,N=new Q(0,0);ma[L]=N}var M=b.local_vertices[L].x,R=b.local_vertices[L].y;null==R&&(R=0);null==M&&(M=0);var qa=b.transform.get_local_to_world_matrix(),U=M,la=R,ua=qa.m01*U+qa.m11*la+1*qa.m21,Y=b._vertices[L];Y.x=qa.m00*U+qa.m10*la+1*qa.m20;Y.y=ua}}for(var aa=0,Z=b.count;aa<Z;){var W=aa++,lb=b._vertices[(W+
1)%b.count],ea=lb.x,da=lb.y,ja=b._vertices[W],fa=da-ja.y;ea-=ja.x;da=fa;var ia=-da;da=ea;ea=ia;if(null==b._normals[W]){var ib=b._normals,ta=new Q(ea,da);ib[W]=ta}else{var oa=b._normals[W];oa.x=ea;oa.y=da}var Oa=b._normals[W],Va=Oa,wa=Oa,va=wa,Za=va.x*va.x+va.y*va.y,xa=0==Za?1:Math.sqrt(Za),na=wa.y/xa;Va.x=wa.x/xa;Va.y=na}}var Aa=b._vertices[(r+1)%b.count],Ga=ya.x,Da=ya.y;d=Aa.x;l=Aa.y;null==l&&(l=1);null==d&&(d=1);null==Da&&(Da=0);null==Ga&&(Ga=0);var Ea=e.start;Ea.x=Ga;Ea.y=Da;var Bb=e.end;Bb.x=
d;Bb.y=l;var ra=(e.get_dy()-e.get_y())*(a.get_dx()-a.get_x())-(e.get_dx()-e.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(ra))var sa=null;else{var Ja=((e.get_dx()-e.get_x())*(a.get_y()-e.get_y())-(e.get_dy()-e.get_y())*(a.get_x()-e.get_x()))/ra,Ba=((a.get_dx()-a.get_x())*(a.get_y()-e.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-e.get_x()))/ra;if(0>Ja||1<Ja||0>Ba||1<Ba)sa=null;else{var vb=a.start,La=Ja,Sa=a.end,Fa=a.start,Ka=vb.x+(Sa.x-Fa.x)*La,Wa=vb.y+(Sa.y-Fa.y)*La,Ia=a.start,Ma=Ka-Ia.x,Ra=Wa-
Ia.y,Na=Math.sqrt(Ma*Ma+Ra*Ra),Ua=a.start,Ta=a.end,Qa=Ta.x-Ua.x,$a=Ta.y-Ua.y,Ya=Math.sqrt(Qa*Qa+$a*$a)-Na,eb=0<=ra,cb=e.start,mb=e.end,gb=mb.x-cb.x,X=mb.y-cb.y,fb=Math.sqrt(gb*gb+X*X)*(eb?-1:1),bb=za.norm,hb=(e.get_dy()-e.get_y())/fb,ob=-(e.get_dx()-e.get_x())/fb;bb.x=hb;bb.y=ob;var jc=za.norm.x,jb=za.norm.y,db=eb;null==db&&(db=!1);var Xa=Rb.pool.get();Xa.line=null;Xa.shape=null;Xa.line2=null;var pb=db;null==pb&&(pb=!1);Xa.distance=Na;Xa.overlap=Ya;Xa.inverse_normal=pb;var Ab=Xa.hit;Ab.x=Ka;Ab.y=
Wa;var Wb=Xa.normal;Wb.x=jc;Wb.y=jb;Xa.pooled=!1;var Pa=Xa;Pa.line=a;Pa.line2=e;sa=Pa}}null!=sa&&(null==c||c.distance>sa.distance)&&(c=sa)}null!=c&&(c.line=a,c.shape=b);return c};za.rect_and_rect=function(a,b,c){null==c&&(c=!1);var e=null,g=a.transform;if(null==g.parent)var h=180/Math.PI*g.local_radians;else g.sync(),h=180/Math.PI*g._radians;0==h?(g=b.transform,null==g.parent?h=180/Math.PI*g.local_radians:(g.sync(),h=180/Math.PI*g._radians),h=0!=h):h=!0;if(h){if(null!=a.transformed_rect){e=za.rect_and_polygon(b,
a.transformed_rect,c);if(null==e)return null;c?e.sa=a:e.sb=a;return e}if(null!=b.transformed_rect){e=za.rect_and_polygon(a,b.transformed_rect,!c);if(null==e)return null;c?e.sa=b:e.sb=b;return e}}h=c?b:a;a=c?a:b;g=a.transform;null==g.parent?b=g.local_x:(g.sync(),b=g._x);g=h.transform;null==g.parent?g=g.local_x:(g.sync(),g=g._x);b-=g;g=a.transform;null==g.parent?c=g.local_y:(g.sync(),c=g._y);g=h.transform;null==g.parent?g=g.local_y:(g.sync(),g=g._y);g=c-g;c=h.local_ex*h.transform.local_scale_x+a.local_ex*
a.transform.local_scale_x-Math.abs(b);if(0<c){var d=h.local_ey*h.transform.local_scale_y+a.local_ey*a.transform.local_scale_y-Math.abs(g);if(0<d){if(c<d){e=tc.pool.get();e.sa=null;e.sb=null;for(var l=e.contact_count=0,f=e.contacts;l<f.length;){var k=f[l];++l;k.x=0;k.y=0}e.overlap=c;c=e.normal;c.x=0>b?-1:1;c.y=0}else{e=tc.pool.get();e.sa=null;e.sb=null;l=e.contact_count=0;for(f=e.contacts;l<f.length;)k=f[l],++l,k.x=0,k.y=0;e.overlap=d;c=e.normal;c.x=0;c.y=0>g?-1:1}e.pooled=!1;e.sa=h;e.sb=a}}return e};
za.circle_and_circle=function(a,b,c){null==c&&(c=!1);var e=c?b:a;a=c?a:b;var g=a.transform;null==g.parent?b=g.local_x:(g.sync(),b=g._x);g=e.transform;null==g.parent?c=g.local_x:(g.sync(),c=g._x);b-=c;g=a.transform;null==g.parent?c=g.local_y:(g.sync(),c=g._y);g=e.transform;null==g.parent?g=g.local_y:(g.sync(),g=g._y);c-=g;var h=e.local_radius;g=e.transform;if(null==g.parent)var d=g.local_scale_x;else g.sync(),d=g._scale_x;var l=a.local_radius;g=a.transform;null==g.parent?g=g.local_scale_x:(g.sync(),
g=g._scale_x);h=h*d+l*g;d=b*b+c*c;g=null;if(d>=h*h)return g;if(1E-5>=Math.abs(d)){h=e.local_radius;g=e.transform;null==g.parent?b=g.local_scale_x:(g.sync(),b=g._scale_x);b*=h;g=tc.pool.get();g.sa=null;g.sb=null;l=g.contact_count=0;for(var f=g.contacts;l<f.length;){var k=f[l];++l;k.x=0;k.y=0}g.overlap=b;h=g.normal;h.x=1;h.y=0}else{d=Math.sqrt(d);b/=d;c/=d;g=tc.pool.get();g.sa=null;g.sb=null;l=g.contact_count=0;for(f=g.contacts;l<f.length;)k=f[l],++l,k.x=0,k.y=0;g.overlap=h-d;h=g.normal;h.x=b;h.y=c}g.pooled=
!1;g.sa=e;g.sb=a;return g};za.polygon_and_polygon=function(a,b,c){null==c&&(c=!1);var e=za.check_polygons(a,b,c);if(null==e)return null;a=za.check_polygons(b,a,!c);if(null==a)return null;0>e.overlap&&(e.overlap=Math.abs(e.overlap));0>a.overlap&&(a.overlap=Math.abs(a.overlap));if(e.overlap<a.overlap)return a.put(),e;e.put();return a};za.rect_and_circle=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect){var e=a.transform;if(null==e.parent)var g=180/Math.PI*e.local_radians;else e.sync(),g=
180/Math.PI*e._radians;g=0!=g}else g=!1;if(g){g=za.circle_and_polygon(b,a.transformed_rect,c);if(null==g)return null;c?g.sa=a:g.sb=a;return g}c?(e=b.transform,null==e.parent?g=e.local_x:(e.sync(),g=e._x),e=a.transform):(e=a.transform,null==e.parent?g=e.local_x:(e.sync(),g=e._x),e=b.transform);if(null==e.parent)var h=e.local_x;else e.sync(),h=e._x;g-=h;c?(e=b.transform,null==e.parent?h=e.local_y:(e.sync(),h=e._y),e=a.transform):(e=a.transform,null==e.parent?h=e.local_y:(e.sync(),h=e._y),e=b.transform);
if(null==e.parent)var d=e.local_y;else e.sync(),d=e._y;h-=d;var l=g,f=h;d=-(a.local_ex*a.transform.local_scale_x);var k=a.local_ex*a.transform.local_scale_x;l<d?l=d:l>k&&(l=k);d=-(a.local_ey*a.transform.local_scale_y);k=a.local_ey*a.transform.local_scale_y;f<d?f=d:f>k&&(f=k);k=!1;d=b.local_radius;e=b.transform;null==e.parent?e=e.local_scale_x:(e.sync(),e=e._scale_x);d*=e;1E-5>=Math.abs(g-l)&&1E-5>=Math.abs(h-f)&&(k=!0,Math.abs(g)>Math.abs(h)?l=0<l?a.local_ex*a.transform.local_scale_x+d+.1:-(a.local_ex*
a.transform.local_scale_x)-d-.1:f=0<f?a.local_ey*a.transform.local_scale_y+d+.1:-(a.local_ey*a.transform.local_scale_y)-d-.1);g-=l;h-=f;l=g*g+h*h;if(l>d*d&&!k)return null;l=Math.sqrt(l);g/=l;h/=l;k&&(g*=-1,h*=-1);l=Math.abs(d-l);d=tc.pool.get();d.sa=null;d.sb=null;f=d.contact_count=0;for(k=d.contacts;f<k.length;)e=k[f],++f,e.x=0,e.y=0;d.overlap=l;l=d.normal;l.x=g;l.y=h;d.pooled=!1;g=d;g.sa=c?b:a;g.sb=c?a:b;return g};za.rect_and_polygon=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect)b=
za.polygon_and_polygon(a.transformed_rect,b,c);else{var e=db.pool.get();e.count=4;for(var g=0,h=e.count;g<h;){var d=g++;if(null==e.local_vertices[d]){var l=e.local_vertices,f=new Q(0,0);l[d]=f}}g=e.local_vertices[0];g.x=-(a.local_ex*a.transform.local_scale_x);g.y=-(a.local_ey*a.transform.local_scale_y);g=e.local_vertices[1];g.x=a.local_ex*a.transform.local_scale_x;g.y=-(a.local_ey*a.transform.local_scale_y);g=e.local_vertices[2];g.x=a.local_ex*a.transform.local_scale_x;g.y=a.local_ey*a.transform.local_scale_y;
g=e.local_vertices[3];g.x=-(a.local_ex*a.transform.local_scale_x);g.y=a.local_ey*a.transform.local_scale_y;g=a.transform.local_x;h=e.transform;h.dirty||h.set_dirty();h.local_x=g;g=a.transform.local_y;h=e.transform;h.dirty||h.set_dirty();h.local_y=g;h=e.transform;g=Math.PI/180*(180/Math.PI)*a.transform.local_radians;h.dirty||h.set_dirty();h.local_radians=g;g=a.transform.local_scale_x;h=e.transform;h.dirty||h.set_dirty();h.local_scale_x=g;g=a.transform.local_scale_y;h=e.transform;h.dirty||h.set_dirty();
h.local_scale_y=g;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;e.set_parent(a.parent);b=za.polygon_and_polygon(e,b,c);e.put()}if(null==b)return null;c?b.sb=a:b.sa=a;return b};za.circle_and_polygon=function(a,b,c){null==c&&(c=!1);var e=0,g=1073741823,h=a.transform;h.sync();var d=h._x,l=h._y,f=a.local_radius;h=a.transform;if(null==h.parent)var k=h.local_scale_x;else h.sync(),k=h._scale_x;for(var y=f*k,r=0,E=b.count;r<E;){var v=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>
b.count;)b._vertices.pop();for(var q=0,u=b.count;q<u;){var m=q++;if(null!=b.local_vertices[m]){if(null==b._vertices[m]){var n=b._vertices,z=new Q(0,0);n[m]=z}var t=b.local_vertices[m].x,x=b.local_vertices[m].y;null==x&&(x=0);null==t&&(t=0);var p=b.transform.get_local_to_world_matrix(),V=t,A=x,ha=1,G=p.m00*V+p.m10*A+p.m20*ha,C=p.m01*V+p.m11*A+p.m21*ha,D=G,ka=C,T=b._vertices[m];T.x=D;T.y=ka}}for(var Ca=0,F=b.count;Ca<F;){var pa=Ca++,ca=b._vertices[(pa+1)%b.count],B=ca.x,J=ca.y,H=b._vertices[pa],Ha=
B-H.x,O=J-H.y;B=Ha;J=O;var kb=-J;J=B;B=kb;if(null==b._normals[pa]){var S=b._normals,ya=new Q(B,J);S[pa]=ya}else{var K=b._normals[pa];K.x=B;K.y=J}var I=b._normals[pa],L=I,ma=I,N=ma,M=N.x*N.x+N.y*N.y,R=0==M?1:Math.sqrt(M),qa=ma.x/R,U=ma.y/R,la=qa,Fb=U;L.x=la;L.y=Fb}}var ua=b._vertices[v],Y=d-ua.x,W=l-ua.y;e=Y*Y+W*W;if(e<g){g=e;var aa=za.closest;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var da=0,ea=b.count;da<ea;){var Z=da++;if(null!=b.local_vertices[Z]){if(null==
b._vertices[Z]){var lb=b._vertices,ja=new Q(0,0);lb[Z]=ja}var fa=b.local_vertices[Z].x,ia=b.local_vertices[Z].y;null==ia&&(ia=0);null==fa&&(fa=0);var ib=b.transform.get_local_to_world_matrix(),ta=fa,oa=ia,Oa=1,Va=ib.m00*ta+ib.m10*oa+ib.m20*Oa,va=ib.m01*ta+ib.m11*oa+ib.m21*Oa,wa=Va,Za=va,xa=b._vertices[Z];xa.x=wa;xa.y=Za}}for(var Ga=0,Aa=b.count;Ga<Aa;){var na=Ga++,Da=b._vertices[(na+1)%b.count],ra=Da.x,sa=Da.y,Ea=b._vertices[na],Bb=ra-Ea.x,Ja=sa-Ea.y;ra=Bb;sa=Ja;var Ba=-sa;sa=ra;ra=Ba;if(null==b._normals[na]){var vb=
b._normals,La=new Q(ra,sa);vb[na]=La}else{var Sa=b._normals[na];Sa.x=ra;Sa.y=sa}var Fa=b._normals[na],Ka=Fa,Wa=Fa,Ia=Wa,Ma=Ia.x*Ia.x+Ia.y*Ia.y,Ra=0==Ma?1:Math.sqrt(Ma),Xa=Wa.x/Ra,Na=Wa.y/Ra,Ua=Xa,Ta=Na;Ka.x=Ua;Ka.y=Ta}}var Qa=b._vertices[v].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var $a=0,eb=b.count;$a<eb;){var mb=$a++;if(null!=b.local_vertices[mb]){if(null==b._vertices[mb]){var cb=b._vertices,X=new Q(0,0);cb[mb]=X}var Ya=b.local_vertices[mb].x,
gb=b.local_vertices[mb].y;null==gb&&(gb=0);null==Ya&&(Ya=0);var hb=b.transform.get_local_to_world_matrix(),ob=Ya,fb=gb,bb=1,db=hb.m00*ob+hb.m10*fb+hb.m20*bb,jb=hb.m01*ob+hb.m11*fb+hb.m21*bb,pb=db,Ab=jb,Wb=b._vertices[mb];Wb.x=pb;Wb.y=Ab}}for(var Pa=0,ab=b.count;Pa<ab;){var rb=Pa++,Ib=b._vertices[(rb+1)%b.count],nb=Ib.x,xb=Ib.y,ub=b._vertices[rb],Jb=nb-ub.x,$b=xb-ub.y;nb=Jb;xb=$b;var Cb=-xb;xb=nb;nb=Cb;if(null==b._normals[rb]){var ac=b._normals,sb=new Q(nb,xb);ac[rb]=sb}else{var zb=b._normals[rb];
zb.x=nb;zb.y=xb}var Gb=b._normals[rb],Hb=Gb,Vb=Gb,hd=Vb,nc=hd.x*hd.x+hd.y*hd.y,wb=0==nc?1:Math.sqrt(nc),Rb=Vb.x/wb,Tb=Vb.y/wb,Mb=Rb,Pb=Tb;Hb.x=Mb;Hb.y=Pb}}var Kb=b._vertices[v].y;aa.x=Qa;aa.y=Kb}}p=za.closest;Y=p.x-d;W=p.y-l;M=Y*Y+W*W;R=0==M?1:Math.sqrt(M);var yb=Y/R,Db=W/R,tb=0;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();r=0;for(E=b.count;r<E;)v=r++,null!=b.local_vertices[v]&&(null==b._vertices[v]&&(n=b._vertices,z=new Q(0,0),n[v]=z),t=b.local_vertices[v].x,
x=b.local_vertices[v].y,null==x&&(x=0),null==t&&(t=0),p=b.transform.get_local_to_world_matrix(),V=t,A=x,ha=1,G=p.m00*V+p.m10*A+p.m20*ha,C=p.m01*V+p.m11*A+p.m21*ha,D=G,ka=C,T=b._vertices[v],T.x=D,T.y=ka);r=0;for(E=b.count;r<E;)v=r++,T=b._vertices[(v+1)%b.count],V=T.x,A=T.y,H=b._vertices[v],Ha=V-H.x,O=A-H.y,V=Ha,A=O,t=-A,A=V,V=t,null==b._normals[v]?(n=b._normals,z=new Q(V,A),n[v]=z):(p=b._normals[v],p.x=V,p.y=A),N=ma=L=ca=b._normals[v],M=N.x*N.x+N.y*N.y,R=0==M?1:Math.sqrt(M),qa=ma.x/R,U=ma.y/R,la=qa,
Fb=U,L.x=la,L.y=Fb}H=b._vertices[0];var Pc=yb*H.x+Db*H.y,Eb=Pc;r=1;for(E=b.count;r<E;){var Ob=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();q=0;for(u=b.count;q<u;)v=q++,null!=b.local_vertices[v]&&(null==b._vertices[v]&&(n=b._vertices,z=new Q(0,0),n[v]=z),t=b.local_vertices[v].x,x=b.local_vertices[v].y,null==x&&(x=0),null==t&&(t=0),p=b.transform.get_local_to_world_matrix(),V=t,A=x,ha=1,G=p.m00*V+p.m10*A+p.m20*ha,C=p.m01*V+p.m11*A+p.m21*ha,D=G,ka=C,T=
b._vertices[v],T.x=D,T.y=ka);Ca=0;for(F=b.count;Ca<F;)m=Ca++,ca=b._vertices[(m+1)%b.count],B=ca.x,J=ca.y,H=b._vertices[m],Ha=B-H.x,O=J-H.y,B=Ha,J=O,kb=-J,J=B,B=kb,null==b._normals[m]?(S=b._normals,ya=new Q(B,J),S[m]=ya):(K=b._normals[m],K.x=B,K.y=J),N=ma=L=I=b._normals[m],M=N.x*N.x+N.y*N.y,R=0==M?1:Math.sqrt(M),qa=ma.x/R,U=ma.y/R,la=qa,Fb=U,L.x=la,L.y=Fb}ua=b._vertices[Ob];tb=yb*ua.x+Db*ua.y;tb<Pc&&(Pc=tb);tb>Eb&&(Eb=tb)}var Qb=y,Lb=-y;Ha=-d;O=-l;var Sb=yb*Ha+Db*O;Pc+=Sb;Eb+=Sb;var Xb=Pc-Qb,dc=Lb-
Eb;if(0<Xb||0<dc)return null;var qb=-(Qb-Pc);c&&(qb*=-1);t=yb;x=Db;f=tc.pool.get();f.sa=null;f.sb=null;r=f.contact_count=0;for(E=f.contacts;r<E.length;){var fc=E[r];++r;fc.x=0;fc.y=0}f.overlap=qb;T=f.normal;T.x=t;T.y=x;f.pooled=!1;var Zb=f,kc=Math.abs(qb);r=0;for(E=b.count;r<E;){v=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();q=0;for(u=b.count;q<u;)m=q++,null!=b.local_vertices[m]&&(null==b._vertices[m]&&(n=b._vertices,z=new Q(0,0),n[m]=z),t=b.local_vertices[m].x,
x=b.local_vertices[m].y,null==x&&(x=0),null==t&&(t=0),p=b.transform.get_local_to_world_matrix(),V=t,A=x,ha=1,G=p.m00*V+p.m10*A+p.m20*ha,C=p.m01*V+p.m11*A+p.m21*ha,D=G,ka=C,T=b._vertices[m],T.x=D,T.y=ka);Ca=0;for(F=b.count;Ca<F;)pa=Ca++,ca=b._vertices[(pa+1)%b.count],B=ca.x,J=ca.y,H=b._vertices[pa],Ha=B-H.x,O=J-H.y,B=Ha,J=O,kb=-J,J=B,B=kb,null==b._normals[pa]?(S=b._normals,ya=new Q(B,J),S[pa]=ya):(K=b._normals[pa],K.x=B,K.y=J),N=ma=L=I=b._normals[pa],M=N.x*N.x+N.y*N.y,R=0==M?1:Math.sqrt(M),qa=ma.x/
R,U=ma.y/R,la=qa,Fb=U,L.x=la,L.y=Fb}fa=b._normals[v].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();da=0;for(ea=b.count;da<ea;)Z=da++,null!=b.local_vertices[Z]&&(null==b._vertices[Z]&&(lb=b._vertices,ja=new Q(0,0),lb[Z]=ja),Ba=b.local_vertices[Z].x,ia=b.local_vertices[Z].y,null==ia&&(ia=0),null==Ba&&(Ba=0),ib=b.transform.get_local_to_world_matrix(),ta=Ba,oa=ia,Oa=1,Va=ib.m00*ta+ib.m10*oa+ib.m20*Oa,va=ib.m01*ta+ib.m11*oa+ib.m21*Oa,wa=Va,Za=va,aa=b._vertices[Z],
aa.x=wa,aa.y=Za);Ga=0;for(Aa=b.count;Ga<Aa;)na=Ga++,xa=b._vertices[(na+1)%b.count],ra=xa.x,sa=xa.y,ua=b._vertices[na],Bb=ra-ua.x,Ja=sa-ua.y,ra=Bb,sa=Ja,Qa=-sa,sa=ra,ra=Qa,null==b._normals[na]?(vb=b._normals,La=new Q(ra,sa),vb[na]=La):(Sa=b._normals[na],Sa.x=ra,Sa.y=sa),Ia=Wa=Ka=Da=b._normals[na],Ma=Ia.x*Ia.x+Ia.y*Ia.y,Ra=0==Ma?1:Math.sqrt(Ma),Xa=Wa.x/Ra,Na=Wa.y/Ra,Ua=Xa,Ta=Na,Ka.x=Ua,Ka.y=Ta}yb=fa;Db=b._normals[v].y;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();
$a=0;for(eb=b.count;$a<eb;)mb=$a++,null!=b.local_vertices[mb]&&(null==b._vertices[mb]&&(cb=b._vertices,X=new Q(0,0),cb[mb]=X),Ya=b.local_vertices[mb].x,gb=b.local_vertices[mb].y,null==gb&&(gb=0),null==Ya&&(Ya=0),hb=b.transform.get_local_to_world_matrix(),ob=Ya,fb=gb,bb=1,db=hb.m00*ob+hb.m10*fb+hb.m20*bb,jb=hb.m01*ob+hb.m11*fb+hb.m21*bb,pb=db,Ab=jb,Fa=b._vertices[mb],Fa.x=pb,Fa.y=Ab);Pa=0;for(ab=b.count;Pa<ab;)rb=Pa++,Wb=b._vertices[(rb+1)%b.count],nb=Wb.x,xb=Wb.y,Ea=b._vertices[rb],Jb=nb-Ea.x,$b=
xb-Ea.y,nb=Jb,xb=$b,Cb=-xb,xb=nb,nb=Cb,null==b._normals[rb]?(ac=b._normals,sb=new Q(nb,xb),ac[rb]=sb):(zb=b._normals[rb],zb.x=nb,zb.y=xb),hd=Vb=Hb=Ib=b._normals[rb],nc=hd.x*hd.x+hd.y*hd.y,wb=0==nc?1:Math.sqrt(nc),Rb=Vb.x/wb,Tb=Vb.y/wb,Mb=Rb,Pb=Tb,Hb.x=Mb,Hb.y=Pb}ub=b._vertices[0];Eb=Pc=yb*ub.x+Db*ub.y;for(var Nb=1,hc=b.count;Nb<hc;){Ob=Nb++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var mc=0,sc=b.count;mc<sc;){var Ub=mc++;if(null!=b.local_vertices[Ub]){if(null==
b._vertices[Ub]){var oc=b._vertices,zc=new Q(0,0);oc[Ub]=zc}var gc=b.local_vertices[Ub].x;Kb=b.local_vertices[Ub].y;null==Kb&&(Kb=0);null==gc&&(gc=0);var Yb=b.transform.get_local_to_world_matrix(),pc=gc,xc=Kb,ic=Yb.m00*pc+Yb.m10*xc+1*Yb.m20,ec=Yb.m01*pc+Yb.m11*xc+1*Yb.m21;Gb=b._vertices[Ub];Gb.x=ic;Gb.y=ec}}for(var rc=0,Ic=b.count;rc<Ic;){var bc=rc++,cc=b._vertices[(bc+1)%b.count],lc=cc.x,Jd=cc.y,yc=b._vertices[bc],Sc=Jd-yc.y;lc-=yc.x;Jd=Sc;var vc=-Jd;Jd=lc;lc=vc;if(null==b._normals[bc]){var Gc=b._normals,
Hc=new Q(lc,Jd);Gc[bc]=Hc}else{var Jc=b._normals[bc];Jc.x=lc;Jc.y=Jd}var Kc=b._normals[bc],Lc=Kc,wc=Kc,qc=wc,Bc=qc.x*qc.x+qc.y*qc.y,Cc=0==Bc?1:Math.sqrt(Bc),Rc=wc.y/Cc;Lc.x=wc.x/Cc;Lc.y=Rc}}var id=b._vertices[Ob];tb=yb*id.x+Db*id.y;tb<Pc&&(Pc=tb);tb>Eb&&(Eb=tb)}Qb=y;Lb=-y;Sb=yb*-d+Db*-l;Pc+=Sb;Eb+=Sb;Xb=Pc-Qb;dc=Lb-Eb;if(0<Xb||0<dc)return Zb.put(),null;qb=-(Qb-Pc);c&&(qb*=-1);if(Math.abs(qb)<kc){var Dc=Zb.normal;Dc.x=yb;Dc.y=Db;Zb.overlap=qb;kc=Math.abs(qb)}}Zb.sa=c?b:a;Zb.sb=c?a:b;Zb.overlap=Math.abs(Zb.overlap);
c&&(T=Zb.normal,T.x=-T.x,T.y=-T.y);return Zb};za.check_polygons=function(a,b,c){null==c&&(c=!1);for(var e=0,g=0,h=0,d=0,l=0,f=0,k=0,y=1073741823,r=null,E=0,v=0,q=0,u=a.count;q<u;){var m=q++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var n=0,z=a.count;n<z;){var t=n++;if(null!=a.local_vertices[t]){if(null==a._vertices[t]){var x=a._vertices,p=new Q(0,0);x[t]=p}var V=a.local_vertices[t].x,A=a.local_vertices[t].y;null==A&&(A=0);null==V&&(V=0);var ha=
a.transform.get_local_to_world_matrix(),T=V,G=A,C=ha.m01*T+ha.m11*G+1*ha.m21,D=a._vertices[t];D.x=ha.m00*T+ha.m10*G+1*ha.m20;D.y=C}}for(var ka=0,Ca=a.count;ka<Ca;){var F=ka++,pa=a._vertices[(F+1)%a.count],ca=pa.x,B=pa.y,J=a._vertices[F],H=B-J.y;ca-=J.x;B=H;var Ha=-B;B=ca;ca=Ha;if(null==a._normals[F]){var O=a._normals,kb=new Q(ca,B);O[F]=kb}else{var S=a._normals[F];S.x=ca;S.y=B}var K=a._normals[F],L=K,ya=K,I=ya,ma=I.x*I.x+I.y*I.y,N=0==ma?1:Math.sqrt(ma),M=ya.y/N;L.x=ya.x/N;L.y=M}}var R=a._normals[m].x;
if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var qa=0,U=a.count;qa<U;){var la=qa++;if(null!=a.local_vertices[la]){if(null==a._vertices[la]){var Fb=a._vertices,ua=new Q(0,0);Fb[la]=ua}var Y=a.local_vertices[la].x,Z=a.local_vertices[la].y;null==Z&&(Z=0);null==Y&&(Y=0);var W=a.transform.get_local_to_world_matrix(),aa=Y,da=Z,ea=W.m01*aa+W.m11*da+1*W.m21,ib=a._vertices[la];ib.x=W.m00*aa+W.m10*da+1*W.m20;ib.y=ea}}for(var lb=0,ia=a.count;lb<ia;){var fa=lb++,
ja=a._vertices[(fa+1)%a.count],ta=ja.x,na=ja.y,oa=a._vertices[fa],ra=na-oa.y;ta-=oa.x;na=ra;var Oa=-na;na=ta;ta=Oa;if(null==a._normals[fa]){var sa=a._normals,Va=new Q(ta,na);sa[fa]=Va}else{var va=a._normals[fa];va.x=ta;va.y=na}var wa=a._normals[fa],xa=wa,Ga=wa,Za=Ga,za=Za.x*Za.x+Za.y*Za.y,Aa=0==za?1:Math.sqrt(za),Ea=Ga.y/Aa;xa.x=Ga.x/Aa;xa.y=Ea}}E=R;v=a._normals[m].y;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var Da=0,Bb=a.count;Da<Bb;){var Ba=Da++;
if(null!=a.local_vertices[Ba]){if(null==a._vertices[Ba]){var Ja=a._vertices,Sa=new Q(0,0);Ja[Ba]=Sa}var vb=a.local_vertices[Ba].x,Ia=a.local_vertices[Ba].y;null==Ia&&(Ia=0);null==vb&&(vb=0);var Fa=a.transform.get_local_to_world_matrix(),Ka=vb,La=Ia,Wa=Fa.m01*Ka+Fa.m11*La+1*Fa.m21,Ma=a._vertices[Ba];Ma.x=Fa.m00*Ka+Fa.m10*La+1*Fa.m20;Ma.y=Wa}}for(var Ra=0,Xa=a.count;Ra<Xa;){var Na=Ra++,Ua=a._vertices[(Na+1)%a.count],Ta=Ua.x,Qa=Ua.y,Ya=a._vertices[Na],gb=Qa-Ya.y;Ta-=Ya.x;Qa=gb;var $a=-Qa;Qa=Ta;Ta=$a;
if(null==a._normals[Na]){var X=a._normals,fb=new Q(Ta,Qa);X[Na]=fb}else{var bb=a._normals[Na];bb.x=Ta;bb.y=Qa}var hb=a._normals[Na],eb=hb,cb=hb,db=cb,jb=db.x*db.x+db.y*db.y,pb=0==jb?1:Math.sqrt(jb),Ab=cb.y/pb;eb.x=cb.x/pb;eb.y=Ab}}var tb=a._vertices[0];l=d=E*tb.x+v*tb.y;for(var yb=1,Pa=a.count;yb<Pa;){var ab=yb++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var rb=0,Db=a.count;rb<Db;){var nb=rb++;if(null!=a.local_vertices[nb]){if(null==a._vertices[nb]){var xb=
a._vertices,Eb=new Q(0,0);xb[nb]=Eb}var ub=a.local_vertices[nb].x,zb=a.local_vertices[nb].y;null==zb&&(zb=0);null==ub&&(ub=0);var Cb=a.transform.get_local_to_world_matrix(),Vb=ub,Zb=zb,Ib=Cb.m01*Vb+Cb.m11*Zb+1*Cb.m21,Gb=a._vertices[nb];Gb.x=Cb.m00*Vb+Cb.m10*Zb+1*Cb.m20;Gb.y=Ib}}for(var Hb=0,Jb=a.count;Hb<Jb;){var qb=Hb++,nc=a._vertices[(qb+1)%a.count],wb=nc.x,sb=nc.y,Kb=a._vertices[qb],Qb=sb-Kb.y;wb-=Kb.x;sb=Qb;var Rb=-sb;sb=wb;wb=Rb;if(null==a._normals[qb]){var Sb=a._normals,Tb=new Q(wb,sb);Sb[qb]=
Tb}else{var Mb=a._normals[qb];Mb.x=wb;Mb.y=sb}var Pb=a._normals[qb],Ub=Pb,Ob=Pb,Lb=Ob,Xb=Lb.x*Lb.x+Lb.y*Lb.y,Yb=0==Xb?1:Math.sqrt(Xb),dc=Ob.y/Yb;Ub.x=Ob.x/Yb;Ub.y=dc}}var bc=a._vertices[ab];h=E*bc.x+v*bc.y;h<d&&(d=h);h>l&&(l=h)}if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var fc=0,kc=b.count;fc<kc;){var Nb=fc++;if(null!=b.local_vertices[Nb]){if(null==b._vertices[Nb]){var lc=b._vertices,mc=new Q(0,0);lc[Nb]=mc}var gc=b.local_vertices[Nb].x,hc=b.local_vertices[Nb].y;
null==hc&&(hc=0);null==gc&&(gc=0);var sc=b.transform.get_local_to_world_matrix(),oc=gc,pc=hc,xc=sc.m01*oc+sc.m11*pc+1*sc.m21,qc=b._vertices[Nb];qc.x=sc.m00*oc+sc.m10*pc+1*sc.m20;qc.y=xc}}for(var rc=0,zc=b.count;rc<zc;){var cc=rc++,wc=b._vertices[(cc+1)%b.count],ic=wc.x,ec=wc.y,yc=b._vertices[cc],Ic=ec-yc.y;ic-=yc.x;ec=Ic;var Jc=-ec;ec=ic;ic=Jc;if(null==b._normals[cc]){var Kc=b._normals,Lc=new Q(ic,ec);Kc[cc]=Lc}else{var Bc=b._normals[cc];Bc.x=ic;Bc.y=ec}var Cc=b._normals[cc],Dc=Cc,Sc=Cc,vc=Sc,Gc=
vc.x*vc.x+vc.y*vc.y,Hc=0==Gc?1:Math.sqrt(Gc),Rc=Sc.y/Hc;Dc.x=Sc.x/Hc;Dc.y=Rc}}var Xc=b._vertices[0];k=f=E*Xc.x+v*Xc.y;for(var Yc=1,jd=b.count;Yc<jd;){var nd=Yc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var $c=0,od=b.count;$c<od;){var id=$c++;if(null!=b.local_vertices[id]){if(null==b._vertices[id]){var qd=b._vertices,td=new Q(0,0);qd[id]=td}var Vc=b.local_vertices[id].x,Wc=b.local_vertices[id].y;null==Wc&&(Wc=0);null==Vc&&(Vc=0);var Ac=b.transform.get_local_to_world_matrix(),
bd=Vc,cd=Wc,yd=Ac.m01*bd+Ac.m11*cd+1*Ac.m21,dd=b._vertices[id];dd.x=Ac.m00*bd+Ac.m10*cd+1*Ac.m20;dd.y=yd}}for(var ed=0,zd=b.count;ed<zd;){var Ec=ed++,fd=b._vertices[(Ec+1)%b.count],Mc=fd.x,Fc=fd.y,gd=b._vertices[Ec],Ad=Fc-gd.y;Mc-=gd.x;Fc=Ad;var Bd=-Fc;Fc=Mc;Mc=Bd;if(null==b._normals[Ec]){var Cd=b._normals,Ed=new Q(Mc,Fc);Cd[Ec]=Ed}else{var kd=b._normals[Ec];kd.x=Mc;kd.y=Fc}var ld=b._normals[Ec],md=ld,Zc=ld,Uc=Zc,pd=Uc.x*Uc.x+Uc.y*Uc.y,rd=0==pd?1:Math.sqrt(pd),Fd=Zc.y/rd;md.x=Zc.x/rd;md.y=Fd}}var sd=
b._vertices[nd];h=E*sd.x+v*sd.y;h<f&&(f=h);h>k&&(k=h)}e=d-k;g=f-l;if(0<e||0<g)return null;var Qc=-(k-d);c&&(Qc*=-1);if(Math.abs(Qc)<y){if(null==r){var Gd=E,Hd=v,Dd=tc.pool.get();Dd.sa=null;Dd.sb=null;for(var ad=Dd.contact_count=0,ud=Dd.contacts;ad<ud.length;){var vd=ud[ad];++ad;vd.x=0;vd.y=0}Dd.overlap=Qc;var wd=Dd.normal;wd.x=Gd;wd.y=Hd;Dd.pooled=!1;r=Dd}else{r.overlap=Qc;var xd=r.normal;xd.x=E;xd.y=v}y=Math.abs(Qc)}}if(null==r)return null;r.sa=c?b:a;r.sb=c?a:b;c&&(D=r.normal,D.x=-D.x,D.y=-D.y);
return r};var Xc=function(a,b,c,e,g){null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.dirty=this.inverse_dirty=this.coordinates_dirty=!1;this.local_to_world_matrix=new oe(1,0,0,0,1,0,0,0,1);this.children=[];this._scale_x=this._scale_y=1;this._x=this._y=this._radians=0;this.on_dirty=null;this.dirty||this.set_dirty();this.local_x=a;this.dirty||this.set_dirty();this.local_y=b;a=Math.PI/180*c;this.dirty||this.set_dirty();this.local_radians=a;this.dirty||this.set_dirty();
this.local_scale_x=e;this.dirty||this.set_dirty();this.local_scale_y=g};d["echo.util.Transform"]=Xc;Xc.__name__=!0;Xc.__interfaces__=[Ha];Xc.prototype={set_parent:function(a,b){null!=this.parent&&I.remove(this.parent.children,this);this.parent=a;null!=a&&this.parent.children.push(this);this.set_dirty()},get_local_to_world_matrix:function(){if(this.dirty){if(null==this.parent){var a=this.local_to_world_matrix,b=Math.sin(this.local_radians),c=Math.cos(this.local_radians),e=c*this.local_scale_x,g=-b*
this.local_scale_y,h=this.local_x;b*=this.local_scale_x;var d=c*this.local_scale_y,l=this.local_y;a.m00=e;a.m10=g;a.m20=h;a.m01=b;a.m11=d;a.m21=l;a.m02=0;a.m12=0;a.m22=1}else{a=this.local_to_world_matrix;var f=this.parent.get_local_to_world_matrix();b=Math.sin(this.local_radians);c=Math.cos(this.local_radians);e=c*this.local_scale_x;g=-b*this.local_scale_y;h=this.local_x;b*=this.local_scale_x;d=c*this.local_scale_y;l=this.local_y;c=f.m00*g+f.m10*d+0*f.m20;var k=f.m00*h+f.m10*l+1*f.m20,y=f.m01*e+f.m11*
b+0*f.m21,r=f.m01*g+f.m11*d+0*f.m21,E=f.m01*h+f.m11*l+1*f.m21,v=f.m02*e+f.m12*b+0*f.m22;g=f.m02*g+f.m12*d+0*f.m22;h=f.m02*h+f.m12*l+1*f.m22;a.m00=f.m00*e+f.m10*b+0*f.m20;a.m10=c;a.m20=k;a.m01=y;a.m11=r;a.m21=E;a.m02=v;a.m12=g;a.m22=h}this.dirty=!1}return this.local_to_world_matrix},sync:function(){if(this.coordinates_dirty){var a=this.get_local_to_world_matrix();if(null==this.parent)this._x=this.local_x,this._y=this.local_y,this._scale_x=this.local_scale_x,this._scale_y=this.local_scale_y,this._radians=
this.local_radians;else{var b=a.m00,c=a.m01,e=a.m10,g=a.m11;this._x=a.m20;this._y=a.m21;this._scale_x=Math.sqrt(b*b+c*c);this._scale_y=Math.sqrt(e*e+g*g);this._radians=180/Math.PI*Math.atan2(-e/this._scale_y,b/this._scale_x)}this.coordinates_dirty=!1}},set_dirty:function(){this.dirty=this.inverse_dirty=this.coordinates_dirty=!0;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.set_dirty()}if(null!=this.on_dirty)this.on_dirty(this)},__class__:Xc};var Lb=u["haxe.StackItem"]={__ename__:!0,__constructs__:null,
CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:k},Module:(f=function(a){return{_hx_index:1,m:a,__enum__:"haxe.StackItem",toString:k}},f._hx_name="Module",f.__params__=["m"],f),FilePos:(f=function(a,b,c,e){return{_hx_index:2,s:a,file:b,line:c,column:e,__enum__:"haxe.StackItem",toString:k}},f._hx_name="FilePos",f.__params__=["s","file","line","column"],f),Method:(f=function(a,b){return{_hx_index:3,classname:a,method:b,__enum__:"haxe.StackItem",toString:k}},f._hx_name=
"Method",f.__params__=["classname","method"],f),LocalFunction:(f=function(a){return{_hx_index:4,v:a,__enum__:"haxe.StackItem",toString:k}},f._hx_name="LocalFunction",f.__params__=["v"],f)};Lb.__constructs__=[Lb.CFunction,Lb.Module,Lb.FilePos,Lb.Method,Lb.LocalFunction];var yc={callStack:function(){return oa.toHaxe(oa.callStack())},exceptionStack:function(a){null==a&&(a=!1);var b=oa.toHaxe(oa.exceptionStack());return a?b:yc.subtract(b,yc.callStack())},toString:function(a){for(var b=new va,c=0;c<a.length;){var e=
a[c];++c;b.b+="\nCalled from ";yc.itemToString(b,e)}return b.b},subtract:function(a,b){for(var c=-1,e=-1;++e<a.length;){for(var g=0,h=b.length;g<h;){var d=g++;if(yc.equalItems(a[e],b[d])){if(0>c&&(c=e),++e,e>=a.length)break}else c=-1}if(0<=c)break}return 0<=c?a.slice(0,c):a},equalItems:function(a,b){if(null==a)return null==b?!0:!1;switch(a._hx_index){case 0:return null==b?!1:0==b._hx_index?!0:!1;case 1:return null==b?!1:1==b._hx_index?a.m==b.m:!1;case 2:if(null==b)return!1;if(2==b._hx_index){var c=
b.s,e=b.line,g=b.column,h=a.column,d=a.line,l=a.s;return a.file==b.file&&d==e&&h==g?yc.equalItems(l,c):!1}return!1;case 3:return null==b?!1:3==b._hx_index?(c=b.method,e=a.method,a.classname==b.classname?e==c:!1):!1;case 4:return null==b?!1:4==b._hx_index?a.v==b.v:!1}},itemToString:function(a,b){switch(b._hx_index){case 0:a.b+="a C function";break;case 1:b=b.m;a.b+="module ";a.b+=null==b?"null":""+b;break;case 2:var c=b.s,e=b.file,g=b.line;b=b.column;null!=c&&(yc.itemToString(a,c),a.b+=" (");a.b+=
null==e?"null":""+e;a.b+=" line ";a.b+=null==g?"null":""+g;null!=b&&(a.b+=" column ",a.b+=null==b?"null":""+b);null!=c&&(a.b+=")");break;case 3:c=b.classname;b=b.method;a.b+=x.string(null==c?"<unknown>":c);a.b+=".";a.b+=null==b?"null":""+b;break;case 4:b=b.v,a.b+="local function #",a.b+=null==b?"null":""+b}}},vc=function(){};d["haxe.IMap"]=vc;vc.__name__=!0;vc.__isInterface__=!0;vc.prototype={__class__:vc};var A=function(a,b,c){Error.call(this,a);this.message=a;this.__previousException=b;this.__nativeException=
null!=c?c:this;this.__skipStack=0;a=Error.prepareStackTrace;Error.prepareStackTrace=function(a){return a.stack};if(c instanceof Error)this.stack=c.stack;else{c=null;if(Error.captureStackTrace)Error.captureStackTrace(this,A),c=this;else if(c=Error(),"undefined"==typeof c.stack){try{throw c;}catch(e){}this.__skipStack++}this.stack=c.stack}Error.prepareStackTrace=a};d["haxe.Exception"]=A;A.__name__=!0;A.caught=function(a){return a instanceof A?a:a instanceof Error?new A(a.message,null,a):new jd(a,null,
a)};A.thrown=function(a){if(a instanceof A)return a.get_native();if(a instanceof Error)return a;a=new jd(a);a.__skipStack++;return a};A.__super__=Error;A.prototype=G(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_native:function(){return this.__nativeException},get_stack:function(){var a=this.__exceptionStack;null==a&&(a=oa.toHaxe(oa.normalize(this.stack),
this.__skipStack),this.setProperty("__exceptionStack",a));return a},setProperty:function(a,b){try{Object.defineProperty(this,a,{value:b})}catch(c){this[a]=b}},__class__:A,__properties__:{get_native:"get_native",get_stack:"get_stack",get_message:"get_message"}});var ia=function(){};d["haxe.Log"]=ia;ia.__name__=!0;ia.formatOutput=function(a,b){var c=x.string(a);if(null==b)return c;var e=b.fileName+":"+b.lineNumber;if(null!=b.customParams){var g=0;for(b=b.customParams;g<b.length;)a=b[g],++g,c+=", "+
x.string(a)}return e+": "+c};ia.trace=function(a,b){a=ia.formatOutput(a,b);"undefined"!=typeof console&&null!=console.log&&console.log(a)};var oa=function(){};d["haxe.NativeStackTrace"]=oa;oa.__name__=!0;oa.saveStack=function(a){oa.lastError=a};oa.callStack=function(){var a=Error(""),b=oa.tryHaxeStack(a);if("undefined"==typeof b){try{throw a;}catch(c){}b=a.stack}return oa.normalize(b,2)};oa.exceptionStack=function(){return oa.normalize(oa.tryHaxeStack(oa.lastError))};oa.toHaxe=function(a,b){null==
b&&(b=0);if(null==a)return[];if("string"==typeof a){a=a.split("\n");"Error"==a[0]&&a.shift();for(var c=[],e=0,g=a.length;e<g;){var h=e++;if(!(b>h)){var d=a[h];h=d.match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=h){d=h[1].split(".");"$hxClasses"==d[0]&&d.shift();var l=d.pop(),f=h[2],k=x.parseInt(h[3]);h=x.parseInt(h[4]);c.push(Lb.FilePos("Anonymous function"==l?Lb.LocalFunction():"Global code"==l?null:Lb.Method(d.join("."),l),f,k,h))}else c.push(Lb.Module(Z.trim(d)))}}return c}return 0<
b&&Array.isArray(a)?a.slice(b):a};oa.tryHaxeStack=function(a){if(null==a)return[];var b=Error.prepareStackTrace;Error.prepareStackTrace=oa.prepareHxStackTrace;a=a.stack;Error.prepareStackTrace=b;return a};oa.prepareHxStackTrace=function(a,b){a=[];for(var c=0;c<b.length;){var e=b[c];++c;null!=oa.wrapCallSite&&(e=oa.wrapCallSite(e));var g=null,h=e.getFunctionName();if(null!=h){var d=h.lastIndexOf(".");0<=d?(g=h.substring(0,d),h=h.substring(d+1),g=Lb.Method(g,h)):g=Lb.Method(null,h)}h=e.getFileName();
d=null==h?-1:h.indexOf("file:");null!=oa.wrapCallSite&&0<d&&(h=h.substring(d+6));a.push(Lb.FilePos(g,h,e.getLineNumber(),e.getColumnNumber()))}return a};oa.normalize=function(a,b){null==b&&(b=0);if(Array.isArray(a)&&0<b)return a.slice(b);if("string"==typeof a){switch(a.substring(0,6)){case "Error\n":case "Error:":++b}return oa.skipLines(a,b)}return a};oa.skipLines=function(a,b,c){null==c&&(c=0);return 0<b?(c=a.indexOf("\n",c),0>c?"":oa.skipLines(a,--b,c+1)):a.substring(c)};var Ed=function(){};d["haxe._Unserializer.DefaultResolver"]=
Ed;Ed.__name__=!0;Ed.prototype={resolveClass:function(a){return d[a]},resolveEnum:function(a){return u[a]},__class__:Ed};var sb=function(a){this.buf=a;this.length=this.buf.length;this.pos=0;this.scache=[];this.cache=[];a=sb.DEFAULT_RESOLVER;null==a&&(a=new Ed,sb.DEFAULT_RESOLVER=a);this.resolver=a};d["haxe.Unserializer"]=sb;sb.__name__=!0;sb.initCodes=function(){for(var a=[],b=0,c=sb.BASE64.length;b<c;){var e=b++;a[sb.BASE64.charCodeAt(e)]=e}return a};sb.run=function(a){return(new sb(a)).unserialize()};
sb.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(45==e){if(this.pos!=c)break;b=!0}else{if(48>e||57<e)break;a=10*a+(e-48)}this.pos++}b&&(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(I.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw A.thrown("Invalid object");
if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw A.thrown("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw A.thrown("Invalid enum format");var c=this.readDigits();if(0==c)return ea.createEnum(a,b);for(var e=[];0<c--;)e.push(this.unserialize());return ea.createEnum(a,b,e)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),
b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw A.thrown("Enum not found "+a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);b.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw A.thrown("Invalid custom data");return b;case 77:a=new yb;this.cache.push(a);
for(var c;104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw A.thrown("Invalid string reference");return this.scache[a];case 97:b=[];for(this.cache.push(b);;){c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}117==c?(this.pos++,a=this.readDigits(),b[b.length+a-1]=null):b.push(this.unserialize())}return b;case 98:a=new Y;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=
this.unserialize(),c=this.unserialize(),a.h[b]=c;this.pos++;return a;case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);this.unserializeObject(b);return b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw A.thrown("Enum not found "+a);this.pos++;for(var e=this.readDigits(),g=c.__constructs__,
h=Array(g.length),d=0,l=g.length;d<l;)b=d++,h[b]=g[b]._hx_name;b=h[e];if(null==b)throw A.thrown("Unknown enum index "+a+"@"+e);b=this.unserializeEnum(c,b);this.cache.push(b);return b;case 107:return NaN;case 108:b=new Db;for(this.cache.push(b);104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());this.pos++;return b;case 109:return-Infinity;case 110:return null;case 111:return b={},this.cache.push(b),this.unserializeObject(b),b;case 112:return Infinity;case 113:a=new Gb;this.cache.push(a);
for(c=this.buf.charCodeAt(this.pos++);58==c;)b=this.readDigits(),c=this.unserialize(),a.h[b]=c,c=this.buf.charCodeAt(this.pos++);if(104!=c)throw A.thrown("Invalid IntMap format");return a;case 114:a=this.readDigits();if(0>a||a>=this.cache.length)throw A.thrown("Invalid reference");return this.cache[a];case 115:a=this.readDigits();c=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw A.thrown("Invalid bytes length");e=sb.CODES;null==e&&(e=sb.initCodes(),sb.CODES=e);b=this.pos;
g=a&3;h=b+(a-g);d=new Ka(new ArrayBuffer(3*(a>>2)+(2<=g?g-1:0)));for(l=0;b<h;){var f=e[c.charCodeAt(b++)],k=e[c.charCodeAt(b++)];d.b[l++]=(f<<2|k>>4)&255;f=e[c.charCodeAt(b++)];d.b[l++]=(k<<4|f>>2)&255;k=e[c.charCodeAt(b++)];d.b[l++]=(f<<6|k)&255}2<=g&&(f=e[c.charCodeAt(b++)],k=e[c.charCodeAt(b++)],d.b[l++]=(f<<2|k>>4)&255,3==g&&(f=e[c.charCodeAt(b++)],d.b[l++]=(k<<4|f>>2)&255));this.pos+=a;this.cache.push(d);return d;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&
48<=this.buf.charCodeAt(this.pos+1)&&57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(b=I.strDate(I.substr(this.buf,this.pos,19)),this.pos+=19):b=new Date(this.readFloat()),this.cache.push(b),b;case 119:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw A.thrown("Enum not found "+a);b=this.unserializeEnum(c,this.unserialize());
this.cache.push(b);return b;case 120:throw A.thrown(this.unserialize());case 121:a=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw A.thrown("Invalid string length");b=I.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw A.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:sb};var jd=function(a,b,c){A.call(this,String(a),b,c);this.value=
a;this.__skipStack++};d["haxe.ValueException"]=jd;jd.__name__=!0;jd.__super__=A;jd.prototype=G(A.prototype,{unwrap:function(){return this.value},__class__:jd});var Gc=function(){this.a1=1;this.a2=0};d["haxe.crypto.Adler32"]=Gc;Gc.__name__=!0;Gc.read=function(a){var b=new Gc,c=a.readByte(),e=a.readByte(),g=a.readByte();a=a.readByte();b.a1=g<<8|a;b.a2=c<<8|e;return b};Gc.prototype={update:function(a,b,c){var e=this.a1,g=this.a2,h=b;for(b+=c;h<b;)c=h++,e=(e+a.b[c])%65521,g=(g+e)%65521;this.a1=e;this.a2=
g},equals:function(a){return a.a1==this.a1?a.a2==this.a2:!1},__class__:Gc};var Ka=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};d["haxe.io.Bytes"]=Ka;Ka.__name__=!0;Ka.ofString=function(a,b){b=[];for(var c=0;c<a.length;){var e=a.charCodeAt(c++);55296<=e&&56319>=e&&(e=e-55232<<10|a.charCodeAt(c++)&1023);127>=e?b.push(e):(2047>=e?b.push(192|e>>6):(65535>=e?b.push(224|e>>12):(b.push(240|e>>18),b.push(128|e>>12&63)),b.push(128|e>>6&63)),
b.push(128|e&63))}return new Ka((new Uint8Array(b)).buffer)};Ka.ofData=function(a){var b=a.hxBytes;return null!=b?b:new Ka(a)};Ka.prototype={blit:function(a,b,c,e){if(0>a||0>c||0>e||a+e>this.length||c+e>b.length)throw A.thrown(Sb.OutsideBounds);0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},getString:function(a,b,c){if(0>a||0>b||a+b>this.length)throw A.thrown(Sb.OutsideBounds);c="";var e=this.b,g=pb.fromCharCode,h=a;for(a+=b;h<a;)if(b=e[h++],128>b){if(0==b)break;c+=g(b)}else if(224>
b)c+=g((b&63)<<6|e[h++]&127);else if(240>b){var d=e[h++];c+=g((b&31)<<12|(d&127)<<6|e[h++]&127)}else{d=e[h++];var l=e[h++];b=(b&15)<<18|(d&127)<<12|(l&127)<<6|e[h++]&127;c+=g((b>>10)+55232);c+=g(b&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},__class__:Ka};var Yc=u["haxe.ds.Either"]={__ename__:!0,__constructs__:null,Left:(f=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Either",toString:k}},f._hx_name="Left",f.__params__=["v"],f),Right:(f=function(a){return{_hx_index:1,
v:a,__enum__:"haxe.ds.Either",toString:k}},f._hx_name="Right",f.__params__=["v"],f)};Yc.__constructs__=[Yc.Left,Yc.Right];var Gb=function(){this.h={}};d["haxe.ds.IntMap"]=Gb;Gb.__name__=!0;Gb.__interfaces__=[vc];Gb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(+b);
return new Dc(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=null==c?"null":""+c;a+=" => ";a+=x.string(x.string(this.h[c]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:Gb};var Db=function(){this.length=0};d["haxe.ds.List"]=Db;Db.__name__=!0;Db.prototype={add:function(a){a=new kd(a,null);null==this.h?
this.h=a:this.q.next=a;this.q=a;this.length++},push:function(a){this.h=a=new kd(a,this.h);null==this.q&&(this.q=a);this.length++},first:function(){return null==this.h?null:this.h.item},pop:function(){if(null==this.h)return null;var a=this.h.item;this.h=this.h.next;null==this.h&&(this.q=null);this.length--;return a},isEmpty:function(){return null==this.h},toString:function(){var a,b=!0,c=this.h;for(a="{";null!=c;)b?b=!1:a+=", ",a+=x.string(x.string(c.item)),c=c.next;return a+"}"},__class__:Db};var kd=
function(a,b){this.item=a;this.next=b};d["haxe.ds._List.ListNode"]=kd;kd.__name__=!0;kd.prototype={__class__:kd};var yb=function(){this.h={__keys__:{}}};d["haxe.ds.ObjectMap"]=yb;yb.__name__=!0;yb.__interfaces__=[vc];yb.prototype={set:function(a,b){var c=a.__id__;null==c&&(c=a.__id__=t.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];
delete this.h.__keys__[a];return!0},keys:function(){var a=[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return new Dc(a)},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=x.string(x.string(c));a+=" => ";a+=x.string(x.string(this.h[c.__id__]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:yb};var Y=function(){this.h=Object.create(null)};d["haxe.ds.StringMap"]=Y;Y.__name__=!0;Y.__interfaces__=[vc];Y.stringify=function(a){var b=
"{",c=!0,e;for(e in a)c?c=!1:b+=",",b+=e+" => "+x.string(a[e]);return b+"}"};Y.prototype={exists:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)},get:function(a){return this.h[a]},set:function(a,b){this.h[a]=b},remove:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)?(delete this.h[a],!0):!1},toString:function(){return Y.stringify(this.h)},__class__:Y};var Hc=function(a,b,c){A.call(this,a,b);this.posInfos=null==c?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",
methodName:"(unknown)"}:c;this.__skipStack++};d["haxe.exceptions.PosException"]=Hc;Hc.__name__=!0;Hc.__super__=A;Hc.prototype=G(A.prototype,{toString:function(){return""+A.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:Hc});var ld=function(a,b,c){null==a&&(a="Not implemented");Hc.call(this,a,b,c);this.__skipStack++};d["haxe.exceptions.NotImplementedException"]=ld;ld.__name__=!0;ld.__super__=
Hc;ld.prototype=G(Hc.prototype,{__class__:ld});var md=function(){this.size=this.pos=0};d["haxe.io.BytesBuffer"]=md;md.__name__=!0;md.prototype={addByte:function(a){this.pos==this.size&&this.grow(1);this.view.setUint8(this.pos++,a)},add:function(a){this.pos+a.length>this.size&&this.grow(a.length);if(0!=this.size){var b=new Uint8Array(a.b.buffer,a.b.byteOffset,a.length);this.u8.set(b,this.pos);this.pos+=a.length}},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw A.thrown(Sb.OutsideBounds);this.pos+
c>this.size&&this.grow(c);0!=this.size&&(a=new Uint8Array(a.b.buffer,a.b.byteOffset+b,c),this.u8.set(a,this.pos),this.pos+=c)},grow:function(a){var b=this.pos+a;for(a=0==this.size?16:this.size;a<b;)a=3*a>>1;b=new ArrayBuffer(a);var c=new Uint8Array(b);0<this.size&&c.set(this.u8);this.size=a;this.buffer=b;this.u8=c;this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new Ka(new ArrayBuffer(0));var a=new Ka(this.buffer);a.length=this.pos;return a},__class__:md};var Zc=function(){};
d["haxe.io.Input"]=Zc;Zc.__name__=!0;Zc.prototype={readByte:function(){throw new ld(null,null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"});},readBytes:function(a,b,c){var e=c,g=a.b;if(0>b||0>c||b+c>a.length)throw A.thrown(Sb.OutsideBounds);try{for(;0<e;)g[b]=this.readByte(),++b,--e}catch(h){if(oa.lastError=h,!(A.caught(h).unwrap()instanceof nd))throw h;}return c-e},readFullBytes:function(a,b,c){for(;0<c;){var e=this.readBytes(a,b,c);if(0==e)throw A.thrown(Sb.Blocked);
b+=e;c-=e}},read:function(a){for(var b=new Ka(new ArrayBuffer(a)),c=0;0<a;){var e=this.readBytes(b,c,a);if(0==e)throw A.thrown(Sb.Blocked);c+=e;a-=e}return b},readInt16:function(){var a=this.readByte(),b=this.readByte();a=this.bigEndian?b|a<<8:a|b<<8;return 0!=(a&32768)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();return this.bigEndian?b|a<<8:a|b<<8},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),e=this.readByte();return this.bigEndian?e|
c<<8|b<<16|a<<24:a|b<<8|c<<16|e<<24},readString:function(a,b){var c=new Ka(new ArrayBuffer(a));this.readFullBytes(c,0,a);return c.getString(0,a,b)},__class__:Zc};var Uc=function(a,b,c){null==b&&(b=0);null==c&&(c=a.length-b);if(0>b||0>c||b+c>a.length)throw A.thrown(Sb.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};d["haxe.io.BytesInput"]=Uc;Uc.__name__=!0;Uc.__super__=Zc;Uc.prototype=G(Zc.prototype,{readByte:function(){if(0==this.len)throw A.thrown(new nd);this.len--;return this.b[this.pos++]},
readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw A.thrown(Sb.OutsideBounds);if(0==this.len&&0<c)throw A.thrown(new nd);this.len<c&&(c=this.len);var e=this.b;a=a.b;for(var g=0,h=c;g<h;){var d=g++;a[b+d]=e[this.pos+d]}this.pos+=c;this.len-=c;return c},__class__:Uc});var lf=u["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:k},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:k}};lf.__constructs__=
[lf.UTF8,lf.RawNative];var nd=function(){};d["haxe.io.Eof"]=nd;nd.__name__=!0;nd.prototype={toString:function(){return"Eof"},__class__:nd};var Sb=u["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:k},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:k},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:k},Custom:(f=function(a){return{_hx_index:3,e:a,__enum__:"haxe.io.Error",
toString:k}},f._hx_name="Custom",f.__params__=["e"],f)};Sb.__constructs__=[Sb.Blocked,Sb.Overflow,Sb.OutsideBounds,Sb.Custom];var Ic=function(a){switch(a){case ".":case "..":this.dir=a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=I.substr(a,0,c),a=I.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=I.substr(a,0,b),a=I.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=I.substr(a,b+1,null),this.file=I.substr(a,0,b)):(this.ext=null,this.file=
a)};d["haxe.io.Path"]=Ic;Ic.__name__=!0;Ic.directory=function(a){a=new Ic(a);return null==a.dir?"":a.dir};Ic.prototype={__class__:Ic};var Dc=function(a){this.current=0;this.array=a};d["haxe.iterators.ArrayIterator"]=Dc;Dc.__name__=!0;Dc.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Dc};var Jc=u["haxe.zip.ExtraField"]={__ename__:!0,__constructs__:null,FUnknown:(f=function(a,b){return{_hx_index:0,tag:a,bytes:b,__enum__:"haxe.zip.ExtraField",
toString:k}},f._hx_name="FUnknown",f.__params__=["tag","bytes"],f),FInfoZipUnicodePath:(f=function(a,b){return{_hx_index:1,name:a,crc:b,__enum__:"haxe.zip.ExtraField",toString:k}},f._hx_name="FInfoZipUnicodePath",f.__params__=["name","crc"],f),FUtf8:{_hx_name:"FUtf8",_hx_index:2,__enum__:"haxe.zip.ExtraField",toString:k}};Jc.__constructs__=[Jc.FUnknown,Jc.FInfoZipUnicodePath,Jc.FUtf8];var Xb=u["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(f=function(a){return{_hx_index:0,i:a,__enum__:"haxe.zip.Huffman",
toString:k}},f._hx_name="Found",f.__params__=["i"],f),NeedBit:(f=function(a,b){return{_hx_index:1,left:a,right:b,__enum__:"haxe.zip.Huffman",toString:k}},f._hx_name="NeedBit",f.__params__=["left","right"],f),NeedBits:(f=function(a,b){return{_hx_index:2,n:a,table:b,__enum__:"haxe.zip.Huffman",toString:k}},f._hx_name="NeedBits",f.__params__=["n","table"],f)};Xb.__constructs__=[Xb.Found,Xb.NeedBit,Xb.NeedBits];var pe=function(){};d["haxe.zip.HuffTools"]=pe;pe.__name__=!0;pe.prototype={treeDepth:function(a){switch(a._hx_index){case 0:return 0;
case 1:var b=a.right;a=this.treeDepth(a.left);b=this.treeDepth(b);return 1+(a<b?a:b);case 2:throw A.thrown("assert");}},treeCompress:function(a){var b=this.treeDepth(a);if(0==b)return a;if(1==b){if(1==a._hx_index)return b=a.right,Xb.NeedBit(this.treeCompress(a.left),this.treeCompress(b));throw A.thrown("assert");}for(var c=[],e=0,g=1<<b;e<g;)e++,c.push(Xb.Found(-1));this.treeWalk(c,0,0,b,a);return Xb.NeedBits(b,c)},treeWalk:function(a,b,c,e,g){if(1==g._hx_index){var h=g.left,d=g.right;0<e?(this.treeWalk(a,
b,c+1,e-1,h),this.treeWalk(a,b|1<<c,c+1,e-1,d)):a[b]=this.treeCompress(g)}else a[b]=this.treeCompress(g)},treeMake:function(a,b,c,e){if(e>b)throw A.thrown("Invalid huffman");var g=c<<5|e;if(a.h.hasOwnProperty(g))return Xb.Found(a.h[g]);c<<=1;++e;return Xb.NeedBit(this.treeMake(a,b,c,e),this.treeMake(a,b,c|1,e))},make:function(a,b,c,e){if(1==c)return Xb.NeedBit(Xb.Found(0),Xb.Found(0));var g=[],h=[];if(32<e)throw A.thrown("Invalid huffman");for(var d=0,l=e;d<l;)d++,g.push(0),h.push(0);d=0;for(l=c;d<
l;){var f=d++;f=a[f+b];if(f>=e)throw A.thrown("Invalid huffman");g[f]++}var k=0;d=1;for(l=e-1;d<l;)f=d++,k=k+g[f]<<1,h[f]=k;g=new Gb;d=0;for(l=c;d<l;)f=d++,c=a[f+b],0!=c&&(k=h[c-1],h[c-1]=k+1,g.h[k<<5|c]=f);return this.treeCompress(Xb.NeedBit(this.treeMake(g,e,0,1),this.treeMake(g,e,1,1)))},__class__:pe};var qe=function(a){this.buffer=new Ka(new ArrayBuffer(65536));this.pos=0;a&&(this.crc=new Gc)};d["haxe.zip._InflateImpl.Window"]=qe;qe.__name__=!0;qe.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,
0,32768);var a=new Ka(new ArrayBuffer(65536));this.pos-=32768;a.blit(0,this.buffer,32768,this.pos);this.buffer=a},addBytes:function(a,b,c){65536<this.pos+c&&this.slide();this.buffer.blit(this.pos,a,b,c);this.pos+=c},addByte:function(a){65536==this.pos&&this.slide();this.buffer.b[this.pos]=a&255;this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){null!=this.crc&&this.crc.update(this.buffer,0,this.pos);return this.crc},__class__:qe};
var fb=u["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:k},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:k},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:k},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:k},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:k},
Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:k},DistOne:{_hx_name:"DistOne",_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:k},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:k}};fb.__constructs__=[fb.Head,fb.Block,fb.CData,fb.Flat,fb.Crc,fb.Dist,fb.DistOne,fb.Done];var bb=function(a,b,c){null==c&&(c=!0);null==b&&(b=!0);this.isFinal=!1;this.htools=new pe;this.huffman=this.buildFixedHuffman();this.huffdist=null;this.dist=
this.len=0;this.state=b?fb.Head:fb.Block;this.input=a;this.needed=this.nbits=this.bits=0;this.output=null;this.outpos=0;this.lengths=[];this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);
this.lengths.push(-1);this.lengths.push(-1);this.window=new qe(c)};d["haxe.zip.InflateImpl"]=bb;bb.__name__=!0;bb.prototype={buildFixedHuffman:function(){if(null!=bb.FIXED_HUFFMAN)return bb.FIXED_HUFFMAN;for(var a=[],b=0;288>b;){var c=b++;a.push(143>=c?8:255>=c?9:279>=c?7:8)}bb.FIXED_HUFFMAN=this.htools.make(a,0,288,10);return bb.FIXED_HUFFMAN},readBytes:function(a,b,c){this.needed=c;this.outpos=b;this.output=a;if(0<c)for(;this.inflateLoop(););return c-this.needed},getBits:function(a){for(;this.nbits<
a;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<a)-1;this.nbits-=a;this.bits>>=a;return b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var a=1==(this.bits&1);this.nbits--;this.bits>>=1;return a},getRevBits:function(a){return 0==a?0:this.getBit()?1<<a-1|this.getRevBits(a-1):this.getRevBits(a-1)},resetBits:function(){this.nbits=this.bits=0},addBytes:function(a,b,c){this.window.addBytes(a,b,c);this.output.blit(this.outpos,a,b,c);this.needed-=
c;this.outpos+=c},addByte:function(a){this.window.addByte(a);this.output.b[this.outpos]=a&255;this.needed--;this.outpos++},addDistOne:function(a){for(var b=this.window.getLastChar(),c=0;c<a;)c++,this.addByte(b)},addDist:function(a,b){this.addBytes(this.window.buffer,this.window.pos-a,b)},applyHuffman:function(a){switch(a._hx_index){case 0:var b=a.i;return b;case 1:return b=a.left,a=a.right,this.applyHuffman(this.getBit()?a:b);case 2:return b=a.n,this.applyHuffman(a.table[this.getBits(b)])}},inflateLengths:function(a,
b){for(var c=0,e=0;c<b;){var g=this.applyHuffman(this.huffman);switch(g){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:e=g;a[c]=g;++c;break;case 16:g=c+3+this.getBits(2);if(g>b)throw A.thrown("Invalid data");for(;c<g;)a[c]=e,++c;break;case 17:c+=3+this.getBits(3);if(c>b)throw A.thrown("Invalid data");break;case 18:c+=11+this.getBits(7);if(c>b)throw A.thrown("Invalid data");break;default:throw A.thrown("Invalid data");}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var a=
this.input.readByte();if(8!=(a&15))throw A.thrown("Invalid data");var b=this.input.readByte(),c=0!=(b&32);if(0!=((a<<8)+b)%31)throw A.thrown("Invalid data");if(c)throw A.thrown("Unsupported dictionary");this.state=fb.Block;return!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:this.len=this.input.readUInt16();if(this.input.readUInt16()!=65535-this.len)throw A.thrown("Invalid data");this.state=fb.Flat;a=this.inflateLoop();this.resetBits();return a;case 1:return this.huffman=this.buildFixedHuffman(),
this.huffdist=null,this.state=fb.CData,!0;case 2:a=this.getBits(5)+257;b=this.getBits(5)+1;var e=this.getBits(4)+4;c=0;for(var g=e;c<g;){var h=c++;this.lengths[bb.CODE_LENGTHS_POS[h]]=this.getBits(3)}c=e;for(g=19;c<g;)h=c++,this.lengths[bb.CODE_LENGTHS_POS[h]]=0;this.huffman=this.htools.make(this.lengths,0,19,8);e=[];c=0;for(g=a+b;c<g;)c++,e.push(0);this.inflateLengths(e,a+b);this.huffdist=this.htools.make(e,a,b,16);this.huffman=this.htools.make(e,0,a,16);this.state=fb.CData;return!0;default:throw A.thrown("Invalid data");
}case 2:b=this.applyHuffman(this.huffman);if(256>b)return this.addByte(b),0<this.needed;if(256==b)this.state=this.isFinal?fb.Crc:fb.Block;else{b-=257;a=bb.LEN_EXTRA_BITS_TBL[b];if(-1==a)throw A.thrown("Invalid data");this.len=bb.LEN_BASE_VAL_TBL[b]+this.getBits(a);b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);a=bb.DIST_EXTRA_BITS_TBL[b];if(-1==a)throw A.thrown("Invalid data");this.dist=bb.DIST_BASE_VAL_TBL[b]+this.getBits(a);if(this.dist>this.window.available())throw A.thrown("Invalid data");
this.state=1==this.dist?fb.DistOne:fb.Dist}return!0;case 3:return a=this.len<this.needed?this.len:this.needed,b=this.input.read(a),this.len-=a,this.addBytes(b,0,a),0==this.len&&(this.state=this.isFinal?fb.Crc:fb.Block),0<this.needed;case 4:a=this.window.checksum();if(null==a)return this.state=fb.Done,!0;b=Gc.read(this.input);if(!a.equals(b))throw A.thrown("Invalid CRC");this.state=fb.Done;return!0;case 5:for(;0<this.len&&0<this.needed;)a=this.len<this.dist?this.len:this.dist,a=this.needed<a?this.needed:
a,this.addDist(this.dist,a),this.len-=a;0==this.len&&(this.state=fb.CData);return 0<this.needed;case 6:return a=this.len<this.needed?this.len:this.needed,this.addDistOne(a),this.len-=a,0==this.len&&(this.state=fb.CData),0<this.needed;case 7:return!1}},__class__:bb};var $c=function(a){this.i=a};d["haxe.zip.Reader"]=$c;$c.__name__=!0;$c.readZip=function(a){return(new $c(a)).read()};$c.prototype={readZipDate:function(){var a=this.i.readUInt16(),b=a>>11&31,c=a>>5&63;a&=31;var e=this.i.readUInt16();return new Date((e>>
9)+1980,(e>>5&15)-1,e&31,b,c,a<<1)},readExtraFields:function(a){for(var b=new Db;0<a;){if(4>a)throw A.thrown("Invalid extra fields data");var c=this.i.readUInt16(),e=this.i.readUInt16();if(a<e)throw A.thrown("Invalid extra fields data");if(28789==c){var g=this.i.readByte();if(1!=g){var h=new md;h.addByte(g);h.add(this.i.read(e-1));b.add(Jc.FUnknown(c,h.getBytes()))}else c=this.i.readInt32(),g=this.i.read(e-5).toString(),b.add(Jc.FInfoZipUnicodePath(g,c))}else b.add(Jc.FUnknown(c,this.i.read(e)));
a-=4+e}return b},readEntryHeader:function(){var a=this.i,b=a.readInt32();if(33639248==b||101010256==b)return null;if(67324752!=b)throw A.thrown("Invalid Zip Data");a.readUInt16();b=a.readUInt16();var c=0!=(b&2048),e=a.readUInt16(),g=0!=e;if(g&&8!=e)throw A.thrown("Unsupported compression "+e);e=this.readZipDate();var h=a.readInt32(),d=a.readInt32(),l=a.readInt32(),f=a.readInt16(),k=a.readInt16();a=a.readString(f);k=this.readExtraFields(k);c&&k.push(Jc.FUtf8);0!=(b&8)&&(d=-1);return{fileName:a,fileSize:l,
fileTime:e,compressed:g,dataSize:d,data:null,crc32:h,extraFields:k}},read:function(){for(var a=new Db,b=null;;){var c=this.readEntryHeader();if(null==c)break;if(0>c.dataSize){null==b&&(b=new Ka(new ArrayBuffer(65536)));for(var e=new md,g=new bb(this.i,!1,!1);;){var h=g.readBytes(b,0,65536);e.addBytes(b,0,h);if(65536>h)break}c.data=e.getBytes();c.crc32=this.i.readInt32();134695760==c.crc32&&(c.crc32=this.i.readInt32());c.dataSize=this.i.readInt32();c.fileSize=this.i.readInt32();c.dataSize=c.fileSize;
c.compressed=!1}else c.data=this.i.read(c.dataSize);a.add(c)}return a},__class__:$c};var zc=function(a,b){this.message=a;this.pos=b};d["hxjsonast.Error"]=zc;zc.__name__=!0;zc.prototype={__class__:zc};var sa=function(a,b){this.value=a;this.pos=b};d["hxjsonast.Json"]=sa;sa.__name__=!0;sa.prototype={__class__:sa};var Ba=u["hxjsonast.JsonValue"]={__ename__:!0,__constructs__:null,JString:(f=function(a){return{_hx_index:0,s:a,__enum__:"hxjsonast.JsonValue",toString:k}},f._hx_name="JString",f.__params__=
["s"],f),JNumber:(f=function(a){return{_hx_index:1,s:a,__enum__:"hxjsonast.JsonValue",toString:k}},f._hx_name="JNumber",f.__params__=["s"],f),JObject:(f=function(a){return{_hx_index:2,fields:a,__enum__:"hxjsonast.JsonValue",toString:k}},f._hx_name="JObject",f.__params__=["fields"],f),JArray:(f=function(a){return{_hx_index:3,values:a,__enum__:"hxjsonast.JsonValue",toString:k}},f._hx_name="JArray",f.__params__=["values"],f),JBool:(f=function(a){return{_hx_index:4,b:a,__enum__:"hxjsonast.JsonValue",
toString:k}},f._hx_name="JBool",f.__params__=["b"],f),JNull:{_hx_name:"JNull",_hx_index:5,__enum__:"hxjsonast.JsonValue",toString:k}};Ba.__constructs__=[Ba.JString,Ba.JNumber,Ba.JObject,Ba.JArray,Ba.JBool,Ba.JNull];var re=function(a,b,c){this.name=a;this.namePos=b;this.value=c};d["hxjsonast.JObjectField"]=re;re.__name__=!0;re.prototype={__class__:re};var je=function(a,b){this.source=a;this.filename=b;this.pos=0};d["hxjsonast.Parser"]=je;je.__name__=!0;je.prototype={doParse:function(){for(var a=this.parseRec(),
b;;){var c=b=this.source.charCodeAt(this.pos++);if(c!=c)break;switch(b){case 9:case 10:case 13:case 32:break;default:this.invalidChar()}}return a},parseRec:function(){for(;;){var a=this.source.charCodeAt(this.pos++);switch(a){case 9:case 10:case 13:case 32:break;case 34:var b=this.pos,c=this.parseString();return new sa(Ba.JString(c),new Ea(this.filename,b-1,this.pos));case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:b=this.pos-1;c=45==a;var e=!c;a=48==a;for(var g=
!1,h=!1,d=!1,l=!1;;){switch(this.source.charCodeAt(this.pos++)){case 43:case 45:h&&!d||this.invalidNumber(b);e=!1;d=!0;break;case 46:(c||g||h)&&this.invalidNumber(b);e=!1;g=!0;break;case 48:a&&!g&&this.invalidNumber(b);c&&(c=!1,a=!0);e=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a&&!g&&this.invalidNumber(b);c&&(c=!1);e=!0;a=!1;break;case 69:case 101:(c||a||h)&&this.invalidNumber(b);e=!1;h=!0;break;default:e||this.invalidNumber(b),this.pos--,l=!0}if(l)break}c=I.substr(this.source,
b,this.pos-b);return new sa(Ba.JNumber(c),new Ea(this.filename,b,this.pos));case 91:for(b=[],c=null,e=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 44:c?c=!1:this.invalidChar();break;case 93:return 0==c&&this.invalidChar(),new sa(Ba.JArray(b),new Ea(this.filename,e,this.pos));default:c&&this.invalidChar(),this.pos--,b.push(this.parseRec()),c=!0}case 102:b=this.pos;if(97!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||
115!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new sa(Ba.JBool(!1),new Ea(this.filename,b-1,this.pos));case 110:b=this.pos;if(117!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new sa(Ba.JNull,new Ea(this.filename,b-1,this.pos));case 116:b=this.pos;if(114!=this.source.charCodeAt(this.pos++)||117!=this.source.charCodeAt(this.pos++)||
101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new sa(Ba.JBool(!0),new Ea(this.filename,b-1,this.pos));case 123:for(b=[],c=Object.create(null),a=h=e=null,g=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 34:(null!=e||a)&&this.invalidChar();h=this.pos-1;e=this.parseString();h=new Ea(this.filename,h,this.pos);if(Object.prototype.hasOwnProperty.call(c,e))throw A.thrown(new zc('Duplicate field name "'+e+'"',h));c[e]=!0;break;
case 44:a?a=!1:this.invalidChar();break;case 58:null==e&&this.invalidChar();b.push(new re(e,h,this.parseRec()));h=e=null;a=!0;break;case 125:return null==e&&0!=a||this.invalidChar(),new sa(Ba.JObject(b),new Ea(this.filename,g,this.pos));default:this.invalidChar()}default:this.invalidChar()}}},parseString:function(){for(var a=this.pos,b=null;;){var c=this.source.charCodeAt(this.pos++);if(34==c)break;if(92==c){null==b&&(b=new va);c=this.source;var e=this.pos-a-1;b.b+=null==e?I.substr(c,a,null):I.substr(c,
a,e);c=this.source.charCodeAt(this.pos++);switch(c){case 34:case 47:case 92:b.b+=String.fromCodePoint(c);break;case 98:b.b+=String.fromCodePoint(8);break;case 102:b.b+=String.fromCodePoint(12);break;case 110:b.b+=String.fromCodePoint(10);break;case 114:b.b+=String.fromCodePoint(13);break;case 116:b.b+=String.fromCodePoint(9);break;case 117:a=x.parseInt("0x"+I.substr(this.source,this.pos,4));this.pos+=4;b.b+=String.fromCodePoint(a);break;default:throw A.thrown(new zc("Invalid escape sequence \\"+String.fromCodePoint(c),
new Ea(this.filename,this.pos-2,this.pos)));}a=this.pos}else if(c!=c)throw this.pos--,A.thrown(new zc("Unclosed string",new Ea(this.filename,a-1,this.pos)));}if(null==b)return I.substr(this.source,a,this.pos-a-1);c=this.source;e=this.pos-a-1;b.b+=null==e?I.substr(c,a,null):I.substr(c,a,e);return b.b},invalidChar:function(){this.pos--;throw A.thrown(new zc("Invalid character: "+this.source.charAt(this.pos),new Ea(this.filename,this.pos,this.pos+1)));},invalidNumber:function(a){throw A.thrown(new zc("Invalid number: "+
this.source.substring(a,this.pos),new Ea(this.filename,a,this.pos)));},__class__:je};var Ea=function(a,b,c){this.file=a;this.min=b;this.max=c};d["hxjsonast.Position"]=Ea;Ea.__name__=!0;Ea.prototype={__class__:Ea};var Aa=function(){};d["js.Boot"]=Aa;Aa.__name__=!0;Aa.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=Aa.__nativeClassName(a);return null!=a?Aa.__resolveNativeClass(a):null};Aa.__string_rec=function(a,b){if(null==a)return"null";
if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a.__enum__){var e=u[a.__enum__].__constructs__[a._hx_index];c=e._hx_name;if(e.__params__){b+="\t";var g=[],h=0;for(e=e.__params__;h<e.length;){var d=e[h];h+=1;g.push(Aa.__string_rec(a[d],b))}return c+"("+g.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";g=0;for(h=a.length;g<h;)e=g++,c+=(0<e?",":"")+Aa.__string_rec(a[e],b);return c+
"]"}try{g=a.toString}catch(l){return oa.lastError=l,"???"}if(null!=g&&g!=Object.toString&&"function"==typeof g&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";g=null!=a.hasOwnProperty;h=null;for(h in a)g&&!a.hasOwnProperty(h)||"prototype"==h||"__class__"==h||"__super__"==h||"__interfaces__"==h||"__properties__"==h||(2!=c.length&&(c+=", \n"),c+=b+h+" : "+Aa.__string_rec(a[h],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};Aa.__interfLoop=
function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var e=0,g=c.length;e<g;){var h=e++;h=c[h];if(h==b||Aa.__interfLoop(h,b))return!0}return Aa.__interfLoop(a.__super__,b)};Aa.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;case pf:return"boolean"==typeof a;case qf:return null!=a;case rf:return"number"==typeof a;case sf:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==
typeof b){if(Aa.__downcastCheck(a,b))return!0}else{if("object"==typeof b&&Aa.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==tf&&null!=a.__name__||b==uf&&null!=a.__ename__?!0:null!=a.__enum__?u[a.__enum__]==b:!1}};Aa.__downcastCheck=function(a,b){return a instanceof b?!0:b.__isInterface__?Aa.__interfLoop(Aa.getClass(a),b):!1};Aa.__cast=function(a,b){if(null==a||Aa.__instanceof(a,b))return a;throw A.thrown("Cannot cast "+x.string(a)+" to "+x.string(b));};Aa.__nativeClassName=function(a){a=
Aa.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};Aa.__isNativeObj=function(a){return null!=Aa.__nativeClassName(a)};Aa.__resolveNativeClass=function(a){return t[a]};var ra=u["json2object.Error"]={__ename__:!0,__constructs__:null,IncorrectType:(f=function(a,b,c){return{_hx_index:0,variable:a,expected:b,pos:c,__enum__:"json2object.Error",toString:k}},f._hx_name="IncorrectType",f.__params__=["variable","expected","pos"],f),IncorrectEnumValue:(f=function(a,
b,c){return{_hx_index:1,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:k}},f._hx_name="IncorrectEnumValue",f.__params__=["value","expected","pos"],f),InvalidEnumConstructor:(f=function(a,b,c){return{_hx_index:2,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:k}},f._hx_name="InvalidEnumConstructor",f.__params__=["value","expected","pos"],f),UninitializedVariable:(f=function(a,b){return{_hx_index:3,variable:a,pos:b,__enum__:"json2object.Error",toString:k}},f._hx_name=
"UninitializedVariable",f.__params__=["variable","pos"],f),UnknownVariable:(f=function(a,b){return{_hx_index:4,variable:a,pos:b,__enum__:"json2object.Error",toString:k}},f._hx_name="UnknownVariable",f.__params__=["variable","pos"],f),ParserError:(f=function(a,b){return{_hx_index:5,message:a,pos:b,__enum__:"json2object.Error",toString:k}},f._hx_name="ParserError",f.__params__=["message","pos"],f),CustomFunctionException:(f=function(a,b){return{_hx_index:6,e:a,pos:b,__enum__:"json2object.Error",toString:k}},
f._hx_name="CustomFunctionException",f.__params__=["e","pos"],f)};ra.__constructs__=[ra.IncorrectType,ra.IncorrectEnumValue,ra.InvalidEnumConstructor,ra.UninitializedVariable,ra.UnknownVariable,ra.ParserError,ra.CustomFunctionException];var Hb=u["json2object.InternalError"]={__ename__:!0,__constructs__:null,AbstractNoJsonRepresentation:(f=function(a){return{_hx_index:0,name:a,__enum__:"json2object.InternalError",toString:k}},f._hx_name="AbstractNoJsonRepresentation",f.__params__=["name"],f),CannotGenerateSchema:(f=
function(a){return{_hx_index:1,name:a,__enum__:"json2object.InternalError",toString:k}},f._hx_name="CannotGenerateSchema",f.__params__=["name"],f),HandleExpr:{_hx_name:"HandleExpr",_hx_index:2,__enum__:"json2object.InternalError",toString:k},ParsingThrow:{_hx_name:"ParsingThrow",_hx_index:3,__enum__:"json2object.InternalError",toString:k},UnsupportedAbstractEnumType:(f=function(a){return{_hx_index:4,name:a,__enum__:"json2object.InternalError",toString:k}},f._hx_name="UnsupportedAbstractEnumType",
f.__params__=["name"],f),UnsupportedEnumAbstractValue:(f=function(a){return{_hx_index:5,name:a,__enum__:"json2object.InternalError",toString:k}},f._hx_name="UnsupportedEnumAbstractValue",f.__params__=["name"],f),UnsupportedMapKeyType:(f=function(a){return{_hx_index:6,name:a,__enum__:"json2object.InternalError",toString:k}},f._hx_name="UnsupportedMapKeyType",f.__params__=["name"],f),UnsupportedSchemaObjectType:(f=function(a){return{_hx_index:7,name:a,__enum__:"json2object.InternalError",toString:k}},
f._hx_name="UnsupportedSchemaObjectType",f.__params__=["name"],f),UnsupportedSchemaType:(f=function(a){return{_hx_index:8,type:a,__enum__:"json2object.InternalError",toString:k}},f._hx_name="UnsupportedSchemaType",f.__params__=["type"],f)};Hb.__constructs__=[Hb.AbstractNoJsonRepresentation,Hb.CannotGenerateSchema,Hb.HandleExpr,Hb.ParsingThrow,Hb.UnsupportedAbstractEnumType,Hb.UnsupportedEnumAbstractValue,Hb.UnsupportedMapKeyType,Hb.UnsupportedSchemaObjectType,Hb.UnsupportedSchemaType];var Xe=function(){};
d["json2object.ErrorUtils"]=Xe;Xe.__name__=!0;Xe.convertError=function(a){switch(a._hx_index){case 0:var b=a.pos;var c=b;break;case 1:c=b=a.pos;break;case 2:c=b=a.pos;break;case 3:c=b=a.pos;break;case 4:c=b=a.pos;break;case 5:c=b=a.pos;break;case 6:c=b=a.pos}b="";if(null!=c){var e=""==c.file?"line":""+c.file+":";1==c.lines.length?b=""+e+c.lines[0].number+": characters "+c.lines[0].start+"-"+c.lines[0].end+" : ":1<c.lines.length&&(b=""+e+c.lines[0].number+": lines "+c.lines[0].number+"-"+c.lines[c.lines.length-
1].number+" : ")}switch(a._hx_index){case 0:return c=a.variable,a=a.expected,b+("Variable '"+c+"' should be of type '"+a+"'");case 1:return c=a.value,a=a.expected,b+("Identifier '"+c+"' isn't part of '"+a+"'");case 2:return c=a.value,a=a.expected,b+("Enum argument '"+c+"' should be of type '"+a+"'");case 3:return c=a.variable,b+("Variable '"+c+"' should be in the json");case 4:return c=a.variable,b+("Variable '"+c+"' isn't part of the schema");case 5:return b+("Parser error: "+a.message);case 6:return a=
a.e,b+("Custom function exception: "+(null==a?"null":x.string(a)))}};var ie=function(a){this.linesInfo=[];for(var b=0,c,e=0,g=0;e<a.length;)switch(a.charAt(e)){case "\n":c=e;this.linesInfo.push({number:g,start:b,end:c});++g;++e;b=e;break;case "\r":c=e;"\n"==a.charAt(e+1)&&++c;this.linesInfo.push({number:g,start:b,end:c});++g;b=e=c+1;break;default:++e}this.linesInfo.push({number:g,start:b,end:e})};d["json2object.PositionUtils"]=ie;ie.__name__=!0;ie.prototype={convertPosition:function(a){var b=a.min,
c=a.max;a={file:a.file,min:b+1,max:c+1,lines:[]};var e=0,g=this.linesInfo.length-1;if(b>this.linesInfo[0].end)for(;g>e;){var h=(e+g)/2|0,d=this.linesInfo[h];d.start==b&&(g=e=h);d.end<b&&(e=h+1);if(d.start>b||d.end>=b&&d.start<b)g=h}for(g=this.linesInfo.length;e<g;){h=e++;d=this.linesInfo[h];if(d.start<=b&&d.end>=c){a.lines.push({number:d.number+1,start:b-d.start+1,end:c-d.start+1});break}d.start<=b&&b<=d.end&&a.lines.push({number:d.number+1,start:b-d.start+1,end:d.end+1});d.start<=c&&c<=d.end&&a.lines.push({number:d.number+
1,start:d.start+1,end:c-d.start+1});if(d.start>=c||d.end>=c)break}return a},__class__:ie};var be=function(){this.connected=!0;this.buttons=[];this.axes=[]};d["lime._internal.backend.html5.GameDeviceData"]=be;be.__name__=!0;be.prototype={__class__:be};var U=function(){this.validStatus0=(new M("Tizen","gi")).match(window.navigator.userAgent)};d["lime._internal.backend.html5.HTML5HTTPRequest"]=U;U.__name__=!0;U.loadImage=function(a){var b=new zb;U.activeRequests<U.requestLimit?(U.activeRequests++,U.__loadImage(a,
b,0)):U.requestQueue.add({instance:null,uri:a,promise:b,type:"IMAGE",options:0});return b.future};U.loadImageFromBytes=function(a,b){var c=URL.createObjectURL(new Blob([a.b.bufferValue],{type:b}));return null!=c?(a=new zb,U.activeRequests<U.requestLimit?(U.activeRequests++,U.__loadImage(c,a,1)):U.requestQueue.add({instance:null,uri:c,promise:a,type:"IMAGE",options:1}),a.future):U.loadImage("data:"+b+";base64,"+kc.encode(a))};U.processQueue=function(){if(U.activeRequests<U.requestLimit&&0<U.requestQueue.length){U.activeRequests++;
var a=U.requestQueue.pop();switch(a.type){case "BINARY":a.instance.__loadData(a.uri,a.promise);break;case "IMAGE":U.__loadImage(a.uri,a.promise,a.options);break;case "TEXT":a.instance.__loadText(a.uri,a.promise);break;default:U.activeRequests--}}};U.__fixHostname=function(a){return null==a?"":a};U.__fixPort=function(a,b){if(null==a||""==a)switch(b){case "ftp:":return"21";case "gopher:":return"70";case "http:":return"80";case "https:":return"443";case "ws:":return"80";case "wss:":return"443";default:return""}return a};
U.__fixProtocol=function(a){return null==a||""==a?"http:":a};U.__isInMemoryURI=function(a){return Z.startsWith(a,"data:")?!0:Z.startsWith(a,"blob:")};U.__isSameOrigin=function(a){if(null==a||""==a||U.__isInMemoryURI(a))return!0;null==U.originElement&&(U.originElement=window.document.createElement("a"),U.originHostname=U.__fixHostname(t.location.hostname),U.originProtocol=U.__fixProtocol(t.location.protocol),U.originPort=U.__fixPort(t.location.port,U.originProtocol));var b=U.originElement;b.href=a;
""==b.hostname&&(b.href=b.href);var c=U.__fixHostname(b.hostname);a=U.__fixProtocol(b.protocol);b=U.__fixPort(b.port,a);c=""==c||c==U.originHostname;b=""==b||b==U.originPort;return"file:"!=a&&c?b:!1};U.__loadImage=function(a,b,c){var e=new Image;U.__isSameOrigin(a)||(e.crossOrigin="Anonymous");null==U.supportsImageProgress&&(U.supportsImageProgress="onprogress"in e);if(U.supportsImageProgress||U.__isInMemoryURI(a))e.addEventListener("load",function(g){U.__revokeBlobURI(a,c);g=new bc(null,e.width,
e.height);g.__srcImage=e;U.activeRequests--;U.processQueue();b.complete(new Ia(g))},!1),e.addEventListener("progress",function(a){b.progress(a.loaded,a.total)},!1),e.addEventListener("error",function(e){U.__revokeBlobURI(a,c);U.activeRequests--;U.processQueue();b.error(e.detail)},!1),e.src=a;else{var g=new XMLHttpRequest;g.onload=function(a){U.activeRequests--;U.processQueue();(new Ia).__fromBytes(Ka.ofData(g.response),function(a){b.complete(a)})};g.onerror=function(a){b.error(a.message)};g.onprogress=
function(a){a.lengthComputable&&b.progress(a.loaded,a.total)};g.open("GET",a,!0);g.responseType="arraybuffer";g.overrideMimeType("text/plain; charset=x-user-defined");g.send(null)}};U.__revokeBlobURI=function(a,b){0!=(b&1)&&URL.revokeObjectURL(a)};U.prototype={init:function(a){this.parent=a},load:function(a,b,c){this.request=new XMLHttpRequest;"POST"==this.parent.method?this.request.upload.addEventListener("progress",b,!1):this.request.addEventListener("progress",b,!1);this.request.onreadystatechange=
c;b="";if(null==this.parent.data){c=Object.keys(this.parent.formData.h);for(var e=c.length,g=0;g<e;){var h=c[g++];0<b.length&&(b+="&");var d=this.parent.formData.h[h];if(-1<h.indexOf("[]")&&d instanceof Array){var l=[];for(d=C(d);d.hasNext();){var f=d.next();l.push(encodeURIComponent(f))}l=l.join("&amp;"+h+"=");b+=encodeURIComponent(h)+"="+l}else l=encodeURIComponent(h)+"=",h=x.string(d),b+=l+encodeURIComponent(h)}"GET"==this.parent.method&&""!=b&&(a=-1<a.indexOf("?")?a+("&"+b):a+("?"+b),b="")}this.request.open(x.string(this.parent.method),
a,!0);0<this.parent.timeout&&(this.request.timeout=this.parent.timeout);this.binary&&(this.request.responseType="arraybuffer");a=null;l=0;for(c=this.parent.headers;l<c.length;)e=c[l],++l,"Content-Type"==e.name?a=e.value:this.request.setRequestHeader(e.name,e.value);null!=this.parent.contentType&&(a=this.parent.contentType);null==a&&(null!=this.parent.data?a="application/octet-stream":""!=b&&(a="application/x-www-form-urlencoded"));null!=a&&this.request.setRequestHeader("Content-Type",a);this.parent.withCredentials&&
(this.request.withCredentials=!0);null!=this.parent.data?this.request.send(this.parent.data.b.bufferValue):this.request.send(b)},loadData:function(a){var b=new zb;U.activeRequests<U.requestLimit?(U.activeRequests++,this.__loadData(a,b)):U.requestQueue.add({instance:this,uri:a,promise:b,type:"BINARY",options:0});return b.future},loadText:function(a){var b=new zb;U.activeRequests<U.requestLimit?(U.activeRequests++,this.__loadText(a,b)):U.requestQueue.add({instance:this,uri:a,promise:b,type:"TEXT",options:0});
return b.future},processResponse:function(){if(this.parent.enableResponseHeaders){this.parent.responseHeaders=[];for(var a,b,c=0,e=this.request.getAllResponseHeaders().split("\n");c<e.length;)b=e[c],++c,a=Z.trim(I.substr(b,0,b.indexOf(":"))),b=Z.trim(I.substr(b,b.indexOf(":")+1,null)),""!=a&&this.parent.responseHeaders.push(new se(a,b))}this.parent.responseStatus=this.request.status},__loadData:function(a,b){var c=this;this.binary=!0;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==
c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>c.request.status||c.validStatus0&&0==c.request.status)?(a=null,""==c.request.responseType?null!=c.request.responseText&&(a=Ka.ofString(c.request.responseText)):null!=c.request.response&&(a=Ka.ofData(c.request.response)),c.processResponse(),b.complete(a)):(c.processResponse(),b.error(c.request.status)),c.request=null,U.activeRequests--,U.processQueue())})},__loadText:function(a,b){var c=this;this.binary=!1;this.load(a,function(a){b.progress(a.loaded,
a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>=c.request.status||c.validStatus0&&0==c.request.status)?(c.processResponse(),b.complete(c.request.responseText)):(c.processResponse(),b.error(c.request.status)),c.request=null,U.activeRequests--,U.processQueue())})},__class__:U};var od=function(a){this.unusedTouchesPool=new Db;this.scale=1;this.currentTouches=new Gb;this.parent=a;this.cursor=Tb.DEFAULT;this.cacheMouseY=this.cacheMouseX=0;var b=a.__attributes;
Object.prototype.hasOwnProperty.call(b,"context")||(b.context={});this.renderType=b.context.type;Object.prototype.hasOwnProperty.call(b,"element")&&(a.element=b.element);var c=a.element;Object.prototype.hasOwnProperty.call(b,"allowHighDPI")&&b.allowHighDPI&&"dom"!=this.renderType&&(this.scale=window.devicePixelRatio);a.__scale=this.scale;this.setWidth=Object.prototype.hasOwnProperty.call(b,"width")?b.width:0;this.setHeight=Object.prototype.hasOwnProperty.call(b,"height")?b.height:0;a.__width=this.setWidth;
a.__height=this.setHeight;a.id=od.windowID++;c instanceof HTMLCanvasElement?this.canvas=c:"dom"==this.renderType?this.div=window.document.createElement("div"):this.canvas=window.document.createElement("canvas");if(null!=this.canvas){var e=this.canvas.style;e.setProperty("-webkit-transform","translateZ(0)",null);e.setProperty("transform","translateZ(0)",null)}else null!=this.div&&(e=this.div.style,e.setProperty("-webkit-transform","translate3D(0,0,0)",null),e.setProperty("transform","translate3D(0,0,0)",
null),e.position="relative",e.overflow="hidden",e.setProperty("-webkit-user-select","none",null),e.setProperty("-moz-user-select","none",null),e.setProperty("-ms-user-select","none",null),e.setProperty("-o-user-select","none",null));0==a.__width&&0==a.__height&&(null!=c?(a.__width=c.clientWidth,a.__height=c.clientHeight):(a.__width=window.innerWidth,a.__height=window.innerHeight),this.cacheElementWidth=a.__width,this.cacheElementHeight=a.__height,this.resizeElement=!0);null!=this.canvas?(this.canvas.width=
Math.round(a.__width*this.scale),this.canvas.height=Math.round(a.__height*this.scale),this.canvas.style.width=a.__width+"px",this.canvas.style.height=a.__height+"px"):(this.div.style.width=a.__width+"px",this.div.style.height=a.__height+"px");if(Object.prototype.hasOwnProperty.call(b,"resizable")&&b.resizable||!Object.prototype.hasOwnProperty.call(b,"width")&&0==this.setWidth&&0==this.setHeight)a.__resizable=!0;this.updateSize();if(null!=c){null!=this.canvas?c!=this.canvas&&c.appendChild(this.canvas):
c.appendChild(this.div);b="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");for(e=0;e<b.length;){var g=b[e];++e;c.addEventListener(g,n(this,this.handleMouseEvent),!0)}c.addEventListener("contextmenu",n(this,this.handleContextMenuEvent),!0);c.addEventListener("dragstart",n(this,this.handleDragEvent),!0);c.addEventListener("dragover",n(this,this.handleDragEvent),!0);c.addEventListener("drop",n(this,this.handleDragEvent),!0);c.addEventListener("touchstart",n(this,this.handleTouchEvent),
!0);c.addEventListener("touchmove",n(this,this.handleTouchEvent),!0);c.addEventListener("touchend",n(this,this.handleTouchEvent),!0);c.addEventListener("touchcancel",n(this,this.handleTouchEvent),!0);c.addEventListener("gamepadconnected",n(this,this.handleGamepadEvent),!0);c.addEventListener("gamepaddisconnected",n(this,this.handleGamepadEvent),!0)}this.createContext();"webgl"==a.context.type&&(this.canvas.addEventListener("webglcontextlost",n(this,this.handleContextEvent),!1),this.canvas.addEventListener("webglcontextrestored",
n(this,this.handleContextEvent),!1))};d["lime._internal.backend.html5.HTML5Window"]=od;od.__name__=!0;od.prototype={close:function(){this.parent.application.__removeWindow(this.parent)},createContext:function(){var a=new te,b=this.parent.__attributes.context;a.window=this.parent;a.attributes=b;if(null!=this.div)a.dom=this.div,a.type="dom",a.version="";else if(null!=this.canvas){var c=null,e="canvas"==this.renderType,g="opengl"==this.renderType||"opengles"==this.renderType||"webgl"==this.renderType,
h=!Object.prototype.hasOwnProperty.call(b,"version")||"1"!=b.version,d=!1;if(g||!e&&(!Object.prototype.hasOwnProperty.call(b,"hardware")||b.hardware)){e=Object.prototype.hasOwnProperty.call(b,"background")&&null==b.background;g=Object.prototype.hasOwnProperty.call(b,"colorDepth")?b.colorDepth:16;var l=Object.prototype.hasOwnProperty.call(b,"antialiasing")&&0<b.antialiasing,f=Object.prototype.hasOwnProperty.call(b,"depth")?b.depth:!0;b=Object.prototype.hasOwnProperty.call(b,"stencil")&&b.stencil;b=
{alpha:e||16<g,antialias:l,depth:f,premultipliedAlpha:!0,stencil:b,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1};e=["webgl","experimental-webgl"];h&&e.unshift("webgl2");for(h=0;h<e.length&&(g=e[h],++h,c=this.canvas.getContext(g,b),null!=c&&"webgl2"==g&&(d=!0),null==c););}null==c?(a.canvas2D=this.canvas.getContext("2d"),a.type="canvas",a.version=""):(a.webgl=vf.fromWebGL2RenderContext(c),d&&(a.webgl2=c),null==pd.context&&(pd.context=c,pd.type="webgl",pd.version=d?2:1),a.type="webgl",a.version=
d?"2":"1")}this.parent.context=a},handleContextEvent:function(a){switch(a.type){case "webglcontextlost":a.cancelable&&a.preventDefault();this.parent.context=null;this.parent.onRenderContextLost.dispatch();break;case "webglcontextrestored":this.createContext(),this.parent.onRenderContextRestored.dispatch(this.parent.context)}},handleContextMenuEvent:function(a){(this.parent.onMouseUp.canceled||this.parent.onMouseDown.canceled)&&a.cancelable&&a.preventDefault()},handleDragEvent:function(a){switch(a.type){case "dragover":return a.preventDefault(),
!1;case "dragstart":if("img"==Aa.__cast(a.target,HTMLElement).nodeName.toLowerCase()&&a.cancelable)return a.preventDefault(),!1;break;case "drop":if(null!=a.dataTransfer&&0<a.dataTransfer.files.length)return this.parent.onDropFile.dispatch(a.dataTransfer.files),a.preventDefault(),!1}return!0},handleGamepadEvent:function(a){switch(a.type){case "gamepadconnected":jb.__connect(a.gamepad.index);"standard"==a.gamepad.mapping&&Ya.__connect(a.gamepad.index);break;case "gamepaddisconnected":jb.__disconnect(a.gamepad.index),
Ya.__disconnect(a.gamepad.index)}},handleMouseEvent:function(a){if("wheel"!=a.type){if(null!=this.parent.element)if(null!=this.canvas){var b=this.canvas.getBoundingClientRect();var c=this.parent.__width/b.width*(a.clientX-b.left);b=this.parent.__height/b.height*(a.clientY-b.top)}else null!=this.div?(b=this.div.getBoundingClientRect(),c=a.clientX-b.left,b=a.clientY-b.top):(b=this.parent.element.getBoundingClientRect(),c=this.parent.__width/b.width*(a.clientX-b.left),b=this.parent.__height/b.height*
(a.clientY-b.top));else c=a.clientX,b=a.clientY;switch(a.type){case "mousedown":a.currentTarget==this.parent.element&&window.addEventListener("mouseup",n(this,this.handleMouseEvent));this.parent.onMouseDown.dispatch(c,b,a.button);this.parent.onMouseDown.canceled&&a.cancelable&&a.preventDefault();break;case "mouseenter":a.target==this.parent.element&&(this.parent.onEnter.dispatch(),this.parent.onEnter.canceled&&a.cancelable&&a.preventDefault());break;case "mouseleave":a.target==this.parent.element&&
(this.parent.onLeave.dispatch(),this.parent.onLeave.canceled&&a.cancelable&&a.preventDefault());break;case "mousemove":if(c!=this.cacheMouseX||b!=this.cacheMouseY)this.parent.onMouseMove.dispatch(c,b),this.parent.onMouseMoveRelative.dispatch(c-this.cacheMouseX,b-this.cacheMouseY),(this.parent.onMouseMove.canceled||this.parent.onMouseMoveRelative.canceled)&&a.cancelable&&a.preventDefault();break;case "mouseup":window.removeEventListener("mouseup",n(this,this.handleMouseEvent)),a.currentTarget==this.parent.element&&
a.stopPropagation(),this.parent.onMouseUp.dispatch(c,b,a.button),this.parent.onMouseUp.canceled&&a.cancelable&&a.preventDefault()}this.cacheMouseX=c;this.cacheMouseY=b}else{switch(a.deltaMode){case 0:c=cc.PIXELS;break;case 1:c=cc.LINES;break;case 2:c=cc.PAGES;break;default:c=cc.UNKNOWN}this.parent.onMouseWheel.dispatch(a.deltaX,-a.deltaY,c);this.parent.onMouseWheel.canceled&&a.cancelable&&a.preventDefault()}},handleResizeEvent:function(a){this.primaryTouch=null;this.updateSize()},handleTouchEvent:function(a){a.cancelable&&
a.preventDefault();var b=null;null!=this.parent.element&&(b=null!=this.canvas?this.canvas.getBoundingClientRect():null!=this.div?this.div.getBoundingClientRect():this.parent.element.getBoundingClientRect());var c=this.setWidth,e=this.setHeight;if(0==c||0==e)null!=b?(c=b.width,e=b.height):e=c=1;for(var g,h,d,l,f,k=0,y=a.changedTouches;k<y.length;){var r=y[k];++k;null!=b?(h=c/b.width*(r.clientX-b.left),d=e/b.height*(r.clientY-b.top)):(h=r.clientX,d=r.clientY);if("touchstart"==a.type)g=this.unusedTouchesPool.pop(),
null==g?g=new ub(h/c,d/e,r.identifier,0,0,r.force,this.parent.id):(g.x=h/c,g.y=d/e,g.id=r.identifier,g.dx=0,g.dy=0,g.pressure=r.force,g.device=this.parent.id),this.currentTouches.h[r.identifier]=g,ub.onStart.dispatch(g),null==this.primaryTouch&&(this.primaryTouch=g),g==this.primaryTouch&&this.parent.onMouseDown.dispatch(h,d,0);else if(g=this.currentTouches.h[r.identifier],null!=g)switch(l=g.x,f=g.y,g.x=h/c,g.y=d/e,g.dx=g.x-l,g.dy=g.y-f,g.pressure=r.force,a.type){case "touchcancel":ub.onCancel.dispatch(g);
this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(g);g==this.primaryTouch&&(this.primaryTouch=null);break;case "touchend":ub.onEnd.dispatch(g);this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(g);g==this.primaryTouch&&(this.parent.onMouseUp.dispatch(h,d,0),this.primaryTouch=null);break;case "touchmove":ub.onMove.dispatch(g),g==this.primaryTouch&&this.parent.onMouseMove.dispatch(h,d)}}},updateSize:function(){if(this.parent.__resizable){if(null!=this.parent.element){var a=
this.parent.element.clientWidth;var b=this.parent.element.clientHeight}else a=window.innerWidth,b=window.innerHeight;if(a!=this.cacheElementWidth||b!=this.cacheElementHeight){this.cacheElementWidth=a;this.cacheElementHeight=b;var c=this.resizeElement||0==this.setWidth&&0==this.setHeight;if(null!=this.parent.element&&(null==this.div||null!=this.div&&c))if(c){if(this.parent.__width!=a||this.parent.__height!=b)this.parent.__width=a,this.parent.__height=b,null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.width=Math.round(a*this.scale),this.canvas.height=Math.round(b*this.scale),this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"):(this.div.style.width=a+"px",this.div.style.height=b+"px"),this.parent.onResize.dispatch(a,b)}else{c=0!=this.setWidth?a/this.setWidth:1;var e=0!=this.setHeight?b/this.setHeight:1,g=a,h=b,d=0,l=0;c<e?(h=Math.floor(this.setHeight*c),l=Math.floor((b-h)/2)):(g=Math.floor(this.setWidth*e),d=Math.floor((a-g)/2));null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.style.width=g+"px",this.canvas.style.height=h+"px",this.canvas.style.marginLeft=d+"px",this.canvas.style.marginTop=l+"px"):(this.div.style.width=g+"px",this.div.style.height=h+"px",this.div.style.marginLeft=d+"px",this.div.style.marginTop=l+"px")}}}},__class__:od};var kc=function(){};d["lime._internal.format.Base64"]=kc;kc.__name__=!0;kc.encode=function(a){var b=[],c=kc.DICTIONARY,e=kc.EXTENDED_DICTIONARY,g=a.length,h=Math.floor(g/3),d=2*h;b.length=2*Math.ceil(g/3);for(var l=0,f=0,k;f<
d;)k=a.b[l]<<16|a.b[l+1]<<8|a.b[l+2],b[f]=e[k>>12&4095],b[f+1]=e[k&4095],l+=3,f+=2;switch(g-3*h){case 1:k=a.b[l]<<16;b[f]=e[k>>12&4095];b[f+1]="==";break;case 2:k=a.b[l]<<16|a.b[l+1]<<8,b[f]=e[k>>12&4095],b[f+1]=c[k>>6&63]+"="}return b.join("")};var Ye=function(){};d["lime._internal.format.Deflate"]=Ye;Ye.__name__=!0;Ye.decompress=function(a){a=pako.inflateRaw(a.b.bufferValue);return Ka.ofData(a)};var Ze=function(){};d["lime._internal.format.GZip"]=Ze;Ze.__name__=!0;Ze.decompress=function(a){a=pako.ungzip(a.b.bufferValue);
return Ka.ofData(a)};var $e=function(){};d["lime._internal.format.LZMA"]=$e;$e.__name__=!0;$e.decompress=function(a){return null};var af=function(){};d["lime._internal.format.Zlib"]=af;af.__name__=!0;af.decompress=function(a){a=pako.inflate(a.b.bufferValue);return Ka.ofData(a)};var Ab=function(){};d["lime._internal.graphics.ImageCanvasUtil"]=Ab;Ab.__name__=!0;Ab.convertToCanvas=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage?(null==c.__srcCanvas&&(Ab.createCanvas(a,c.__srcImage.width,
c.__srcImage.height),c.__srcContext.drawImage(c.__srcImage,0,0)),c.__srcImage=null):null==c.__srcCanvas&&null!=c.data?(a.set_transparent(!0),Ab.createCanvas(a,c.width,c.height),Ab.createImageData(a),c.__srcContext.putImageData(c.__srcImageData,0,0)):a.type==Ub.DATA&&null!=c.__srcImageData&&a.dirty&&(c.__srcContext.putImageData(c.__srcImageData,0,0),a.dirty=!1);b?(c.data=null,c.__srcImageData=null):null==c.data&&null!=c.__srcImageData&&(c.data=c.__srcImageData.data);a.type=Ub.CANVAS};Ab.convertToData=
function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage&&Ab.convertToCanvas(a);if(null!=c.__srcCanvas&&null==c.data)Ab.createImageData(a),a.type==Ub.CANVAS&&(a.dirty=!1);else if(a.type==Ub.CANVAS&&null!=c.__srcCanvas&&a.dirty){if(null==c.__srcImageData)Ab.createImageData(a);else{c.__srcImageData=c.__srcContext.getImageData(0,0,c.width,c.height);var e=c.__srcImageData.data.buffer;e=null!=e?new Uint8Array(e):null;c.data=e}a.dirty=!1}b&&(a.buffer.__srcCanvas=null,a.buffer.__srcContext=null);
a.type=Ub.DATA};Ab.createCanvas=function(a,b,c){var e=a.buffer;null==e.__srcCanvas&&(e.__srcCanvas=window.document.createElement("canvas"),e.__srcCanvas.width=b,e.__srcCanvas.height=c,a.get_transparent()?e.__srcContext=e.__srcCanvas.getContext("2d"):(a.get_transparent()||e.__srcCanvas.setAttribute("moz-opaque","true"),e.__srcContext=e.__srcCanvas.getContext("2d",{alpha:!1})))};Ab.createImageData=function(a){a=a.buffer;if(null==a.__srcImageData){null==a.data?a.__srcImageData=a.__srcContext.getImageData(0,
0,a.width,a.height):(a.__srcImageData=a.__srcContext.createImageData(a.width,a.height),a.__srcImageData.data.set(a.data));var b=a.__srcImageData.data.buffer;b=null!=b?new Uint8Array(b):null;a.data=b}};Ab.fillRect=function(a,b,c,e){Ab.convertToCanvas(a);if(1==e){e=c>>16&255;var g=c>>8&255;var h=c&255;c=a.get_transparent()?c>>24&255:255}else e=c>>24&255,g=c>>16&255,h=c>>8&255,c=a.get_transparent()?c&255:255;0==b.x&&0==b.y&&b.width==a.width&&b.height==a.height&&a.get_transparent()&&0==c?a.buffer.__srcCanvas.width=
a.buffer.width:(255>c&&a.buffer.__srcContext.clearRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY),0<c&&(a.buffer.__srcContext.fillStyle="rgba("+e+", "+g+", "+h+", "+c/255+")",a.buffer.__srcContext.fillRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY)),a.dirty=!0,a.version++)};var bf=function(){};d["lime._internal.graphics.ImageDataUtil"]=bf;bf.__name__=!0;bf.fillRect=function(a,b,c,e){switch(e){case 1:c=(c>>>16&255)<<24|(c>>>8&255)<<16|(c&255)<<8|c>>>24&
255;break;case 2:c=(c>>>8&255)<<24|(c>>>16&255)<<16|(c>>>24&255)<<8|c&255}a.get_transparent()||(c=(c>>>24&255)<<24|(c>>>16&255)<<16|(c>>>8&255)<<8|255);var g=a.buffer.data;if(null!=g){e=a.buffer.format;var h=a.buffer.premultiplied;h&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Mb.a16=Mb.__alpha16[c&255],c=((c>>>24&255)*Mb.a16>>16&255)<<24|((c>>>16&255)*Mb.a16>>16&255)<<16|((c>>>8&255)*Mb.a16>>16&255)<<8|c&255));b=new ue(a,b);for(var d,l=0,f=b.height;l<f;){h=l++;d=b.byteOffset+b.stride*h;for(var k=0,y=
b.width;k<y;){h=k++;var r=d+4*h,E=e;h=!1;null==h&&(h=!1);null==E&&(E=0);h&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Mb.a16=Mb.__alpha16[c&255],c=((c>>>24&255)*Mb.a16>>16&255)<<24|((c>>>16&255)*Mb.a16>>16&255)<<16|((c>>>8&255)*Mb.a16>>16&255)<<8|c&255));switch(E){case 0:g[r]=c>>>24&255;g[r+1]=c>>>16&255;g[r+2]=c>>>8&255;g[r+3]=c&255;break;case 1:g[r]=c&255;g[r+1]=c>>>24&255;g[r+2]=c>>>16&255;g[r+3]=c>>>8&255;break;case 2:g[r]=c>>>8&255,g[r+1]=c>>>16&255,g[r+2]=c>>>24&255,g[r+3]=c&255}}}a.dirty=!0;a.version++}};
var ue=function(a,b){this.image=a;null==b?this.rect=a.get_rect():(0>b.x&&(b.x=0),0>b.y&&(b.y=0),b.x+b.width>a.width&&(b.width=a.width-b.x),b.y+b.height>a.height&&(b.height=a.height-b.y),0>b.width&&(b.width=0),0>b.height&&(b.height=0),this.rect=b);this.stride=a.buffer.get_stride();this.__update()};d["lime._internal.graphics._ImageDataUtil.ImageDataView"]=ue;ue.__name__=!0;ue.prototype={__update:function(){this.x=Math.ceil(this.rect.x);this.y=Math.ceil(this.rect.y);this.width=Math.floor(this.rect.width);
this.height=Math.floor(this.rect.height);this.byteOffset=this.stride*(this.y+this.image.offsetY)+4*(this.x+this.image.offsetX)},__class__:ue};var Ta=function(a,b){null==b&&(b=!1);if(null!=a)if(b)b=new zb,b.future=this,Ib.queue({promise:b,work:a});else try{this.value=a(),this.isComplete=!0}catch(c){oa.lastError=c,this.error=A.caught(c).unwrap(),this.isError=!0}};d["lime.app.Future"]=Ta;Ta.__name__=!0;Ta.withValue=function(a){var b=new Ta;b.isComplete=!0;b.value=a;return b};Ta.prototype={onComplete:function(a){null!=
a&&(this.isComplete?a(this.value):this.isError||(null==this.__completeListeners&&(this.__completeListeners=[]),this.__completeListeners.push(a)));return this},onError:function(a){null!=a&&(this.isError?a(this.error):this.isComplete||(null==this.__errorListeners&&(this.__errorListeners=[]),this.__errorListeners.push(a)));return this},onProgress:function(a){null!=a&&(null==this.__progressListeners&&(this.__progressListeners=[]),this.__progressListeners.push(a));return this},then:function(a){if(this.isComplete)return a(this.value);
if(this.isError){var b=new Ta;b.isError=!0;b.error=this.error;return b}var c=new zb;this.onError(n(c,c.error));this.onProgress(n(c,c.progress));this.onComplete(function(b){b=a(b);b.onError(n(c,c.error));b.onComplete(n(c,c.complete))});return c.future},__class__:Ta};var Ib=function(){};d["lime.app._Future.FutureWork"]=Ib;Ib.__name__=!0;Ib.queue=function(a){null==Ib.threadPool&&(Ib.threadPool=new ve,Ib.threadPool.doWork.add(Ib.threadPool_doWork),Ib.threadPool.onComplete.add(Ib.threadPool_onComplete),
Ib.threadPool.onError.add(Ib.threadPool_onError));Ib.threadPool.queue(a)};Ib.threadPool_doWork=function(a){try{var b=a.work();Ib.threadPool.sendComplete({promise:a.promise,result:b})}catch(c){oa.lastError=c,b=A.caught(c).unwrap(),Ib.threadPool.sendError({promise:a.promise,error:b})}};Ib.threadPool_onComplete=function(a){a.promise.complete(a.result)};Ib.threadPool_onError=function(a){a.promise.error(a.error)};var zb=function(){this.future=new Ta};d["lime.app.Promise"]=zb;zb.__name__=!0;zb.prototype=
{complete:function(a){if(!this.future.isError&&(this.future.isComplete=!0,this.future.value=a,null!=this.future.__completeListeners)){for(var b=0,c=this.future.__completeListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__completeListeners=null}return this},completeWith:function(a){a.onComplete(n(this,this.complete));a.onError(n(this,this.error));a.onProgress(n(this,this.progress));return this},error:function(a){if(!this.future.isComplete&&(this.future.isError=!0,this.future.error=a,null!=this.future.__errorListeners)){for(var b=
0,c=this.future.__errorListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__errorListeners=null}return this},progress:function(a,b){if(!this.future.isError&&!this.future.isComplete&&null!=this.future.__progressListeners)for(var c=0,e=this.future.__progressListeners;c<e.length;){var g=e[c];++c;g(a,b)}return this},__class__:zb};var Kc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Dynamic_Void"]=Kc;Kc.__name__=!0;Kc.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Kc};var we=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Float_Void"]=we;we.__name__=!0;we.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,
b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:we};var xe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Int_Void"]=xe;xe.__name__=!0;xe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,
0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:xe};var qd=function(){this.canceled=
!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Void"]=qd;qd.__name__=!0;qd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:qd};var ye=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseButton_Void"]=ye;ye.__name__=!0;ye.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=
0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,
g=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:ye};var ze=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseWheelMode_Void"]=ze;ze.__name__=!0;ze.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:ze};var Ae=function(){this.canceled=!1;this.__listeners=
[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Float_Float_Void"]=Ae;Ae.__name__=!0;Ae.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:Ae};var Be=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};d["lime.app._Event_Int_Float_Void"]=Be;Be.__name__=!0;Be.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Be};var rd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Int_Void"]=rd;rd.__name__=!0;rd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>
this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?
++g:this.remove(c[g]),!this.canceled););},__class__:rd};var rc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Void"]=rc;rc.__name__=!0;rc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},
remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:rc};var Ce=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_lime_ui_JoystickHatPosition_Void"]=
Ce;Ce.__name__=!0;Ce.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:Ce};var De=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Int_Int_Void"]=De;De.__name__=
!0;De.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:De};var Fd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Void"]=Fd;Fd.__name__=!0;Fd.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Fd};var Qa=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Void_Void"]=Qa;Qa.__name__=!0;Qa.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(){this.canceled=!1;for(var a=this.__listeners,b=this.__repeat,c=0;c<a.length&&(a[c](),b[c]?++c:this.remove(a[c]),!this.canceled););},__class__:Qa};var sd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};d["lime.app._Event_lime_graphics_RenderContext_Void"]=sd;sd.__name__=!0;sd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:sd};var Ee=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadAxis_Float_Void"]=Ee;Ee.__name__=!0;Ee.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=
this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=
this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Ee};var Qc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadButton_Void"]=Qc;Qc.__name__=!0;Qc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);
return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Qc};var Fe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};d["lime.app._Event_lime_ui_Gamepad_Void"]=Fe;Fe.__name__=!0;Fe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Fe};var Ge=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Joystick_Void"]=Ge;Ge.__name__=!0;Ge.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<
g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Ge};var Gd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_KeyCode_lime_ui_KeyModifier_Void"]=Gd;Gd.__name__=!0;Gd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Gd};var Lc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};d["lime.app._Event_lime_ui_Touch_Void"]=Lc;Lc.__name__=!0;Lc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Lc};var ce=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Window_Void"]=ce;ce.__name__=!0;ce.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)F.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:ce};var Ia=function(a,b,c,e,g,h,d){null==g&&(g=-1);null==e&&(e=-1);null==c&&(c=0);null==b&&(b=0);this.offsetX=b;this.offsetY=c;this.width=e;this.height=g;this.version=0;null==d&&(d=Ub.CANVAS);this.type=d;if(null==a){if(0<e&&0<g)switch(this.type._hx_index){case 0:this.buffer=new bc(null,
e,g);Ab.createCanvas(this,e,g);null!=h&&0!=h&&this.fillRect(new td(0,0,e,g),h);break;case 1:a=e*g*4,a=null!=a?new Uint8Array(a):null,this.buffer=new bc(a,e,g),null!=h&&0!=h&&this.fillRect(new td(0,0,e,g),h)}}else this.__fromImageBuffer(a)};d["lime.graphics.Image"]=Ia;Ia.__name__=!0;Ia.fromFile=function(a){if(null==a)return null;var b=new Ia;return b.__fromFile(a)?b:null};Ia.loadFromBytes=function(a){if(null==a)return Ta.withValue(null);if(Ia.__isPNG(a))var b="image/png";else if(Ia.__isJPG(a))b="image/jpeg";
else if(Ia.__isGIF(a))b="image/gif";else if(Ia.__isWebP(a))b="image/webp";else return Ta.withValue(null);return U.loadImageFromBytes(a,b)};Ia.loadFromFile=function(a){return null==a?Ta.withValue(null):U.loadImage(a)};Ia.__isGIF=function(a){if(null==a||6>a.length)return!1;a=a.getString(0,6);return"GIF87a"!=a?"GIF89a"==a:!0};Ia.__isJPG=function(a){return null==a||4>a.length?!1:255==a.b[0]&&216==a.b[1]&&255==a.b[a.length-2]?217==a.b[a.length-1]:!1};Ia.__isPNG=function(a){return null==a||8>a.length?!1:
137==a.b[0]&&80==a.b[1]&&78==a.b[2]&&71==a.b[3]&&13==a.b[4]&&10==a.b[5]&&26==a.b[6]?10==a.b[7]:!1};Ia.__isWebP=function(a){return null==a||16>a.length?!1:"RIFF"==a.getString(0,4)?"WEBP"==a.getString(8,4):!1};Ia.prototype={fillRect:function(a,b,c){a=this.__clipRect(a);if(null!=this.buffer&&null!=a)switch(this.type._hx_index){case 0:Ab.fillRect(this,a,b,c);break;case 1:Ab.convertToData(this);if(0==this.buffer.data.length)break;bf.fillRect(this,a,b,c);break;case 2:a.offset(this.offsetX,this.offsetY);
if(null==c)b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255;else switch(c){case 1:break;case 2:b=(b&255)<<24|(b>>>8&255)<<16|(b>>>16&255)<<8|b>>>24&255;break;default:b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255}this.buffer.__srcBitmapData.fillRect(a.__toFlashRectangle(),b)}},__clipRect:function(a){return null==a||0>a.x&&(a.width-=-a.x,a.x=0,0>=a.x+a.width)||0>a.y&&(a.height-=-a.y,a.y=0,0>=a.y+a.height)||a.x+a.width>=this.width&&(a.width-=a.x+a.width-this.width,0>=a.width)||a.y+
a.height>=this.height&&(a.height-=a.y+a.height-this.height,0>=a.height)?null:a},__fromBase64:function(a,b,c){var e=this,g=new Image;g.addEventListener("load",function(a){e.buffer=new bc(null,g.width,g.height);e.buffer.__srcImage=g;e.offsetX=0;e.offsetY=0;e.width=e.buffer.width;e.height=e.buffer.height;null!=c&&c(e)},!1);g.src="data:"+b+";base64,"+a},__fromBytes:function(a,b){if(Ia.__isPNG(a))var c="image/png";else if(Ia.__isJPG(a))c="image/jpeg";else if(Ia.__isGIF(a))c="image/gif";else return!1;this.__fromBase64(kc.encode(a),
c,b);return!0},__fromFile:function(a,b,c){var e=this,g=new Image;U.__isSameOrigin(a)||(g.crossOrigin="Anonymous");g.onload=function(a){e.buffer=new bc(null,g.width,g.height);e.buffer.__srcImage=g;e.width=g.width;e.height=g.height;null!=b&&b(e)};g.onerror=function(a){null!=c&&c()};g.src=a;return!0},__fromImageBuffer:function(a){this.buffer=a;null!=a&&(-1==this.width&&(this.width=a.width),-1==this.height&&(this.height=a.height))},get_data:function(){null==this.buffer.data&&0<this.buffer.width&&0<this.buffer.height&&
Ab.convertToData(this);return this.buffer.data},get_rect:function(){return new td(0,0,this.width,this.height)},get_transparent:function(){return null==this.buffer?!1:this.buffer.transparent},set_transparent:function(a){return null==this.buffer?!1:this.buffer.transparent=a},__class__:Ia,__properties__:{set_transparent:"set_transparent",get_transparent:"get_transparent",get_rect:"get_rect",get_data:"get_data"}};var bc=function(a,b,c,e,g){null==e&&(e=32);null==c&&(c=0);null==b&&(b=0);this.data=a;this.width=
b;this.height=c;this.bitsPerPixel=e;this.format=null==g?0:g;this.premultiplied=!1;this.transparent=!0};d["lime.graphics.ImageBuffer"]=bc;bc.__name__=!0;bc.prototype={get_stride:function(){return this.width*(this.bitsPerPixel/8|0)},__class__:bc,__properties__:{get_stride:"get_stride"}};var Ub=u["lime.graphics.ImageType"]={__ename__:!0,__constructs__:null,CANVAS:{_hx_name:"CANVAS",_hx_index:0,__enum__:"lime.graphics.ImageType",toString:k},DATA:{_hx_name:"DATA",_hx_index:1,__enum__:"lime.graphics.ImageType",
toString:k},FLASH:{_hx_name:"FLASH",_hx_index:2,__enum__:"lime.graphics.ImageType",toString:k},CUSTOM:{_hx_name:"CUSTOM",_hx_index:3,__enum__:"lime.graphics.ImageType",toString:k}};Ub.__constructs__=[Ub.CANVAS,Ub.DATA,Ub.FLASH,Ub.CUSTOM];var te=function(){};d["lime.graphics.RenderContext"]=te;te.__name__=!0;te.prototype={__class__:te};var vf={fromWebGL2RenderContext:function(a){return a}},pd=function(){};d["lime.graphics.opengl.GL"]=pd;pd.__name__=!0;var Mb={},td=function(a,b,c,e){null==e&&(e=0);
null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.width=c;this.height=e};d["lime.math.Rectangle"]=td;td.__name__=!0;td.prototype={offset:function(a,b){this.x+=a;this.y+=b},__toFlashRectangle:function(){return null},__class__:td};var Xa=function(){};d["lime.media.AudioBuffer"]=Xa;Xa.__name__=!0;Xa.fromBytes=function(a){if(null==a)return null;var b=new Xa;b.set_src(new Howl({src:["data:"+Xa.__getCodec(a)+";base64,"+kc.encode(a)],html5:!0,preload:!1}));return b};Xa.fromFile=function(a){if(null==
a)return null;var b=new Xa;b.__srcHowl=new Howl({src:[a],preload:!1});return b};Xa.fromFiles=function(a){var b=new Xa;b.__srcHowl=new Howl({src:a,preload:!1});return b};Xa.loadFromFile=function(a){var b=new zb,c=Xa.fromFile(a);null!=c?null!=c&&(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(a,c){b.error(c)}),c.__srcHowl.load()):b.error(null);return b.future};Xa.loadFromFiles=function(a){var b=new zb,c=Xa.fromFiles(a);null!=c?(c.__srcHowl.on("load",function(){b.complete(c)}),
c.__srcHowl.on("loaderror",function(){b.error(null)}),c.__srcHowl.load()):b.error(null);return b.future};Xa.__getCodec=function(a){switch(a.getString(0,4)){case "OggS":return"audio/ogg";case "RIFF":if("WAVE"==a.getString(8,4))return"audio/wav";var b=a.b[1],c=a.b[2];switch(a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}break;case "fLaC":return"audio/flac";default:switch(b=a.b[1],c=a.b[2],a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";
break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}}Ja.error("Unsupported sound format",{fileName:"lime/media/AudioBuffer.hx",lineNumber:362,className:"lime.media.AudioBuffer",methodName:"__getCodec"});return null};Xa.prototype={set_src:function(a){return this.__srcHowl=a},__class__:Xa,__properties__:{set_src:"set_src"}};var Ie=function(a){if("custom"!=a){if(null==a||"web"==a)try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.web=new window.AudioContext,
this.type="web"}catch(b){oa.lastError=b}null==this.web&&"web"!=a&&(this.html5=new He,this.type="html5")}else this.type="custom"};d["lime.media.AudioContext"]=Ie;Ie.__name__=!0;Ie.prototype={__class__:Ie};var lc=function(){};d["lime.media.AudioManager"]=lc;lc.__name__=!0;lc.init=function(a){if(null==lc.context){if(null==a&&(lc.context=new Ie,a=lc.context,"openal"==a.type)){var b=a.openal,c=b.openDevice();c=b.createContext(c);b.makeContextCurrent(c);b.processContext(c)}lc.context=a}};var He=function(){};
d["lime.media.HTML5AudioContext"]=He;He.__name__=!0;He.prototype={__class__:He};var cf=function(){};d["lime.media.OpenALAudioContext"]=cf;cf.__name__=!0;cf.prototype={createContext:function(a,b){return gc.createContext(a,b)},makeContextCurrent:function(a){return gc.makeContextCurrent(a)},openDevice:function(a){return gc.openDevice(a)},processContext:function(a){gc.processContext(a)},__class__:cf};var gc=function(){};d["lime.media.openal.ALC"]=gc;gc.__name__=!0;gc.createContext=function(a,b){return null};
gc.makeContextCurrent=function(a){return!1};gc.openDevice=function(a){return null};gc.processContext=function(a){};var Hd=function(){};d["lime.net._IHTTPRequest"]=Hd;Hd.__name__=!0;Hd.__isInterface__=!0;Hd.prototype={__class__:Hd};var Nb=function(a){this.uri=a;this.contentType="application/x-www-form-urlencoded";this.followRedirects=!0;this.enableResponseHeaders=!1;this.formData=new Y;this.headers=[];this.method="GET";this.timeout=3E4;this.withCredentials=!1;this.__backend=new U;this.__backend.init(this)};
d["lime.net._HTTPRequest.AbstractHTTPRequest"]=Nb;Nb.__name__=!0;Nb.__interfaces__=[Hd];Nb.prototype={__class__:Nb};var Vc=function(a){Nb.call(this,a)};d["lime.net._HTTPRequest_Bytes"]=Vc;Vc.__name__=!0;Vc.__super__=Nb;Vc.prototype=G(Nb.prototype,{fromBytes:function(a){return a},load:function(a){var b=this;null!=a&&(this.uri=a);var c=new zb;a=this.__backend.loadData(this.uri);a.onProgress(n(c,c.progress));a.onError(n(c,c.error));a.onComplete(function(a){b.responseData=b.fromBytes(a);c.complete(b.responseData)});
return c.future},__class__:Vc});var ad=function(a){Nb.call(this,a)};d["lime.net._HTTPRequest_String"]=ad;ad.__name__=!0;ad.__super__=Nb;ad.prototype=G(Nb.prototype,{load:function(a){var b=this;null!=a&&(this.uri=a);var c=new zb;a=this.__backend.loadText(this.uri);a.onProgress(n(c,c.progress));a.onError(n(c,c.error));a.onComplete(function(a){b.responseData=a;c.complete(b.responseData)});return c.future},__class__:ad});var se=function(a,b){null==b&&(b="");this.name=a;this.value=b};d["lime.net.HTTPRequestHeader"]=
se;se.__name__=!0;se.prototype={__class__:se};var ud=function(a){Nb.call(this,a)};d["lime.net._HTTPRequest_lime_utils_Bytes"]=ud;ud.__name__=!0;ud.__super__=Vc;ud.prototype=G(Vc.prototype,{fromBytes:function(a){return Yb.fromBytes(a)},__class__:ud});var mc=function(a,b){this.onUpdate=new we;this.type=a;this.id=b};d["lime.system.Sensor"]=mc;mc.__name__=!0;mc.registerSensor=function(a,b){a=new mc(a,b);mc.sensors.push(a);return mc.sensorByID.h[b]=a};mc.prototype={__class__:mc};var kf=u["lime.system.SensorType"]=
{__ename__:!0,__constructs__:null,ACCELEROMETER:{_hx_name:"ACCELEROMETER",_hx_index:0,__enum__:"lime.system.SensorType",toString:k}};kf.__constructs__=[kf.ACCELEROMETER];var Qb=function(){};d["lime.system.System"]=Qb;Qb.__name__=!0;Qb.embed=m.lime.embed=function(a,b,c,e,g){if(null!=Qb.__applicationEntryPoint&&Object.prototype.hasOwnProperty.call(Qb.__applicationEntryPoint.h,a)){var h="string"==typeof b?window.document.getElementById(b):null==b?window.document.createElement("div"):b;null==h?window.console.log("[lime.embed] ERROR: Cannot find target element: "+
x.string(b)):(null==c&&(c=0),null==e&&(e=0),null==g&&(g={}),Object.prototype.hasOwnProperty.call(g,"background")&&"string"==typeof g.background&&(b=Z.replace(x.string(g.background),"#",""),-1<b.indexOf("0x")?g.background=x.parseInt(b):g.background=x.parseInt("0x"+b)),g.element=h,g.width=c,g.height=e,Qb.__applicationEntryPoint.h[a](g))}};Qb.exit=function(a){};Qb.__registerEntryPoint=function(a,b){null==Qb.__applicationEntryPoint&&(Qb.__applicationEntryPoint=new Y);Qb.__applicationEntryPoint.h[a]=b};
var ve=function(a,b){null==b&&(b=1);null==a&&(a=0);this.onRun=new Kc;this.onError=new Kc;this.onComplete=new Kc;this.doWork=new Kc;this.minThreads=a;this.maxThreads=b;this.currentThreads=0};d["lime.system.ThreadPool"]=ve;ve.__name__=!0;ve.prototype={queue:function(a){this.runWork(a)},sendComplete:function(a){this.onComplete.dispatch(a)},sendError:function(a){this.onError.dispatch(a)},runWork:function(a){this.onRun.dispatch(a);this.doWork.dispatch(a)},__class__:ve};var tb=function(a){null!=a&&(this.name=
a);this.__init||(void 0==this.ascender&&(this.ascender=0),void 0==this.descender&&(this.descender=0),void 0==this.height&&(this.height=0),void 0==this.numGlyphs&&(this.numGlyphs=0),void 0==this.underlinePosition&&(this.underlinePosition=0),void 0==this.underlineThickness&&(this.underlineThickness=0),void 0==this.unitsPerEM&&(this.unitsPerEM=0),null!=this.__fontID?R.isLocal(this.__fontID)&&this.__fromBytes(R.getBytes(this.__fontID)):null!=this.__fontPath&&this.__fromFile(this.__fontPath))};d["lime.text.Font"]=
tb;tb.__name__=!0;tb.fromFile=function(a){if(null==a)return null;var b=new tb;b.__fromFile(a);return b};tb.loadFromName=function(a){return(new tb).__loadFromName(a)};tb.__measureFontNode=function(a){var b=window.document.createElement("span");b.setAttribute("aria-hidden","true");var c=window.document.createTextNode("BESbswy");b.appendChild(c);c=b.style;c.display="block";c.position="absolute";c.top="-9999px";c.left="-9999px";c.fontSize="300px";c.width="auto";c.height="auto";c.lineHeight="normal";c.margin=
"0";c.padding="0";c.fontVariant="normal";c.whiteSpace="nowrap";c.fontFamily=a;window.document.body.appendChild(b);return b};tb.prototype={__fromBytes:function(a){this.__fontPath=null},__fromFile:function(a){this.__fontPath=a},__loadFromName:function(a){var b=this,c=new zb;this.name=a;var e=t.navigator.userAgent.toLowerCase(),g=0<=e.indexOf(" safari/")&&0>e.indexOf(" chrome/");e=(new M("(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)","i")).match(e);if(!g&&!e&&window.document.fonts&&(f=window.document.fonts,
n(f,f.load)))window.document.fonts.load("1em '"+a+"'").then(function(a){c.complete(b)},function(e){Ja.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:513,className:"lime.text.Font",methodName:"__loadFromName"});c.complete(b)});else{var h=tb.__measureFontNode("'"+a+"', sans-serif"),d=tb.__measureFontNode("'"+a+"', serif"),l=h.offsetWidth,k=d.offsetWidth,y=-1,E=0,r,v;y=window.setInterval(function(){E+=1;r=h.offsetWidth!=l||d.offsetWidth!=k;v=3E3<=50*E;if(r||v)window.clearInterval(y),
h.parentNode.removeChild(h),d.parentNode.removeChild(d),d=h=null,v&&Ja.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:548,className:"lime.text.Font",methodName:"__loadFromName"}),c.complete(b)},50)}return c.future},__class__:tb};var Ya=function(a){this.onDisconnect=new Qa;this.onButtonUp=new Qc;this.onButtonDown=new Qc;this.onAxisMove=new Ee;this.id=a;this.connected=!0};d["lime.ui.Gamepad"]=Ya;Ya.__name__=!0;Ya.__connect=function(a){if(!Ya.devices.h.hasOwnProperty(a)){var b=
new Ya(a);Ya.devices.h[a]=b;Ya.onConnect.dispatch(b)}};Ya.__disconnect=function(a){var b=Ya.devices.h[a];null!=b&&(b.connected=!1);Ya.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};Ya.prototype={__class__:Ya};var jb=function(a){this.onTrackballMove=new Ae;this.onHatMove=new Ce;this.onDisconnect=new Qa;this.onButtonUp=new rc;this.onButtonDown=new rc;this.onAxisMove=new Be;this.id=a;this.connected=!0};d["lime.ui.Joystick"]=jb;jb.__name__=!0;jb.__connect=function(a){if(!jb.devices.h.hasOwnProperty(a)){var b=
new jb(a);jb.devices.h[a]=b;jb.onConnect.dispatch(b)}};jb.__disconnect=function(a){var b=jb.devices.h[a];null!=b&&(b.connected=!1);jb.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};jb.__getDeviceData=function(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():null};jb.prototype={__class__:jb};var Tb=u["lime.ui.MouseCursor"]={__ename__:!0,__constructs__:null,ARROW:{_hx_name:"ARROW",_hx_index:0,__enum__:"lime.ui.MouseCursor",toString:k},
CROSSHAIR:{_hx_name:"CROSSHAIR",_hx_index:1,__enum__:"lime.ui.MouseCursor",toString:k},DEFAULT:{_hx_name:"DEFAULT",_hx_index:2,__enum__:"lime.ui.MouseCursor",toString:k},MOVE:{_hx_name:"MOVE",_hx_index:3,__enum__:"lime.ui.MouseCursor",toString:k},POINTER:{_hx_name:"POINTER",_hx_index:4,__enum__:"lime.ui.MouseCursor",toString:k},RESIZE_NESW:{_hx_name:"RESIZE_NESW",_hx_index:5,__enum__:"lime.ui.MouseCursor",toString:k},RESIZE_NS:{_hx_name:"RESIZE_NS",_hx_index:6,__enum__:"lime.ui.MouseCursor",toString:k},
RESIZE_NWSE:{_hx_name:"RESIZE_NWSE",_hx_index:7,__enum__:"lime.ui.MouseCursor",toString:k},RESIZE_WE:{_hx_name:"RESIZE_WE",_hx_index:8,__enum__:"lime.ui.MouseCursor",toString:k},TEXT:{_hx_name:"TEXT",_hx_index:9,__enum__:"lime.ui.MouseCursor",toString:k},WAIT:{_hx_name:"WAIT",_hx_index:10,__enum__:"lime.ui.MouseCursor",toString:k},WAIT_ARROW:{_hx_name:"WAIT_ARROW",_hx_index:11,__enum__:"lime.ui.MouseCursor",toString:k},CUSTOM:{_hx_name:"CUSTOM",_hx_index:12,__enum__:"lime.ui.MouseCursor",toString:k}};
Tb.__constructs__=[Tb.ARROW,Tb.CROSSHAIR,Tb.DEFAULT,Tb.MOVE,Tb.POINTER,Tb.RESIZE_NESW,Tb.RESIZE_NS,Tb.RESIZE_NWSE,Tb.RESIZE_WE,Tb.TEXT,Tb.WAIT,Tb.WAIT_ARROW,Tb.CUSTOM];var cc=u["lime.ui.MouseWheelMode"]={__ename__:!0,__constructs__:null,PIXELS:{_hx_name:"PIXELS",_hx_index:0,__enum__:"lime.ui.MouseWheelMode",toString:k},LINES:{_hx_name:"LINES",_hx_index:1,__enum__:"lime.ui.MouseWheelMode",toString:k},PAGES:{_hx_name:"PAGES",_hx_index:2,__enum__:"lime.ui.MouseWheelMode",toString:k},UNKNOWN:{_hx_name:"UNKNOWN",
_hx_index:3,__enum__:"lime.ui.MouseWheelMode",toString:k}};cc.__constructs__=[cc.PIXELS,cc.LINES,cc.PAGES,cc.UNKNOWN];var ub=function(a,b,c,e,g,h,d){this.x=a;this.y=b;this.id=c;this.dx=e;this.dy=g;this.pressure=h;this.device=d};d["lime.ui.Touch"]=ub;ub.__name__=!0;ub.prototype={__class__:ub};var ee=function(a,b){this.onTextInput=new Fd;this.onTextEdit=new De;this.onRestore=new Qa;this.onResize=new rd;this.onRenderContextRestored=new sd;this.onRenderContextLost=new Qa;this.onRender=new sd;this.onMove=
new qd;this.onMouseWheel=new ze;this.onMouseUp=new xe;this.onMouseMoveRelative=new qd;this.onMouseMove=new qd;this.onMouseDown=new ye;this.onMinimize=new Qa;this.onLeave=new Qa;this.onKeyUp=new Gd;this.onKeyDown=new Gd;this.onFullscreen=new Qa;this.onFocusOut=new Qa;this.onFocusIn=new Qa;this.onExpose=new Qa;this.onEnter=new Qa;this.onDropFile=new Fd;this.onDeactivate=new Qa;this.onClose=new Qa;this.onActivate=new Qa;this.application=a;this.__attributes=null!=b?b:{};Object.prototype.hasOwnProperty.call(this.__attributes,
"parameters")&&(this.parameters=this.__attributes.parameters);this.__height=this.__width=0;this.__fullscreen=!1;this.__scale=1;this.__y=this.__x=0;this.__title="";this.id=-1;this.__backend=new od(this)};d["lime.ui.Window"]=ee;ee.__name__=!0;ee.prototype={close:function(){this.__backend.close()},__class__:ee};var dc=function(){this.data=new Y;this.paths=[]};d["lime.utils.AssetBundle"]=dc;dc.__name__=!0;dc.fromBytes=function(a){a=new Uc(a);return dc.__extractBundle(a)};dc.loadFromBytes=function(a){return Ta.withValue(dc.fromBytes(a))};
dc.loadFromFile=function(a){return Yb.loadFromFile(a).then(dc.loadFromBytes)};dc.__extractBundle=function(a){var b=$c.readZip(a);a=new dc;for(b=b.h;null!=b;){var c=b.item;b=b.next;if(c.compressed){var e=a.data,g=c.fileName,h=Yb.decompress(c.data,vd.DEFLATE);e.h[g]=h}else a.data.h[c.fileName]=c.data;a.paths.push(c.fileName)}return a};dc.prototype={__class__:dc};var Je=function(){this.enabled=!0;this.audio=new Y;this.font=new Y;this.image=new Y;this.version=849983};d["lime.utils.AssetCache"]=Je;Je.__name__=
!0;Je.prototype={exists:function(a,b){return("IMAGE"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.image.h,a)||("FONT"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.font.h,a)||("SOUND"==b||"MUSIC"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.audio.h,a)?!0:!1},set:function(a,b,c){switch(b){case "FONT":this.font.h[a]=c;break;case "IMAGE":if(!(c instanceof Ia))throw A.thrown("Cannot cache non-Image asset: "+x.string(c)+" as Image");this.image.h[a]=c;break;case "MUSIC":case "SOUND":if(!(c instanceof
Xa))throw A.thrown("Cannot cache non-AudioBuffer asset: "+x.string(c)+" as AudioBuffer");this.audio.h[a]=c;break;default:throw A.thrown(b+" assets are not cachable");}},clear:function(a){if(null==a)this.audio=new Y,this.font=new Y,this.image=new Y;else{var b=this.audio.h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var g=b[e++];if(Z.startsWith(g,a)){var h=this.audio;Object.prototype.hasOwnProperty.call(h.h,g)&&delete h.h[g]}}b=this.font.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)g=b[e++],Z.startsWith(g,
a)&&(h=this.font,Object.prototype.hasOwnProperty.call(h.h,g)&&delete h.h[g]);b=this.image.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)g=b[e++],Z.startsWith(g,a)&&(h=this.image,Object.prototype.hasOwnProperty.call(h.h,g)&&delete h.h[g])}},__class__:Je};var qb=function(){this.types=new Y;this.sizes=new Y;this.preload=new Y;this.paths=new Y;this.pathGroups=new Y;this.classTypes=new Y;this.cachedText=new Y;this.cachedImages=new Y;this.cachedFonts=new Y;this.cachedBytes=new Y;this.cachedAudioBuffers=new Y;
this.onChange=new Qa;this.bytesTotal=this.bytesLoaded=0};d["lime.utils.AssetLibrary"]=qb;qb.__name__=!0;qb.fromBundle=function(a){if(Object.prototype.hasOwnProperty.call(a.data.h,"library.json")){var b=Jb.fromBytes(a.data.h["library.json"]);if(null!=b){if(null==b.libraryType)var c=new qb;else if(c=d[b.libraryType],null!=c)c=ea.createInstance(c,b.libraryArgs);else return Ja.warn("Could not find library type: "+b.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:122,className:"lime.utils.AssetLibrary",
methodName:"fromBundle"}),null;c.__fromBundle(a,b);return c}}else return c=new qb,c.__fromBundle(a),c;return null};qb.fromManifest=function(a){if(null==a)return null;if(null==a.libraryType)var b=new qb;else if(b=d[a.libraryType],null!=b)b=ea.createInstance(b,a.libraryArgs);else return Ja.warn("Could not find library type: "+a.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:160,className:"lime.utils.AssetLibrary",methodName:"fromManifest"}),null;b.__fromManifest(a);return b};qb.prototype=
{exists:function(a,b){b=null!=b?Aa.__cast(b,String):null;a=this.types.h[a];return null==a||a!=b&&("SOUND"!=b&&"MUSIC"!=b||"MUSIC"!=a&&"SOUND"!=a)&&"BINARY"!=b&&null!=b&&("BINARY"!=a||"TEXT"!=b)?!1:!0},getAsset:function(a,b){switch(b){case "BINARY":return this.getBytes(a);case "FONT":return this.getFont(a);case "IMAGE":return this.getImage(a);case "MUSIC":case "SOUND":return this.getAudioBuffer(a);case "TEMPLATE":throw A.thrown("Not sure how to get template: "+a);case "TEXT":return this.getText(a);
default:throw A.thrown("Unknown asset type: "+b);}},getAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?this.cachedAudioBuffers.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Xa.fromBytes(Aa.__cast(ea.createInstance(this.classTypes.h[a],[]),Ka)):Xa.fromFile(this.paths.h[a])},getBytes:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a))return this.cachedBytes.h[a];if(Object.prototype.hasOwnProperty.call(this.cachedText.h,
a)){var b=Yb.ofString(this.cachedText.h[a]);return this.cachedBytes.h[a]=b}return Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Aa.__cast(ea.createInstance(this.classTypes.h[a],[]),Ka):Yb.fromFile(this.paths.h[a])},getFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?this.cachedFonts.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Aa.__cast(ea.createInstance(this.classTypes.h[a],[]),tb):tb.fromFile(this.paths.h[a])},getImage:function(a){return Object.prototype.hasOwnProperty.call(this.cachedImages.h,
a)?this.cachedImages.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Aa.__cast(ea.createInstance(this.classTypes.h[a],[]),Ia):Ia.fromFile(this.paths.h[a])},getText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return this.cachedText.h[a];a=this.getBytes(a);return null==a?null:a.getString(0,a.length)},isLocal:function(a,b){if(Object.prototype.hasOwnProperty.call(this.classTypes.h,a))return!0;b=null!=b?Aa.__cast(b,String):null;if(null==b)return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,
a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a);switch(b){case "FONT":return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a);case "IMAGE":return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a);case "MUSIC":case "SOUND":return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a);default:return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a)}},load:function(){if(this.loaded)return Ta.withValue(this);
if(null==this.promise){this.promise=new zb;this.bytesLoadedCache=new Y;this.assetsLoaded=0;this.assetsTotal=1;for(var a=Object.keys(this.preload.h),b=a.length,c=0;c<b;){var e=a[c++];if(this.preload.h[e]){Ja.verbose("Preloading asset: "+e+" ["+this.types.h[e]+"]",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:405,className:"lime.utils.AssetLibrary",methodName:"load"});var g=this.types.h[e];if(null!=g)switch(g){case "BINARY":this.assetsTotal++;g=this.loadBytes(e);g.onProgress(function(a,b){return function(c,
e){b[0](a[0],c,e)}}([e],[n(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.load_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.loadBytes_onComplete)]));break;case "FONT":this.assetsTotal++;g=this.loadFont(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[n(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.load_onError)]));
g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.loadFont_onComplete)]));break;case "IMAGE":this.assetsTotal++;g=this.loadImage(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[n(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.load_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.loadImage_onComplete)]));break;case "MUSIC":case "SOUND":this.assetsTotal++;
g=this.loadAudioBuffer(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[n(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.loadAudioBuffer_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.loadAudioBuffer_onComplete)]));break;case "TEXT":this.assetsTotal++,g=this.loadText(e),g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[n(this,this.load_onProgress)])),g.onError(function(a,
b){return function(c){b[0](a[0],c)}}([e],[n(this,this.load_onError)])),g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[n(this,this.loadText_onComplete)]))}}}this.__assetLoaded(null)}return this.promise.future},loadAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?Ta.withValue(this.cachedAudioBuffers.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ta.withValue(ea.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.pathGroups.h,
a)?Xa.loadFromFiles(this.pathGroups.h[a]):Xa.loadFromFile(this.paths.h[a])},loadBytes:function(a){return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ta.withValue(this.cachedBytes.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ta.withValue(ea.createInstance(this.classTypes.h[a],[])):Yb.loadFromFile(this.paths.h[a])},loadFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?Ta.withValue(this.cachedFonts.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,
a)?(a=ea.createInstance(this.classTypes.h[a],[]),a.__loadFromName(a.name)):tb.loadFromName(this.paths.h[a])},loadImage:function(a){var b=this;return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a)?Ta.withValue(this.cachedImages.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ta.withValue(ea.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ia.loadFromBytes(this.cachedBytes.h[a]).then(function(c){var e=b.cachedBytes;Object.prototype.hasOwnProperty.call(e.h,
a)&&delete e.h[a];b.cachedImages.h[a]=c;return Ta.withValue(c)}):Ia.loadFromFile(this.paths.h[a])},loadText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return Ta.withValue(this.cachedText.h[a]);if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)||Object.prototype.hasOwnProperty.call(this.classTypes.h,a)){var b=this.getBytes(a);if(null==b)return Ta.withValue(null);b=b.getString(0,b.length);this.cachedText.h[a]=b;return Ta.withValue(b)}return(new ad).load(this.paths.h[a])},
unload:function(){},__assetLoaded:function(a){this.assetsLoaded++;null!=a&&Ja.verbose("Loaded asset: "+a+" ["+this.types.h[a]+"] ("+(this.assetsLoaded-1)+"/"+(this.assetsTotal-1)+")",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:619,className:"lime.utils.AssetLibrary",methodName:"__assetLoaded"});if(null!=a){var b=Object.prototype.hasOwnProperty.call(this.sizes.h,a)?this.sizes.h[a]:0;if(Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)){var c=this.bytesLoadedCache.h[a];c<b&&(this.bytesLoaded+=
b-c)}else this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b}this.assetsLoaded<this.assetsTotal?this.promise.progress(this.bytesLoaded,this.bytesTotal):(this.loaded=!0,this.promise.progress(this.bytesTotal,this.bytesTotal),this.promise.complete(this))},__cacheBreak:function(a){return R.__cacheBreak(a)},__fromBundle:function(a,b){if(null!=b){var c=0;for(b=b.assets;c<b.length;){var e=b[c];++c;var g=Object.prototype.hasOwnProperty.call(e,"id")?e.id:e.path;var h=a.data.h[e.path];if(Object.prototype.hasOwnProperty.call(e,
"type")){var d=e.type;"TEXT"==d?this.cachedText.h[g]=null!=h?x.string(h):null:this.cachedBytes.h[g]=h;this.types.h[g]=e.type}else this.cachedBytes.h[g]=h,this.types.h[g]="BINARY"}}else for(c=0,b=a.paths;c<b.length;)g=b[c],++c,this.cachedBytes.h[g]=a.data.h[g],this.types.h[g]="BINARY"},__fromManifest:function(a){var b=2<=a.version,c=a.rootPath;null==c&&(c="");""!=c&&(c+="/");for(var e=0,g=a.assets;e<g.length;){var h=g[e];++e;var f=b&&Object.prototype.hasOwnProperty.call(h,"size")?h.size:100;var l=
Object.prototype.hasOwnProperty.call(h,"id")?h.id:h.path;if(Object.prototype.hasOwnProperty.call(h,"path")){var k=this.paths;var y=this.__cacheBreak(this.__resolvePath(c+x.string(F.field(h,"path"))));k.h[l]=y}if(Object.prototype.hasOwnProperty.call(h,"pathGroup")){k=F.field(h,"pathGroup");y=0;for(var E=k.length;y<E;){var r=y++;k[r]=this.__cacheBreak(this.__resolvePath(c+k[r]))}this.pathGroups.h[l]=k}this.sizes.h[l]=f;this.types.h[l]=h.type;Object.prototype.hasOwnProperty.call(h,"preload")&&(this.preload.h[l]=
F.field(h,"preload"));Object.prototype.hasOwnProperty.call(h,"className")&&(f=F.field(h,"className"),f=d[f],this.classTypes.h[l]=f)}e=this.bytesTotal=0;for(g=a.assets;e<g.length;)h=g[e],++e,l=Object.prototype.hasOwnProperty.call(h,"id")?h.id:h.path,Object.prototype.hasOwnProperty.call(this.preload.h,l)&&this.preload.h[l]&&Object.prototype.hasOwnProperty.call(this.sizes.h,l)&&(this.bytesTotal+=this.sizes.h[l])},__resolvePath:function(a){a=Z.replace(a,"\\","/");var b=a.indexOf(":");Z.startsWith(a,"http")&&
0<b?(b+=3,a=I.substr(a,0,b)+Z.replace(I.substr(a,b,null),"//","/")):a=Z.replace(a,"//","/");if(-1<a.indexOf("./")){a=a.split("/");b=[];for(var c=0,e=a.length;c<e;){var g=c++;".."==a[g]?0==g||".."==b[g-1]?b.push(".."):b.pop():"."==a[g]?0==g&&b.push("."):b.push(a[g])}a=b.join("/")}return a},loadAudioBuffer_onComplete:function(a,b){this.cachedAudioBuffers.h[a]=b;if(Object.prototype.hasOwnProperty.call(this.pathGroups.h,a))for(var c=this.pathGroups.h[a],e=Object.keys(this.pathGroups.h),g=e.length,h=0;h<
g;){var d=e[h++];if(d!=a)for(var l=0;l<c.length;){var f=c[l];++l;if(-1<this.pathGroups.h[d].indexOf(f)){this.cachedAudioBuffers.h[d]=b;break}}}this.__assetLoaded(a)},loadAudioBuffer_onError:function(a,b){null!=b&&""!=b?Ja.warn('Could not load "'+a+'": '+x.string(b),{fileName:"lime/utils/AssetLibrary.hx",lineNumber:865,className:"lime.utils.AssetLibrary",methodName:"loadAudioBuffer_onError"}):Ja.warn('Could not load "'+a+'"',{fileName:"lime/utils/AssetLibrary.hx",lineNumber:869,className:"lime.utils.AssetLibrary",
methodName:"loadAudioBuffer_onError"});this.loadAudioBuffer_onComplete(a,new Xa)},loadBytes_onComplete:function(a,b){this.cachedBytes.h[a]=b;this.__assetLoaded(a)},loadFont_onComplete:function(a,b){this.cachedFonts.h[a]=b;this.__assetLoaded(a)},loadImage_onComplete:function(a,b){this.cachedImages.h[a]=b;this.__assetLoaded(a)},loadText_onComplete:function(a,b){this.cachedText.h[a]=b;this.__assetLoaded(a)},load_onError:function(a,b){null!=b&&""!=b?this.promise.error('Error loading asset "'+a+'": '+
x.string(b)):this.promise.error('Error loading asset "'+a+'"')},load_onProgress:function(a,b,c){if(0<b){var e=this.sizes.h[a];0<c?(b/=c,1<b&&(b=1),b=Math.floor(b*e)):b>e&&(b=e);Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)?(e=this.bytesLoadedCache.h[a],b!=e&&(this.bytesLoaded+=b-e)):this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b;this.promise.progress(this.bytesLoaded,this.bytesTotal)}},__class__:qb};var Jb=function(){this.assets=[];this.libraryArgs=[];this.version=2};d["lime.utils.AssetManifest"]=
Jb;Jb.__name__=!0;Jb.fromBytes=function(a,b){return null!=a?Jb.parse(a.getString(0,a.length),b):null};Jb.loadFromFile=function(a,b){a=Jb.__resolvePath(a);b=Jb.__resolveRootPath(b,a);return null==a?null:Yb.loadFromFile(a).then(function(a){return Ta.withValue(Jb.fromBytes(a,b))})};Jb.parse=function(a,b){if(null==a||""==a)return null;a=JSON.parse(a);var c=new Jb;Object.prototype.hasOwnProperty.call(a,"name")&&(c.name=a.name);Object.prototype.hasOwnProperty.call(a,"libraryType")&&(c.libraryType=a.libraryType);
Object.prototype.hasOwnProperty.call(a,"libraryArgs")&&(c.libraryArgs=a.libraryArgs);if(Object.prototype.hasOwnProperty.call(a,"assets")){var e=a.assets;Object.prototype.hasOwnProperty.call(a,"version")&&2>=a.version?c.assets=sb.run(e):c.assets=e}Object.prototype.hasOwnProperty.call(a,"rootPath")&&(c.rootPath=a.rootPath);null!=b&&""!=b&&(c.rootPath=null==c.rootPath||""==c.rootPath?b:b+"/"+c.rootPath);return c};Jb.__resolvePath=function(a){if(null==a)return null;var b=a.indexOf("?");var c=-1<b?I.substr(a,
0,b):a;for(c=Z.replace(c,"\\","/");Z.endsWith(c,"/");)c=I.substr(c,0,c.length-1);return Z.endsWith(c,".bundle")?-1<b?c+"/library.json"+I.substr(a,b,null):c+"/library.json":a};Jb.__resolveRootPath=function(a,b){if(null!=a)return a;a=b.indexOf("?");a=-1<a?I.substr(b,0,a):b;for(a=Z.replace(a,"\\","/");Z.endsWith(a,"/");){if("/"==a)return a;a=I.substr(a,0,a.length-1)}return Z.endsWith(a,".bundle")?a:Ic.directory(a)};Jb.prototype={__class__:Jb};var R=function(){};d["lime.utils.Assets"]=R;R.__name__=!0;
R.getAsset=function(a,b,c){if(c&&R.cache.enabled)switch(b){case "BINARY":case "TEXT":c=!1;break;case "FONT":var e=R.cache.font.h[a];if(null!=e)return e;break;case "IMAGE":e=R.cache.image.h[a];if(R.isValidImage(e))return e;break;case "MUSIC":case "SOUND":e=R.cache.audio.h[a];if(R.isValidAudio(e))return e;break;case "TEMPLATE":throw A.thrown("Not sure how to get template: "+a);default:return null}var g=a.indexOf(":");e=a.substring(0,g);g=a.substring(g+1);var h=R.getLibrary(e);if(null!=h)if(h.exists(g,
b)){if(h.isLocal(g,b))return e=h.getAsset(g,b),c&&R.cache.enabled&&R.cache.set(a,b,e),e;Ja.error(b+' asset "'+a+'" exists, but only asynchronously',{fileName:"lime/utils/Assets.hx",lineNumber:133,className:"lime.utils.Assets",methodName:"getAsset"})}else Ja.error("There is no "+b+' asset with an ID of "'+a+'"',{fileName:"lime/utils/Assets.hx",lineNumber:138,className:"lime.utils.Assets",methodName:"getAsset"});else Ja.error(R.__libraryNotFound(e),{fileName:"lime/utils/Assets.hx",lineNumber:143,className:"lime.utils.Assets",
methodName:"getAsset"});return null};R.getBytes=function(a){return R.getAsset(a,"BINARY",!1)};R.getLibrary=function(a){if(null==a||""==a)a="default";return R.libraries.h[a]};R.isLocal=function(a,b,c){null==c&&(c=!0);if(c&&R.cache.enabled&&R.cache.exists(a,b))return!0;var e=a.indexOf(":");c=a.substring(0,e);a=a.substring(e+1);c=R.getLibrary(c);return null!=c?c.isLocal(a,b):!1};R.isValidAudio=function(a){return null!=a};R.isValidImage=function(a){return null!=a?null!=a.buffer:!1};R.loadLibrary=function(a){var b=
new zb,c=R.getLibrary(a);if(null!=c)return c.load();c=a;var e=null;if(Object.prototype.hasOwnProperty.call(R.bundlePaths.h,a))dc.loadFromFile(R.bundlePaths.h[a]).onComplete(function(c){null==c?b.error('Cannot load bundle for library "'+a+'"'):(c=qb.fromBundle(c),null==c?b.error('Cannot open library "'+a+'"'):(R.libraries.h[a]=c,c.onChange.add((f=R.onChange,n(f,f.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});else Object.prototype.hasOwnProperty.call(R.libraryPaths.h,
a)?(c=R.libraryPaths.h[a],e=Ic.directory(c)):(Z.endsWith(c,".bundle")?(e=c,c+="/library.json"):e=Ic.directory(c),c=R.__cacheBreak(c)),Jb.loadFromFile(c,e).onComplete(function(c){null==c?b.error('Cannot parse asset manifest for library "'+a+'"'):(c=qb.fromManifest(c),null==c?b.error('Cannot open library "'+a+'"'):(R.libraries.h[a]=c,c.onChange.add((f=R.onChange,n(f,f.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});return b.future};
R.registerLibrary=function(a,b){if(Object.prototype.hasOwnProperty.call(R.libraries.h,a)){if(R.libraries.h[a]==b)return;R.unloadLibrary(a)}null!=b&&b.onChange.add(R.library_onChange);R.libraries.h[a]=b};R.unloadLibrary=function(a){if(null==a||""==a)a="default";var b=R.libraries.h[a];null!=b&&(R.cache.clear(a+":"),b.onChange.remove(R.library_onChange),b.unload());b=R.libraries;Object.prototype.hasOwnProperty.call(b.h,a)&&delete b.h[a]};R.__cacheBreak=function(a){0<R.cache.version&&(a=-1<a.indexOf("?")?
a+("&"+R.cache.version):a+("?"+R.cache.version));return a};R.__libraryNotFound=function(a){if(null==a||""==a)a="default";return null==ca.current||null==ca.current.__preloader||ca.current.__preloader.complete?'There is no asset library named "'+a+'"':'There is no asset library named "'+a+'", or it is not yet preloaded'};R.library_onChange=function(){R.cache.clear();R.onChange.dispatch()};var Yb={_new:function(a,b){return new Ka(b)},decompress:function(a,b){switch(b._hx_index){case 0:return Ye.decompress(a);
case 1:return Ze.decompress(a);case 2:return $e.decompress(a);case 3:return af.decompress(a)}},fromBytes:function(a){return null==a?null:Yb._new(a.length,a.b.bufferValue)},fromFile:function(a){return null},loadFromFile:function(a){return(new ud).load(a)},ofString:function(a){a=Ka.ofString(a);return Yb._new(a.length,a.b.bufferValue)}},vd=u["lime.utils.CompressionAlgorithm"]={__ename__:!0,__constructs__:null,DEFLATE:{_hx_name:"DEFLATE",_hx_index:0,__enum__:"lime.utils.CompressionAlgorithm",toString:k},
GZIP:{_hx_name:"GZIP",_hx_index:1,__enum__:"lime.utils.CompressionAlgorithm",toString:k},LZMA:{_hx_name:"LZMA",_hx_index:2,__enum__:"lime.utils.CompressionAlgorithm",toString:k},ZLIB:{_hx_name:"ZLIB",_hx_index:3,__enum__:"lime.utils.CompressionAlgorithm",toString:k}};vd.__constructs__=[vd.DEFLATE,vd.GZIP,vd.LZMA,vd.ZLIB];var Ja=function(){};d["lime.utils.Log"]=Ja;Ja.__name__=!0;Ja.error=function(a,b){if(1<=Ja.level){a="["+b.className+"] ERROR: "+x.string(a);if(Ja.throwErrors)throw A.thrown(a);console.error(a)}};
Ja.verbose=function(a,b){5<=Ja.level&&(a="["+b.className+"] "+x.string(a),console.log(a))};Ja.warn=function(a,b){2<=Ja.level&&console.warn("["+b.className+"] WARNING: "+x.string(a))};var de=function(){this.bytesTotalCache=new Y;this.bytesLoadedCache2=new Y;this.bytesLoadedCache=new yb;this.onProgress=new rd;this.onComplete=new Qa;this.bytesTotal=this.bytesLoaded=0;this.libraries=[];this.libraryNames=[];this.onProgress.add(n(this,this.update))};d["lime.utils.Preloader"]=de;de.__name__=!0;de.prototype=
{addLibrary:function(a){this.libraries.push(a)},addLibraryName:function(a){-1==this.libraryNames.indexOf(a)&&this.libraryNames.push(a)},load:function(){for(var a=this,b=0,c=this.libraries;b<c.length;){var e=c[b];++b;this.bytesTotal+=e.bytesTotal}this.loadedLibraries=-1;this.preloadStarted=!1;b=0;for(c=this.libraries;b<c.length;)e=[c[b]],++b,Ja.verbose("Preloading asset library",{fileName:"lime/utils/Preloader.hx",lineNumber:132,className:"lime.utils.Preloader",methodName:"load"}),e[0].load().onProgress(function(b){return function(c,
e){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+c:a.bytesLoaded+(c-a.bytesLoadedCache.h[b[0].__id__]);a.bytesLoadedCache.set(b[0],c);a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal)}}(e)).onComplete(function(b){return function(c){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+b[0].bytesTotal:a.bytesLoaded+(b[0].bytesTotal-a.bytesLoadedCache.h[b[0].__id__]);a.loadedAssetLibrary()}}(e)).onError(function(){return function(a){Ja.error(a,
{fileName:"lime/utils/Preloader.hx",lineNumber:168,className:"lime.utils.Preloader",methodName:"load"})}}());b=0;for(c=this.libraryNames;b<c.length;)++b,this.bytesTotal+=200;this.loadedLibraries++;this.preloadStarted=!0;this.updateProgress()},loadedAssetLibrary:function(a){this.loadedLibraries++;var b=this.loadedLibraries;this.preloadStarted||++b;var c=this.libraries.length+this.libraryNames.length;null!=a?Ja.verbose("Loaded asset library: "+a+" ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",
lineNumber:195,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"}):Ja.verbose("Loaded asset library ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",lineNumber:199,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"});this.updateProgress()},start:function(){this.complete||this.simulateProgress||!this.preloadComplete||(this.complete=!0,this.onComplete.dispatch())},update:function(a,b){},updateProgress:function(){var a=this;this.simulateProgress||this.onProgress.dispatch(this.bytesLoaded,
this.bytesTotal);if(this.loadedLibraries==this.libraries.length&&!this.initLibraryNames){this.initLibraryNames=!0;for(var b=0,c=this.libraryNames;b<c.length;){var e=[c[b]];++b;Ja.verbose("Preloading asset library: "+e[0],{fileName:"lime/utils/Preloader.hx",lineNumber:236,className:"lime.utils.Preloader",methodName:"updateProgress"});R.loadLibrary(e[0]).onProgress(function(b){return function(c,e){0<e&&(Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])||(a.bytesTotalCache.h[b[0]]=e,a.bytesTotal+=
e-200),c>e&&(c=e),Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:a.bytesLoaded+=c,a.bytesLoadedCache2.h[b[0]]=c,a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal))}}(e)).onComplete(function(b){return function(c){c=200;Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])&&(c=a.bytesTotalCache.h[b[0]]);Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:
a.bytesLoaded+=c;a.loadedAssetLibrary(b[0])}}(e)).onError(function(){return function(a){Ja.error(a,{fileName:"lime/utils/Preloader.hx",lineNumber:290,className:"lime.utils.Preloader",methodName:"updateProgress"})}}())}}this.simulateProgress||this.loadedLibraries!=this.libraries.length+this.libraryNames.length||(this.preloadComplete||(this.preloadComplete=!0,Ja.verbose("Preload complete",{fileName:"lime/utils/Preloader.hx",lineNumber:301,className:"lime.utils.Preloader",methodName:"updateProgress"})),
this.start())},__class__:de};var fe=function(a,b){this.drawNeedsUpdate=!1;this.totalTicksPassed=this.elapsedMsSinceLastTick=0;this.isUpdating=!1;this.window=a;this.config=null!=b?b:{framesPerSecond:60,drawOnlyWhenRequested:!1};this.setTickDuration(Math.floor(1E3/this.config.framesPerSecond));this.loop=new wd;this.loop.onInit(this)};d["ob.gum.Gum"]=fe;fe.__name__=!0;fe.prototype={setTickDuration:function(a){this.tickDurationMs=a},toggleUpdate:function(a){this.isUpdating=null!=a?a:!this.isUpdating},
changeLoop:function(a){this.loop=a;this.loop.onInit(this)},onUpdate:function(a){this.isUpdating&&(this.loop.onUpdate(a),this.elapsedMsSinceLastTick+=a,this.elapsedMsSinceLastTick>=this.tickDurationMs&&(this.elapsedMsSinceLastTick=0,this.totalTicksPassed++,this.drawNeedsUpdate=this.loop.onTick(a)),!this.config.drawOnlyWhenRequested||this.drawNeedsUpdate)&&(this.loop.onDraw(a),this.drawNeedsUpdate=!1)},onKeyDown:function(a,b){this.loop.onKeyDown(a,b)},onKeyUp:function(a,b){this.loop.onKeyUp(a,b)},onMouseMove:function(a,
b){this.loop.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.loop.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.loop.onMouseUp(a,b,c)},onMouseScroll:function(a,b,c){this.loop.onMouseScroll(a,b,c)},onWindowResize:function(a,b){this.loop.onWindowResize(a,b)},__class__:fe};var Wc=function(){};d["ob.gum.ILoop"]=Wc;Wc.__name__=!0;Wc.__isInterface__=!0;Wc.prototype={__class__:Wc};var wd=function(){};d["ob.gum.LoadingLoop"]=wd;wd.__name__=!0;wd.__interfaces__=[Wc];wd.prototype={onTick:function(a){return!1},
onInit:function(a){this.gum=a;ia.trace("LoadingLoop onInit",{fileName:"ob/gum/Core.hx",lineNumber:136,className:"ob.gum.LoadingLoop",methodName:"onInit"})},onUpdate:function(a){},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){},__class__:wd};var wc=function(){};d["ob.gum.backends.PeoteViewLoop"]=wc;wc.__name__=!0;wc.__interfaces__=
[Wc];wc.prototype={onInit:function(a){this.gum=a;this.peoteView=new Ke(a.window);var b=null==a.config.displayWidth?a.window.__width:a.config.displayWidth,c=null==a.config.displayHeight?a.window.__height:a.config.displayHeight;this.display=new xd(0,0,a.config.displayIsScaled?a.window.__width:b,a.config.displayIsScaled?a.window.__height:c,255);this.peoteView.addDisplay(this.display);this.peoteView.start()},onUpdate:function(a){},onTick:function(a){return!1},onDraw:function(a){},onKeyDown:function(a,
b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){this.peoteView.resize(a,b)},getFrameBufferDisplay:function(a,b,c,e,g){a=new xd(a,b,c,e);this.peoteView.addDisplay(a);this.peoteView.renderToTexture(a,0);this.peoteView.addFramebufferDisplay(a);c=new Ac(c,e);c.clearOnRenderInto=!g;a.setFramebuffer(c);this.peoteView.removeDisplay(a);return{display:a,texture:c}},__class__:wc};
var bd=function(){};d["ob.gum.backends.PaletteExtensions"]=bd;bd.__name__=!0;bd.toRGBA=function(a){for(var b=[],c=0;c<a.length;){var e=a[c];++c;b.push(bd.RGBA(e))}return b};bd.RGBA=function(a,b){null==b&&(b=255);return a<<8|b};var he=function(a){this.imageCache=[];this.fontCache=[];this.paths=a};d["ob.gum.backends.Assets"]=he;he.__name__=!0;he.prototype={Preload:function(a){ia.trace("begin loading "+x.string(this.paths),{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:125,className:"ob.gum.backends.Assets",
methodName:"Preload"});this.onReady=a;this.loadFonts()},loadFonts:function(a){null==a&&(a=0);var b=this;if(a>this.paths.fonts.length-1)this.loadImages();else{var c=this.paths.fonts[a];ia.trace("loading font index "+a+" "+c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:137,className:"ob.gum.backends.Assets",methodName:"loadFonts"});(new Le(c)).load(function(c){b.fontCache.push(c);a+=1;b.loadFonts(a)})}},loadImages:function(){var a,b=this;ia.trace("load images",{fileName:"ob/gum/backends/PeoteView.hx",
lineNumber:147,className:"ob.gum.backends.Assets",methodName:"loadImages"});var c=!1;if(0>=this.paths.images.length)ia.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:150,className:"ob.gum.backends.Assets",methodName:"loadImages"}),this.onReady();else{ia.trace("loading "+this.paths.images.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:153,className:"ob.gum.backends.Assets",methodName:"loadImages"});var e=this.paths.images,g=c,h=function(a,c){ia.trace(c,
{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:156,className:"ob.gum.backends.Assets",methodName:"loadImages"});ia.trace("starting without images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:157,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()},d=function(a){b.imageCache=a;ia.trace("loaded "+b.imageCache.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:161,className:"ob.gum.backends.Assets",methodName:"loadImages"});ia.trace("asset loading finished",
{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:162,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()};null==g&&(g=!1);var l=[],f=e.length;var k=0;for(a=e.length;k<a;){var y=[k++];var r=[e[y[0]]];c=g;var E=null==h?null:function(a){return function(b){h(a[0],b)}}(y);y=null==d?null:function(a){return function(b){l[a[0]]=b;0==--f&&d(l)}}(y);null==c&&(c=!1);""!=cb.corsServer&&(new M("^https?://","")).match(r[0])&&(r[0]="//"+cb.corsServer+"/"+r[0]);var v=Ia.loadFromFile(r[0]);
c&&(ia.trace('Start loading image "'+r[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),v.onProgress(function(a){return function(b,c){cb.onProgressDebug(b,c,a[0])}}(r)),v.onError(cb.onErrorDebug),v.onComplete(function(a){return function(b){cb.onCompleteDebug(a[0])}}(r)));if(null!=E)v.onError(E);if(null!=y)v.onComplete(y)}}},__class__:he};var Me=function(){this.weight=.5;this.zIndex=this.tilt=0;this.width=this.height=16;this.bgColor=255;this.color=-855703297};
d["ob.gum.backends.FontStyle"]=Me;Me.__name__=!0;Me.prototype={__class__:Me};var Da=function(){};d["peote.text.BackgroundElement"]=Da;Da.__name__=!0;var ke=function(){};d["peote.text.FontConfig"]=ke;ke.__name__=!0;ke.prototype={__class__:ke};var Eb=function(a){this.uniformFloats=[];this.uniformFloatsVertex=this.uniformFloatsFragment=null;this.hasFragmentInjection=this.ready=!1;this.fragmentFloatPrecision=null;this.formulaHasChanged=!1;this.formula=new Y;this.colorFormula="";this.used_by_ColorFormula=
this.usedID_by_ColorFormula=0;this.textureID_Defaults=[];this.customTextureIdentifiers=[];this.activeUnits=[];this.activeTextures=[];this.textureLayers=new Gb;this.textureListPicking=new Kd(new yb);this.textureList=new Kd(new yb);this.glShaderConfig={isPICKING:!1,isES3:!1,isINSTANCED:!1,isUBO:!1,IN:"attribute",VARIN:"varying",VAROUT:"varying",hasTEXTURES:!1,hasTEXTURE_FUNCTIONS:!1,hasFRAGMENT_INJECTION:!1,FRAGMENT_PROGRAM_UNIFORMS:"",FRAGMENT_CALC_LAYER:"",TEXTURES:[],TEXTURE_DEFAULTS:[],isDISCARD:!0,
DISCARD:"0.0",isPIXELSNAPPING:!1,PIXELDIVISOR:"1.0",VERTEX_FLOAT_PRECISION:null,VERTEX_INT_PRECISION:null,VERTEX_SAMPLER_PRECISION:null,FRAGMENT_FLOAT_PRECISION:null,FRAGMENT_INT_PRECISION:null,FRAGMENT_SAMPLER_PRECISION:null,VERTEX_INJECTION:"",FRAGMENT_INJECTION:"",SIZE_FORMULA:null,POS_FORMULA:null,ROTZ_FORMULA:null,PIVOT_FORMULA:null,FORMULA_VARYINGS:{},FORMULA_CONSTANTS:{},FRAGMENT_EXTENSIONS:[]};this.gl=this.glProgram=this.glProgramPicking=this.glVertexShader=this.glFragmentShader=this.glVertexShaderPicking=
this.glFragmentShaderPicking=null;this.displays=[];this.autoUpdateTextures=this.isVisible=!0;this.clearMask=!1;this.mask=0;this.colorEnabled=!0;this.buffer=a;this.alphaEnabled=a.hasAlpha();this.zIndexEnabled=a.hasZindex();this.colorIdentifiers=a.getColorIdentifiers();this.customIdentifiers=a.getCustomIdentifiers();this.customVaryings=a.getCustomVaryings();this.textureIdentifiers=a.getTextureIdentifiers();this.defaultColorFormula=a.getDefaultColorFormula();this.defaultFormulaVars=a.getDefaultFormulaVars();
var b=a.getFormulas().h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var g=b[e++],h=this.formula,d=a.getFormulas().h[g];h.h[g]=d}try{oc.resolveFormulaCyclic(a.getFormulas())}catch(l){throw oa.lastError=l,a=A.caught(l).unwrap(),A.thrown('Error: cyclic reference of "'+x.string(a.errVar)+'" inside @formula "'+x.string(a.formula)+'" for "'+x.string(a.errKey)+'"');}oc.resolveFormulaVars(a.getFormulas(),a.getAttributes());this.parseColorFormula()};d["peote.view.Program"]=Eb;Eb.__name__=!0;Eb.prototype=
{addToDisplay:function(a,b,c){null==c&&(c=!1);if(0>this.displays.indexOf(a)){this.displays.push(a);var e=a.gl;if(null!=e&&e!=this.gl){for(var g=0,h=this.displays;g<h.length;){var d=h[g];++g;if(null!=d.gl&&d.gl!=e)throw A.thrown("Error, program can not used inside different gl-contexts");}null!=this.gl&&(this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),
this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)));this.gl=e;K.isES3&&(this.glShaderConfig.isES3=!0,this.glShaderConfig.IN="in",this.glShaderConfig.VARIN="in",this.glShaderConfig.VAROUT="out");K.isUBO&&(this.glShaderConfig.isUBO=!0);K.isINSTANCED&&(this.glShaderConfig.isINSTANCED=!0);this.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=this.gl.getExtension("OES_standard_derivatives")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});
null!=this.gl.getExtension("EXT_color_buffer_float")?this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=this.gl.getExtension("OES_texture_float")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});this.buffer.setNewGLContext(this.gl);this.createProg();this.buffer.hasPicking()&&this.createProg(!0);g=0;for(h=this.activeTextures;g<h.length;){var l=h[g];++g;e=this.gl;if(null!=e&&e!=l.gl){d=0;for(var f=l.programs;d<f.length;){var k=f[d];
++d;if(null!=k.gl&&k.gl!=e)throw A.thrown("Error, texture can not used inside different gl-contexts");}f=0;for(k=l.displays;f<k.length;)if(d=k[f],++f,null!=d.gl&&d.gl!=e)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=l.gl&&(l.gl.deleteTexture(l.glTexture),l.glTexture=null,0==l.displays.length&&null!=l.framebuffer&&(l.gl.deleteFramebuffer(l.framebuffer),l.framebuffer=null,null!=l.glDepthBuffer&&l.gl.deleteRenderbuffer(l.glDepthBuffer),l.glDepthBuffer=null));l.gl=e;
if(l.width>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE)||l.height>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");l.glTexture=Ob.createEmptyTexture(l.gl,l.width,l.height,l.colorChannels,l.createMipmaps,l.magFilter,l.minFilter,l.useFloat);if(0<l.displays.length&&null==l.framebuffer){l.glDepthBuffer=l.gl.createRenderbuffer();e=l.gl;d=l.glTexture;f=l.glDepthBuffer;k=l.width;var y=l.height,r=e.createFramebuffer();e.bindRenderbuffer(e.RENDERBUFFER,
f);Ma.clearGlErrorQueue(e);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT24,k,y);Ma.getLastGlError(e)==e.INVALID_ENUM&&(ia.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,k,y));e.bindFramebuffer(e.FRAMEBUFFER,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,f);e.framebufferTexture2D(e.FRAMEBUFFER,
e.COLOR_ATTACHMENT0,e.TEXTURE_2D,d,0);if(e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");e.bindFramebuffer(e.FRAMEBUFFER,null);e.bindRenderbuffer(e.RENDERBUFFER,null);l.framebuffer=r;l.updated=!0}for(e=l.images.keys();e.hasNext();)d=e.next(),l.bufferImage(d,l.images.h[d.__id__])}}}}a.programList.add(this,b,c)},createProg:function(a){null==a&&(a=!1);this.glShaderConfig.isPICKING=a;if(null!=this.fragmentFloatPrecision)this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=
this.fragmentFloatPrecision;else if(this.buffer.needFragmentPrecision()&&23>Na.FragmentFloat.medium){var b=Na.FragmentFloat;this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.high?"highp":0<b.medium?"mediump":0<b.low?"lowp":null}else b=Na.FragmentFloat,this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.medium?"mediump":0<b.low?"lowp":null;this.parseAndResolveFormulas();var c=this.gl,e=this.gl.VERTEX_SHADER,g=this.buffer.getVertexShader(),h=this.glShaderConfig;g=new La(g);var d=Ma.rStartspaces,l=Ma.rEmptylines;
h=g.execute(h).replace(l.r,"\n").replace(d.r,"");g=c.createShader(e);c.shaderSource(g,h);c.compileShader(g);if(0==c.getShaderParameter(g,c.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+x.string(c.getShaderInfoLog(g)));b=g;c=this.gl;e=this.gl.FRAGMENT_SHADER;g=this.buffer.getFragmentShader();h=this.glShaderConfig;g=new La(g);d=Ma.rStartspaces;l=Ma.rEmptylines;h=g.execute(h).replace(l.r,"\n").replace(d.r,"");g=c.createShader(e);c.shaderSource(g,
h);c.compileShader(g);if(0==c.getShaderParameter(g,c.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+x.string(c.getShaderInfoLog(g)));e=g;h=this.gl.createProgram();this.gl.attachShader(h,b);this.gl.attachShader(h,e);this.buffer.bindAttribLocations(this.gl,h);c=this.gl;c.linkProgram(h);if(0==c.getProgramParameter(h,c.LINK_STATUS))throw A.thrown(x.string(c.getProgramInfoLog(h))+"VALIDATE_STATUS: "+x.string(c.getProgramParameter(h,c.VALIDATE_STATUS))+
"ERROR: "+x.string(c.getError()));!a&&K.isUBO?(c=this.gl.getUniformBlockIndex(h,"uboView"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(h,c,0),c=this.gl.getUniformBlockIndex(h,"uboDisplay"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(h,c,1)):a?(this.uRESOLUTION_PICK=this.gl.getUniformLocation(h,"uResolution"),this.uZOOM_PICK=this.gl.getUniformLocation(h,"uZoom"),this.uOFFSET_PICK=this.gl.getUniformLocation(h,"uOffset")):(this.uRESOLUTION=this.gl.getUniformLocation(h,"uResolution"),
this.uZOOM=this.gl.getUniformLocation(h,"uZoom"),this.uOFFSET=this.gl.getUniformLocation(h,"uOffset"));if(a)for(this.uTIME_PICK=this.gl.getUniformLocation(h,"uTime"),this.uniformFloatPickLocations=[],c=0,g=this.uniformFloats;c<g.length;)d=g[c],++c,this.uniformFloatPickLocations.push(this.gl.getUniformLocation(h,d.name));else for(this.uTIME=this.gl.getUniformLocation(h,"uTime"),this.uniformFloatLocations=[],c=0,g=this.uniformFloats;c<g.length;)d=g[c],++c,this.uniformFloatLocations.push(this.gl.getUniformLocation(h,
d.name));if(a){this.textureListPicking.clear();c=0;for(g=this.activeTextures.length;c<g;)a=c++,this.textureListPicking.add(new Ld(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(h,"uTexture"+a)),null,!1);this.glProgramPicking=h;this.glVertexShaderPicking=b;this.glFragmentShaderPicking=e}else{this.textureList.clear();c=0;for(g=this.activeTextures.length;c<g;)a=c++,this.textureList.add(new Ld(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(h,"uTexture"+a)),
null,!1);this.glProgram=h;this.glVertexShader=b;this.glFragmentShader=e}this.ready=!0},parseColorFormula:function(){var a="";if(""!=this.colorFormula)a=this.colorFormula;else if(""!=this.defaultColorFormula)a=this.defaultColorFormula;else{for(var b=this.colorIdentifiers.slice(),c=[],e=0,g=this.textureIdentifiers.length;e<g;){var h=e++;this.textureLayers.h.hasOwnProperty(h)&&c.push(this.textureIdentifiers[h])}e=0;for(g=this.customTextureIdentifiers.length;e<g;)h=e++,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+
h)&&c.push(this.customTextureIdentifiers[h]);if(0==b.length+c.length){var d=-16776961;c=""+x.string((d>>24&255)/255);var l=""+x.string((d>>16&255)/255),f=""+x.string((d>>8&255)/255);d=""+x.string((d&255)/255);a="vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")}else{0<c.length&&(a=c.shift(),0<b.length&&(a=""+b.shift()+
" * "+a));for(e=0;e<c.length;)l=c[e],++e,0<b.length&&(l=""+b.shift()+" * "+l+" "),a="mix( "+a+", "+l+", ("+l+").a )";for(;0<b.length;)a+=(""!=a?"*":"")+b.shift(),0<b.length&&(a="("+a+" + "+b.shift()+")")}}e=0;for(g=this.colorIdentifiers.length;e<g;)h=e++,b=new M("(^|.*?[^\\w.])"+this.colorIdentifiers[h]+"\\b.*?","g"),b.match(a)&&(a=a.replace(b.r,"$1c"+h));e=0;for(g=this.customIdentifiers.length;e<g;)if(h=e++,b=new M("(^|.*?[^\\w.])"+this.customIdentifiers[h]+"\\b.*?","g"),b.match(a))if(null!=this.customVaryings[h])a=
a.replace(b.r,"$1"+this.customVaryings[h]);else throw A.thrown("Error while parsing ColorFormula: custom identifier "+this.customIdentifiers[h]+" need @varying to access in fragmentshader");this.textureID_Defaults=[];e=this.usedID_by_ColorFormula=this.used_by_ColorFormula=0;for(g=this.textureIdentifiers.length;e<g;)h=e++,b=new M("(^|.*?[^\\w.])"+this.textureIdentifiers[h]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(h)&&(a=a.replace(b.r,"$1t"+h)),this.used_by_ColorFormula|=1<<h),
b=new M("(^|.*?[^\\w.])"+(this.textureIdentifiers[h]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+h),this.usedID_by_ColorFormula|=1<<h,this.textureLayers.h.hasOwnProperty(h)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[h]],c=""+x.string((d>>24&255)/255),l=""+x.string((d>>16&255)/255),f=""+x.string((d>>8&255)/255),d=""+x.string((d&255)/255),this.textureID_Defaults.push({layer:h,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?
l:l+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=0;for(g=this.customTextureIdentifiers.length;e<g;)h=e++,b=new M("(^|.*?[^\\w.])"+this.customTextureIdentifiers[h]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+h)&&(a=a.replace(b.r,"$1t"+(this.textureIdentifiers.length+h))),this.used_by_ColorFormula|=1<<this.textureIdentifiers.length+h),b=new M("(^|.*?[^\\w.])"+(this.customTextureIdentifiers[h]+
"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+(this.textureIdentifiers.length+h)),this.usedID_by_ColorFormula|=1<<this.textureIdentifiers.length+h,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+h)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[this.textureIdentifiers.length+h]],c=""+x.string((d>>24&255)/255),l=""+x.string((d>>16&255)/255),f=""+x.string((d>>8&255)/255),d=""+x.string((d&255)/255),this.textureID_Defaults.push({layer:this.textureIdentifiers.length+h,value:"vec4("+
(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=Object.keys(this.defaultFormulaVars.h);g=e.length;for(h=0;h<g;)c=e[h++],b=new M("(^|.*?[^\\w.])"+c+"\\b.*?","g"),b.match(a)&&(d=this.defaultFormulaVars.h[c],c=""+x.string((d>>24&255)/255),l=""+x.string((d>>16&255)/255),f=""+x.string((d>>8&255)/255),d=""+x.string((d&255)/
255),a=a.replace(b.r,"$1vec4("+((-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")"))));this.glShaderConfig.FRAGMENT_CALC_LAYER=a},setColorFormula:function(a,b,c){null==a&&(a="");this.colorFormula=a;if(null!=b){a=Object.keys(b.h);for(var e=a.length,g=0;g<e;){var h=a[g++];if(!(new M("^([a-zA-z_]+\\d*)+$","g")).match(h))throw A.thrown('Error: "'+
h+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');this.defaultFormulaVars.h[h]=b.h[h]}}null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},injectIntoVertexShader:function(a,b,c,e){null==b&&(b=!1);null==a&&(a="");this.uniformFloatsVertex=c;b=(b&&!this.buffer.hasTime()?"uniform float uTime;":"")+this.generateUniformFloatsGLSL(c);this.glShaderConfig.VERTEX_INJECTION=b+a;this.accumulateUniformsFloat();null!=e?e&&this.updateTextures():
this.autoUpdateTextures&&this.updateTextures()},injectIntoFragmentShader:function(a,b,c,e){null==b&&(b=!1);null==a&&(a="");this.hasFragmentInjection=""==a?!1:!0;this.uniformFloatsFragment=c;b=(b?"uniform float uTime;":"")+this.generateUniformFloatsGLSL(c);this.glShaderConfig.FRAGMENT_INJECTION=b+a;this.accumulateUniformsFloat();null!=e?e&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},generateUniformFloatsGLSL:function(a){var b="";if(null!=a)for(var c=0;c<a.length;){var e=a[c];
++c;b+="uniform float "+e.name+";"}return b},accumulateUniformsFloat:function(){if(null==this.uniformFloatsVertex)null!=this.uniformFloatsFragment&&(this.uniformFloats=this.uniformFloatsFragment);else if(null==this.uniformFloatsFragment)this.uniformFloats=this.uniformFloatsVertex;else{this.uniformFloats=this.uniformFloatsVertex;for(var a=0,b=this.uniformFloatsFragment;a<b.length;){var c=b[a];++a;0>this.uniformFloats.indexOf(c)&&this.uniformFloats.push(c)}}},setFormula:function(a,b,c){var e=this.buffer.getFormulaNames().h[a];
if(null!=e)ia.trace("  set formula: "+e+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:514,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[e]=b;else{e=[];var g=this.buffer.getFormulaNames().h;g=Object.keys(g);for(var h=g.length,d=0;d<h;){var l=g[d++];e.push(this.buffer.getFormulaNames().h[l])}if(0<=e.indexOf(a))this.formula.h[a]=b;else if(0<=this.buffer.getFormulaVaryings().indexOf(a))ia.trace("  set formula for varying: "+a+" = "+b,{fileName:"peote/view/Program.hx",
lineNumber:522,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaConstants().indexOf(a))ia.trace("  set formula for constant: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:526,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaCustoms().indexOf(a))ia.trace("  set formula for custom: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:530,className:"peote.view.Program",
methodName:"setFormula"}),this.formula.h[a]=b;else throw A.thrown("Error: can not set Formula for "+a+" if there is no property defined for @"+a+" inside Element");}this.formulaHasChanged=!0;null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},parseAndResolveFormulas:function(){var a=this;if(this.formulaHasChanged){for(var b=new Y,c=Object.keys(this.formula.h),e=c.length,g=0;g<e;){var h=c[g++];b.h[h]=this.formula.h[h]}var d=b;try{oc.resolveFormulaCyclic(d)}catch(l){throw oa.lastError=
l,b=A.caught(l).unwrap(),A.thrown('Error: cyclic reference of "'+x.string(b.errVar)+'" inside formula "'+x.string(b.formula)+'" for "'+x.string(b.errKey)+'"');}oc.resolveFormulaVars(d,this.buffer.getAttributes());b=function(b,c,e,g){var h=a.buffer.getFormulaNames().h[b];null==h&&(h="");var l=a.buffer.getFormulaNames().h[c];null==l&&(l="");var f=d.h[h],k=d.h[l];return f!=a.buffer.getFormulas().h[h]||k!=a.buffer.getFormulas().h[l]?(null==f&&(f=a.buffer.getAttributes().h[h]),null==f&&(f=e),null==k&&
(k=a.buffer.getAttributes().h[l]),null==k&&(k=g),"rotation"==b&&"0.0"!=f&&(f="("+f+")/180.0*"+Math.PI),"zIndex"==c&&"0.0"!=k&&(b=""+x.string(a.buffer.getMaxZindex()),k="clamp( "+k+"/"+(-1!=b.indexOf(".")||-1!=b.indexOf("e-")?b:b+".0")+", -1.0, 1.0)"),"vec2("+f+", "+k+")"):null};this.glShaderConfig.SIZE_FORMULA=b("sizeX","sizeY","100.0","100.0");this.glShaderConfig.POS_FORMULA=b("posX","posY","0.0","0.0");this.glShaderConfig.ROTZ_FORMULA=b("rotation","zIndex","0.0","0.0");this.glShaderConfig.PIVOT_FORMULA=
b("pivotX","pivotY","0.0","0.0");b=0;for(c=this.buffer.getFormulaVaryings();b<c.length;)e=c[b],++b,g=d.h[e],g!=this.buffer.getFormulas().h[e]?(null==g&&(g=this.buffer.getAttributes().h[e]),this.glShaderConfig.FORMULA_VARYINGS[e]=g,ia.trace(" -- replacing Formula "+e+" => "+g,{fileName:"peote/view/Program.hx",lineNumber:591,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_VARYINGS[e]=null;b=0;for(c=this.buffer.getFormulaConstants();b<c.length;)e=c[b],
++b,g=d.h[e],null!=g&&g!=this.buffer.getAttributes().h[e]?(this.glShaderConfig.FORMULA_CONSTANTS[e]=g,ia.trace(" -- replacing Formula "+e+" => "+g,{fileName:"peote/view/Program.hx",lineNumber:601,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_CONSTANTS[e]=null}},getTextureIndexByIdentifier:function(a,b){null==b&&(b=!0);var c=this.textureIdentifiers.indexOf(a);if(0>c&&(c=this.customTextureIdentifiers.indexOf(a),0>c&&b)){if(!(new M("^([a-zA-z_]+\\d*)+$",
"g")).match(a))throw A.thrown('Error: "'+a+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');c=this.textureIdentifiers.length+this.customTextureIdentifiers.length;this.customTextureIdentifiers.push(a)}return c},validatePrecision:function(a){if(null!=a)if(0>["low","medium","high"].indexOf(a.toLowerCase())){if(0>["lowp","mediump","highp"].indexOf(a.toLowerCase()))throw A.thrown("Error, no valid precision format. Use 'low', 'medium' or 'high' (or leave it null for default)");
}else a+="p";return a},setFragmentFloatPrecision:function(a,b){a=this.validatePrecision(a);var c=Na.FragmentFloat;this.fragmentFloatPrecision=null==a?null:0<c.high&&"highp"==a?"highp":0<c.medium&&("highp"==a||"mediump"==a)?"mediump":0<c.low?"lowp":null;null!=b?b&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},discardAtAlpha:function(a,b){null==a?this.glShaderConfig.isDISCARD=!1:(this.glShaderConfig.isDISCARD=!0,a=""+x.string(a),this.glShaderConfig.DISCARD=-1!=a.indexOf(".")||
-1!=a.indexOf("e-")?a:a+".0");null!=b?b&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},setTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},addTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);if(null==a)throw A.thrown("Error, texture is null.");var e=this.textureLayers.h[b];if(null!=e){if(0<=e.indexOf(a))throw A.thrown("Error, textureLayer already contains this texture.");
e.push(a);this.textureLayers.h[b]=e}else this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},updateTextures:function(){for(var a=[],b=this.textureLayers.keys();b.hasNext();)for(var c=b.next(),e=0,g=this.textureLayers.h[c];e<g.length;)c=g[e],++e,0>a.indexOf(c)&&a.push(c);for(var h=this.activeTextures.length;0<h--;)if(0>a.indexOf(this.activeTextures[h])){if(!I.remove(this.activeTextures[h].programs,this))throw A.thrown("Error, this texture is not used by program anymore");
this.activeTextures.splice(h,1);this.activeUnits.splice(h,1)}for(e=0;e<a.length;)if(c=a[e],++e,0>this.activeTextures.indexOf(c)){this.activeTextures.push(c);for(g=0;0<=this.activeUnits.indexOf(g);)++g;this.activeUnits.push(g);if(0<=c.programs.indexOf(this))throw A.thrown("Error, texture is already used by program");b=this.gl;if(null!=b&&b!=c.gl){g=0;for(h=c.programs;g<h.length;){var d=h[g];++g;if(null!=d.gl&&d.gl!=b)throw A.thrown("Error, texture can not used inside different gl-contexts");}g=0;for(h=
c.displays;g<h.length;)if(d=h[g],++g,null!=d.gl&&d.gl!=b)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=c.gl&&(c.gl.deleteTexture(c.glTexture),c.glTexture=null,0==c.displays.length&&null!=c.framebuffer&&(c.gl.deleteFramebuffer(c.framebuffer),c.framebuffer=null,null!=c.glDepthBuffer&&c.gl.deleteRenderbuffer(c.glDepthBuffer),c.glDepthBuffer=null));c.gl=b;if(c.width>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE)||c.height>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");
c.glTexture=Ob.createEmptyTexture(c.gl,c.width,c.height,c.colorChannels,c.createMipmaps,c.magFilter,c.minFilter,c.useFloat);if(0<c.displays.length&&null==c.framebuffer){c.glDepthBuffer=c.gl.createRenderbuffer();g=c.gl;b=c.glTexture;h=c.glDepthBuffer;d=c.width;var l=c.height,f=g.createFramebuffer();g.bindRenderbuffer(g.RENDERBUFFER,h);Ma.clearGlErrorQueue(g);g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT24,d,l);Ma.getLastGlError(g)==g.INVALID_ENUM&&(ia.trace("switching to DEPTH_COMPONENT16 for framebuffer",
{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT16,d,l));g.bindFramebuffer(g.FRAMEBUFFER,f);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,h);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,b,0);if(g.checkFramebufferStatus(g.FRAMEBUFFER)!=g.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");g.bindFramebuffer(g.FRAMEBUFFER,
null);g.bindRenderbuffer(g.RENDERBUFFER,null);c.framebuffer=f;c.updated=!0}for(g=c.images.keys();g.hasNext();)b=g.next(),c.bufferImage(b,c.images.h[b.__id__])}c.programs.push(this)}this.parseColorFormula();this.glShaderConfig.hasFRAGMENT_INJECTION=this.hasFragmentInjection;this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS="";this.glShaderConfig.TEXTURES=[];if(0==this.activeTextures.length)this.glShaderConfig.hasTEXTURES=!1;else{this.glShaderConfig.hasTEXTURES=!0;e=0;for(g=this.activeTextures.length;e<
g;)h=e++,this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS+="uniform sampler2D uTexture"+h+";";for(b=this.textureLayers.keys();b.hasNext();){c=b.next();a=[];d=this.textureLayers.h[c];e=0;for(g=d.length;e<g;){h=e++;l=""+x.string(d[h].slotWidth/d[h].width);f=""+x.string(d[h].slotHeight/d[h].height);var k=""+x.string(d[h].slotsX*d[h].slotWidth/d[h].width),y=""+x.string(d[h].slotsY*d[h].slotHeight/d[h].height);a.push({UNIT_VALUE:h+1+".0",TEXTURE:"uTexture"+this.activeTextures.indexOf(d[h]),SLOTS_X:d[h].slotsX+
".0",SLOTS_Y:d[h].slotsY+".0",SLOT_WIDTH:-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0",SLOT_HEIGHT:-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0",SLOTS_WIDTH:-1!=k.indexOf(".")||-1!=k.indexOf("e-")?k:k+".0",SLOTS_HEIGHT:-1!=y.indexOf(".")||-1!=y.indexOf("e-")?y:y+".0",TILES_X:d[h].tilesX+".0",TILES_Y:d[h].tilesY+".0",TEXTURE_WIDTH:d[h].width+".0",TEXTURE_HEIGHT:d[h].height+".0",FIRST:0==h,LAST:h==d.length-1})}this.glShaderConfig.TEXTURES.push({LAYER:c,UNITS:a,USED:0<(this.used_by_ColorFormula&
1<<c),USED_ID:0<(this.usedID_by_ColorFormula&1<<c)})}}this.glShaderConfig.TEXTURE_DEFAULTS=[];e=0;for(g=this.textureID_Defaults;e<g.length;)a=g[e],++e,this.glShaderConfig.TEXTURE_DEFAULTS.push({LAYER:a.layer,DEFAULT_VALUE:a.value});this.glShaderConfig.hasTEXTURE_FUNCTIONS=0==this.usedID_by_ColorFormula&&0==this.textureID_Defaults.length?!1:!0;null!=this.gl&&(this.ready=!1,this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&
(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)),this.createProg(),this.buffer.hasPicking()&&this.createProg(!0))},__class__:Eb};var Pd=function(a,b,c,e){null==e&&(e=!1);null==c&&(c=!1);this.isMasked=this.hasBackground=!1;this._buffer=new Md(1024,1024,!0);Eb.call(this,this._buffer);c&&(this.isMasked=!0,this.maskBuffer=new Nd(16,16,!0),this.maskProgram=new Eb(this.maskBuffer),this.maskProgram.mask=2,this.maskProgram.colorEnabled=
!1,this.mask=1,this.hasBackground&&(this.backgroundProgram.mask=1));e&&(this.hasBackground=!0,this.backgroundBuffer=new Od(16,16,!0),this.backgroundProgram=new Eb(this.backgroundBuffer),this.isMasked&&(this.backgroundProgram.mask=1));this.font=a;this.autoUpdateTextures=!1;this.setTexture(a.textureCache,"TEX");this.fontStyle=b;this.alphaEnabled=!0;this.font.config.distancefield?(a=""+x.string(.5),a=-1!=a.indexOf(".")||-1!=a.indexOf("e-")?a:a+".0",this.setColorFormula("mix(bgColor,color,smoothstep( weight - "+
a+" * fwidth(TEX.r), weight + "+a+" * fwidth(TEX.r), TEX.r))")):this.setColorFormula("mix(bgColor,color,TEX.r)");this.setFormula("x","x + (1.0-aPosition.y)*width*tilt");this.updateTextures()};d["peote.text.FontProgram__ob_gum_backends_PeoteView_FontStyle"]=Pd;Pd.__name__=!0;Pd.__super__=Eb;Pd.prototype=G(Eb.prototype,{addToDisplay:function(a,b,c){null==c&&(c=!1);Eb.prototype.addToDisplay.call(this,a,b,c);this.isMasked&&this.maskProgram.addToDisplay(a,this,!0);this.hasBackground&&this.backgroundProgram.addToDisplay(a,
this,!0)},__class__:Pd});var Le=function(a,b,c,e){null==e&&(e=16384);null==c&&(c=!0);this.rHexToDec=new M('("\\s*)?(0x[0-9a-f]+)(\\s*")?',"gi");this.rComments=new M("//.*?$","gm");this.rParsePathConfig=new M("^(.*?)([^/]+)$","");this.kerning=!1;if(this.rParsePathConfig.match(a))this.path=this.rParsePathConfig.matched(1),this.jsonFilename=this.rParsePathConfig.matched(2);else throw A.thrown("Can't load font, error in path to jsonfile: \""+a+'"');this.ranges=b;this.kerning=c;this.maxTextureSize=e};
d["peote.text.Font__ob_gum_backends_PeoteView_FontStyle"]=Le;Le.__name__=!0;Le.prototype={createFontProgram:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return new Pd(this,a,b,c)},createFontStyle:function(){return new Me},load:function(a,b,c){null==c&&(c=!1);var e=this,g=c,h=function(g){g=g.replace(e.rComments.r,"");g=e.rHexToDec.map(g,function(a){return x.string(x.parseInt(a.matched(2)))});var h=new O;e.config=h.fromJson(g,e.path+e.jsonFilename);g=0;for(h=h.errors;g<h.length;){var d=h[g];++g;
switch(d._hx_index){case 0:var f=d.variable;var l=d.expected;f=d.pos;break;case 1:f=d.pos;break;case 2:f=d.pos;break;case 3:f=d.pos;break;case 4:f=d.pos;break;case 5:f=d.pos;break;case 6:f=d.pos}ia.trace(f.lines[0].number,{fileName:"peote/text/Font.hx",lineNumber:246,className:"peote.text.Font__ob_gum_backends_PeoteView_FontStyle",methodName:"load"});null!=f&&ia.trace(Xe.convertError(d),{fileName:f.file,lineNumber:f.lines[0].number,className:"",methodName:""})}if(e.config.packed)throw g='Error, metadata of FontStyle class has to be "@packed" for "'+
e.path+e.jsonFilename+'" and "packed":true',ia.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(g);e.kerning&&null!=e.config.kerning&&(e.kerning=e.config.kerning);if(null==e.ranges&&1<e.config.ranges.length)throw g='Error, set FontStyle to @multiSlot and/or @multiTexture or define a single range while Font creation or inside "'+e.path+e.jsonFilename+'"',ia.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(g);d=[];g=
0;for(h=e.config.ranges;g<h.length;){var k=h[g];++g;var y=k.range.min,E=k.range.max;if(null!=e.ranges)for(f=0,l=e.ranges;f<l.length;){var v=l[f];++f;if(v.min>=y&&v.min<=E||v.max>=y&&v.max<=E){d.push(k);break}}else d.push(k);if(1==d.length)break}if(0==d.length)throw g='Error, can not found any ranges inside font-config "'+e.path+e.jsonFilename+'" that fit '+x.string(e.ranges),ia.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(g);e.config.ranges=d;e.init(a,
b,c)};null==g&&(g=!1);var d=this.path+this.jsonFilename,f=null==h?null:h,k=null==h?null:function(a){h(a.toString())};null==g&&(g=!1);""!=cb.corsServer&&(new M("^https?://","")).match(d)&&(d="//"+cb.corsServer+"/"+d);var y=Yb.loadFromFile(d);g&&(ia.trace('Start loading bytes "'+d+'"',{fileName:"utils/Loader.hx",lineNumber:81,className:"utils.Loader",methodName:"bytes"}),y.onProgress(function(a,b){cb.onProgressDebug(a,b,d)}),y.onError(cb.onErrorDebug),y.onComplete(function(a){cb.onCompleteDebug(d)}));
if(null!=f)y.onError(f);if(null!=k)y.onComplete(k)},init:function(a,b,c){for(var e=0,g=0,h=0,d=this.config.ranges;h<d.length;){var f=d[h];++h;f.slot.width>e&&(e=f.slot.width);f.slot.height>g&&(g=f.slot.height)}this.textureCache=new Ac(e,g,this.config.ranges.length,4,!1,1,1,null,this.maxTextureSize);this.loadImages(null,a,b,c)},loadImages:function(a,b,c,e){var g=this,h=this.config.ranges;a=Array(h.length);for(var d=0,f=h.length;d<f;){var k=d++;a[k]=g.path+h[k].image}h=e;var y=function(a,b,e){null!=
c&&c(b,e)},E=function(a,b){if(null!=g.config.ranges[a].tiles){var c=g.config.ranges[a].tiles.x;var e=g.config.ranges[a].tiles.y}else if(null!=g.config.tiles)c=g.config.tiles.x,e=g.config.tiles.y;else throw b='Error, can not found tiles inside font-config "'+g.path+g.jsonFilename+'"',ia.trace(b,{fileName:g.path+g.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(b);if(null!=g.config.ranges[a].line){var h=g.config.ranges[a].line.height/b.height*e;var d=g.config.ranges[a].line.base/b.height*
e}else null!=g.config.line?(h=g.config.line.height/b.height*e,d=g.config.line.base/b.height*e):d=h=1;a=g.config.ranges[a].range;g.textureCache.setImage(b,0,c,e);g.rangeMapping={min:a.min,max:a.max,height:h,base:d}},r=function(a){b(g)};null==h&&(h=!1);var v=a.length;d=0;for(f=a.length;d<f;){k=[d++];var q=[a[k[0]]];e=h;var u=null==y?null:function(a){return function(b,c){null!=y&&y(a[0],b,c)}}(k);k=null==r?null:function(a){return function(c){null!=E&&E(a[0],c);0==--v&&b(g)}}(k);null==e&&(e=!1);""!=cb.corsServer&&
(new M("^https?://","")).match(q[0])&&(q[0]="//"+cb.corsServer+"/"+q[0]);var m=Ia.loadFromFile(q[0]);e&&(ia.trace('Start loading image "'+q[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),m.onProgress(function(a){return function(b,c){cb.onProgressDebug(b,c,a[0])}}(q)),m.onError(cb.onErrorDebug),m.onComplete(function(a){return function(b){cb.onCompleteDebug(a[0])}}(q)));if(null!=u)m.onProgress(u);if(null!=k)m.onComplete(k)}},__class__:Le};var of=function(){};
d["peote.text.Gl3FontData"]=of;of.__name__=!0;var xa=function(){this.bytePos=-1;this.weight=this.tilt=this.zIndex=this.width=this.height=this.tile=0;this.bgColor=255;this.color=-1;this.x=this.y=0;this.char=-1};d["peote.text.Glyph__ob_gum_backends_PeoteView_FontStyle"]=xa;xa.__name__=!0;xa.prototype={__class__:xa};var Fa=function(){};d["peote.text.MaskElement"]=Fa;Fa.__name__=!0;var le=function(a,b){this.min=a;this.max=b};d["peote.text.Range"]=le;le.__name__=!0;le.prototype={__class__:le};var hc=function(){};
d["peote.view.BufferInterface"]=hc;hc.__name__=!0;hc.__isInterface__=!0;hc.prototype={__class__:hc};var Od=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);K.isINSTANCED?(null==Da.instanceBytes&&(Da.instanceBytes=
new Ua(new ArrayBuffer(12)),Da.instanceBytes.b[0]=1,Da.instanceBytes.b[1]=1,Da.instanceBytes.b[2]=1,Da.instanceBytes.b[3]=1,Da.instanceBytes.b[4]=0,Da.instanceBytes.b[5]=1,Da.instanceBytes.b[6]=1,Da.instanceBytes.b[7]=0,Da.instanceBytes.b[8]=0,Da.instanceBytes.b[9]=0,Da.instanceBytes.b[10]=0,Da.instanceBytes.b[11]=0),this._elemBuffSize=24):this._elemBuffSize=168;this._bytes=new Ua(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_BackgroundElement"]=
Od;Od.__name__=!0;Od.__interfaces__=[hc];Od.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),K.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),K.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);
this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);K.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=Da.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));K.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),
a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,24,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,24,4),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,24,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,24,16),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,
this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,28,0),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,28,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,28,8),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,28,16),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,28,24)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return Da.DEFAULT_FORMULA_VARS},getFormulas:function(){return Da.FORMULAS},getAttributes:function(){return Da.ATTRIBUTES},getFormulaNames:function(){return Da.FORMULA_NAMES},getFormulaVaryings:function(){return""==Da.FORMULA_VARYINGS?[]:Da.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==Da.FORMULA_CONSTANTS?[]:Da.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==Da.FORMULA_CUSTOMS?[]:Da.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,4,"aColorStart0");a.bindAttribLocation(b,3,"aRotZ");
a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;K.isINSTANCED?(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,24,0),b.vertexAttribDivisor(4,
1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,24,4),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,24,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,24,16),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,
4,b.UNSIGNED_BYTE,!0,28,0),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,28,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,28,8),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,28,16),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,28,24)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));K.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(3),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Od};var Qd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);K.isINSTANCED?(null==ja.instanceBytes&&
(ja.instanceBytes=new Ua(new ArrayBuffer(12)),ja.instanceBytes.b[0]=1,ja.instanceBytes.b[1]=1,ja.instanceBytes.b[2]=1,ja.instanceBytes.b[3]=1,ja.instanceBytes.b[4]=0,ja.instanceBytes.b[5]=1,ja.instanceBytes.b[6]=1,ja.instanceBytes.b[7]=0,ja.instanceBytes.b[8]=0,ja.instanceBytes.b[9]=0,ja.instanceBytes.b[10]=0,ja.instanceBytes.b[11]=0),this._elemBuffSize=16):this._elemBuffSize=96;this._bytes=new Ua(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_FilterElement"]=Qd;Qd.__name__=!0;Qd.__interfaces__=[hc];Qd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),K.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),K.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,
b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);K.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ja.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));K.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),
a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,4,a.UNSIGNED_BYTE,!0,16,0),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,16,4),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,16,8),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.SHORT,!1,16,12),a.vertexAttribDivisor(4,
1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,4,a.UNSIGNED_BYTE,!0,16,0),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,16,4),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,16,8),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.SHORT,!1,16,12),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,16,14)),this._gl.bindVertexArray(null))}},updateElement:function(a){if(K.isINSTANCED){var b=
this._bytes;b.b_Int32[a.bytePos>>2]=a.c;b.b_Uint16[a.bytePos+4>>1]=a.x&65535;b.b_Uint16[a.bytePos+6>>1]=a.y&65535;b.b_Uint16[a.bytePos+8>>1]=a.w&65535;b.b_Uint16[a.bytePos+10>>1]=a.h&65535;b.b_Uint16[a.bytePos+12>>1]=a.slot&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.c,b.b_Uint16[a.bytePos+4>>1]=a.x&65535,b.b_Uint16[a.bytePos+6>>1]=a.y&65535,b.b_Uint16[a.bytePos+8>>1]=a.w&65535,b.b_Uint16[a.bytePos+10>>1]=a.h&65535,b.b_Uint16[a.bytePos+12>>1]=a.slot&65535,b.b[a.bytePos+14]=1,b.b[a.bytePos+
15]=1,b.b_Int32[a.bytePos+16>>2]=a.c,b.b_Uint16[a.bytePos+20>>1]=a.x&65535,b.b_Uint16[a.bytePos+22>>1]=a.y&65535,b.b_Uint16[a.bytePos+24>>1]=a.w&65535,b.b_Uint16[a.bytePos+26>>1]=a.h&65535,b.b_Uint16[a.bytePos+28>>1]=a.slot&65535,b.b[a.bytePos+30]=1,b.b[a.bytePos+31]=1,b.b_Int32[a.bytePos+32>>2]=a.c,b.b_Uint16[a.bytePos+36>>1]=a.x&65535,b.b_Uint16[a.bytePos+38>>1]=a.y&65535,b.b_Uint16[a.bytePos+40>>1]=a.w&65535,b.b_Uint16[a.bytePos+42>>1]=a.h&65535,b.b_Uint16[a.bytePos+44>>1]=a.slot&65535,b.b[a.bytePos+
46]=0,b.b[a.bytePos+47]=1,b.b_Int32[a.bytePos+48>>2]=a.c,b.b_Uint16[a.bytePos+52>>1]=a.x&65535,b.b_Uint16[a.bytePos+54>>1]=a.y&65535,b.b_Uint16[a.bytePos+56>>1]=a.w&65535,b.b_Uint16[a.bytePos+58>>1]=a.h&65535,b.b_Uint16[a.bytePos+60>>1]=a.slot&65535,b.b[a.bytePos+62]=1,b.b[a.bytePos+63]=0,b.b_Int32[a.bytePos+64>>2]=a.c,b.b_Uint16[a.bytePos+68>>1]=a.x&65535,b.b_Uint16[a.bytePos+70>>1]=a.y&65535,b.b_Uint16[a.bytePos+72>>1]=a.w&65535,b.b_Uint16[a.bytePos+74>>1]=a.h&65535,b.b_Uint16[a.bytePos+76>>1]=
a.slot&65535,b.b[a.bytePos+78]=0,b.b[a.bytePos+79]=0,b.b_Int32[a.bytePos+80>>2]=a.c,b.b_Uint16[a.bytePos+84>>1]=a.x&65535,b.b_Uint16[a.bytePos+86>>1]=a.y&65535,b.b_Uint16[a.bytePos+88>>1]=a.w&65535,b.b_Uint16[a.bytePos+90>>1]=a.h&65535,b.b_Uint16[a.bytePos+92>>1]=a.slot&65535,b.b[a.bytePos+94]=0,b.b[a.bytePos+95]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,
a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Ua(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];
e=this._bytes;var f=d.bytePos,k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null),K.isVAO&&(this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,4,b.UNSIGNED_BYTE,!0,16,0),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,
2,b.SHORT,!1,16,8),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.vertexAttribDivisor(4,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,4,b.UNSIGNED_BYTE,!0,16,0),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,16,8),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.enableVertexAttribArray(0),
b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,16,14)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: float aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: float vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0 = ::if FORMULA_VARYINGS.slot::::FORMULA_VARYINGS.slot::::else::aShort0::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: float vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: + floor(mod(vTexPack0, ::SLOTS_X::)) * ::SLOT_WIDTH::, vTexCoord.y * ::SLOT_HEIGHT:: + floor(floor(vTexPack0)/::SLOTS_X::) * ::SLOT_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER == 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: + floor(mod(vTexPack0, ::SLOTS_X::)) * ::SLOT_WIDTH::, vTexCoord.y * ::SLOT_HEIGHT:: + floor(floor(vTexPack0)/::SLOTS_X::) * ::SLOT_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 1)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return["base"]},getColorIdentifiers:function(){return["c"]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ja.DEFAULT_FORMULA_VARS},getFormulas:function(){return ja.FORMULAS},getAttributes:function(){return ja.ATTRIBUTES},getFormulaNames:function(){return ja.FORMULA_NAMES},getFormulaVaryings:function(){return""==ja.FORMULA_VARYINGS?[]:ja.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==ja.FORMULA_CONSTANTS?[]:ja.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==ja.FORMULA_CUSTOMS?[]:ja.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,3,"aColorStart0");a.bindAttribLocation(b,1,"aPos");
a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,4,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;K.isINSTANCED?(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,4,b.UNSIGNED_BYTE,!0,16,0),b.vertexAttribDivisor(3,
1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,16,8),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.vertexAttribDivisor(4,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,
4,b.UNSIGNED_BYTE,!0,16,0),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,16,8),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,16,14)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));K.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(3),b.disableVertexAttribArray(1),
b.disableVertexAttribArray(2),b.disableVertexAttribArray(4));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Qd};var Md=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);K.isINSTANCED?(null==xa.instanceBytes&&
(xa.instanceBytes=new Ua(new ArrayBuffer(12)),xa.instanceBytes.b[0]=1,xa.instanceBytes.b[1]=1,xa.instanceBytes.b[2]=1,xa.instanceBytes.b[3]=1,xa.instanceBytes.b[4]=0,xa.instanceBytes.b[5]=1,xa.instanceBytes.b[6]=1,xa.instanceBytes.b[7]=0,xa.instanceBytes.b[8]=0,xa.instanceBytes.b[9]=0,xa.instanceBytes.b[10]=0,xa.instanceBytes.b[11]=0),this._elemBuffSize=40):this._elemBuffSize=240;this._bytes=new Ua(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_Glyph__ob_gum_backends_PeoteView_FontStyle"]=Md;Md.__name__=!0;Md.__interfaces__=[hc];Md.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),K.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),K.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,
0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);K.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=xa.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));K.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(a=this._gl,b=this._glBuffer,
a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,40,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),
a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.vertexAttribDivisor(7,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,
40,0),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,
2,a.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(K.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_Int32[c.bytePos+4>>2]=c.bgColor;e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151));e.b_UFloat32[c.bytePos+12>>2]=c.x;e.b_UFloat32[c.bytePos+16>>2]=c.y;e.b_UFloat32[c.bytePos+20>>2]=c.width;e.b_UFloat32[c.bytePos+24>>2]=c.height;e.b_UFloat32[c.bytePos+28>>2]=c.weight;
e.b_UFloat32[c.bytePos+32>>2]=c.tilt;e.b_Uint16[c.bytePos+36>>1]=c.tile&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_Int32[c.bytePos+4>>2]=c.bgColor,e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+12>>2]=c.x,e.b_UFloat32[c.bytePos+16>>2]=c.y,e.b_UFloat32[c.bytePos+20>>2]=c.width,e.b_UFloat32[c.bytePos+24>>2]=c.height,e.b_UFloat32[c.bytePos+28>>2]=c.weight,e.b_UFloat32[c.bytePos+32>>2]=c.tilt,e.b_Uint16[c.bytePos+36>>
1]=c.tile&65535,e.b[c.bytePos+38]=1,e.b[c.bytePos+39]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_Int32[c.bytePos+44>>2]=c.bgColor,e.b_UFloat32[c.bytePos+48>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+52>>2]=c.x,e.b_UFloat32[c.bytePos+56>>2]=c.y,e.b_UFloat32[c.bytePos+60>>2]=c.width,e.b_UFloat32[c.bytePos+64>>2]=c.height,e.b_UFloat32[c.bytePos+68>>2]=c.weight,e.b_UFloat32[c.bytePos+72>>2]=c.tilt,e.b_Uint16[c.bytePos+76>>1]=c.tile&65535,e.b[c.bytePos+78]=1,e.b[c.bytePos+79]=1,
e.b_Int32[c.bytePos+80>>2]=c.color,e.b_Int32[c.bytePos+84>>2]=c.bgColor,e.b_UFloat32[c.bytePos+88>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+92>>2]=c.x,e.b_UFloat32[c.bytePos+96>>2]=c.y,e.b_UFloat32[c.bytePos+100>>2]=c.width,e.b_UFloat32[c.bytePos+104>>2]=c.height,e.b_UFloat32[c.bytePos+108>>2]=c.weight,e.b_UFloat32[c.bytePos+112>>2]=c.tilt,e.b_Uint16[c.bytePos+116>>1]=c.tile&65535,e.b[c.bytePos+118]=0,e.b[c.bytePos+119]=1,e.b_Int32[c.bytePos+120>>2]=c.color,e.b_Int32[c.bytePos+
124>>2]=c.bgColor,e.b_UFloat32[c.bytePos+128>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+132>>2]=c.x,e.b_UFloat32[c.bytePos+136>>2]=c.y,e.b_UFloat32[c.bytePos+140>>2]=c.width,e.b_UFloat32[c.bytePos+144>>2]=c.height,e.b_UFloat32[c.bytePos+148>>2]=c.weight,e.b_UFloat32[c.bytePos+152>>2]=c.tilt,e.b_Uint16[c.bytePos+156>>1]=c.tile&65535,e.b[c.bytePos+158]=1,e.b[c.bytePos+159]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_Int32[c.bytePos+164>>2]=c.bgColor,e.b_UFloat32[c.bytePos+168>>
2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+172>>2]=c.x,e.b_UFloat32[c.bytePos+176>>2]=c.y,e.b_UFloat32[c.bytePos+180>>2]=c.width,e.b_UFloat32[c.bytePos+184>>2]=c.height,e.b_UFloat32[c.bytePos+188>>2]=c.weight,e.b_UFloat32[c.bytePos+192>>2]=c.tilt,e.b_Uint16[c.bytePos+196>>1]=c.tile&65535,e.b[c.bytePos+198]=0,e.b[c.bytePos+199]=0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_Int32[c.bytePos+204>>2]=c.bgColor,e.b_UFloat32[c.bytePos+208>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),
e.b_UFloat32[c.bytePos+212>>2]=c.x,e.b_UFloat32[c.bytePos+216>>2]=c.y,e.b_UFloat32[c.bytePos+220>>2]=c.width,e.b_UFloat32[c.bytePos+224>>2]=c.height,e.b_UFloat32[c.bytePos+228>>2]=c.weight,e.b_UFloat32[c.bytePos+232>>2]=c.tilt,e.b_Uint16[c.bytePos+236>>1]=c.tile&65535,e.b[c.bytePos+238]=0,e.b[c.bytePos+239]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null)},updateElement:function(a){if(K.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_Int32[a.bytePos+4>>2]=a.bgColor;b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151));b.b_UFloat32[a.bytePos+12>>2]=a.x;b.b_UFloat32[a.bytePos+16>>2]=a.y;b.b_UFloat32[a.bytePos+20>>2]=a.width;b.b_UFloat32[a.bytePos+24>>2]=a.height;b.b_UFloat32[a.bytePos+28>>2]=a.weight;b.b_UFloat32[a.bytePos+32>>2]=a.tilt;b.b_Uint16[a.bytePos+36>>1]=a.tile&65535}else b=this._bytes,b.b_Int32[a.bytePos>>
2]=a.color,b.b_Int32[a.bytePos+4>>2]=a.bgColor,b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+12>>2]=a.x,b.b_UFloat32[a.bytePos+16>>2]=a.y,b.b_UFloat32[a.bytePos+20>>2]=a.width,b.b_UFloat32[a.bytePos+24>>2]=a.height,b.b_UFloat32[a.bytePos+28>>2]=a.weight,b.b_UFloat32[a.bytePos+32>>2]=a.tilt,b.b_Uint16[a.bytePos+36>>1]=a.tile&65535,b.b[a.bytePos+38]=1,b.b[a.bytePos+39]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_Int32[a.bytePos+44>>2]=a.bgColor,b.b_UFloat32[a.bytePos+
48>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+52>>2]=a.x,b.b_UFloat32[a.bytePos+56>>2]=a.y,b.b_UFloat32[a.bytePos+60>>2]=a.width,b.b_UFloat32[a.bytePos+64>>2]=a.height,b.b_UFloat32[a.bytePos+68>>2]=a.weight,b.b_UFloat32[a.bytePos+72>>2]=a.tilt,b.b_Uint16[a.bytePos+76>>1]=a.tile&65535,b.b[a.bytePos+78]=1,b.b[a.bytePos+79]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_Int32[a.bytePos+84>>2]=a.bgColor,b.b_UFloat32[a.bytePos+88>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+
92>>2]=a.x,b.b_UFloat32[a.bytePos+96>>2]=a.y,b.b_UFloat32[a.bytePos+100>>2]=a.width,b.b_UFloat32[a.bytePos+104>>2]=a.height,b.b_UFloat32[a.bytePos+108>>2]=a.weight,b.b_UFloat32[a.bytePos+112>>2]=a.tilt,b.b_Uint16[a.bytePos+116>>1]=a.tile&65535,b.b[a.bytePos+118]=0,b.b[a.bytePos+119]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_Int32[a.bytePos+124>>2]=a.bgColor,b.b_UFloat32[a.bytePos+128>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+132>>2]=a.x,b.b_UFloat32[a.bytePos+136>>2]=a.y,
b.b_UFloat32[a.bytePos+140>>2]=a.width,b.b_UFloat32[a.bytePos+144>>2]=a.height,b.b_UFloat32[a.bytePos+148>>2]=a.weight,b.b_UFloat32[a.bytePos+152>>2]=a.tilt,b.b_Uint16[a.bytePos+156>>1]=a.tile&65535,b.b[a.bytePos+158]=1,b.b[a.bytePos+159]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_Int32[a.bytePos+164>>2]=a.bgColor,b.b_UFloat32[a.bytePos+168>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+172>>2]=a.x,b.b_UFloat32[a.bytePos+176>>2]=a.y,b.b_UFloat32[a.bytePos+180>>2]=a.width,b.b_UFloat32[a.bytePos+
184>>2]=a.height,b.b_UFloat32[a.bytePos+188>>2]=a.weight,b.b_UFloat32[a.bytePos+192>>2]=a.tilt,b.b_Uint16[a.bytePos+196>>1]=a.tile&65535,b.b[a.bytePos+198]=0,b.b[a.bytePos+199]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_Int32[a.bytePos+204>>2]=a.bgColor,b.b_UFloat32[a.bytePos+208>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+212>>2]=a.x,b.b_UFloat32[a.bytePos+216>>2]=a.y,b.b_UFloat32[a.bytePos+220>>2]=a.width,b.b_UFloat32[a.bytePos+224>>2]=a.height,b.b_UFloat32[a.bytePos+228>>
2]=a.weight,b.b_UFloat32[a.bytePos+232>>2]=a.tilt,b.b_Uint16[a.bytePos+236>>1]=a.tile&65535,b.b[a.bytePos+238]=0,b.b[a.bytePos+239]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");
var b=this._maxElements+this._growSize,c=new Ua(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];e=this._bytes;var f=d.bytePos,k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),
this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),K.isVAO&&(this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),
b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);
e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;::IN:: vec4 aColorStart1;\n\t\n\t::IN:: vec2 aFloat0;::IN:: float aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;::if isES3::flat ::end::::VAROUT:: vec4 vColor1;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: float vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: float vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; vColor1 = aColorStart1.wzyx; \n\n\t\tvPack0 = ::if FORMULA_VARYINGS.weight::::FORMULA_VARYINGS.weight::::else::aFloat0.x::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0 = ::if FORMULA_VARYINGS.tile::::FORMULA_VARYINGS.tile::::else::aShort0::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; ::if isES3::flat ::end::::VARIN:: vec4 vColor1; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: float vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: float vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; vec4 c1 = vColor1; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color","bgColor"]},getCustomIdentifiers:function(){return["weight","tilt"]},getCustomVaryings:function(){return["vPack0","null"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return xa.DEFAULT_FORMULA_VARS},getFormulas:function(){return xa.FORMULAS},getAttributes:function(){return xa.ATTRIBUTES},getFormulaNames:function(){return xa.FORMULA_NAMES},getFormulaVaryings:function(){return""==
xa.FORMULA_VARYINGS?[]:xa.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==xa.FORMULA_CONSTANTS?[]:xa.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==xa.FORMULA_CUSTOMS?[]:xa.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!0},bindAttribLocations:function(a,b){a.bindAttribLocation(b,
4,"aColorStart0");a.bindAttribLocation(b,5,"aColorStart1");a.bindAttribLocation(b,3,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,7,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;K.isINSTANCED?(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,
2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,
2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),
b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,
0,6*a));K.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(5),b.disableVertexAttribArray(3),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(6),b.disableVertexAttribArray(7));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Md};var Nd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=
this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);K.isINSTANCED?(null==Fa.instanceBytes&&(Fa.instanceBytes=new Ua(new ArrayBuffer(12)),Fa.instanceBytes.b[0]=1,Fa.instanceBytes.b[1]=1,Fa.instanceBytes.b[2]=1,Fa.instanceBytes.b[3]=1,Fa.instanceBytes.b[4]=0,Fa.instanceBytes.b[5]=1,Fa.instanceBytes.b[6]=1,Fa.instanceBytes.b[7]=0,Fa.instanceBytes.b[8]=
0,Fa.instanceBytes.b[9]=0,Fa.instanceBytes.b[10]=0,Fa.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new Ua(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_MaskElement"]=Nd;Nd.__name__=!0;Nd.__interfaces__=[hc];Nd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),K.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),
K.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);K.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=Fa.instanceBytes,b=new Uint8Array(b.b.bufferValue,
0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));K.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return Fa.DEFAULT_FORMULA_VARS},getFormulas:function(){return Fa.FORMULAS},getAttributes:function(){return Fa.ATTRIBUTES},getFormulaNames:function(){return Fa.FORMULA_NAMES},getFormulaVaryings:function(){return""==Fa.FORMULA_VARYINGS?[]:Fa.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==Fa.FORMULA_CONSTANTS?[]:Fa.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==Fa.FORMULA_CUSTOMS?[]:Fa.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,
0,"aPosition")},render:function(a,b,c){a=this._maxElements;K.isINSTANCED?(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,
1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));K.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Nd};var Rd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);K.isINSTANCED?(null==na.instanceBytes&&
(na.instanceBytes=new Ua(new ArrayBuffer(12)),na.instanceBytes.b[0]=1,na.instanceBytes.b[1]=1,na.instanceBytes.b[2]=1,na.instanceBytes.b[3]=1,na.instanceBytes.b[4]=0,na.instanceBytes.b[5]=1,na.instanceBytes.b[6]=1,na.instanceBytes.b[7]=0,na.instanceBytes.b[8]=0,na.instanceBytes.b[9]=0,na.instanceBytes.b[10]=0,na.instanceBytes.b[11]=0),this._elemBuffSize=36):this._elemBuffSize=240;this._bytes=new Ua(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_Shape"]=Rd;Rd.__name__=!0;Rd.__interfaces__=[hc];Rd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),K.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),K.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,
b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);K.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=na.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));K.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),
a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,36,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,36,4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,36,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,36,16),a.vertexAttribDivisor(3,
1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,36,24),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,36,32),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,40,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,8),a.enableVertexAttribArray(3),
a.vertexAttribPointer(3,2,a.FLOAT,!1,40,16),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,24),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,40,32),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(K.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*
Math.PI;e.b_UFloat32[c.bytePos+8>>2]=c.x;e.b_UFloat32[c.bytePos+12>>2]=c.y;e.b_UFloat32[c.bytePos+16>>2]=c.px_offset;e.b_UFloat32[c.bytePos+20>>2]=c.py_offset;e.b_UFloat32[c.bytePos+24>>2]=c.sides;e.b_UFloat32[c.bytePos+28>>2]=c.shape;e.b_Uint16[c.bytePos+32>>1]=c.w&65535;e.b_Uint16[c.bytePos+34>>1]=c.h&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+8>>2]=c.x,e.b_UFloat32[c.bytePos+12>>2]=c.y,
e.b_UFloat32[c.bytePos+16>>2]=c.px_offset,e.b_UFloat32[c.bytePos+20>>2]=c.py_offset,e.b_UFloat32[c.bytePos+24>>2]=c.sides,e.b_UFloat32[c.bytePos+28>>2]=c.shape,e.b_Uint16[c.bytePos+32>>1]=c.w&65535,e.b_Uint16[c.bytePos+34>>1]=c.h&65535,e.b[c.bytePos+36]=1,e.b[c.bytePos+37]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_UFloat32[c.bytePos+44>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+48>>2]=c.x,e.b_UFloat32[c.bytePos+52>>2]=c.y,e.b_UFloat32[c.bytePos+56>>2]=c.px_offset,e.b_UFloat32[c.bytePos+60>>
2]=c.py_offset,e.b_UFloat32[c.bytePos+64>>2]=c.sides,e.b_UFloat32[c.bytePos+68>>2]=c.shape,e.b_Uint16[c.bytePos+72>>1]=c.w&65535,e.b_Uint16[c.bytePos+74>>1]=c.h&65535,e.b[c.bytePos+76]=1,e.b[c.bytePos+77]=1,e.b_Int32[c.bytePos+80>>2]=c.color,e.b_UFloat32[c.bytePos+84>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+88>>2]=c.x,e.b_UFloat32[c.bytePos+92>>2]=c.y,e.b_UFloat32[c.bytePos+96>>2]=c.px_offset,e.b_UFloat32[c.bytePos+100>>2]=c.py_offset,e.b_UFloat32[c.bytePos+104>>2]=c.sides,e.b_UFloat32[c.bytePos+
108>>2]=c.shape,e.b_Uint16[c.bytePos+112>>1]=c.w&65535,e.b_Uint16[c.bytePos+114>>1]=c.h&65535,e.b[c.bytePos+116]=0,e.b[c.bytePos+117]=1,e.b_Int32[c.bytePos+120>>2]=c.color,e.b_UFloat32[c.bytePos+124>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+128>>2]=c.x,e.b_UFloat32[c.bytePos+132>>2]=c.y,e.b_UFloat32[c.bytePos+136>>2]=c.px_offset,e.b_UFloat32[c.bytePos+140>>2]=c.py_offset,e.b_UFloat32[c.bytePos+144>>2]=c.sides,e.b_UFloat32[c.bytePos+148>>2]=c.shape,e.b_Uint16[c.bytePos+152>>1]=c.w&65535,e.b_Uint16[c.bytePos+
154>>1]=c.h&65535,e.b[c.bytePos+156]=1,e.b[c.bytePos+157]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_UFloat32[c.bytePos+164>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+168>>2]=c.x,e.b_UFloat32[c.bytePos+172>>2]=c.y,e.b_UFloat32[c.bytePos+176>>2]=c.px_offset,e.b_UFloat32[c.bytePos+180>>2]=c.py_offset,e.b_UFloat32[c.bytePos+184>>2]=c.sides,e.b_UFloat32[c.bytePos+188>>2]=c.shape,e.b_Uint16[c.bytePos+192>>1]=c.w&65535,e.b_Uint16[c.bytePos+194>>1]=c.h&65535,e.b[c.bytePos+196]=0,e.b[c.bytePos+197]=
0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_UFloat32[c.bytePos+204>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+208>>2]=c.x,e.b_UFloat32[c.bytePos+212>>2]=c.y,e.b_UFloat32[c.bytePos+216>>2]=c.px_offset,e.b_UFloat32[c.bytePos+220>>2]=c.py_offset,e.b_UFloat32[c.bytePos+224>>2]=c.sides,e.b_UFloat32[c.bytePos+228>>2]=c.shape,e.b_Uint16[c.bytePos+232>>1]=c.w&65535,e.b_Uint16[c.bytePos+234>>1]=c.h&65535,e.b[c.bytePos+236]=0,e.b[c.bytePos+237]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);
e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},updateElement:function(a){if(K.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI;b.b_UFloat32[a.bytePos+8>>2]=a.x;b.b_UFloat32[a.bytePos+12>>2]=a.y;b.b_UFloat32[a.bytePos+16>>2]=a.px_offset;b.b_UFloat32[a.bytePos+20>>2]=a.py_offset;b.b_UFloat32[a.bytePos+24>>2]=a.sides;b.b_UFloat32[a.bytePos+
28>>2]=a.shape;b.b_Uint16[a.bytePos+32>>1]=a.w&65535;b.b_Uint16[a.bytePos+34>>1]=a.h&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.color,b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+8>>2]=a.x,b.b_UFloat32[a.bytePos+12>>2]=a.y,b.b_UFloat32[a.bytePos+16>>2]=a.px_offset,b.b_UFloat32[a.bytePos+20>>2]=a.py_offset,b.b_UFloat32[a.bytePos+24>>2]=a.sides,b.b_UFloat32[a.bytePos+28>>2]=a.shape,b.b_Uint16[a.bytePos+32>>1]=a.w&65535,b.b_Uint16[a.bytePos+34>>1]=a.h&65535,b.b[a.bytePos+
36]=1,b.b[a.bytePos+37]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_UFloat32[a.bytePos+44>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+48>>2]=a.x,b.b_UFloat32[a.bytePos+52>>2]=a.y,b.b_UFloat32[a.bytePos+56>>2]=a.px_offset,b.b_UFloat32[a.bytePos+60>>2]=a.py_offset,b.b_UFloat32[a.bytePos+64>>2]=a.sides,b.b_UFloat32[a.bytePos+68>>2]=a.shape,b.b_Uint16[a.bytePos+72>>1]=a.w&65535,b.b_Uint16[a.bytePos+74>>1]=a.h&65535,b.b[a.bytePos+76]=1,b.b[a.bytePos+77]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_UFloat32[a.bytePos+
84>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+88>>2]=a.x,b.b_UFloat32[a.bytePos+92>>2]=a.y,b.b_UFloat32[a.bytePos+96>>2]=a.px_offset,b.b_UFloat32[a.bytePos+100>>2]=a.py_offset,b.b_UFloat32[a.bytePos+104>>2]=a.sides,b.b_UFloat32[a.bytePos+108>>2]=a.shape,b.b_Uint16[a.bytePos+112>>1]=a.w&65535,b.b_Uint16[a.bytePos+114>>1]=a.h&65535,b.b[a.bytePos+116]=0,b.b[a.bytePos+117]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_UFloat32[a.bytePos+124>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+128>>2]=
a.x,b.b_UFloat32[a.bytePos+132>>2]=a.y,b.b_UFloat32[a.bytePos+136>>2]=a.px_offset,b.b_UFloat32[a.bytePos+140>>2]=a.py_offset,b.b_UFloat32[a.bytePos+144>>2]=a.sides,b.b_UFloat32[a.bytePos+148>>2]=a.shape,b.b_Uint16[a.bytePos+152>>1]=a.w&65535,b.b_Uint16[a.bytePos+154>>1]=a.h&65535,b.b[a.bytePos+156]=1,b.b[a.bytePos+157]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_UFloat32[a.bytePos+164>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+168>>2]=a.x,b.b_UFloat32[a.bytePos+172>>2]=a.y,b.b_UFloat32[a.bytePos+
176>>2]=a.px_offset,b.b_UFloat32[a.bytePos+180>>2]=a.py_offset,b.b_UFloat32[a.bytePos+184>>2]=a.sides,b.b_UFloat32[a.bytePos+188>>2]=a.shape,b.b_Uint16[a.bytePos+192>>1]=a.w&65535,b.b_Uint16[a.bytePos+194>>1]=a.h&65535,b.b[a.bytePos+196]=0,b.b[a.bytePos+197]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_UFloat32[a.bytePos+204>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+208>>2]=a.x,b.b_UFloat32[a.bytePos+212>>2]=a.y,b.b_UFloat32[a.bytePos+216>>2]=a.px_offset,b.b_UFloat32[a.bytePos+220>>2]=a.py_offset,
b.b_UFloat32[a.bytePos+224>>2]=a.sides,b.b_UFloat32[a.bytePos+228>>2]=a.shape,b.b_Uint16[a.bytePos+232>>1]=a.w&65535,b.b_Uint16[a.bytePos+234>>1]=a.h&65535,b.b[a.bytePos+236]=0,b.b[a.bytePos+237]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==
this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Ua(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];e=this._bytes;var f=d.bytePos,k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,
f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),K.isVAO&&(this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),
b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),
b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,
f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t::IN:: vec2 aPivot;\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: vec2 aFloat0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: vec2 vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\tvec2 pivot = ::if PIVOT_FORMULA::::PIVOT_FORMULA::::else::vec2((aSize.x) * 0.5 + (aPivot.x), (aSize.y) * 0.5 + (aPivot.y))::end::;\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( aRotZ, 0.0 )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + (aPosition * size - pivot) * mat2( vec2(cos(rotZ.x), -sin(rotZ.x)), vec2(sin(rotZ.x), cos(rotZ.x)) );\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\tvPack0.x = ::if FORMULA_VARYINGS.sides::::FORMULA_VARYINGS.sides::::else::aFloat0.x::end::;vPack0.y = ::if FORMULA_VARYINGS.shape::::FORMULA_VARYINGS.shape::::else::aFloat0.y::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: vec2 vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return["sides","shape"]},getCustomVaryings:function(){return["vPack0.x","vPack0.y"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return na.DEFAULT_FORMULA_VARS},getFormulas:function(){return na.FORMULAS},getAttributes:function(){return na.ATTRIBUTES},getFormulaNames:function(){return na.FORMULA_NAMES},getFormulaVaryings:function(){return""==na.FORMULA_VARYINGS?
[]:na.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==na.FORMULA_CONSTANTS?[]:na.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==na.FORMULA_CUSTOMS?[]:na.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!0},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,5,"aColorStart0");
a.bindAttribLocation(b,4,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,3,"aPivot");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;K.isINSTANCED?(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,
1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),
b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));K.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(5),b.disableVertexAttribArray(4),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),
b.disableVertexAttribArray(3),b.disableVertexAttribArray(6));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Rd};var Sd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);K.isINSTANCED?(null==da.instanceBytes&&
(da.instanceBytes=new Ua(new ArrayBuffer(12)),da.instanceBytes.b[0]=1,da.instanceBytes.b[1]=1,da.instanceBytes.b[2]=1,da.instanceBytes.b[3]=1,da.instanceBytes.b[4]=0,da.instanceBytes.b[5]=1,da.instanceBytes.b[6]=1,da.instanceBytes.b[7]=0,da.instanceBytes.b[8]=0,da.instanceBytes.b[9]=0,da.instanceBytes.b[10]=0,da.instanceBytes.b[11]=0),this._elemBuffSize=44):this._elemBuffSize=288;this._bytes=new Ua(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_Sprite"]=Sd;Sd.__name__=!0;Sd.__interfaces__=[hc];Sd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),K.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),K.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,
b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);K.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=da.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));K.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),
a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,44,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,44,4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,44,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,44,16),a.vertexAttribDivisor(3,
1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,3,a.FLOAT,!1,44,24),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,44,36),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,2,a.SHORT,!1,44,40),a.vertexAttribDivisor(7,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,48,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,
!1,48,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,48,8),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,48,16),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,3,a.FLOAT,!1,48,24),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,48,36),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,2,a.SHORT,!1,48,40),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,48,44)),this._gl.bindVertexArray(null))}},update:function(){for(var a=
0,b=this._maxElements;a<b;){var c=a++;if(K.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.c;e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI;e.b_UFloat32[c.bytePos+8>>2]=c.x;e.b_UFloat32[c.bytePos+12>>2]=c.y;e.b_UFloat32[c.bytePos+16>>2]=c.px_offset;e.b_UFloat32[c.bytePos+20>>2]=c.py_offset;e.b_UFloat32[c.bytePos+24>>2]=c.shakeAtTime;e.b_UFloat32[c.bytePos+28>>2]=c.shakeDurationX;e.b_UFloat32[c.bytePos+32>>2]=c.shakeDurationY;e.b_Uint16[c.bytePos+36>>1]=c.w&65535;
e.b_Uint16[c.bytePos+38>>1]=c.h&65535;e.b_Uint16[c.bytePos+40>>1]=c.slot&65535;e.b_Uint16[c.bytePos+42>>1]=c.tile&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.c,e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+8>>2]=c.x,e.b_UFloat32[c.bytePos+12>>2]=c.y,e.b_UFloat32[c.bytePos+16>>2]=c.px_offset,e.b_UFloat32[c.bytePos+20>>2]=c.py_offset,e.b_UFloat32[c.bytePos+24>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+28>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+
32>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+36>>1]=c.w&65535,e.b_Uint16[c.bytePos+38>>1]=c.h&65535,e.b_Uint16[c.bytePos+40>>1]=c.slot&65535,e.b_Uint16[c.bytePos+42>>1]=c.tile&65535,e.b[c.bytePos+44]=1,e.b[c.bytePos+45]=1,e.b_Int32[c.bytePos+48>>2]=c.c,e.b_UFloat32[c.bytePos+52>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+56>>2]=c.x,e.b_UFloat32[c.bytePos+60>>2]=c.y,e.b_UFloat32[c.bytePos+64>>2]=c.px_offset,e.b_UFloat32[c.bytePos+68>>2]=c.py_offset,e.b_UFloat32[c.bytePos+72>>2]=c.shakeAtTime,
e.b_UFloat32[c.bytePos+76>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+80>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+84>>1]=c.w&65535,e.b_Uint16[c.bytePos+86>>1]=c.h&65535,e.b_Uint16[c.bytePos+88>>1]=c.slot&65535,e.b_Uint16[c.bytePos+90>>1]=c.tile&65535,e.b[c.bytePos+92]=1,e.b[c.bytePos+93]=1,e.b_Int32[c.bytePos+96>>2]=c.c,e.b_UFloat32[c.bytePos+100>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+104>>2]=c.x,e.b_UFloat32[c.bytePos+108>>2]=c.y,e.b_UFloat32[c.bytePos+112>>2]=c.px_offset,e.b_UFloat32[c.bytePos+
116>>2]=c.py_offset,e.b_UFloat32[c.bytePos+120>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+124>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+128>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+132>>1]=c.w&65535,e.b_Uint16[c.bytePos+134>>1]=c.h&65535,e.b_Uint16[c.bytePos+136>>1]=c.slot&65535,e.b_Uint16[c.bytePos+138>>1]=c.tile&65535,e.b[c.bytePos+140]=0,e.b[c.bytePos+141]=1,e.b_Int32[c.bytePos+144>>2]=c.c,e.b_UFloat32[c.bytePos+148>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+152>>2]=c.x,e.b_UFloat32[c.bytePos+
156>>2]=c.y,e.b_UFloat32[c.bytePos+160>>2]=c.px_offset,e.b_UFloat32[c.bytePos+164>>2]=c.py_offset,e.b_UFloat32[c.bytePos+168>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+172>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+176>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+180>>1]=c.w&65535,e.b_Uint16[c.bytePos+182>>1]=c.h&65535,e.b_Uint16[c.bytePos+184>>1]=c.slot&65535,e.b_Uint16[c.bytePos+186>>1]=c.tile&65535,e.b[c.bytePos+188]=1,e.b[c.bytePos+189]=0,e.b_Int32[c.bytePos+192>>2]=c.c,e.b_UFloat32[c.bytePos+196>>
2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+200>>2]=c.x,e.b_UFloat32[c.bytePos+204>>2]=c.y,e.b_UFloat32[c.bytePos+208>>2]=c.px_offset,e.b_UFloat32[c.bytePos+212>>2]=c.py_offset,e.b_UFloat32[c.bytePos+216>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+220>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+224>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+228>>1]=c.w&65535,e.b_Uint16[c.bytePos+230>>1]=c.h&65535,e.b_Uint16[c.bytePos+232>>1]=c.slot&65535,e.b_Uint16[c.bytePos+234>>1]=c.tile&65535,e.b[c.bytePos+236]=
0,e.b[c.bytePos+237]=0,e.b_Int32[c.bytePos+240>>2]=c.c,e.b_UFloat32[c.bytePos+244>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+248>>2]=c.x,e.b_UFloat32[c.bytePos+252>>2]=c.y,e.b_UFloat32[c.bytePos+256>>2]=c.px_offset,e.b_UFloat32[c.bytePos+260>>2]=c.py_offset,e.b_UFloat32[c.bytePos+264>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+268>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+272>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+276>>1]=c.w&65535,e.b_Uint16[c.bytePos+278>>1]=c.h&65535,e.b_Uint16[c.bytePos+
280>>1]=c.slot&65535,e.b_Uint16[c.bytePos+282>>1]=c.tile&65535,e.b[c.bytePos+284]=0,e.b[c.bytePos+285]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},updateElement:function(a){if(K.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.c;b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI;b.b_UFloat32[a.bytePos+8>>2]=a.x;b.b_UFloat32[a.bytePos+
12>>2]=a.y;b.b_UFloat32[a.bytePos+16>>2]=a.px_offset;b.b_UFloat32[a.bytePos+20>>2]=a.py_offset;b.b_UFloat32[a.bytePos+24>>2]=a.shakeAtTime;b.b_UFloat32[a.bytePos+28>>2]=a.shakeDurationX;b.b_UFloat32[a.bytePos+32>>2]=a.shakeDurationY;b.b_Uint16[a.bytePos+36>>1]=a.w&65535;b.b_Uint16[a.bytePos+38>>1]=a.h&65535;b.b_Uint16[a.bytePos+40>>1]=a.slot&65535;b.b_Uint16[a.bytePos+42>>1]=a.tile&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.c,b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+
8>>2]=a.x,b.b_UFloat32[a.bytePos+12>>2]=a.y,b.b_UFloat32[a.bytePos+16>>2]=a.px_offset,b.b_UFloat32[a.bytePos+20>>2]=a.py_offset,b.b_UFloat32[a.bytePos+24>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+28>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+32>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+36>>1]=a.w&65535,b.b_Uint16[a.bytePos+38>>1]=a.h&65535,b.b_Uint16[a.bytePos+40>>1]=a.slot&65535,b.b_Uint16[a.bytePos+42>>1]=a.tile&65535,b.b[a.bytePos+44]=1,b.b[a.bytePos+45]=1,b.b_Int32[a.bytePos+48>>2]=a.c,b.b_UFloat32[a.bytePos+
52>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+56>>2]=a.x,b.b_UFloat32[a.bytePos+60>>2]=a.y,b.b_UFloat32[a.bytePos+64>>2]=a.px_offset,b.b_UFloat32[a.bytePos+68>>2]=a.py_offset,b.b_UFloat32[a.bytePos+72>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+76>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+80>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+84>>1]=a.w&65535,b.b_Uint16[a.bytePos+86>>1]=a.h&65535,b.b_Uint16[a.bytePos+88>>1]=a.slot&65535,b.b_Uint16[a.bytePos+90>>1]=a.tile&65535,b.b[a.bytePos+92]=1,b.b[a.bytePos+
93]=1,b.b_Int32[a.bytePos+96>>2]=a.c,b.b_UFloat32[a.bytePos+100>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+104>>2]=a.x,b.b_UFloat32[a.bytePos+108>>2]=a.y,b.b_UFloat32[a.bytePos+112>>2]=a.px_offset,b.b_UFloat32[a.bytePos+116>>2]=a.py_offset,b.b_UFloat32[a.bytePos+120>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+124>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+128>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+132>>1]=a.w&65535,b.b_Uint16[a.bytePos+134>>1]=a.h&65535,b.b_Uint16[a.bytePos+136>>1]=a.slot&
65535,b.b_Uint16[a.bytePos+138>>1]=a.tile&65535,b.b[a.bytePos+140]=0,b.b[a.bytePos+141]=1,b.b_Int32[a.bytePos+144>>2]=a.c,b.b_UFloat32[a.bytePos+148>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+152>>2]=a.x,b.b_UFloat32[a.bytePos+156>>2]=a.y,b.b_UFloat32[a.bytePos+160>>2]=a.px_offset,b.b_UFloat32[a.bytePos+164>>2]=a.py_offset,b.b_UFloat32[a.bytePos+168>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+172>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+176>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+180>>1]=
a.w&65535,b.b_Uint16[a.bytePos+182>>1]=a.h&65535,b.b_Uint16[a.bytePos+184>>1]=a.slot&65535,b.b_Uint16[a.bytePos+186>>1]=a.tile&65535,b.b[a.bytePos+188]=1,b.b[a.bytePos+189]=0,b.b_Int32[a.bytePos+192>>2]=a.c,b.b_UFloat32[a.bytePos+196>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+200>>2]=a.x,b.b_UFloat32[a.bytePos+204>>2]=a.y,b.b_UFloat32[a.bytePos+208>>2]=a.px_offset,b.b_UFloat32[a.bytePos+212>>2]=a.py_offset,b.b_UFloat32[a.bytePos+216>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+220>>2]=a.shakeDurationX,
b.b_UFloat32[a.bytePos+224>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+228>>1]=a.w&65535,b.b_Uint16[a.bytePos+230>>1]=a.h&65535,b.b_Uint16[a.bytePos+232>>1]=a.slot&65535,b.b_Uint16[a.bytePos+234>>1]=a.tile&65535,b.b[a.bytePos+236]=0,b.b[a.bytePos+237]=0,b.b_Int32[a.bytePos+240>>2]=a.c,b.b_UFloat32[a.bytePos+244>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+248>>2]=a.x,b.b_UFloat32[a.bytePos+252>>2]=a.y,b.b_UFloat32[a.bytePos+256>>2]=a.px_offset,b.b_UFloat32[a.bytePos+260>>2]=a.py_offset,b.b_UFloat32[a.bytePos+
264>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+268>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+272>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+276>>1]=a.w&65535,b.b_Uint16[a.bytePos+278>>1]=a.h&65535,b.b_Uint16[a.bytePos+280>>1]=a.slot&65535,b.b_Uint16[a.bytePos+282>>1]=a.tile&65535,b.b[a.bytePos+284]=0,b.b[a.bytePos+285]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,
a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Ua(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];
e=this._bytes;var f=d.bytePos,k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null),K.isVAO&&(this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,44,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,44,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,
2,b.FLOAT,!1,44,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,44,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,3,b.FLOAT,!1,44,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,44,36),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,2,b.SHORT,!1,44,40),b.vertexAttribDivisor(7,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),
b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,48,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,48,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,48,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,48,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,3,b.FLOAT,!1,48,24),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,48,36),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,2,b.SHORT,
!1,48,40),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,48,44)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t::IN:: vec2 aPivot;\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: vec3 aFloat0;::IN:: vec2 aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: vec2 vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\tvec2 pivot = ::if PIVOT_FORMULA::::PIVOT_FORMULA::::else::vec2((aSize.x) * 0.5 + (aPivot.x), (aSize.y) * 0.5 + (aPivot.y))::end::;\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( aRotZ, 0.0 )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::vec2((aPos.x) + shake((aFloat0.x), 7.0, 8.0, (aFloat0.y)), (aPos.y) + shake((aFloat0.x), 5.0, 6.0, (aFloat0.z)))::end::;\npos = pos + (aPosition * size - pivot) * mat2( vec2(cos(rotZ.x), -sin(rotZ.x)), vec2(sin(rotZ.x), cos(rotZ.x)) );\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0.x = ::if FORMULA_VARYINGS.slot::::FORMULA_VARYINGS.slot::::else::aShort0.x::end::;vTexPack0.y = ::if FORMULA_VARYINGS.tile::::FORMULA_VARYINGS.tile::::else::aShort0.y::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: vec2 vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.x, ::SLOTS_X::)) * ::SLOT_WIDTH:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOT_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOT_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.x)/::SLOTS_X::) * ::SLOT_HEIGHT:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOT_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER == 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.x, ::SLOTS_X::)) * ::SLOT_WIDTH:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOT_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOT_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.x)/::SLOTS_X::) * ::SLOT_HEIGHT:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOT_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 1)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return["base"]},getColorIdentifiers:function(){return["c"]},getCustomIdentifiers:function(){return["shakeAtTime","shakeDurationX","shakeDurationY"]},getCustomVaryings:function(){return["null","null","null"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return da.DEFAULT_FORMULA_VARS},getFormulas:function(){return da.FORMULAS},getAttributes:function(){return da.ATTRIBUTES},getFormulaNames:function(){return da.FORMULA_NAMES},getFormulaVaryings:function(){return""==
da.FORMULA_VARYINGS?[]:da.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==da.FORMULA_CONSTANTS?[]:da.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==da.FORMULA_CUSTOMS?[]:da.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!0},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!0},bindAttribLocations:function(a,b){a.bindAttribLocation(b,
5,"aColorStart0");a.bindAttribLocation(b,4,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,3,"aPivot");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,7,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;K.isINSTANCED?(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,
2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,44,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,44,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,44,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,44,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,
3,b.FLOAT,!1,44,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,44,36),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,2,b.SHORT,!1,44,40),b.vertexAttribDivisor(7,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,48,0),b.enableVertexAttribArray(4),
b.vertexAttribPointer(4,1,b.FLOAT,!1,48,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,48,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,48,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,3,b.FLOAT,!1,48,24),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,48,36),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,2,b.SHORT,!1,48,40),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,48,44)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,
0,6*a));K.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(5),b.disableVertexAttribArray(4),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(3),b.disableVertexAttribArray(6),b.disableVertexAttribArray(7));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Sd};var Td=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=
this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);K.isINSTANCED?(null==fa.instanceBytes&&(fa.instanceBytes=new Ua(new ArrayBuffer(12)),fa.instanceBytes.b[0]=1,fa.instanceBytes.b[1]=1,fa.instanceBytes.b[2]=1,fa.instanceBytes.b[3]=1,fa.instanceBytes.b[4]=0,fa.instanceBytes.b[5]=1,fa.instanceBytes.b[6]=1,fa.instanceBytes.b[7]=0,fa.instanceBytes.b[8]=
0,fa.instanceBytes.b[9]=0,fa.instanceBytes.b[10]=0,fa.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new Ua(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_ViewElement"]=Td;Td.__name__=!0;Td.__interfaces__=[hc];Td.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),K.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),
K.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);K.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=fa.instanceBytes,b=new Uint8Array(b.b.bufferValue,
0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));K.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},updateElement:function(a){if(K.isINSTANCED){var b=this._bytes;b.b_Uint16[a.bytePos>>1]=a.x&65535;b.b_Uint16[a.bytePos+
2>>1]=a.y&65535;b.b_Uint16[a.bytePos+4>>1]=a.w&65535;b.b_Uint16[a.bytePos+6>>1]=a.h&65535}else b=this._bytes,b.b_Uint16[a.bytePos>>1]=a.x&65535,b.b_Uint16[a.bytePos+2>>1]=a.y&65535,b.b_Uint16[a.bytePos+4>>1]=a.w&65535,b.b_Uint16[a.bytePos+6>>1]=a.h&65535,b.b[a.bytePos+8]=1,b.b[a.bytePos+9]=1,b.b_Uint16[a.bytePos+12>>1]=a.x&65535,b.b_Uint16[a.bytePos+14>>1]=a.y&65535,b.b_Uint16[a.bytePos+16>>1]=a.w&65535,b.b_Uint16[a.bytePos+18>>1]=a.h&65535,b.b[a.bytePos+20]=1,b.b[a.bytePos+21]=1,b.b_Uint16[a.bytePos+
24>>1]=a.x&65535,b.b_Uint16[a.bytePos+26>>1]=a.y&65535,b.b_Uint16[a.bytePos+28>>1]=a.w&65535,b.b_Uint16[a.bytePos+30>>1]=a.h&65535,b.b[a.bytePos+32]=0,b.b[a.bytePos+33]=1,b.b_Uint16[a.bytePos+36>>1]=a.x&65535,b.b_Uint16[a.bytePos+38>>1]=a.y&65535,b.b_Uint16[a.bytePos+40>>1]=a.w&65535,b.b_Uint16[a.bytePos+42>>1]=a.h&65535,b.b[a.bytePos+44]=1,b.b[a.bytePos+45]=0,b.b_Uint16[a.bytePos+48>>1]=a.x&65535,b.b_Uint16[a.bytePos+50>>1]=a.y&65535,b.b_Uint16[a.bytePos+52>>1]=a.w&65535,b.b_Uint16[a.bytePos+54>>
1]=a.h&65535,b.b[a.bytePos+56]=0,b.b[a.bytePos+57]=0,b.b_Uint16[a.bytePos+60>>1]=a.x&65535,b.b_Uint16[a.bytePos+62>>1]=a.y&65535,b.b_Uint16[a.bytePos+64>>1]=a.w&65535,b.b_Uint16[a.bytePos+66>>1]=a.h&65535,b.b[a.bytePos+68]=0,b.b[a.bytePos+69]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==
a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Ua(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];e=this._bytes;var f=d.bytePos,k=this._elemBuffSize;null==k&&(k=0);
null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),K.isVAO&&(this._gl.bindVertexArray(this._glVAO),K.isINSTANCED?
(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,
!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;k=this._elemBuffSize;null==k&&(k=0);null==f&&(f=0);e=0<k?new Uint8Array(e.b.bufferValue,f,k):new Uint8Array(e.b.bufferValue,f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");
},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return fa.DEFAULT_FORMULA_VARS},getFormulas:function(){return fa.FORMULAS},getAttributes:function(){return fa.ATTRIBUTES},getFormulaNames:function(){return fa.FORMULA_NAMES},getFormulaVaryings:function(){return""==fa.FORMULA_VARYINGS?[]:fa.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==fa.FORMULA_CONSTANTS?[]:fa.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==fa.FORMULA_CUSTOMS?[]:fa.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,
0,"aPosition")},render:function(a,b,c){a=this._maxElements;K.isINSTANCED?(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,
1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(K.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));K.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Td};var xd=function(a,b,c,e,g){null==g&&(g=0);this.renderFramebufferSkipFrames=this.renderFramebufferFrame=0;this._renderFramebufferEnabled=!1;this.renderFramebufferEnabled=!0;this.framebufferTextureSlot=0;this.peoteView=this.gl=this.fbTexture=null;this.alpha=1;this.red=this.green=this.blue=0;this.backgroundAlpha=this.backgroundDepth=this.backgroundEnabled=!1;this.isVisible=!0;this.xz=
this.yz=1;this.width=this.height=this.x=this.y=this.xOffset=this.yOffset=0;if(K.isUBO){var h=this.uniformBuffer,d=this.gl;null!=d&&(h.uniformBytes.b_UFloat32[0]=a+this.xOffset,d.bindBuffer(d.UNIFORM_BUFFER,h.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,0,h.xOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null))}this.x=a;K.isUBO&&(h=this.uniformBuffer,d=this.gl,null!=d&&(h.uniformBytes.b_UFloat32[1]=b+this.yOffset,d.bindBuffer(d.UNIFORM_BUFFER,h.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,
4,h.yOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null)));this.y=b;this.width=c;this.height=e;this.red=(g>>24&255)/255;this.green=(g>>16&255)/255;this.blue=(g>>8&255)/255;this.alpha=(g&255)/255;this.backgroundEnabled=0<this.alpha;this.backgroundAlpha=1>this.alpha;this.programList=new Ne(new yb);K.isUBO&&(this.uniformBuffer=new Ud,this.uniformBufferFB=new Ud,this.uniformBufferViewFB=new Vd)};d["peote.view.Display"]=xd;xd.__name__=!0;xd.prototype={addToPeoteView:function(a,b,c){null==c&&(c=!1);
this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.displayList.add(this,b,c)},removeFromPeoteView:function(a){if(this.peoteView!=a)throw A.thrown("Error, display is not inside peoteView");a.framebufferDisplayList.has(this)||(this.peoteView=null);a.displayList.remove(this)},addToPeoteViewFramebuffer:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.framebufferDisplayList.add(this,b,c)},setNewGLContext:function(a){if(null!=a&&a!=this.gl){null!=
this.gl&&K.isUBO&&(this.uniformBuffer.deleteGLBuffer(this.gl),this.uniformBufferFB.deleteGLBuffer(this.gl),this.uniformBufferViewFB.deleteGLBuffer(this.gl));this.gl=a;K.isUBO&&(this.uniformBuffer.createGLBuffer(this.gl,this.x+this.xOffset,this.y+this.yOffset,this.xz,this.yz),this.uniformBufferFB.createGLBuffer(this.gl,this.xOffset,this.yOffset-this.height,this.xz,this.yz),this.uniformBufferViewFB.createGLBuffer(this.gl,this.width,-this.height,0,0,1,1));for(var b=this.programList.first;null!=b;){var c=
b.value;b=b.next;if(null!=a&&a!=c.gl){for(var e=0,g=c.displays;e<g.length;){var d=g[e];++e;if(null!=d.gl&&d.gl!=a)throw A.thrown("Error, program can not used inside different gl-contexts");}null!=c.gl&&(c.gl.deleteShader(c.glVertexShader),c.gl.deleteShader(c.glFragmentShader),c.gl.deleteProgram(c.glProgram),c.buffer.hasPicking()&&(c.gl.deleteShader(c.glVertexShaderPicking),c.gl.deleteShader(c.glFragmentShaderPicking),c.gl.deleteProgram(c.glProgramPicking)));c.gl=a;K.isES3&&(c.glShaderConfig.isES3=
!0,c.glShaderConfig.IN="in",c.glShaderConfig.VARIN="in",c.glShaderConfig.VAROUT="out");K.isUBO&&(c.glShaderConfig.isUBO=!0);K.isINSTANCED&&(c.glShaderConfig.isINSTANCED=!0);c.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=c.gl.getExtension("OES_standard_derivatives")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=c.gl.getExtension("EXT_color_buffer_float")?c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=c.gl.getExtension("OES_texture_float")&&
c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});c.buffer.setNewGLContext(c.gl);c.createProg();c.buffer.hasPicking()&&c.createProg(!0);e=0;for(g=c.activeTextures;e<g.length;){d=g[e];++e;var f=c.gl;if(null!=f&&f!=d.gl){for(var l=0,k=d.programs;l<k.length;){var y=k[l];++l;if(null!=y.gl&&y.gl!=f)throw A.thrown("Error, texture can not used inside different gl-contexts");}y=0;for(l=d.displays;y<l.length;)if(k=l[y],++y,null!=k.gl&&k.gl!=f)throw A.thrown("Error, texture can not used inside different gl-contexts");
null!=d.gl&&(d.gl.deleteTexture(d.glTexture),d.glTexture=null,0==d.displays.length&&null!=d.framebuffer&&(d.gl.deleteFramebuffer(d.framebuffer),d.framebuffer=null,null!=d.glDepthBuffer&&d.gl.deleteRenderbuffer(d.glDepthBuffer),d.glDepthBuffer=null));d.gl=f;if(d.width>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE)||d.height>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");d.glTexture=Ob.createEmptyTexture(d.gl,d.width,d.height,d.colorChannels,
d.createMipmaps,d.magFilter,d.minFilter,d.useFloat);if(0<d.displays.length&&null==d.framebuffer){d.glDepthBuffer=d.gl.createRenderbuffer();f=d.gl;y=d.glTexture;l=d.glDepthBuffer;k=d.width;var E=d.height,r=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,l);Ma.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,k,E);Ma.getLastGlError(f)==f.INVALID_ENUM&&(ia.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,k,E));f.bindFramebuffer(f.FRAMEBUFFER,r);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,l);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,y,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);d.framebuffer=r;d.updated=
!0}for(f=d.images.keys();f.hasNext();)y=f.next(),d.bufferImage(y,d.images.h[y.__id__])}}}}if(null!=this.fbTexture&&(b=this.fbTexture,null!=a&&a!=b.gl)){e=0;for(g=b.programs;e<g.length;)if(y=g[e],++e,null!=y.gl&&y.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");e=0;for(g=b.displays;e<g.length;)if(d=g[e],++e,null!=d.gl&&d.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==
b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=Ob.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&
null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();f=b.gl;y=b.glTexture;l=b.glDepthBuffer;k=b.width;E=b.height;r=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,l);Ma.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,k,E);Ma.getLastGlError(f)==f.INVALID_ENUM&&(ia.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,
f.DEPTH_COMPONENT16,k,E));f.bindFramebuffer(f.FRAMEBUFFER,r);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,l);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,y,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);b.framebuffer=r;b.updated=!0}for(f=b.images.keys();f.hasNext();)y=f.next(),b.bufferImage(y,b.images.h[y.__id__])}}},
addProgram:function(a,b,c){null==c&&(c=!1);a.addToDisplay(this,b,c)},setFramebuffer:function(a,b,c){if(this.fbTexture==a)throw A.thrown("Error, texture is already in use as Framebuffer for Display");if(b>=a.imageSlots)throw A.thrown("Error, maximum texture slot of framebufferTexture is"+(a.imageSlots-1));if(null==c){if(null==this.gl)throw A.thrown("Error, if the display is not added it needs the gl-context of a peoteView to set a framebuffer texture");}else this.peoteView!=c&&(this.peoteView=c,this.setNewGLContext(c.gl));
null!=b&&(this.framebufferTextureSlot=b);if(null!=this.fbTexture){b=this.fbTexture;if(!I.remove(b.displays,this))throw A.thrown("Error, this texture (Framebuffer) is not used by display anymore");0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null)}b=this.fbTexture=a;if(0<=b.displays.indexOf(this))throw A.thrown("Error, texture is already used by display");a=this.gl;
if(null!=a&&a!=b.gl){c=0;for(var e=b.programs;c<e.length;){var g=e[c];++c;if(null!=g.gl&&g.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");}c=0;for(e=b.displays;c<e.length;)if(g=e[c],++c,null!=g.gl&&g.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&
b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=Ob.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;g=b.width;
var d=b.height,f=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);Ma.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT24,g,d);Ma.getLastGlError(c)==c.INVALID_ENUM&&(ia.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,g,d));c.bindFramebuffer(c.FRAMEBUFFER,f);c.framebufferRenderbuffer(c.FRAMEBUFFER,
c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=f;b.updated=!0}for(a=b.images.keys();a.hasNext();)c=a.next(),b.bufferImage(c,b.images.h[c.__id__])}b.displays.push(this);if(null!=b.gl&&0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=
b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;g=b.width;d=b.height;f=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);Ma.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT24,g,d);Ma.getLastGlError(c)==c.INVALID_ENUM&&(ia.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,
g,d));c.bindFramebuffer(c.FRAMEBUFFER,f);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=f;b.updated=!0}this.renderFramebufferEnabled&&(this._renderFramebufferEnabled=!0)},__class__:xd};var wf=
{fromRenderContext:function(a){if(null!=a.webgl2)return ia.trace("WEBGL2 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:86,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),K.isUBO=!0,K.isINSTANCED=!0,K.isVAO=!0,K.isES3=!0,a.webgl2;if(null!=a.webgl)return ia.trace("WEBGL1 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:91,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),a.webgl;window.alert("Error: missing webgl context");
return null}},K=function(){};d["peote.view.Version"]=K;K.__name__=!0;var Na=function(){};d["peote.view.Precision"]=Na;Na.__name__=!0;var Ke=function(a,b,c){null==c&&(c=!0);null==b&&(b=255);this.speed=1;this.startTime=this.stopTime=0;this.isRun=!1;this.xOffset=this.yOffset=0;this.xz=this.yz=1;this.maskState=0;this.glStateAlpha=this.glStateDepth=!1;this.colorState=!0;this.alpha=1;this.red=this.green=this.blue=0;this.gl=wf.fromRenderContext(a.context);this.width=a.__width;this.height=a.__height;this.red=
(b>>24&255)/255;this.green=(b>>16&255)/255;this.blue=(b>>8&255)/255;this.alpha=(b&255)/255;K.isUBO&&(this.uniformBuffer=new Vd,this.uniformBuffer.createGLBuffer(this.gl,this.width,this.height,this.xOffset,this.yOffset,this.xz,this.yz));this.maxTextureImageUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);this.glStateTexture=b=Array(this.maxTextureImageUnits);b=this.gl;var e=b.VERTEX_SHADER,g=Na.VertexFloat,d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,
b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.VERTEX_SHADER;g=Na.VertexInt;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.VERTEX_SHADER;g=Na.VertexSampler;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,
b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.FRAGMENT_SHADER;g=Na.FragmentFloat;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.FRAGMENT_SHADER;g=Na.FragmentInt;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=
b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.FRAGMENT_SHADER;g=Na.FragmentSampler;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);K.isINSTANCED?(this.pickInt32=b=new Int32Array(4),this.pickTexture=Ob.createPickingTexture(this.gl,
!0)):(this.pickUInt8=b=new Uint8Array(4),this.pickTexture=Ob.createPickingTexture(this.gl));this.pickDepthBuffer=this.gl.createRenderbuffer();b=this.gl;e=this.pickTexture;g=this.pickDepthBuffer;d=b.createFramebuffer();b.bindRenderbuffer(b.RENDERBUFFER,g);Ma.clearGlErrorQueue(b);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT24,1,1);Ma.getLastGlError(b)==b.INVALID_ENUM&&(ia.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,1,1));b.bindFramebuffer(b.FRAMEBUFFER,d);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,g);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!=b.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindRenderbuffer(b.RENDERBUFFER,null);this.pickFB=d;this.background=
new Oe(this.gl);this.displayList=new Wd(new yb);this.framebufferDisplayList=new Wd(new yb);c&&(a.onRender.add(n(this,this.render)),a.onResize.add(n(this,this.resize)))};d["peote.view.PeoteView"]=Ke;Ke.__name__=!0;Ke.prototype={isTextureStateChange:function(a,b){return b.updated?(b.updated=!1,this.glStateTexture=Array(this.maxTextureImageUnits),this.glStateTexture[a]=b.glTexture,!0):this.glStateTexture[a]!=b.glTexture?(this.glStateTexture[a]=b.glTexture,!0):!1},start:function(){if(!this.isRun){var a=
this.stopTime;this.startTime=this.stopTime=(new Date).getTime()/1E3-a;this.isRun=!0}},addDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteView(this,b,c)},removeDisplay:function(a){a.removeFromPeoteView(this)},addFramebufferDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteViewFramebuffer(this,b,c)},resize:function(a,b){this.width=a;this.height=b;if(K.isUBO){var c=this.uniformBuffer,e=this.gl;c.uniformBytes.b_UFloat32[0]=a;c.uniformBytes.b_UFloat32[1]=b;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);
e.bufferSubData(e.UNIFORM_BUFFER,0,c.resolutionBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}},renderToTexture:function(a,b){if(null!=a.fbTexture){b=null!=b?b:a.framebufferTextureSlot;null==b&&(b=a.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.fbTexture.framebuffer);this.gl.viewport(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.scissor(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,
a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);a.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(a.backgroundEnabled){1!=
this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=a.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=0);this.background.render(a.red,a.green,a.blue,a.alpha)}for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;b.gl.useProgram(b.glProgram);for(b.textureListItem=
b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;K.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,a.uniformBufferViewFB.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,
1,a.uniformBufferFB.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,a.width,-a.height),b.gl.uniform2f(b.uZOOM,a.xz,a.yz),b.gl.uniform2f(b.uOFFSET,(a.xOffset+this.xOffset)/a.xz,(a.yOffset+this.yOffset-a.height)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=b.uniformFloats.length;c<e;){var g=c++;b.gl.uniform1f(b.uniformFloatLocations[g],b.uniformFloats[g].value)}c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,
c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),
0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null);a.programListItem=a.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);a.fbTexture.createMipmaps&&
(this.gl.bindTexture(this.gl.TEXTURE_2D,a.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null),a.fbTexture.updated=!0)}},render:function(a){for(this.displayListItem=this.framebufferDisplayList.first;null!=this.displayListItem;){if(this.displayListItem.value._renderFramebufferEnabled)if(this.displayListItem.value.renderFramebufferFrame==this.displayListItem.value.renderFramebufferSkipFrames){var b=this.displayListItem.value;a=null;null==a&&(a=
b.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.fbTexture.framebuffer);this.gl.viewport(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.scissor(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);b.fbTexture.clearOnRenderInto?
this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(b.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=b.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&
(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0);this.background.render(b.red,b.green,b.blue,b.alpha)}for(b.programListItem=b.programList.first;null!=b.programListItem;){a=b.programListItem.value;a.gl.useProgram(a.glProgram);for(a.textureListItem=a.textureList.first;null!=a.textureListItem;)this.isTextureStateChange(a.textureListItem.value.unit,a.textureListItem.value.texture)&&(a.gl.activeTexture(a.gl.TEXTURE0+
a.textureListItem.value.unit),a.gl.bindTexture(a.gl.TEXTURE_2D,a.textureListItem.value.texture.glTexture)),a.gl.uniform1i(a.textureListItem.value.uniformLoc,a.textureListItem.value.unit),a.textureListItem=a.textureListItem.next;K.isUBO?(a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,0,b.uniformBufferViewFB.uniformBuffer),a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,1,b.uniformBufferFB.uniformBuffer)):(a.gl.uniform2f(a.uRESOLUTION,b.width,-b.height),a.gl.uniform2f(a.uZOOM,b.xz,b.yz),a.gl.uniform2f(a.uOFFSET,(b.xOffset+
this.xOffset)/b.xz,(b.yOffset+this.yOffset-b.height)/b.yz));a.gl.uniform1f(a.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=a.uniformFloats.length;c<e;){var g=c++;a.gl.uniform1f(a.uniformFloatLocations[g],a.uniformFloats[g].value)}c=a.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=a.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=
!1,this.gl.disable(this.gl.DEPTH_TEST));(c=a.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=a.mask;e=a.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,
this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);a.buffer.render(this,b,a);a.gl.useProgram(null);b.programListItem=b.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);b.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,b.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,
null),b.fbTexture.updated=!0);this.displayListItem.value.renderFramebufferFrame=0}else this.displayListItem.value.renderFramebufferFrame++;this.displayListItem=this.displayListItem.next}b=this.width;c=this.height;this.gl.viewport(0,0,b,c);this.gl.scissor(0,0,b,c);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(this.red,this.green,this.blue,this.alpha);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,
this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);for(this.displayListItem=this.displayList.first;null!=this.displayListItem;){a=this.displayListItem.value;if(a.isVisible){b=this.width;c=this.height;var d=this.xz,f=this.yz;e=Math.floor((a.x+this.xOffset)*d);g=Math.floor((a.y+this.yOffset)*f);d=Math.floor(a.width*d);f=Math.floor(a.height*f);0>e&&(d+=e);e=Math.max(0,Math.min(b,e))|0;d=Math.max(0,Math.min(b-e,d))|0;0>g&&(f+=g);g=Math.max(0,Math.min(c,g))|0;f=Math.max(0,Math.min(c-g,f))|
0;this.gl.scissor(e,c-f-g,d,f);a.backgroundEnabled&&(1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0)),(c=a.backgroundDepth)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST)),(c=a.backgroundAlpha)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND)),0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),
this.maskState=this.maskState=0),this.background.render(a.red,a.green,a.blue,a.alpha));for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;if(b.isVisible){b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),
b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;K.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,this.uniformBuffer.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBuffer.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,this.width,this.height),b.gl.uniform2f(b.uZOOM,this.xz*a.xz,this.yz*a.yz),b.gl.uniform2f(b.uOFFSET,(a.x+a.xOffset+this.xOffset)/a.xz,(a.y+a.yOffset+this.yOffset)/a.yz));b.gl.uniform1f(b.uTIME,
(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(e=b.uniformFloats.length;c<e;)g=c++,b.gl.uniform1f(b.uniformFloatLocations[g],b.uniformFloats[g].value);c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=
!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),
this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null)}a.programListItem=a.programListItem.next}}this.displayListItem=this.displayListItem.next}},__class__:Ke};var Ld=function(a,b,c){this.unit=a;this.texture=b;this.uniformLoc=c};d["peote.view.ActiveTexture"]=Ld;Ld.__name__=!0;Ld.prototype={__class__:Ld};var Ac=function(a,b,c,e,g,d,f,l,k){null==k&&(k=16384);null==l&&(l=!1);null==f&&(f=0);
null==d&&(d=0);null==g&&(g=!1);null==e&&(e=4);null==c&&(c=1);this.displays=[];this.programs=[];this.useFloat=this.updated=!1;this.magFilter=this.minFilter=0;this.createMipmaps=!1;this.images=new yb;this.imageSlots=this.freeSlots=this.slotsX=this.slotsY=this.tilesX=this.tilesY=1;this.width=this.height=0;this.colorChannels=4;this.clearOnRenderInto=!0;this.gl=this.glTexture=this.framebuffer=this.glDepthBuffer=null;this.slotWidth=a;this.slotHeight=b;this.imageSlots=this.freeSlots=c;this.colorChannels=
e;this.createMipmaps=g;this.magFilter=f;this.minFilter=d;this.useFloat=l;a=Ob.optimalTextureSize(c,a,b,k);this.width=a.width;this.height=a.height;this.slotsX=a.slotsX;this.slotsY=a.slotsY};d["peote.view.Texture"]=Ac;Ac.__name__=!0;Ac.prototype={setImage:function(a,b,c,e){null==b&&(b=0);if(null!=this.images.h.__keys__[a.__id__])throw A.thrown("Error, image is already inside texture inside slot "+this.images.h[a.__id__].imageSlot);null!=c&&(this.tilesX=c);null!=e&&(this.tilesY=e);this.images.set(a,
{imageSlot:b});this.freeSlots--;if(null!=this.gl){if(null==this.glTexture){if(this.width>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)||this.height>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");this.glTexture=Ob.createEmptyTexture(this.gl,this.width,this.height,this.colorChannels,this.createMipmaps,this.magFilter,this.minFilter,this.useFloat)}this.bufferImage(a,{imageSlot:b})}},bufferImage:function(a,b){var c=this.gl,e=b.imageSlot%
this.slotsX*this.slotWidth;b=this.slotHeight*Math.floor(b.imageSlot/this.slotsX);var g=a.width,d=a.height,f=this.createMipmaps,l=this.useFloat;null==l&&(l=!1);null==f&&(f=!1);c.bindTexture(c.TEXTURE_2D,this.glTexture);if(l){l=g*d*4;l=null!=l?new Float32Array(l):null;for(var k=0,E=g*d*4;k<E;){var v=k++;l[v]=y.toFloat(a.get_data()[v])/y.toFloat(255)}c.texSubImage2D(c.TEXTURE_2D,0,e,b,g,d,c.RGBA,c.FLOAT,l)}else c.texSubImage2D(c.TEXTURE_2D,0,e,b,g,d,c.RGBA,c.UNSIGNED_BYTE,a.get_data());f&&c.generateMipmap(c.TEXTURE_2D);
c.bindTexture(c.TEXTURE_2D,null);this.updated=!0},__class__:Ac};var Ud=function(){var a=this.uniformBytes=new Ua(new ArrayBuffer(32)),b=0;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=4;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,
b)};d["peote.view.UniformBufferDisplay"]=Ud;Ud.__name__=!0;Ud.prototype={createGLBuffer:function(a,b,c,e,g){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=g;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},
__class__:Ud};var Vd=function(){var a=this.uniformBytes=new Ua(new ArrayBuffer(48)),b=0;null==b&&(b=0);this.resolutionBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=16;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=20;null==
b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};d["peote.view.UniformBufferView"]=Vd;Vd.__name__=!0;Vd.prototype={createGLBuffer:function(a,b,c,e,g,d,f){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=g;this.uniformBytes.b_UFloat32[4]=d;this.uniformBytes.b_UFloat32[5]=f;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,
0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Vd};var df=function(a,b){this.name=a;this.value=b};d["peote.view.UniformFloat"]=df;df.__name__=!0;df.prototype={__class__:df};var Oe=function(a){this.gl=a;this.createBuffer();this.createProgram()};d["peote.view.utils.Background"]=Oe;Oe.__name__=!0;Oe.prototype={createBuffer:function(){var a=new Ua(new ArrayBuffer(32));a.b_UFloat32[0]=1;a.b_UFloat32[1]=
1;a.b_UFloat32[2]=0;a.b_UFloat32[3]=1;a.b_UFloat32[4]=1;a.b_UFloat32[5]=0;a.b_UFloat32[6]=0;a.b_UFloat32[7]=0;this.buffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);a=new Uint8Array(a.b.bufferValue,0);this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},createProgram:function(){var a="",b=Na.VertexFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Na.VertexFloat,null!=(0<b.medium?"mediump":0<b.low?
"lowp":null)&&(a="precision mediump float;"));b=this.gl;var c=this.gl.VERTEX_SHADER,e=b.createShader(c);b.shaderSource(e,a+"\t\n\t\t\tattribute vec2 aPosition;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_Position = mat4 (\n\t\t\t\t\tvec4(2.0, 0.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, -2.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, 0.0, -1.0, 0.0),\n\t\t\t\t\tvec4(-1.0, 1.0, 0.0, 1.0)\n\t\t\t\t) * vec4 (aPosition, -1.0 ,1.0);\n\t\t\t}\n\t\t");b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw A.thrown("ERROR compiling "+
(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+x.string(b.getShaderInfoLog(e)));var g=e;b=Na.FragmentFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Na.FragmentFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;c=this.gl.FRAGMENT_SHADER;e=b.createShader(c);b.shaderSource(e,a+"\n\t\t\tuniform vec4 uRGBA;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_FragColor = uRGBA;\n\t\t\t\t\n\t\t\t\t// TODO: Fix for old FF\n\t\t\t\tgl_FragColor.w = clamp(uRGBA.w, 0.003, 1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+x.string(b.getShaderInfoLog(e)));a=e;this.glProgram=this.gl.createProgram();this.gl.attachShader(this.glProgram,g);this.gl.attachShader(this.glProgram,a);this.gl.deleteShader(g);this.gl.deleteShader(a);this.gl.bindAttribLocation(this.glProgram,0,"aPosition");b=this.gl;g=this.glProgram;b.linkProgram(g);if(0==b.getProgramParameter(g,b.LINK_STATUS))throw A.thrown(x.string(b.getProgramInfoLog(g))+
"VALIDATE_STATUS: "+x.string(b.getProgramParameter(g,b.VALIDATE_STATUS))+"ERROR: "+x.string(b.getError()));this.uRGBA=this.gl.getUniformLocation(this.glProgram,"uRGBA")},render:function(a,b,c,e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);this.gl.enableVertexAttribArray(0);this.gl.vertexAttribPointer(0,2,this.gl.FLOAT,!1,8,0);this.gl.useProgram(this.glProgram);this.gl.uniform4f(this.uRGBA,a,b,c,e);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);this.gl.disableVertexAttribArray(0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
null)},__class__:Oe};var Ua=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b;this.b_UFloat32=new Float32Array(a);this.b_Int32=new Int32Array(a);this.b_Uint16=new Uint16Array(a)};d["peote.view.utils.BufferBytes"]=Ua;Ua.__name__=!0;Ua.prototype={blit:function(a,b,c,e){0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},fill:function(a,b,c){for(var e=0;e<b;)e++,this.b[a++]=c},__class__:Ua};var Ma=function(){};d["peote.view.utils.GLTool"]=
Ma;Ma.__name__=!0;Ma.clearGlErrorQueue=function(a){for(;a.getError()!=a.NO_ERROR;);};Ma.getLastGlError=function(a){var b=a.getError();b!=a.NO_ERROR&&(b==a.INVALID_ENUM?ia.trace("(GL-Error: INVALID_ENUM)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:22,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.INVALID_VALUE?ia.trace("(GL-Error: INVALID_VALUE)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:23,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==
a.INVALID_OPERATION?ia.trace("(GL-Error: INVALID_OPERATION)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:24,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.OUT_OF_MEMORY?ia.trace("(GL-Error: OUT_OF_MEMORY)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:25,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):ia.trace("GL-Error: "+b,{fileName:"peote/view/utils/GLTool.hx",lineNumber:26,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}));return b};
var pc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_ActiveTexture"]=pc;pc.__name__=!0;pc.prototype={__class__:pc};var xc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Display"]=xc;xc.__name__=!0;xc.prototype={__class__:xc};var ic=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=
this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Program"]=ic;ic.__name__=!0;ic.prototype={__class__:ic};var Kd=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_ActiveTexture"]=Kd;Kd.__name__=!0;Kd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new pc(a,null,null);else if(null==b)b=this.first=new pc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new pc(a,c.prev,c),c==this.first&&(this.first=
b);else throw A.thrown("Error on add: "+x.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new pc(a,null,null);else if(null==b)b=this.last=new pc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new pc(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+x.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=
c.prev));this.itemMap.set(a,b)},clear:function(){for(;null!=this.first;){null!=this.last.value&&this.itemMap.remove(this.last.value);var a=this.last;a==this.first&&(this.first=a.next);a==this.last&&(this.last=a.prev);null!=a.prev&&(a.prev.next=a.next);null!=a.next&&(a.next.prev=a.prev)}},__class__:Kd};var Wd=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Display"]=Wd;Wd.__name__=!0;Wd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=
this.last=new xc(a,null,null);else if(null==b)b=this.first=new xc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new xc(a,c.prev,c),c==this.first&&(this.first=b);else throw A.thrown("Error on add: "+x.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new xc(a,null,null);else if(null==b)b=this.last=new xc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new xc(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+x.string(b)+" is not in list.");
c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},remove:function(a){var b=this.itemMap.get(a);if(null!=b)this.itemMap.remove(a),b==this.first&&(this.first=b.next),b==this.last&&(this.last=b.prev),null!=b.prev&&(b.prev.next=b.next),null!=b.next&&(b.next.prev=b.prev);else throw A.thrown("Error on remove: "+x.string(a)+" is not in list.");},has:function(a){return this.itemMap.exists(a)},
__class__:Wd};var Ne=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Program"]=Ne;Ne.__name__=!0;Ne.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new ic(a,null,null);else if(null==b)b=this.first=new ic(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new ic(a,c.prev,c),c==this.first&&(this.first=b);else throw A.thrown("Error on add: "+x.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=
new ic(a,null,null);else if(null==b)b=this.last=new ic(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new ic(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+x.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:Ne};var Ob=function(){};d["peote.view.utils.TexUtils"]=Ob;Ob.__name__=
!0;Ob.createEmptyTexture=function(a,b,c,e,g,d,f,l){null==l&&(l=!1);null==f&&(f=0);null==d&&(d=0);null==g&&(g=!1);e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);Ma.clearGlErrorQueue(a);if(l){l=a.TEXTURE_2D;var h=a.RGBA32F,k=a.RGBA,y=a.FLOAT,r=0;0==r?a.texImage2D(l,0,h,b,c,0,k,y,null):a.texImage2D(l,0,h,b,c,0,k,y,r);Ma.getLastGlError(a)==a.INVALID_VALUE&&(ia.trace("switching to RGBA16F for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:25,className:"peote.view.utils.TexUtils",
methodName:"createEmptyTexture"}),l=a.TEXTURE_2D,h=a.RGBA16F,k=a.RGBA,y=a.FLOAT,r=0,0==r?a.texImage2D(l,0,h,b,c,0,k,y,null):a.texImage2D(l,0,h,b,c,0,k,y,r),Ma.getLastGlError(a)==a.INVALID_VALUE&&(ia.trace("switching to RGBA for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:28,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),l=a.TEXTURE_2D,k=h=a.RGBA,y=a.FLOAT,r=0,0==r?a.texImage2D(l,0,h,b,c,0,k,y,null):a.texImage2D(l,0,h,b,c,0,k,y,r)))}else l=
a.TEXTURE_2D,k=h=a.RGBA,y=a.UNSIGNED_BYTE,r=0,0==r?a.texImage2D(l,0,h,b,c,0,k,y,null):a.texImage2D(l,0,h,b,c,0,k,y,r);if(Ma.getLastGlError(a)==a.OUT_OF_MEMORY)throw A.thrown("OUT OF GPU MEMORY while texture creation");1==d?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);if(g)switch(f){case 1:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);break;case 2:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST_MIPMAP_NEAREST);break;case 3:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST)}else 1==f?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);g&&a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,
null);return e};Ob.createPickingTexture=function(a,b){null==b&&(b=!1);var c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);if(b){b=a.TEXTURE_2D;var e=a.RGBA32I,g=a.RGBA_INTEGER,d=a.INT,f=0}else b=a.TEXTURE_2D,g=e=a.RGBA,d=a.UNSIGNED_BYTE,f=0;0==f?a.texImage2D(b,0,e,1,1,0,g,d,null):a.texImage2D(b,0,e,1,1,0,g,d,f);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);return c};Ob.optimalTextureSize=function(a,b,c,e,g,d){null==g&&(g=!0);d=Math.ceil(Math.log(e)/Math.log(2));for(var h=Math.ceil(Math.log(a*b*c)/Math.log(2)),f,k=1,y=h-1,E=Math.floor(Math.abs(k-y)),r=(1<<d)*(1<<d),v=!1,q=Math.floor(Math.min(d,h)),u;1<<q>=b;){for(u=Math.floor(Math.min(d,h-q+1));1<<u>=c&&!(Math.floor((1<<q)/b)*Math.floor((1<<u)/c)<a);){f=(1<<q)*(1<<u)-a*b*c;if(0>f)break;f<=r&&(f==r?Math.abs(q-u)<E&&(E=Math.floor(Math.abs(q-
u)),k=q,y=u,v=!0):(k=q,y=u,r=f,v=!0));--u}--q}if(v)k=1<<k,y=1<<y;else{if(g)throw A.thrown("Error: max texture-size ("+e+") is to small for "+a+" images ("+b+" x "+c+")");if(b>e||c>e)throw A.thrown("Error: max texture-size ("+e+") is to small for image ("+b+" x "+c+")");k=y=e}return{width:k,height:y,slotsX:k/b|0,slotsY:y/c|0,imageSlots:(k/b|0)*(y/c|0)}};var oc=function(){};d["peote.view.utils.Util"]=oc;oc.__name__=!0;oc.resolveFormulaCyclic=function(a){for(var b=[],c=a.h,e=Object.keys(c),g=e.length,
d=0;d<g;)if(c=e[d++],c=oc.resolveFormulaKey(c,a,b),null!=c.errKey)throw A.thrown(c);c=a.h;b=Object.keys(c);e=b.length;for(g=0;g<e;)c=b[g++],d=a.h[c].replace(/___:::___/g,""),a.h[c]=d};oc.resolveFormulaKey=function(a,b,c,e){null==e&&(e=[a]);null==c&&(c=[]);var g=b.h[a];if(0<=c.indexOf(a))return{formula:g,errKey:null,errVar:null};for(var d=Object.keys(b.h),f=d.length,l=0;l<f;){var k=d[l++];if(k!=a){var y=new M("(^|.*?[^\\w.])"+k+"\\b.*?","g");if(y.match(g)){if(0<=e.indexOf(k))return{formula:g,errKey:a,
errVar:k};k=oc.resolveFormulaKey(k,b,c,e.concat([k]));if(null!=k.errKey)return k;g=g.replace(y.r,"$1(___:::___"+k.formula+"___:::___)")}}}b.h[a]=g;c.push(a);return{formula:g,errKey:null,errVar:null}};oc.resolveFormulaVars=function(a,b){for(var c=a.h,e=Object.keys(c),g=e.length,d=0;d<g;){var f=e[d++],l=a.h[f];c=b.h;c=Object.keys(c);for(var k=c.length,y=0;y<k;){var E=c[y++],r=new M("(^|.*?[^\\w.])"+E+"\\b.*?","g");r.match(l)&&(l=l.replace(r.r,"$1("+b.h[E]+")"))}a.h[f]=l}};var cd=function(a,b){this.numColumns=
a;this.numRows=b};d["tyke.GridLogic"]=cd;cd.__name__=!0;cd.prototype={column:function(a){return a%this.numColumns|0},row:function(a){return a/this.numColumns|0},__class__:cd};var qc=function(a,b,c){cd.call(this,a,b);this.cellInit=c;this.init()};d["tyke.GridStructure"]=qc;qc.__name__=!0;qc.__super__=cd;qc.prototype=G(cd.prototype,{init:function(){this.cells=[];for(var a=0,b=this.numColumns*this.numRows;a<b;){var c=a++,e=this.column(c);c=this.row(c);this.cells.push(this.cellInit(e,c))}},forEach:function(a,
b){null==b&&(b=!1);if(b)for(b=this.cells.length;0<b--;)a(this.column(b),this.row(b),this.cells[b]);else for(var c=0,e=this.cells;c<e.length;){var g=e[c];b=c++;a(this.column(b),this.row(b),g)}},__class__:qc});var Bc=function(a){qc.call(this,a.numColumns,a.numRows,a.cellInit);this.palette=a.palette};d["tyke.GridLayer"]=Bc;Bc.__name__=!0;Bc.__super__=qc;Bc.prototype=G(qc.prototype,{__class__:Bc});var Yd=function(a,b){this.fontProgram=b;b.fontStyle.bgColor=0;null==a.cellInit&&(a.cellInit=function(c,e){c*=
a.cellWidth;e*=a.cellHeight;var g=b.fontStyle,d=b.font;d=32>=d.rangeMapping.min&&32<=d.rangeMapping.max?d.rangeMapping:null;if(null!=d){var f=new xa;g=null!=g?g:b.fontStyle;f.width=g.width;f.height=g.height;f.color=g.color;f.bgColor=g.bgColor;f.weight=g.weight;f.tilt=g.tilt;f.zIndex=g.zIndex;f.char=32;f.tile=32-d.min;f.x=c;f.y=e;b._buffer.addElement(f);c=f}else c=null;return new Xd(0,c,10,-1,1)});Bc.call(this,a)};d["tyke.GlyphLayer"]=Yd;Yd.__name__=!0;Yd.__super__=Bc;Yd.prototype=G(Bc.prototype,{__class__:Yd});
var ec=function(a){this.alwaysDraw=!1;this.onInitComplete=function(){throw A.thrown("You must set onInitComplete function!");};this.assets=a;this.keyboard=new Pe([])};d["tyke.PhysicalStageLoop"]=ec;ec.__name__=!0;ec.__super__=wc;ec.prototype=G(wc.prototype,{onInit:function(a){var b=this;wc.prototype.onInit.call(this,a);this.assets.Preload(function(){b.initWorldAndStage();b.onInitComplete()})},initWorldAndStage:function(){this.stage=new Qe(this.display,this);this.world=T.start({width:this.display.width,
height:this.display.height,gravity_y:100,iterations:2})},onTick:function(a){return this.alwaysDraw?!0:!1},onDraw:function(a){T.step(this.world,a/1E3);this.stage.updateGraphicsBuffers()},onKeyDown:function(a,b){this.keyboard.handle(a,this)},__class__:ec});var dd=function(a,b){var c=this;ec.call(this,b);this.onInitComplete=function(){c.initWorldAndStage();c.begin(a.numCellsWide,a.numCellsHigh)};this.keyboard.bind(112,"PAUSE","TOGGLE UPDATE",function(a){c.gum.toggleUpdate()})};d["samples.TYKE"]=dd;dd.__name__=
!0;dd.__super__=ec;dd.prototype=G(ec.prototype,{begin:function(a,b){a=new Re(this.stage.get_width(),this.stage.get_height(),ef.Hues,!0);b=this.stage.createLayer("bg",!1);a.addToDisplay(b.get_display());a=Math.ceil(this.stage.get_width()/this.assets.fontCache[0].config.width);b=Math.ceil(this.stage.get_height()/this.assets.fontCache[0].config.height);this.soup=new Se(a,b,this.stage,this.assets.fontCache[0]);this.salad=new Te(this.world,this.stage,this.assets.imageCache[0]);this.stage.globalFilter("globalCompose(globalFramebuffer_ID)",
ff.DotScreen);this.alwaysDraw=!0;this.gum.toggleUpdate(!0)},onTick:function(a){this.soup.onTick(a);this.salad.onTick(a);return ec.prototype.onTick.call(this,a)},onDraw:function(a){ec.prototype.onDraw.call(this,a)},__class__:dd});var Se=function(a,b,c,e){this.elapsedTicks=0;this.gain=.02;this.waves=2;this.layerName="glyphs";this.word="TYKE";var d=this;this.glyphFrames=c.createGlyphRendererLayer(this.layerName,e);var h=this.glyphFrames.get_fontProgram();a={numColumns:a,numRows:b,cellWidth:Math.ceil(h.fontStyle.width),
cellHeight:Math.ceil(h.fontStyle.height),palette:new Ue(bd.toRGBA(gf.Versitle)),cellInit:function(a,b){var c=p(d.word.length)-1;c=I.cca(d.word,c);a*=h.fontStyle.width;b*=h.fontStyle.height;var e=h.fontStyle,g=h.font;g=c>=g.rangeMapping.min&&c<=g.rangeMapping.max?g.rangeMapping:null;if(null!=g){var f=new xa;e=null!=e?e:h.fontStyle;f.width=e.width;f.height=e.height;f.color=e.color;f.bgColor=e.bgColor;f.weight=e.weight;f.tilt=e.tilt;f.zIndex=e.zIndex;f.char=c;f.tile=c-g.min;f.x=a;f.y=b;h._buffer.addElement(f);
c=f}else c=null;return new Xd(0,c,4,-1,1)}};this.glyphs=new Yd(a,h)};d["samples.WordSoup"]=Se;Se.__name__=!0;Se.prototype={onTick:function(a){var b=this;this.elapsedTicks++;this.glyphs.forEach(function(a,e,d){var c=.5+.5*Math.cos(b.elapsedTicks+e+2),g=.5+.5*Math.cos(b.elapsedTicks+a+4);d.glyph.color=d.glyph.color&16777215|Math.ceil(255*(.5+.5*Math.cos(b.elapsedTicks+a)))<<24;d.glyph.color=d.glyph.color&-16711681|Math.ceil(255*c)<<16;d.glyph.color=d.glyph.color&-65281|Math.ceil(255*g)<<8;d.glyph.color=
d.glyph.color&-256|Math.ceil(127*Math.sin(a-e*b.waves*b.elapsedTicks*b.gain)+127);d.char=I.cca(b.word,Math.ceil((.5+.5*Math.sin(.3*b.elapsedTicks+a+4))*b.word.length)-1);e=b.glyphFrames.get_fontProgram();a=d.glyph;d=d.char;e=e.font;e=d>=e.rangeMapping.min&&d<=e.rangeMapping.max?e.rangeMapping:null;null!=e&&(a.char=d,a.tile=d-e.min)})},__class__:Se};var Te=function(a,b,c){this.spriteScale=3;this.colliders=[];this.timer=0;this.layerName="sprites";this.frameSize=10;this.world=a;this.stage=b;this.sprites=
[];this.initSprites(c);this.initEdges();this.initCollisionListeners()};d["samples.SimulationSalad"]=Te;Te.__name__=!0;Te.prototype={initSprites:function(a){this.spriteFrames=this.stage.createSpriteRendererLayer(this.layerName,a,this.frameSize);this.debugLayer=this.stage.createShapeRenderLayer()},initEdges:function(){this.makeEdge(.5*this.stage.get_width()|0,0,this.stage.get_width()+80,40);this.makeEdge(.5*this.stage.get_width()|0,this.stage.get_height(),this.stage.get_width()+80,40);this.makeEdge(20,
.5*this.stage.get_height()|0,40,this.stage.get_height()+80)},makeEdge:function(a,b,c,e){T.make(this.world,{shape:{type:0,width:c,height:e},mass:0,x:a,y:b,elasticity:2})},initCollisionListeners:function(){T.listen(this.world,null,null,{enter:function(a,b,c){if(null!=a.sprite){c=p(30);a.sprite.tile=c+4;(c=0!=a.rotational_velocity)||(c=void 0,null==c&&(c=50),c=Math.random()<c/100);if(c){var e=10*a.mass;c=a.rotational_velocity;var d=e;e+=10;null==e&&(e=1);null==d&&(d=0);a.rotational_velocity=c-(d+Math.random()*
(e-d))}null!=b.sprite&&(b.sprite.tile=a.sprite.tile)}}})},onTick:function(a){for(var b=0,c=this.colliders;b<c.length;){var e=c[b];++b;e.transform.local_x>this.stage.get_width()+100&&(e.active=!1)}b=750-p(300);this.timer+=a;if(this.timer>b){a={elasticity:.5,mass:10-p(5),x:-100,y:-100,max_velocity_x:9E3,max_velocity_y:9E3,max_rotational_velocity:200,shape:{type:0,width:50,height:50}};b=new E(a);c=4;null==c&&(c=0);var d=this.spriteFrames.makeSprite(-100,-100,a.shape.width*this.spriteScale|0,c);b.on_move=
function(a,b){d.move(a,b)};b.on_rotate=function(a){d.rotate(a)};b.sprite=d;d.c=d.c&-256|Math.ceil(5/b.mass*95)+160;this.sprites.push(d);this.colliders.push(b);b=this.world.add(b);a=this.world;b.set_position(a.width-20,a.height/2);a=b.velocity;a.x=-3E3;a.y=3E3;this.timer=0}},__class__:Te};var ef=function(){};d["tyke.ColorFilterFormulas"]=ef;ef.__name__=!0;var ff=function(){};d["tyke.FrameBufferFormulas"]=ff;ff.__name__=!0;var Xd=function(a,b,c,e,d){this.char=a;this.glyph=b;this.paletteIndexFg=c;this.paletteIndexBg=
e;this.bgIntensity=d};d["tyke.GlyphModel"]=Xd;Xd.__name__=!0;Xd.prototype={__class__:Xd};var ge=function(a,b){this.numCellsWide=a;this.numCellsHigh=b};d["tyke.GlyphLoopConfig"]=ge;ge.__name__=!0;ge.prototype={__class__:ge};var Ue=function(a,b){null==b&&(b=-1);this.defaultBgIndex=b;this.colors=a};d["tyke.Palette"]=Ue;Ue.__name__=!0;Ue.prototype={__class__:Ue};var Cc=function(){};d["tyke.IHaveGraphicsBuffer"]=Cc;Cc.__name__=!0;Cc.__isInterface__=!0;Cc.prototype={__class__:Cc,__properties__:{get_program:"get_program"}};
var hf=u["tyke.Geometry"]={__ename__:!0,__constructs__:null,RECT:{_hx_name:"RECT",_hx_index:0,__enum__:"tyke.Geometry",toString:k},CIRCLE:{_hx_name:"CIRCLE",_hx_index:1,__enum__:"tyke.Geometry",toString:k},POLYGON:(f=function(a){return{_hx_index:2,numSides:a,__enum__:"tyke.Geometry",toString:k}},f._hx_name="POLYGON",f.__params__=["numSides"],f)};hf.__constructs__=[hf.RECT,hf.CIRCLE,hf.POLYGON];var Ve=function(a){this.frameBuffer=a;this.buffers=[]};d["tyke.Layer"]=Ve;Ve.__name__=!0;Ve.prototype={updateGraphicsBuffers:function(){for(var a=
0,b=this.buffers;a<b.length;){var c=b[a];++a;c.updateGraphicsBuffers()}},registerGraphicsBuffer:function(a){this.buffers.push(a)},addProgramToFrameBuffer:function(a){this.frameBuffer.display.addProgram(a)},get_display:function(){return this.frameBuffer.display},__class__:Ve,__properties__:{get_display:"get_display"}};var Zd=function(a){this.text=jf.initText(null,a)};d["tyke.GlyphRenderer"]=Zd;Zd.__name__=!0;Zd.__interfaces__=[Cc];Zd.prototype={get_program:function(){return this.text.fontProgram},
get_fontProgram:function(){return this.text.fontProgram},updateGraphicsBuffers:function(){this.text.fontProgram._buffer.update()},__class__:Zd,__properties__:{get_fontProgram:"get_fontProgram",get_program:"get_program"}};var na=function(a,b,c,e,d,h,f){null==f&&(f=-1);null==h&&(h=3);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.shape=0;this.sides=3;this.x=this.y=0;this.color=-1430585089;this.w=this.h=100;this.px_offset=this.py_offset=this.rotation=0;this.x=a;this.y=b;this.w=c;this.h=e;this.shape=
d;this.color=f;this.sides=h};d["tyke.Shape"]=na;na.__name__=!0;na.prototype={__class__:na};var $d=function(a){null==a&&(a=256);this.buffer=new Rd(a,a,!0);this._program=new Eb(this.buffer);this._program.setFragmentFloatPrecision("high");this._program.discardAtAlpha(null);this._program.injectIntoFragmentShader(na.InjectFragment,!1);this._program.setColorFormula(na.ColorFormula)};d["tyke.ShapeRenderer"]=$d;$d.__name__=!0;$d.__interfaces__=[Cc];$d.prototype={get_program:function(){return this._program},
makeShape:function(a,b,c,e,d,h){null==h&&(h=-855703297);switch(d._hx_index){case 0:var g=0;break;case 1:g=1;break;default:g=2}switch(d._hx_index){case 1:d=1;break;case 2:d=d.numSides;break;default:d=4}d=new na(a|0,b|0,c,e,g,d,h);this.buffer.addElement(d);return d},updateGraphicsBuffers:function(){this.buffer.update()},__class__:$d,__properties__:{get_program:"get_program"}};var da=function(a,b,c,e,d,h,f){null==f&&(f=!0);null==h&&(h=-1);null==d&&(d=0);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;
this.x=this.y=0;this.shakeDurationY=.9;this.shakeDurationX=1.2;this.shakeAtTime=-100;this.tile=0;this.c=-1430585089;this.slot=0;this.w=this.h=100;this.px_offset=this.py_offset=this.rotation=0;this.x=a;this.y=b;this.w=c;this.h=e;this.width=this.w;this.height=this.h;this.c=h;this.tile=d;this.set_visible(f)};d["tyke.Sprite"]=da;da.__name__=!0;da.prototype={set_visible:function(a){this.c=this.c&-256|(a?255:0);return a},attachDebug:function(a){this.debugElement=a},move:function(a,b){this.x=a;this.y=b;
null!=this.debugElement&&(this.debugElement.x=a,this.debugElement.y=b)},rotate:function(a){this.rotation=a;null!=this.debugElement&&(this.debugElement.rotation=a)},__class__:da,__properties__:{set_visible:"set_visible"}};var ae=function(a,b,c){null==c&&(c=256);this.spriteSheet=new Ac(a.width,a.height);this.spriteSheet.tilesX=a.width/b|0;this.spriteSheet.tilesY=a.height/b|0;this.spriteSheet.setImage(a,0);this.buffer=new Sd(c,c,!0);this._program=new Eb(this.buffer);this._program.setFragmentFloatPrecision("high");
this._program.discardAtAlpha(null);this._program.injectIntoVertexShader(da.InjectVertex,!0);this._program.injectIntoFragmentShader(da.InjectFragment,!1);this._program.addTexture(this.spriteSheet,"base")};d["tyke.SpriteRenderer"]=ae;ae.__name__=!0;ae.__interfaces__=[Cc];ae.prototype={get_program:function(){return this._program},makeSprite:function(a,b,c,e,d,h){null==h&&(h=!0);a=new da(a,b,c,c,e,null,h);this.buffer.addElement(a);return a},updateGraphicsBuffers:function(){this.buffer.update()},__class__:ae,
__properties__:{get_program:"get_program"}};var ja=function(a,b,c,e,d){null==e&&(e=100);null==c&&(c=100);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.c=-16776961;this.slot=0;this.w=this.h=100;this.x=this.y=0;this.x=a;this.y=b;this.w=c;this.h=e;this.c=d};d["tyke.FilterElement"]=ja;ja.__name__=!0;ja.prototype={__class__:ja};var Re=function(a,b,c,e){null==e&&(e=!1);this.buffer=new Qd(1,1,!0);this.program=new Eb(this.buffer);this.program.discardAtAlpha(null);bd.RGBA(1127270,204);a=new ja(0,0,a,
b,255);this.buffer.addElement(a);this.program.injectIntoFragmentShader(c,e);this.program.setColorFormula("compose()")};d["tyke.Filter"]=Re;Re.__name__=!0;Re.prototype={addToDisplay:function(a){a.addProgram(this.program)},__class__:Re};var Pe=function(a){this.sortOrder=[];this.bindings=new Gb;for(var b=0;b<a.length;){var c=a[b];++b;this._bind(c)}};d["tyke.KeyPresses_tyke_PhysicalStageLoop"]=Pe;Pe.__name__=!0;Pe.prototype={handle:function(a,b){this.lastHandled=a;this.bindings.exists(a)&&this.bindings.get(a).handle(b)},
_bind:function(a){this.sortOrder.push(a.code);this.bindings.set(a.code,a)},bind:function(a,b,c,e){this._bind({description:c,label:b,code:a,handle:e})},__class__:Pe};var We=function(a,b,c){this.font=a;this.fontStyle=b;this.fontProgram=c};d["tyke.Text"]=We;We.__name__=!0;We.prototype={__class__:We};var jf=function(){};d["tyke.Glyphs"]=jf;jf.__name__=!0;jf.initText=function(a,b){var c=b.createFontStyle();c.width=b.config.width;c.height=b.config.height;var e=b.createFontProgram(c);null!=a&&a.addProgram(e);
return new We(b,c,e)};var gf=function(){};d["tyke.Sixteen"]=gf;gf.__name__=!0;var Qe=function(a,b){this.layers=new Y;this.display=a;this.coreLoop=b;b=new Td(1);this.program=new Eb(b);this.program.setFragmentFloatPrecision("high");this.program.alphaEnabled=!0;this.program.discardAtAlpha(null);a.addProgram(this.program);a=new fa(0,0,a.width,a.height);b.addElement(a);this.globalFrameBuffer=this.makeFrameBuffer("globalFramebuffer",!1)};d["tyke.Stage"]=Qe;Qe.__name__=!0;Qe.prototype={globalFilter:function(a,
b){this.program.injectIntoFragmentShader(b,!0);this.program.setColorFormula(a)},chainFrameBuffer:function(a,b){this.program.addTexture(a.texture,b,!0)},makeFrameBuffer:function(a,b){b=this.coreLoop.getFrameBufferDisplay(this.display.x,this.display.y,this.display.width,this.display.height,b);this.chainFrameBuffer(b,a);return b},createLayer:function(a,b,c){null==c&&(c=!0);b=c?this.globalFrameBuffer:this.makeFrameBuffer(a,b);b=new Ve(b);return this.layers.h[a]=b},initGraphicsBuffer:function(a,b,c,e){c=
this.createLayer(a,c,!e);c.registerGraphicsBuffer(b);c.addProgramToFrameBuffer(b.get_program());this.layers.h[a]=c},createShapeRenderLayer:function(a,b){null==b&&(b=!1);null==a&&(a=!1);var c=new $d;this.initGraphicsBuffer("echo",c,a,b);return c},createSpriteRendererLayer:function(a,b,c,e,d){null==d&&(d=!1);null==e&&(e=!1);b=new ae(b,c);this.initGraphicsBuffer(a,b,e,d);return b},createGlyphRendererLayer:function(a,b,c,e){null==e&&(e=!1);null==c&&(c=!1);b=new Zd(b);this.initGraphicsBuffer(a,b,c,e);
return b},updateGraphicsBuffers:function(){for(var a=this.layers.h,b=Object.keys(a),c=b.length,e=0;e<c;)a[b[e++]].updateGraphicsBuffers()},get_width:function(){return this.display.width},get_height:function(){return this.display.height},__class__:Qe,__properties__:{get_height:"get_height",get_width:"get_width"}};var fa=function(a,b,c,e){null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.w=this.h=100;this.x=this.y=0;this.x=a;this.y=b;this.w=c;this.h=e};d["tyke.ViewElement"]=fa;fa.__name__=!0;fa.prototype=
{__class__:fa};var cb=function(){};d["utils.Loader"]=cb;cb.__name__=!0;cb.onProgressDebug=function(a,b,c){ia.trace("...loading "+a+"/"+b+' of "'+c+'"',{fileName:"utils/Loader.hx",lineNumber:11,className:"utils.Loader",methodName:"onProgressDebug"})};cb.onErrorDebug=function(a){ia.trace("Error - "+a,{fileName:"utils/Loader.hx",lineNumber:15,className:"utils.Loader",methodName:"onErrorDebug"})};cb.onCompleteDebug=function(a){ia.trace('Loading complete "'+a+'"',{fileName:"utils/Loader.hx",lineNumber:19,
className:"utils.Loader",methodName:"onCompleteDebug"})};var Pb=u["utils._MultipassTemplate.TemplateExpr"]={__ename__:!0,__constructs__:null,OpVar:(f=function(a){return{_hx_index:0,v:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:k}},f._hx_name="OpVar",f.__params__=["v"],f),OpExpr:(f=function(a){return{_hx_index:1,expr:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:k}},f._hx_name="OpExpr",f.__params__=["expr"],f),OpIf:(f=function(a,b,c){return{_hx_index:2,expr:a,eif:b,eelse:c,
__enum__:"utils._MultipassTemplate.TemplateExpr",toString:k}},f._hx_name="OpIf",f.__params__=["expr","eif","eelse"],f),OpStr:(f=function(a){return{_hx_index:3,str:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:k}},f._hx_name="OpStr",f.__params__=["str"],f),OpBlock:(f=function(a){return{_hx_index:4,l:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:k}},f._hx_name="OpBlock",f.__params__=["l"],f),OpForeach:(f=function(a,b){return{_hx_index:5,expr:a,loop:b,__enum__:"utils._MultipassTemplate.TemplateExpr",
toString:k}},f._hx_name="OpForeach",f.__params__=["expr","loop"],f),OpMacro:(f=function(a,b){return{_hx_index:6,name:a,params:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:k}},f._hx_name="OpMacro",f.__params__=["name","params"],f)};Pb.__constructs__=[Pb.OpVar,Pb.OpExpr,Pb.OpIf,Pb.OpStr,Pb.OpBlock,Pb.OpForeach,Pb.OpMacro];var La=function(a){a=this.parseTokens(a);this.expr=this.parseBlock(a);if(!a.isEmpty())throw A.thrown("Unexpected '"+x.string(a.first().s)+"'");};d["utils.MultipassTemplate"]=
La;La.__name__=!0;La.prototype={execute:function(a,b){this.macros=null==b?{}:b;this.context=a;this.stack=new Db;this.buf=new va;this.run(this.expr);return this.buf.b},resolve:function(a){if("__current__"==a)return this.context;var b=F.getProperty(this.context,a);if(null!=b||Object.prototype.hasOwnProperty.call(this.context,a))return b;for(var c=this.stack.h;null!=c;){b=c.item;c=c.next;var e=b;b=F.getProperty(e,a);if(null!=b||Object.prototype.hasOwnProperty.call(e,a))return b}if(!Object.prototype.hasOwnProperty.call(La.globals,
a))throw A.thrown(a);return F.field(La.globals,a)},parseTokens:function(a){for(var b=new Db;La.splitter.match(a);){var c=La.splitter.matchedPos();0<c.pos&&b.add({p:I.substr(a,0,c.pos),s:!0,l:null});if(58==I.cca(a,c.pos))b.add({p:I.substr(a,c.pos+2,c.len-4),s:!1,l:null}),a=La.splitter.matchedRight();else{c=c.pos+c.len;for(var e=1,d=[],h="";;){var f=I.cca(a,c);++c;if(40==f)++e;else if(41==f){if(--e,0>=e)break}else if(null==f)throw A.thrown("Unclosed macro parenthesis");44==f&&1==e?(d.push(h),h=""):
h+=String.fromCodePoint(f)}d.push(h);b.add({p:La.splitter.matched(2),s:!1,l:d});a=I.substr(a,c,a.length-c)}}0<a.length&&b.add({p:a,s:!0,l:null});return b},parseBlock:function(a){for(var b=new Db;;){var c=a.first();if(null==c)break;if(!c.s&&("end"==c.p||"else"==c.p||"elseif "==I.substr(c.p,0,7)))break;b.add(this.parse(a))}return 1==b.length?b.first():Pb.OpBlock(b)},parse:function(a){var b=a.pop(),c=b.p;if(b.s)return Pb.OpStr(c);if(null!=b.l){a=new Db;var e=0;for(b=b.l;e<b.length;){var d=b[e];++e;a.add(this.parseBlock(this.parseTokens(d)))}return Pb.OpMacro(c,
a)}if("if "==I.substr(c,0,3)){c=I.substr(c,3,c.length-3);e=null;try{e=this.parseExpr(c)}catch(h){oa.lastError=h;b=A.caught(h).unwrap();if("string"==typeof b)throw ia.trace(b,{fileName:"utils/MultipassTemplate.hx",lineNumber:211,className:"utils.MultipassTemplate",methodName:"parse"}),A.thrown(b);throw h;}c=this.parseBlock(a);b=a.first();if(null==b)throw A.thrown("Unclosed 'if'");if("end"==b.p)a.pop(),d=null;else if("else"==b.p){if(a.pop(),d=this.parseBlock(a),b=a.pop(),null==b||"end"!=b.p)throw A.thrown("Unclosed 'else'");
}else b.p=I.substr(b.p,4,b.p.length-4),d=this.parse(a);return Pb.OpIf(e,c,d)}if("foreach "==I.substr(c,0,8)){c=I.substr(c,8,c.length-8);e=this.parseExpr(c);c=this.parseBlock(a);b=a.pop();if(null==b||"end"!=b.p)throw A.thrown("Unclosed 'foreach'");return Pb.OpForeach(e,c)}return La.expr_splitter.match(c)?Pb.OpExpr(this.parseExpr(c)):Pb.OpVar(c)},parseExpr:function(a){for(var b=new Db,c=a;La.expr_splitter.match(a);){var e=La.expr_splitter.matchedPos();0!=e.pos&&b.add({p:I.substr(a,0,e.pos),s:!0});a=
La.expr_splitter.matched(0);b.add({p:a,s:0<=a.indexOf('"')});a=La.expr_splitter.matchedRight()}0!=a.length&&b.add({p:a,s:!0});try{var d=this.makeExpr(b);if(!b.isEmpty())throw A.thrown(b.first().p);}catch(h){oa.lastError=h;b=A.caught(h).unwrap();if("string"==typeof b)throw A.thrown("Unexpected '"+b+"' in "+c);throw h;}return function(){try{return d()}catch(w){oa.lastError=w;var a=A.caught(w).unwrap();throw A.thrown({v:a,expr:c});}}},makeConst:function(a){La.expr_trim.match(a);a=La.expr_trim.matched(1);
if(34==I.cca(a,0)){var b=I.substr(a,1,a.length-2);return function(){return b}}if(La.expr_int.match(a)){var c=x.parseInt(a);return function(){return c}}if(La.expr_float.match(a)){var e=parseFloat(a);return function(){return e}}var d=this;return function(){return d.resolve(a)}},makePath:function(a,b){var c=b.first();if(null==c||"."!=c.p)return a;b.pop();c=b.pop();if(null==c||!c.s)throw A.thrown(c.p);var e=c.p;La.expr_trim.match(e);e=La.expr_trim.matched(1);return this.makePath(function(){return F.field(a(),
e)},b)},makeExpr:function(a){return this.makePath(this.makeExpr2(a),a)},makeExpr2:function(a){var b=a.pop();if(null==b)throw A.thrown("<eof>");if(b.s)return this.makeConst(b.p);switch(b.p){case "!":var c=this.makeExpr(a);return function(){var a=c();return null!=a?0==a:!0};case "(":var e=this.makeExpr(a);b=a.pop();if(null==b||b.s)throw A.thrown(b);if(")"==b.p)return e;var d=this.makeExpr(a);a=a.pop();if(null==a||")"!=a.p)throw A.thrown(a);switch(b.p){case "!=":return function(){return e()!=d()};case "&&":return function(){return e()&&
d()};case "*":return function(){return e()*d()};case "+":return function(){return e()+d()};case "-":return function(){return e()-d()};case "/":return function(){return e()/d()};case "<":return function(){return e()<d()};case "<=":return function(){return e()<=d()};case "==":return function(){return e()==d()};case ">":return function(){return e()>d()};case ">=":return function(){return e()>=d()};case "||":return function(){return e()||d()};default:throw A.thrown("Unknown operation "+b.p);}case "-":var h=
this.makeExpr(a);return function(){return-h()}}throw A.thrown(b.p);},run:function(a){switch(a._hx_index){case 0:var b=a.v;try{var c=this.buf,e=x.string(this.resolve(b));c.b+=x.string(e)}catch(ba){oa.lastError=ba,this.buf.b+=x.string("::"+b+"::")}break;case 1:var d=a.expr;try{c=this.buf,e=x.string(d()),c.b+=x.string(e)}catch(ba){oa.lastError=ba,b=A.caught(ba).unwrap(),this.buf.b+=x.string("::("+x.string(b.expr)+")::")}break;case 2:d=a.expr;e=a.eif;c=a.eelse;try{b=d(),null==b||0==b?null!=c&&this.run(c):
this.run(e)}catch(ba){oa.lastError=ba,b=A.caught(ba).unwrap(),this.buf.b+=x.string("::if "+x.string(b.expr)+"::"),this.run(e),null!=c&&(this.buf.b+="::else::",this.run(c)),this.buf.b+="::end::"}break;case 3:b=a.str;this.buf.b+=null==b?"null":""+b;break;case 4:for(a=a.l.h;null!=a;){var h=a.item;a=a.next;d=h;this.run(d)}break;case 5:d=a.expr;c=a.loop;try{b=d();try{e=C(b);if(null==e.hasNext)throw A.thrown(null);b=e}catch(ba){oa.lastError=ba;try{if(null==b.hasNext)throw A.thrown(null);}catch(P){throw A.thrown("Cannot iter on "+
x.string(b));}}for(this.stack.push(this.context);b.hasNext();)this.context=b.next(),this.run(c);this.context=this.stack.pop()}catch(ba){oa.lastError=ba,b=A.caught(ba).unwrap(),this.buf.b+=x.string("::foreach "+x.string(b.v)+"::"),this.run(c),this.buf.b+="::end::"}break;case 6:d=a.name;a=a.params;b=F.field(this.macros,d);var f=[],l=this.buf;f.push(n(this,this.resolve));for(a=a.h;null!=a;)h=a.item,a=a.next,0==h._hx_index?(h=h.v,f.push(this.resolve(h))):(this.buf=new va,this.run(h),f.push(this.buf.b));
this.buf=l;try{c=this.buf,e=x.string(b.apply(this.macros,f)),c.b+=x.string(e)}catch(ba){oa.lastError=ba;a=A.caught(ba).unwrap();try{var k=f.join(",")}catch(P){k="???"}b="Macro call "+d+"("+k+") failed ("+x.string(a)+")";throw A.thrown(b);}}},__class__:La};t.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(I.now=performance.now.bind(performance));d.Math=Math;null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>
10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=d.String=String;String.__name__=!0;d.Array=Array;Array.__name__=!0;Date.prototype.__class__=d.Date=Date;Date.__name__="Date";var sf={},qf={},rf=Number,pf=Boolean,tf={},uf={};yb.count=0;Aa.__toStr={}.toString;var mf=new Uint32Array(256);Mb.__alpha16=mf;for(var Rc=0;256>Rc;){var yd=Rc++;Mb.__alpha16[yd]=Math.ceil(257.00392156862745*yd)}mf=new Uint8Array(511);Mb.__clamp=mf;for(Rc=0;255>Rc;)yd=Rc++,Mb.__clamp[yd]=yd;for(Rc=255;511>
Rc;)yd=Rc++,Mb.__clamp[yd]=255;Ja.level=3;"undefined"==typeof console&&(console={});null==console.log&&(console.log=function(){});E.default_mass=-1;E.minimum_mass=1E-4;E.ids=0;v.qr=[];v.sqr=[];T.cached_listeners=new Ca;T.cached_collisions=[];T.cached_body=new E({mass:1});Fb.pool=new ib(Fb);Bb.global=new Bb(null,null,null,null,null);Vb.pool=new Zb(Vb);tc.pool=new zd(tc);Kb.pool=new Ec(Kb);Rb.pool=new fd(Rb);fc.pool=new Mc(fc);db.pool=new Fc(db);wb.pool=new gd(wb);$a.pool=new Ad($a);eb.pool=new Bd(eb);
za.norm=new Q(0,0);za.closest=new Q(0,0);sb.DEFAULT_RESOLVER=new Ed;sb.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";bb.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];bb.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];bb.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1];bb.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,
193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];bb.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];U.activeRequests=0;U.requestLimit=17;U.requestQueue=new Db;od.windowID=0;kc.DICTIONARY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");kc.EXTENDED_DICTIONARY=function(a){a=[];for(var b=0,c=kc.DICTIONARY;b<c.length;){var e=c[b];++b;for(var d=0,h=kc.DICTIONARY;d<h.length;){var f=h[d];++d;a.push(e+f)}}return a}(this);mc.sensorByID=
new Gb;mc.sensors=[];Ya.devices=new Gb;Ya.onConnect=new Fe;jb.devices=new Gb;jb.onConnect=new Ge;ub.onCancel=new Lc;ub.onEnd=new Lc;ub.onMove=new Lc;ub.onStart=new Lc;R.cache=new Je;R.onChange=new Qa;R.bundlePaths=new Y;R.libraries=new Y;R.libraryPaths=new Y;Ja.throwErrors=!0;Da.FORMULAS=new Y;Da.ATTRIBUTES=function(a){a=new Y;a.h.zStart="aRotZ";a.h.zEnd="aRotZ";a.h.z="aRotZ";a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";
a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);Da.FORMULA_NAMES=function(a){a=new Y;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.zIndex="z";return a}(this);Da.FORMULA_VARYINGS="";Da.FORMULA_CONSTANTS="";Da.FORMULA_CUSTOMS="";Da.DEFAULT_FORMULA_VARS=new Y;xa.__meta__={fields:{x:{posX:null},y:{posY:null},color:{color:null},bgColor:{color:null},weight:{custom:null,varying:null},tilt:{custom:null},zIndex:{zIndex:null},width:{sizeX:null,
varying:null},height:{sizeY:null},tile:{texTile:null}}};xa.FORMULAS=new Y;xa.ATTRIBUTES=function(a){a=new Y;a.h.zIndexStart="aRotZ";a.h.zIndexEnd="aRotZ";a.h.zIndex="aRotZ";a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.widthStart="aSize.x";a.h.widthEnd="aSize.x";a.h.width="aSize.x";a.h.weightStart="aFloat0.x";a.h.weightEnd="aFloat0.x";a.h.weight="aFloat0.x";a.h.tiltStart="aFloat0.y";a.h.tiltEnd="aFloat0.y";a.h.tilt="aFloat0.y";a.h.tileStart=
"aShort0";a.h.tileEnd="aShort0";a.h.tile="aShort0";a.h.heightStart="aSize.y";a.h.heightEnd="aSize.y";a.h.height="aSize.y";return a}(this);xa.FORMULA_NAMES=function(a){a=new Y;a.h.sizeX="width";a.h.sizeY="height";a.h.posX="x";a.h.posY="y";a.h.zIndex="zIndex";return a}(this);xa.FORMULA_VARYINGS="weight,tile";xa.FORMULA_CONSTANTS="";xa.FORMULA_CUSTOMS="tilt";xa.DEFAULT_FORMULA_VARS=new Y;Fa.FORMULAS=new Y;Fa.ATTRIBUTES=function(a){a=new Y;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart=
"aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);Fa.FORMULA_NAMES=function(a){a=new Y;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);Fa.FORMULA_VARYINGS="";Fa.FORMULA_CONSTANTS="";Fa.FORMULA_CUSTOMS="";Fa.DEFAULT_FORMULA_VARS=new Y;K.isES3=!1;K.isUBO=!1;K.isINSTANCED=!1;K.isVAO=!1;Na.VertexFloat={high:0,medium:0,low:0};Na.VertexInt={high:0,medium:0,low:0};
Na.VertexSampler={high:0,medium:0,low:0};Na.FragmentFloat={high:0,medium:0,low:0};Na.FragmentInt={high:0,medium:0,low:0};Na.FragmentSampler={high:0,medium:0,low:0};Ma.rEmptylines=new M("([ \t]*\r?\n)+","g");Ma.rStartspaces=new M("^([ \t]*\r?\n)+","g");ef.Hues="\n\tvec4 compose(){\n\t\t// time varying pixel color\n\t\tvec3 col = 0.5 + 0.5*cos(uTime+vTexCoord.xyx+vec3(0,2,4));\n\t\treturn vec4(col * 0.5, 0.5);\n\t}\n\t";ff.DotScreen="\n\tfloat greyScale(in vec3 col) {\n\t\treturn dot(col, vec3(0.2126, 0.7152, 0.0722));\n\t}\n\n\tmat2 rotate2d(float angle){\n\t\treturn mat2(cos(angle), -sin(angle), sin(angle),cos(angle));\n\t}\n\n\tfloat dotScreen(in vec2 uv, in float angle, in float scale, vec2 res) {\n\t\tfloat s = sin( angle ), c = cos( angle );\n\t\tvec2 p = (uv - vec2(0.5)) * res.xy;\n\t\tvec2 q = rotate2d(angle) * p * scale; \n\t\treturn ( sin( q.x ) * sin( q.y ) ) * 4.0;\n\t}\n\n\tvec4 globalCompose( int textureID ){\n\t\tvec2 uv = vTexCoord;\n\t\tvec3 col = getTextureColor(textureID, vTexCoord).rgb; \n\t\tfloat grey = greyScale(col); \n\t\tfloat angle = 0.4;\n\t\tfloat scale = 1.0 + 0.8 * sin(uTime); \n\t\tvec2 res = getTextureResolution(textureID);\n\t\tcol = vec3( grey * 10.0 - 5.0 + dotScreen(uv, angle, scale, res ) );\n\t\tvec3 tex = getTextureColor(textureID, vTexCoord).rgb;\n\t\treturn vec4( mix(col, tex, 0.9), 1.0 );\n\t}\n\t";
na.__meta__={fields:{px_offset:{pivotX:null,formula:["w * 0.5 + px_offset"]},py_offset:{pivotY:null,formula:["h * 0.5 + py_offset"]},rotation:{rotation:null},w:{sizeX:null,varying:null},h:{sizeY:null,varying:null},color:{color:null},x:{posX:null,set:["Position"]},y:{posY:null,set:["Position"]},sides:{custom:null,varying:null},shape:{custom:null,varying:null}}};na.InjectFragment="\n    #define PI 3.14159265359\n    #define TWO_PI 6.28318530718\n    \n    // from the book of shaders https://thebookofshaders.com/07/\n\t// only triangle is correct at the moment\n\t// todo ! calculate r for n sided polygons\n\t// or use vertices data from echo shape\n    vec4 polygon(vec4 c, float sides){\n        // Remap the coord for\n        vec2 coord = vTexCoord;\n        coord.y = (1.0 - coord.y);\n\n        // Remap the space to -1. to 1.\n        vec2 st = coord * 2.0-1.0;\n\n        // Angle and radius from the current pixel\n        float r = TWO_PI/sides;\n        float a = atan(st.x,st.y) + PI;\n\n        // Shaping function that modulate the distance\n        float d = cos(floor(.5+a/r)*r-a)*length(st);\n        float A = 1.0-smoothstep(.5,.51,d) == 1.0 ? c.a : 0.0;\n        return vec4(c.rgb, A);\n    }\n\n    // // https://github.com/ayamflow/glsl-2d-primitives/blob/master/polygon.glsl\n    // vec4 polygon(vec4 c, float sides){\n    //     vec2 st = vTexCoord * 2.0 - 1.0;\n    //     st.y  = (1.0 - st.y);\n    //     float angle = atan(st.x,st.y) + PI;\n    //     float slice = TWO_PI / sides;\n    //     // float radius = 0.4;\n    //     float radius = 0.5;//1.0;//0.7;//sides / 10.0;\n    //     // float x = vSize.x; \n    //     // float radius = 1.0 / cos(x) * (180.0 / sides);\n    //     float s = step(radius, cos(floor(0.5 + angle / slice ) * slice - angle) * length(st));\n    //     float A = 1.0 - s == 1.0 ? c.a : 0.0;\n    //     return vec4(c.rgb, A);\n    // }\n\n    float circle(vec2 st, float radius)\n    {\n        vec2 dist = st-vec2(0.5);\n        return 1.-smoothstep(radius-(radius*0.01),\n                             radius+(radius*0.01),\n                             dot(dist,dist)*4.0\n                            );\n    }\n\n    vec4 compose(vec4 c, float shapeType, float numSides){\n        // return vec4(0.8,0.8,0.8,1.0);\n        if(shapeType <= 0.0 ){\n            return c;\n        }\n        // circle\n        if(shapeType == 1.0){\n            float a = circle(vTexCoord, 1.0) == 1.0 ? c.a : 0.0;\n\t\t\treturn vec4(c.rgb, a);\n        }\n        // polygon\n        return polygon(c, numSides);\n    }\n    ";
na.ColorFormula="compose(color, shape, sides)";na.FORMULAS=function(a){a=new Y;a.h.py_offset="h * 0.5 + py_offset";a.h.px_offset="w * 0.5 + px_offset";return a}(this);na.ATTRIBUTES=function(a){a=new Y;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.sidesStart="aFloat0.x";a.h.sidesEnd="aFloat0.x";a.h.sides="aFloat0.x";a.h.shapeStart="aFloat0.y";a.h.shapeEnd="aFloat0.y";a.h.shape="aFloat0.y";
a.h.rotationStart="aRotZ";a.h.rotationEnd="aRotZ";a.h.rotation="aRotZ";a.h.py_offsetStart="aPivot.y";a.h.py_offsetEnd="aPivot.y";a.h.py_offset="aPivot.y";a.h.px_offsetStart="aPivot.x";a.h.px_offsetEnd="aPivot.x";a.h.px_offset="aPivot.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);na.FORMULA_NAMES=function(a){a=new Y;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.rotation="rotation";a.h.pivotX="px_offset";a.h.pivotY="py_offset";return a}(this);na.FORMULA_VARYINGS=
"sides,shape";na.FORMULA_CONSTANTS="";na.FORMULA_CUSTOMS="";na.DEFAULT_FORMULA_VARS=new Y;da.__meta__={fields:{px_offset:{pivotX:null,formula:["w * 0.5 + px_offset"]},py_offset:{pivotY:null,formula:["h * 0.5 + py_offset"]},rotation:{rotation:null},w:{sizeX:null},h:{sizeY:null},slot:{texSlot:["base"]},c:{color:null},tile:{texTile:null},shakeAtTime:{custom:null},shakeDurationX:{custom:null},shakeDurationY:{custom:null},x:{posX:null,set:["Position"],formula:["x + shake(shakeAtTime, 7.0, 8.0, shakeDurationX)"]},
y:{posY:null,set:["Position"],formula:["y + shake(shakeAtTime, 5.0, 6.0, shakeDurationY)"]}}};da.InjectVertex="\n\t#define TWO_PI 6.28318530718\n\tfloat shake( float atTime, float freq, float size, float duration )\n\t{\n\t\tfloat t = max(0.0, uTime - atTime);\t\t\t\t\n\t\tt = (clamp(t, 0.0, duration) / duration);\t\t\t\n\t\t// return 1.0 - size + size * sin(freq * TWO_PI * t) * (t+0.5)*t*t*(t-1.0)*(t-1.0)*15.5;\n\t\treturn size * sin(freq * TWO_PI * t) * (t+0.5)*t*t*(t-1.0)*(t-1.0)*15.5;\n\t}\n\t";
da.InjectFragment="";da.FORMULAS=function(a){a=new Y;a.h.y="y + shake(shakeAtTime, 5.0, 6.0, shakeDurationY)";a.h.x="x + shake(shakeAtTime, 7.0, 8.0, shakeDurationX)";a.h.py_offset="h * 0.5 + py_offset";a.h.px_offset="w * 0.5 + px_offset";return a}(this);da.ATTRIBUTES=function(a){a=new Y;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.tileStart="aShort0.y";a.h.tileEnd="aShort0.y";
a.h.tile="aShort0.y";a.h.slotStart="aShort0.x";a.h.slotEnd="aShort0.x";a.h.slot="aShort0.x";a.h.shakeDurationYStart="aFloat0.z";a.h.shakeDurationYEnd="aFloat0.z";a.h.shakeDurationY="aFloat0.z";a.h.shakeDurationXStart="aFloat0.y";a.h.shakeDurationXEnd="aFloat0.y";a.h.shakeDurationX="aFloat0.y";a.h.shakeAtTimeStart="aFloat0.x";a.h.shakeAtTimeEnd="aFloat0.x";a.h.shakeAtTime="aFloat0.x";a.h.rotationStart="aRotZ";a.h.rotationEnd="aRotZ";a.h.rotation="aRotZ";a.h.py_offsetStart="aPivot.y";a.h.py_offsetEnd=
"aPivot.y";a.h.py_offset="aPivot.y";a.h.px_offsetStart="aPivot.x";a.h.px_offsetEnd="aPivot.x";a.h.px_offset="aPivot.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);da.FORMULA_NAMES=function(a){a=new Y;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.rotation="rotation";a.h.pivotX="px_offset";a.h.pivotY="py_offset";return a}(this);da.FORMULA_VARYINGS="slot,tile";da.FORMULA_CONSTANTS="";da.FORMULA_CUSTOMS="shakeAtTime,shakeDurationX,shakeDurationY";da.DEFAULT_FORMULA_VARS=
new Y;ja.__meta__={fields:{x:{posX:null},y:{posY:null},w:{sizeX:null},h:{sizeY:null},slot:{texSlot:["base"]},c:{color:null}}};ja.FORMULAS=new Y;ja.ATTRIBUTES=function(a){a=new Y;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.slotStart="aShort0";a.h.slotEnd="aShort0";a.h.slot="aShort0";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);ja.FORMULA_NAMES=function(a){a=
new Y;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);ja.FORMULA_VARYINGS="slot";ja.FORMULA_CONSTANTS="";ja.FORMULA_CUSTOMS="";ja.DEFAULT_FORMULA_VARS=new Y;gf.Versitle=[789263,11485010,6240601,3025207,9460890,14126402,9656635,9278124,13926320,14540112,7714118,4877746,15977364,15724777,10999514,5677512];fa.__meta__={fields:{x:{posX:null},y:{posY:null},w:{sizeX:null},h:{sizeY:null}}};fa.FORMULAS=new Y;fa.ATTRIBUTES=function(a){a=new Y;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y=
"aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);fa.FORMULA_NAMES=function(a){a=new Y;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);fa.FORMULA_VARYINGS="";fa.FORMULA_CONSTANTS="";fa.FORMULA_CUSTOMS="";fa.DEFAULT_FORMULA_VARS=new Y;cb.corsServer="";La.splitter=new M('(::[A-Za-z0-9_ ()&|!+=/><*."-]+::|\\$\\$([A-Za-z0-9_-]+)\\()',"");La.expr_splitter=
new M('(\\(|\\)|[ \r\n\t]*"[^"]*"[ \r\n\t]*|[!+=/><*.&|-]+)',"");La.expr_trim=new M("^[ ]*([^ ]+)[ ]*$","");La.expr_int=new M("^[0-9]+$","");La.expr_float=new M("^([+-]?)(?=\\d|,\\d)\\d*(,\\d*)?([Ee]([+-]?\\d+))?$","");La.globals={};la.main()})("undefined"!=typeof m?m:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof p?p:"undefined"!=typeof self?self:this)};H.lime.embed=function(t){var p={},C=H.lime.$scripts[t];if(!C)throw Error('Cannot find project name "'+
t+'"');C(p,m);for(var B in p)H[B]=H[B]||p[B];(C=p.lime||window.lime)&&C.embed&&this!=C.embed&&C.embed.apply(C,arguments);return p};"function"==typeof define&&define.amd&&(define([],function(){return H.lime}),define.__amd=define.amd,define.amd=null)})("undefined"!=typeof exports?exports:"function"==typeof define&&define.amd?{}:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
!function(){var H=function(){this.init()};H.prototype={init:function(){var d=this||m;return d._counter=1E3,d._html5AudioPool=[],d.html5PoolSize=10,d._codecs={},d._howls=[],d._muted=!1,d._volume=1,d._canPlayEvent="canplaythrough",d._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,d.masterGain=null,d.noAudio=!1,d.usingWebAudio=!0,d.autoSuspend=!0,d.ctx=null,d.autoUnlock=!0,d._setup(),d},volume:function(d){var k=this||m;if(d=parseFloat(d),k.ctx||n(),void 0!==d&&0<=d&&1>=
d){if(k._volume=d,k._muted)return k;k.usingWebAudio&&k.masterGain.gain.setValueAtTime(d,m.ctx.currentTime);for(var u=0;u<k._howls.length;u++)if(!k._howls[u]._webAudio)for(var f=k._howls[u]._getSoundIds(),t=0;t<f.length;t++){var p=k._howls[u]._soundById(f[t]);p&&p._node&&(p._node.volume=p._volume*d)}return k}return k._volume},mute:function(d){var k=this||m;k.ctx||n();k._muted=d;k.usingWebAudio&&k.masterGain.gain.setValueAtTime(d?0:k._volume,m.ctx.currentTime);for(var u=0;u<k._howls.length;u++)if(!k._howls[u]._webAudio)for(var f=
k._howls[u]._getSoundIds(),t=0;t<f.length;t++){var p=k._howls[u]._soundById(f[t]);p&&p._node&&(p._node.muted=!!d||p._muted)}return k},unload:function(){for(var d=this||m,k=d._howls.length-1;0<=k;k--)d._howls[k].unload();return d.usingWebAudio&&d.ctx&&void 0!==d.ctx.close&&(d.ctx.close(),d.ctx=null,n()),d},codecs:function(d){return(this||m)._codecs[d.replace(/^x-/,"")]},_setup:function(){var d=this||m;if(d.state=d.ctx?d.ctx.state||"suspended":"suspended",d._autoSuspend(),!d.usingWebAudio)if("undefined"!=
typeof Audio)try{var k=new Audio;void 0===k.oncanplaythrough&&(d._canPlayEvent="canplay")}catch(u){d.noAudio=!0}else d.noAudio=!0;try{k=new Audio,k.muted&&(d.noAudio=!0)}catch(u){}return d.noAudio||d._setupCodecs(),d},_setupCodecs:function(){var d=this||m,k=null;try{k="undefined"!=typeof Audio?new Audio:null}catch(ha){return d}if(!k||"function"!=typeof k.canPlayType)return d;var u=k.canPlayType("audio/mpeg;").replace(/^no$/,""),f=d._navigator&&d._navigator.userAgent.match(/OPR\/([0-6].)/g);f=f&&33>
parseInt(f[0].split("/")[1],10);return d._codecs={mp3:!(f||!u&&!k.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!u,opus:!!k.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!k.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!k.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!k.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!k.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!k.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(k.canPlayType("audio/x-m4a;")||
k.canPlayType("audio/m4a;")||k.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(k.canPlayType("audio/x-mp4;")||k.canPlayType("audio/mp4;")||k.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!k.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!k.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!k.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(k.canPlayType("audio/x-flac;")||k.canPlayType("audio/flac;")).replace(/^no$/,"")},d},_unlockAudio:function(){var d=
this||m,k=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(d._navigator&&d._navigator.userAgent);if(!d._audioUnlocked&&d.ctx&&k){d._audioUnlocked=!1;d.autoUnlock=!1;d._mobileUnloaded||44100===d.ctx.sampleRate||(d._mobileUnloaded=!0,d.unload());d._scratchBuffer=d.ctx.createBuffer(1,1,22050);var u=function(f){for(f=0;f<d.html5PoolSize;f++){var k=new Audio;k._unlocked=!0;d._releaseHtml5Audio(k)}for(f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio){k=d._howls[f]._getSoundIds();
for(var m=0;m<k.length;m++){var n=d._howls[f]._soundById(k[m]);n&&n._node&&!n._node._unlocked&&(n._node._unlocked=!0,n._node.load())}}d._autoResume();var t=d.ctx.createBufferSource();t.buffer=d._scratchBuffer;t.connect(d.ctx.destination);void 0===t.start?t.noteOn(0):t.start(0);"function"==typeof d.ctx.resume&&d.ctx.resume();t.onended=function(){t.disconnect(0);d._audioUnlocked=!0;document.removeEventListener("touchstart",u,!0);document.removeEventListener("touchend",u,!0);document.removeEventListener("click",
u,!0);for(var f=0;f<d._howls.length;f++)d._howls[f]._emit("unlock")}};return document.addEventListener("touchstart",u,!0),document.addEventListener("touchend",u,!0),document.addEventListener("click",u,!0),d}},_obtainHtml5Audio:function(){var d=this||m;if(d._html5AudioPool.length)return d._html5AudioPool.pop();d=(new Audio).play();return d&&"undefined"!=typeof Promise&&(d instanceof Promise||"function"==typeof d.then)&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),
new Audio},_releaseHtml5Audio:function(d){var k=this||m;return d._unlocked&&k._html5AudioPool.push(d),k},_autoSuspend:function(){var d=this;if(d.autoSuspend&&d.ctx&&void 0!==d.ctx.suspend&&m.usingWebAudio){for(var k=0;k<d._howls.length;k++)if(d._howls[k]._webAudio)for(var u=0;u<d._howls[k]._sounds.length;u++)if(!d._howls[k]._sounds[u]._paused)return d;return d._suspendTimer&&clearTimeout(d._suspendTimer),d._suspendTimer=setTimeout(function(){d.autoSuspend&&(d._suspendTimer=null,d.state="suspending",
d.ctx.suspend().then(function(){d.state="suspended";d._resumeAfterSuspend&&(delete d._resumeAfterSuspend,d._autoResume())}))},3E4),d}},_autoResume:function(){var d=this;if(d.ctx&&void 0!==d.ctx.resume&&m.usingWebAudio)return"running"===d.state&&d._suspendTimer?(clearTimeout(d._suspendTimer),d._suspendTimer=null):"suspended"===d.state?(d.ctx.resume().then(function(){d.state="running";for(var k=0;k<d._howls.length;k++)d._howls[k]._emit("resume")}),d._suspendTimer&&(clearTimeout(d._suspendTimer),d._suspendTimer=
null)):"suspending"===d.state&&(d._resumeAfterSuspend=!0),d}};var m=new H,t=function(d){if(!d.src||0===d.src.length)return void console.error("An array of source files must be passed with any new Howl.");this.init(d)};t.prototype={init:function(d){var k=this;return m.ctx||n(),k._autoplay=d.autoplay||!1,k._format="string"!=typeof d.format?d.format:[d.format],k._html5=d.html5||!1,k._muted=d.mute||!1,k._loop=d.loop||!1,k._pool=d.pool||5,k._preload="boolean"!=typeof d.preload||d.preload,k._rate=d.rate||
1,k._sprite=d.sprite||{},k._src="string"!=typeof d.src?d.src:[d.src],k._volume=void 0!==d.volume?d.volume:1,k._xhrWithCredentials=d.xhrWithCredentials||!1,k._duration=0,k._state="unloaded",k._sounds=[],k._endTimers={},k._queue=[],k._playLock=!1,k._onend=d.onend?[{fn:d.onend}]:[],k._onfade=d.onfade?[{fn:d.onfade}]:[],k._onload=d.onload?[{fn:d.onload}]:[],k._onloaderror=d.onloaderror?[{fn:d.onloaderror}]:[],k._onplayerror=d.onplayerror?[{fn:d.onplayerror}]:[],k._onpause=d.onpause?[{fn:d.onpause}]:[],
k._onplay=d.onplay?[{fn:d.onplay}]:[],k._onstop=d.onstop?[{fn:d.onstop}]:[],k._onmute=d.onmute?[{fn:d.onmute}]:[],k._onvolume=d.onvolume?[{fn:d.onvolume}]:[],k._onrate=d.onrate?[{fn:d.onrate}]:[],k._onseek=d.onseek?[{fn:d.onseek}]:[],k._onunlock=d.onunlock?[{fn:d.onunlock}]:[],k._onresume=[],k._webAudio=m.usingWebAudio&&!k._html5,void 0!==m.ctx&&m.ctx&&m.autoUnlock&&m._unlockAudio(),m._howls.push(k),k._autoplay&&k._queue.push({event:"play",action:function(){k.play()}}),k._preload&&k.load(),k},load:function(){var d=
null;if(m.noAudio)return void this._emit("loaderror",null,"No audio support.");"string"==typeof this._src&&(this._src=[this._src]);for(var k=0;k<this._src.length;k++){var u;if(this._format&&this._format[k])var f=this._format[k];else{if("string"!=typeof(u=this._src[k])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(f=/^data:audio\/([^;,]+);/i.exec(u))||(f=/\.([^.]+)$/.exec(u.split("?",1)[0]));f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),
f&&m.codecs(f)){d=this._src[k];break}}return d?(this._src=d,this._state="loading","https:"===window.location.protocol&&"http:"===d.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new p(this),this._webAudio&&B(this),this):void this._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(d,k){var u=this,f=null;if("number"==typeof d)f=d,d=null;else{if("string"==typeof d&&"loaded"===u._state&&!u._sprite[d])return null;if(void 0===d&&(d="__default",!u._playLock)){for(var n=
0,t=0;t<u._sounds.length;t++)u._sounds[t]._paused&&!u._sounds[t]._ended&&(n++,f=u._sounds[t]._id);1===n?d=null:f=null}}var p=f?u._soundById(f):u._inactiveSound();if(!p)return null;if(f&&!d&&(d=p._sprite||"__default"),"loaded"!==u._state){p._sprite=d;p._ended=!1;var D=p._id;return u._queue.push({event:"play",action:function(){u.play(D)}}),D}if(f&&!p._paused)return k||u._loadQueue("play"),p._id;u._webAudio&&m._autoResume();var G=Math.max(0,0<p._seek?p._seek:u._sprite[d][0]/1E3),C=Math.max(0,(u._sprite[d][0]+
u._sprite[d][1])/1E3-G),B=1E3*C/Math.abs(p._rate),J=u._sprite[d][0]/1E3,H=(u._sprite[d][0]+u._sprite[d][1])/1E3,I=!(!p._loop&&!u._sprite[d][2]);p._sprite=d;p._ended=!1;var z=function(){p._paused=!1;p._seek=G;p._start=J;p._stop=H;p._loop=I};if(G>=H)return void u._ended(p);var O=p._node;if(u._webAudio)f=function(){u._playLock=!1;z();u._refreshBuffer(p);O.gain.setValueAtTime(p._muted||u._muted?0:p._volume,m.ctx.currentTime);p._playStart=m.ctx.currentTime;void 0===O.bufferSource.start?p._loop?O.bufferSource.noteGrainOn(0,
G,86400):O.bufferSource.noteGrainOn(0,G,C):p._loop?O.bufferSource.start(0,G,86400):O.bufferSource.start(0,G,C);B!==1/0&&(u._endTimers[p._id]=setTimeout(u._ended.bind(u,p),B));k||setTimeout(function(){u._emit("play",p._id);u._loadQueue()},0)},"running"===m.state?f():(u._playLock=!0,u.once("resume",f),u._clearTimer(p._id));else{var ya=function(){O.currentTime=G;O.muted=p._muted||u._muted||m._muted||O.muted;O.volume=p._volume*m.volume();O.playbackRate=p._rate;try{var f=O.play();if(f&&"undefined"!=typeof Promise&&
(f instanceof Promise||"function"==typeof f.then)?(u._playLock=!0,z(),f.then(function(){u._playLock=!1;O._unlocked=!0;k||(u._emit("play",p._id),u._loadQueue())}).catch(function(){u._playLock=!1;u._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");p._ended=!0;p._paused=!0})):k||(u._playLock=!1,z(),u._emit("play",p._id),u._loadQueue()),O.playbackRate=p._rate,O.paused)return void u._emit("playerror",
p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==d||p._loop?u._endTimers[p._id]=setTimeout(u._ended.bind(u,p),B):(u._endTimers[p._id]=function(){u._ended(p);O.removeEventListener("ended",u._endTimers[p._id],!1)},O.addEventListener("ended",u._endTimers[p._id],!1))}catch(ua){u._emit("playerror",p._id,ua)}};f=window&&window.ejecta||!O.readyState&&m._navigator.isCocoonJS;if(3<=O.readyState||
f)ya();else{u._playLock=!0;var S=function(){ya();O.removeEventListener(m._canPlayEvent,S,!1)};O.addEventListener(m._canPlayEvent,S,!1);u._clearTimer(p._id)}}return p._id},pause:function(d,k){var u=this;if("loaded"!==u._state||u._playLock)return u._queue.push({event:"pause",action:function(){u.pause(d)}}),u;for(var f=u._getSoundIds(d),m=0;m<f.length;m++){u._clearTimer(f[m]);var n=u._soundById(f[m]);if(n&&!n._paused&&(n._seek=u.seek(f[m]),n._rateSeek=0,n._paused=!0,u._stopFade(f[m]),n._node))if(u._webAudio){if(!n._node.bufferSource)continue;
void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0);u._cleanBuffer(n._node)}else isNaN(n._node.duration)&&n._node.duration!==1/0||n._node.pause();k||u._emit("pause",n?n._id:null)}return u},stop:function(d,k){var u=this;if("loaded"!==u._state||u._playLock)return u._queue.push({event:"stop",action:function(){u.stop(d)}}),u;for(var f=u._getSoundIds(d),m=0;m<f.length;m++){u._clearTimer(f[m]);var n=u._soundById(f[m]);n&&(n._seek=n._start||0,n._rateSeek=0,n._paused=
!0,n._ended=!0,u._stopFade(f[m]),n._node&&(u._webAudio?n._node.bufferSource&&(void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),u._cleanBuffer(n._node)):isNaN(n._node.duration)&&n._node.duration!==1/0||(n._node.currentTime=n._start||0,n._node.pause())),k||u._emit("stop",n._id))}return u},mute:function(d,k){var u=this;if("loaded"!==u._state||u._playLock)return u._queue.push({event:"mute",action:function(){u.mute(d,k)}}),u;if(void 0===k){if("boolean"!=typeof d)return u._muted;
u._muted=d}for(var f=u._getSoundIds(k),n=0;n<f.length;n++){var t=u._soundById(f[n]);t&&(t._muted=d,t._interval&&u._stopFade(t._id),u._webAudio&&t._node?t._node.gain.setValueAtTime(d?0:t._volume,m.ctx.currentTime):t._node&&(t._node.muted=!!m._muted||d),u._emit("mute",t._id))}return u},volume:function(){var d,k,u=this,f=arguments;if(0===f.length)return u._volume;1===f.length||2===f.length&&void 0===f[1]?0<=u._getSoundIds().indexOf(f[0])?k=parseInt(f[0],10):d=parseFloat(f[0]):2<=f.length&&(d=parseFloat(f[0]),
k=parseInt(f[1],10));var n;if(!(void 0!==d&&0<=d&&1>=d))return n=k?u._soundById(k):u._sounds[0],n?n._volume:0;if("loaded"!==u._state||u._playLock)return u._queue.push({event:"volume",action:function(){u.volume.apply(u,f)}}),u;void 0===k&&(u._volume=d);k=u._getSoundIds(k);for(var t=0;t<k.length;t++)(n=u._soundById(k[t]))&&(n._volume=d,f[2]||u._stopFade(k[t]),u._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(d,m.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=d*m.volume()),u._emit("volume",
n._id));return u},fade:function(d,k,u,f){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"fade",action:function(){n.fade(d,k,u,f)}}),n;d=parseFloat(d);k=parseFloat(k);u=parseFloat(u);n.volume(d,f);for(var t=n._getSoundIds(f),p=0;p<t.length;p++){var G=n._soundById(t[p]);if(G){if(f||n._stopFade(t[p]),n._webAudio&&!G._muted){var D=m.ctx.currentTime,C=D+u/1E3;G._volume=d;G._node.gain.setValueAtTime(d,D);G._node.gain.linearRampToValueAtTime(k,C)}n._startFadeInterval(G,d,k,u,
t[p],void 0===f)}}return n},_startFadeInterval:function(d,k,u,f,n,m){var t=this,p=k,G=u-k;n=Math.abs(G/.01);n=Math.max(4,0<n?f/n:f);var D=Date.now();d._fadeTo=u;d._interval=setInterval(function(){var n=(Date.now()-D)/f;D=Date.now();p+=G*n;p=Math.max(0,p);p=Math.min(1,p);p=Math.round(100*p)/100;t._webAudio?d._volume=p:t.volume(p,d._id,!0);m&&(t._volume=p);(u<k&&p<=u||u>k&&p>=u)&&(clearInterval(d._interval),d._interval=null,d._fadeTo=null,t.volume(u,d._id),t._emit("fade",d._id))},n)},_stopFade:function(d){var k=
this._soundById(d);return k&&k._interval&&(this._webAudio&&k._node.gain.cancelScheduledValues(m.ctx.currentTime),clearInterval(k._interval),k._interval=null,this.volume(k._fadeTo,d),k._fadeTo=null,this._emit("fade",d)),this},loop:function(){var d,k,u,f=arguments;if(0===f.length)return this._loop;if(1===f.length){if("boolean"!=typeof f[0])return!!(u=this._soundById(parseInt(f[0],10)))&&u._loop;this._loop=d=f[0]}else 2===f.length&&(d=f[0],k=parseInt(f[1],10));k=this._getSoundIds(k);for(f=0;f<k.length;f++)(u=
this._soundById(k[f]))&&(u._loop=d,this._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=d,d&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop)));return this},rate:function(){var d,k,u=this,f=arguments;0===f.length?k=u._sounds[0]._id:1===f.length?0<=u._getSoundIds().indexOf(f[0])?k=parseInt(f[0],10):d=parseFloat(f[0]):2===f.length&&(d=parseFloat(f[0]),k=parseInt(f[1],10));var n;if("number"!=typeof d)return n=u._soundById(k),n?n._rate:u._rate;if("loaded"!==
u._state||u._playLock)return u._queue.push({event:"rate",action:function(){u.rate.apply(u,f)}}),u;void 0===k&&(u._rate=d);k=u._getSoundIds(k);for(var t=0;t<k.length;t++)if(n=u._soundById(k[t])){u.playing(k[t])&&(n._rateSeek=u.seek(k[t]),n._playStart=u._webAudio?m.ctx.currentTime:n._playStart);n._rate=d;u._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(d,m.ctx.currentTime):n._node&&(n._node.playbackRate=d);var p=u.seek(k[t]);p=1E3*((u._sprite[n._sprite][0]+
u._sprite[n._sprite][1])/1E3-p)/Math.abs(n._rate);!u._endTimers[k[t]]&&n._paused||(u._clearTimer(k[t]),u._endTimers[k[t]]=setTimeout(u._ended.bind(u,n),p));u._emit("rate",n._id)}return u},seek:function(){var d,k,n=this,f=arguments;0===f.length?k=n._sounds[0]._id:1===f.length?0<=n._getSoundIds().indexOf(f[0])?k=parseInt(f[0],10):n._sounds.length&&(k=n._sounds[0]._id,d=parseFloat(f[0])):2===f.length&&(d=parseFloat(f[0]),k=parseInt(f[1],10));if(void 0===k)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",
action:function(){n.seek.apply(n,f)}}),n;var t=n._soundById(k);if(t){if(!("number"==typeof d&&0<=d))return n._webAudio?(d=n.playing(k)?m.ctx.currentTime-t._playStart:0,t._seek+((t._rateSeek?t._rateSeek-t._seek:0)+d*Math.abs(t._rate))):t._node.currentTime;var p=n.playing(k);p&&n.pause(k,!0);t._seek=d;t._ended=!1;n._clearTimer(k);n._webAudio||!t._node||isNaN(t._node.duration)||(t._node.currentTime=d);var G=function(){n._emit("seek",k);p&&n.play(k,!0)};if(p&&!n._webAudio){var D=function(){n._playLock?
setTimeout(D,0):G()};setTimeout(D,0)}else G()}return n},playing:function(d){if("number"==typeof d)return d=this._soundById(d),!!d&&!d._paused;for(d=0;d<this._sounds.length;d++)if(!this._sounds[d]._paused)return!0;return!1},duration:function(d){var k=this._duration;d=this._soundById(d);return d&&(k=this._sprite[d._sprite][1]/1E3),k},state:function(){return this._state},unload:function(){for(var d=this._sounds,k=0;k<d.length;k++)(d[k]._paused||this.stop(d[k]._id),this._webAudio)||(/MSIE |Trident\//.test(m._navigator&&
m._navigator.userAgent)||(d[k]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),d[k]._node.removeEventListener("error",d[k]._errorFn,!1),d[k]._node.removeEventListener(m._canPlayEvent,d[k]._loadFn,!1),m._releaseHtml5Audio(d[k]._node)),delete d[k]._node,this._clearTimer(d[k]._id);k=m._howls.indexOf(this);0<=k&&m._howls.splice(k,1);d=!0;for(k=0;k<m._howls.length;k++)if(m._howls[k]._src===this._src||0<=this._src.indexOf(m._howls[k]._src)){d=!1;break}return C&&
d&&delete C[this._src],m.noAudio=!1,this._state="unloaded",this._sounds=[],null},on:function(d,k,n,f){d=this["_on"+d];return"function"==typeof k&&d.push(f?{id:n,fn:k,once:f}:{id:n,fn:k}),this},off:function(d,k,n){var f=this["_on"+d];if("number"==typeof k&&(n=k,k=null),k||n)for(d=0;d<f.length;d++){var u=n===f[d].id;if(k===f[d].fn&&u||!k&&u){f.splice(d,1);break}}else if(d)this["_on"+d]=[];else for(k=Object.keys(this),d=0;d<k.length;d++)0===k[d].indexOf("_on")&&Array.isArray(this[k[d]])&&(this[k[d]]=
[]);return this},once:function(d,k,n){return this.on(d,k,n,1),this},_emit:function(d,k,n){for(var f=this["_on"+d],u=f.length-1;0<=u;u--)f[u].id&&f[u].id!==k&&"load"!==d||(setTimeout(function(d){d.call(this,k,n)}.bind(this,f[u].fn),0),f[u].once&&this.off(d,f[u].fn,f[u].id));return this._loadQueue(d),this},_loadQueue:function(d){if(0<this._queue.length){var k=this._queue[0];k.event===d&&(this._queue.shift(),this._loadQueue());d||k.action()}return this},_ended:function(d){var k=d._sprite;if(!this._webAudio&&
d._node&&!d._node.paused&&!d._node.ended&&d._node.currentTime<d._stop)return setTimeout(this._ended.bind(this,d),100),this;k=!(!d._loop&&!this._sprite[k][2]);if(this._emit("end",d._id),!this._webAudio&&k&&this.stop(d._id,!0).play(d._id),this._webAudio&&k){this._emit("play",d._id);d._seek=d._start||0;d._rateSeek=0;d._playStart=m.ctx.currentTime;var n=1E3*(d._stop-d._start)/Math.abs(d._rate);this._endTimers[d._id]=setTimeout(this._ended.bind(this,d),n)}return this._webAudio&&!k&&(d._paused=!0,d._ended=
!0,d._seek=d._start||0,d._rateSeek=0,this._clearTimer(d._id),this._cleanBuffer(d._node),m._autoSuspend()),this._webAudio||k||this.stop(d._id,!0),this},_clearTimer:function(d){if(this._endTimers[d]){if("function"!=typeof this._endTimers[d])clearTimeout(this._endTimers[d]);else{var k=this._soundById(d);k&&k._node&&k._node.removeEventListener("ended",this._endTimers[d],!1)}delete this._endTimers[d]}return this},_soundById:function(d){for(var k=0;k<this._sounds.length;k++)if(d===this._sounds[k]._id)return this._sounds[k];
return null},_inactiveSound:function(){this._drain();for(var d=0;d<this._sounds.length;d++)if(this._sounds[d]._ended)return this._sounds[d].reset();return new p(this)},_drain:function(){var d=this._pool,k=0,n;if(!(this._sounds.length<d)){for(n=0;n<this._sounds.length;n++)this._sounds[n]._ended&&k++;for(n=this._sounds.length-1;0<=n&&!(k<=d);n--)this._sounds[n]._ended&&(this._webAudio&&this._sounds[n]._node&&this._sounds[n]._node.disconnect(0),this._sounds.splice(n,1),k--)}},_getSoundIds:function(d){if(void 0===
d){d=[];for(var k=0;k<this._sounds.length;k++)d.push(this._sounds[k]._id);return d}return[d]},_refreshBuffer:function(d){return d._node.bufferSource=m.ctx.createBufferSource(),d._node.bufferSource.buffer=C[this._src],d._panner?d._node.bufferSource.connect(d._panner):d._node.bufferSource.connect(d._node),d._node.bufferSource.loop=d._loop,d._loop&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop||0),d._node.bufferSource.playbackRate.setValueAtTime(d._rate,m.ctx.currentTime),
this},_cleanBuffer:function(d){var k=m._navigator&&0<=m._navigator.vendor.indexOf("Apple");if(m._scratchBuffer&&d.bufferSource&&(d.bufferSource.onended=null,d.bufferSource.disconnect(0),k))try{d.bufferSource.buffer=m._scratchBuffer}catch(u){}return d.bufferSource=null,this}};var p=function(d){this._parent=d;this.init()};p.prototype={init:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._paused=!0,this._ended=!0,
this._sprite="__default",this._id=++m._counter,d._sounds.push(this),this.create(),this},create:function(){var d=this._parent,k=m._muted||this._muted||this._parent._muted?0:this._volume;return d._webAudio?(this._node=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),this._node.gain.setValueAtTime(k,m.ctx.currentTime),this._node.paused=!0,this._node.connect(m.masterGain)):(this._node=m._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",
this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(m._canPlayEvent,this._loadFn,!1),this._node.src=d._src,this._node.preload="auto",this._node.volume=k*m.volume(),this._node.load()),this},reset:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++m._counter,this},_errorListener:function(){this._parent._emit("loaderror",
this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var d=this._parent;d._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue());this._node.removeEventListener(m._canPlayEvent,this._loadFn,!1)}};var C={},B=function(d){var k=d._src;if(C[k])return d._duration=C[k].duration,void D(d);
if(/^data:[^;]+;base64,/.test(k)){for(var n=atob(k.split(",")[1]),f=new Uint8Array(n.length),m=0;m<n.length;++m)f[m]=n.charCodeAt(m);J(f.buffer,d)}else{var t=new XMLHttpRequest;t.open("GET",k,!0);t.withCredentials=d._xhrWithCredentials;t.responseType="arraybuffer";t.onload=function(){var f=(t.status+"")[0];if("0"!==f&&"2"!==f&&"3"!==f)return void d._emit("loaderror",null,"Failed loading audio file with status: "+t.status+".");J(t.response,d)};t.onerror=function(){d._webAudio&&(d._html5=!0,d._webAudio=
!1,d._sounds=[],delete C[k],d.load())};G(t)}},G=function(d){try{d.send()}catch(k){d.onerror()}},J=function(d,k){var n=function(){k._emit("loaderror",null,"Decoding audio data failed.")},f=function(d){d&&0<k._sounds.length?(C[k._src]=d,D(k,d)):n()};"undefined"!=typeof Promise&&1===m.ctx.decodeAudioData.length?m.ctx.decodeAudioData(d).then(f).catch(n):m.ctx.decodeAudioData(d,f,n)},D=function(d,k){k&&!d._duration&&(d._duration=k.duration);0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*
d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue())},n=function(){if(m.usingWebAudio){try{"undefined"!=typeof AudioContext?m.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?m.ctx=new webkitAudioContext:m.usingWebAudio=!1}catch(u){m.usingWebAudio=!1}m.ctx||(m.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(m._navigator&&m._navigator.platform),k=m._navigator&&m._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);k=k?parseInt(k[1],10):null;d&&k&&9>k&&(d=
/safari/.test(m._navigator&&m._navigator.userAgent.toLowerCase()),(m._navigator&&m._navigator.standalone&&!d||m._navigator&&!m._navigator.standalone&&!d)&&(m.usingWebAudio=!1));m.usingWebAudio&&(m.masterGain=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),m.masterGain.gain.setValueAtTime(m._muted?0:1,m.ctx.currentTime),m.masterGain.connect(m.ctx.destination));m._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:m,Howl:t}});"undefined"!=typeof exports&&
(exports.Howler=m,exports.Howl=t);"undefined"!=typeof window?(window.HowlerGlobal=H,window.Howler=m,window.Howl=t,window.Sound=p):"undefined"!=typeof global&&(global.HowlerGlobal=H,global.Howler=m,global.Howl=t,global.Sound=p)}();
!function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(m){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;0<=t;t--)this._howls[t].stereo(m);return this};HowlerGlobal.prototype.pos=function(m,t,p){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,p="number"!=typeof p?this._pos[2]:p,"number"!=typeof m?this._pos:(this._pos=[m,t,p],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],
Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this};HowlerGlobal.prototype.orientation=function(m,t,p,C,B,G){if(!this.ctx||!this.ctx.listener)return this;var J=this._orientation;return t="number"!=typeof t?J[1]:t,p="number"!=typeof p?J[2]:p,C="number"!=typeof C?J[3]:C,B="number"!=
typeof B?J[4]:B,G="number"!=typeof G?J[5]:G,"number"!=typeof m?J:(this._orientation=[m,t,p,C,B,G],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(m,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(p,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(m,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(p,
Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(m,t,p,C,B,G),this)};Howl.prototype.init=function(m){return function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==
t.maxDistance?t.maxDistance:1E4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],m.call(this,t)}}(Howl.prototype.init);Howl.prototype.stereo=function(m,t){var p=this;if(!p._webAudio)return p;if("loaded"!==p._state)return p._queue.push({event:"stereo",
action:function(){p.stereo(m,t)}}),p;var C=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof m)return p._stereo;p._stereo=m;p._pos=[m,0,0]}for(var B=p._getSoundIds(t),G=0;G<B.length;G++){var J=p._soundById(B[G]);if(J){if("number"!=typeof m)return J._stereo;J._stereo=m;J._pos=[m,0,0];J._node&&(J._pannerAttr.panningModel="equalpower",J._panner&&J._panner.pan||H(J,C),"spatial"===C?void 0!==J._panner.positionX?(J._panner.positionX.setValueAtTime(m,Howler.ctx.currentTime),
J._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),J._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):J._panner.setPosition(m,0,0):J._panner.pan.setValueAtTime(m,Howler.ctx.currentTime));p._emit("stereo",J._id)}}return p};Howl.prototype.pos=function(m,t,p,C){var B=this;if(!B._webAudio)return B;if("loaded"!==B._state)return B._queue.push({event:"pos",action:function(){B.pos(m,t,p,C)}}),B;if(t="number"!=typeof t?0:t,p="number"!=typeof p?-.5:p,void 0===C){if("number"!=typeof m)return B._pos;
B._pos=[m,t,p]}for(var G=B._getSoundIds(C),J=0;J<G.length;J++){var D=B._soundById(G[J]);if(D){if("number"!=typeof m)return D._pos;D._pos=[m,t,p];D._node&&(D._panner&&!D._panner.pan||H(D,"spatial"),void 0!==D._panner.positionX?(D._panner.positionX.setValueAtTime(m,Howler.ctx.currentTime),D._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),D._panner.positionZ.setValueAtTime(p,Howler.ctx.currentTime)):D._panner.setPosition(m,t,p));B._emit("pos",D._id)}}return B};Howl.prototype.orientation=function(m,
t,p,C){var B=this;if(!B._webAudio)return B;if("loaded"!==B._state)return B._queue.push({event:"orientation",action:function(){B.orientation(m,t,p,C)}}),B;if(t="number"!=typeof t?B._orientation[1]:t,p="number"!=typeof p?B._orientation[2]:p,void 0===C){if("number"!=typeof m)return B._orientation;B._orientation=[m,t,p]}for(var G=B._getSoundIds(C),J=0;J<G.length;J++){var D=B._soundById(G[J]);if(D){if("number"!=typeof m)return D._orientation;D._orientation=[m,t,p];D._node&&(D._panner||(D._pos||(D._pos=
B._pos||[0,0,-.5]),H(D,"spatial")),void 0!==D._panner.orientationX?(D._panner.orientationX.setValueAtTime(m,Howler.ctx.currentTime),D._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),D._panner.orientationZ.setValueAtTime(p,Howler.ctx.currentTime)):D._panner.setOrientation(m,t,p));B._emit("orientation",D._id)}}return B};Howl.prototype.pannerAttr=function(){var m,t,p=arguments;if(!this._webAudio)return this;if(0===p.length)return this._pannerAttr;if(1===p.length){if("object"!=typeof p[0])return t=
this._soundById(parseInt(p[0],10)),t?t._pannerAttr:this._pannerAttr;var C=p[0];void 0===m&&(C.pannerAttr||(C.pannerAttr={coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor,panningModel:C.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==C.pannerAttr.coneInnerAngle?C.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==C.pannerAttr.coneOuterAngle?
C.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==C.pannerAttr.coneOuterGain?C.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==C.pannerAttr.distanceModel?C.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==C.pannerAttr.maxDistance?C.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==C.pannerAttr.refDistance?C.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==C.pannerAttr.rolloffFactor?C.pannerAttr.rolloffFactor:this._rolloffFactor,
panningModel:void 0!==C.pannerAttr.panningModel?C.pannerAttr.panningModel:this._panningModel})}else 2===p.length&&(C=p[0],m=parseInt(p[1],10));m=this._getSoundIds(m);for(p=0;p<m.length;p++)if(t=this._soundById(m[p])){var B=t._pannerAttr;B={coneInnerAngle:void 0!==C.coneInnerAngle?C.coneInnerAngle:B.coneInnerAngle,coneOuterAngle:void 0!==C.coneOuterAngle?C.coneOuterAngle:B.coneOuterAngle,coneOuterGain:void 0!==C.coneOuterGain?C.coneOuterGain:B.coneOuterGain,distanceModel:void 0!==C.distanceModel?C.distanceModel:
B.distanceModel,maxDistance:void 0!==C.maxDistance?C.maxDistance:B.maxDistance,refDistance:void 0!==C.refDistance?C.refDistance:B.refDistance,rolloffFactor:void 0!==C.rolloffFactor?C.rolloffFactor:B.rolloffFactor,panningModel:void 0!==C.panningModel?C.panningModel:B.panningModel};var G=t._panner;G?(G.coneInnerAngle=B.coneInnerAngle,G.coneOuterAngle=B.coneOuterAngle,G.coneOuterGain=B.coneOuterGain,G.distanceModel=B.distanceModel,G.maxDistance=B.maxDistance,G.refDistance=B.refDistance,G.rolloffFactor=
B.rolloffFactor,G.panningModel=B.panningModel):(t._pos||(t._pos=this._pos||[0,0,-.5]),H(t,"spatial"))}return this};Sound.prototype.init=function(m){return function(){var t=this._parent;this._orientation=t._orientation;this._stereo=t._stereo;this._pos=t._pos;this._pannerAttr=t._pannerAttr;m.call(this);this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init);Sound.prototype.reset=function(m){return function(){var t=this._parent;return this._orientation=
t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),m.call(this)}}(Sound.prototype.reset);var H=function(m,t){"spatial"===(t||"spatial")?(m._panner=Howler.ctx.createPanner(),m._panner.coneInnerAngle=m._pannerAttr.coneInnerAngle,m._panner.coneOuterAngle=m._pannerAttr.coneOuterAngle,
m._panner.coneOuterGain=m._pannerAttr.coneOuterGain,m._panner.distanceModel=m._pannerAttr.distanceModel,m._panner.maxDistance=m._pannerAttr.maxDistance,m._panner.refDistance=m._pannerAttr.refDistance,m._panner.rolloffFactor=m._pannerAttr.rolloffFactor,m._panner.panningModel=m._pannerAttr.panningModel,void 0!==m._panner.positionX?(m._panner.positionX.setValueAtTime(m._pos[0],Howler.ctx.currentTime),m._panner.positionY.setValueAtTime(m._pos[1],Howler.ctx.currentTime),m._panner.positionZ.setValueAtTime(m._pos[2],
Howler.ctx.currentTime)):m._panner.setPosition(m._pos[0],m._pos[1],m._pos[2]),void 0!==m._panner.orientationX?(m._panner.orientationX.setValueAtTime(m._orientation[0],Howler.ctx.currentTime),m._panner.orientationY.setValueAtTime(m._orientation[1],Howler.ctx.currentTime),m._panner.orientationZ.setValueAtTime(m._orientation[2],Howler.ctx.currentTime)):m._panner.setOrientation(m._orientation[0],m._orientation[1],m._orientation[2])):(m._panner=Howler.ctx.createStereoPanner(),m._panner.pan.setValueAtTime(m._stereo,
Howler.ctx.currentTime));m._panner.connect(m._node);m._paused||m._parent.pause(m._id,!0).play(m._id,!0)}}();
!function(H){"object"==typeof exports&&"undefined"!=typeof module?module.exports=H():"function"==typeof define&&define.amd?define([],H):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=H()}(function(){return function C(m,t,p){function B(D,n){if(!t[D]){if(!m[D]){var d="function"==typeof require&&require;if(!n&&d)return d(D,!0);if(G)return G(D,!0);n=Error("Cannot find module '"+D+"'");throw n.code="MODULE_NOT_FOUND",n;}n=t[D]={exports:{}};
m[D][0].call(n.exports,function(d){var k=m[D][1][d];return B(k?k:d)},n,n.exports,C,m,t,p)}return t[D].exports}for(var G="function"==typeof require&&require,J=0;J<p.length;J++)B(p[J]);return B}({1:[function(m,t,p){function C(m){if(!(this instanceof C))return new C(m);m=this.options=J.assign({level:f,method:V,chunkSize:16384,windowBits:15,memLevel:8,strategy:ha,to:""},m||{});m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&16>m.windowBits&&(m.windowBits+=16);this.err=0;this.msg=
"";this.ended=!1;this.chunks=[];this.strm=new d;this.strm.avail_out=0;var t=G.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(t!==u)throw Error(n[t]);if(m.header&&G.deflateSetHeader(this.strm,m.header),m.dictionary){var p;if(p="string"==typeof m.dictionary?D.string2buf(m.dictionary):"[object ArrayBuffer]"===k.call(m.dictionary)?new Uint8Array(m.dictionary):m.dictionary,t=G.deflateSetDictionary(this.strm,p),t!==u)throw Error(n[t]);this._dict_set=!0}}function B(d,f){f=
new C(f);if(f.push(d,!0),f.err)throw f.msg;return f.result}var G=m("./zlib/deflate"),J=m("./utils/common"),D=m("./utils/strings"),n=m("./zlib/messages"),d=m("./zlib/zstream"),k=Object.prototype.toString,u=0,f=-1,ha=0,V=8;C.prototype.push=function(d,f){var n,m=this.strm,t=this.options.chunkSize;if(this.ended)return!1;f=f===~~f?f:!0===f?4:0;"string"==typeof d?m.input=D.string2buf(d):"[object ArrayBuffer]"===k.call(d)?m.input=new Uint8Array(d):m.input=d;m.next_in=0;m.avail_in=m.input.length;do{if(0===
m.avail_out&&(m.output=new J.Buf8(t),m.next_out=0,m.avail_out=t),n=G.deflate(m,f),1!==n&&n!==u)return this.onEnd(n),this.ended=!0,!1;0!==m.avail_out&&(0!==m.avail_in||4!==f&&2!==f)||("string"===this.options.to?this.onData(D.buf2binstring(J.shrinkBuf(m.output,m.next_out))):this.onData(J.shrinkBuf(m.output,m.next_out)))}while((0<m.avail_in||0===m.avail_out)&&1!==n);return 4===f?(n=G.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==f||(this.onEnd(u),m.avail_out=0,!0)};C.prototype.onData=
function(d){this.chunks.push(d)};C.prototype.onEnd=function(d){d===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=J.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};p.Deflate=C;p.deflate=B;p.deflateRaw=function(d,f){return f=f||{},f.raw=!0,B(d,f)};p.gzip=function(d,f){return f=f||{},f.gzip=!0,B(d,f)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(m,t,p){function C(f){if(!(this instanceof
C))return new C(f);var m=this.options=J.assign({chunkSize:16384,windowBits:0,to:""},f||{});m.raw&&0<=m.windowBits&&16>m.windowBits&&(m.windowBits=-m.windowBits,0===m.windowBits&&(m.windowBits=-15));!(0<=m.windowBits&&16>m.windowBits)||f&&f.windowBits||(m.windowBits+=32);15<m.windowBits&&48>m.windowBits&&0===(15&m.windowBits)&&(m.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new k;this.strm.avail_out=0;f=G.inflateInit2(this.strm,m.windowBits);if(f!==n.Z_OK)throw Error(d[f]);
this.header=new u;G.inflateGetHeader(this.strm,this.header)}function B(d,f){f=new C(f);if(f.push(d,!0),f.err)throw f.msg;return f.result}var G=m("./zlib/inflate"),J=m("./utils/common"),D=m("./utils/strings"),n=m("./zlib/constants"),d=m("./zlib/messages"),k=m("./zlib/zstream"),u=m("./zlib/gzheader"),f=Object.prototype.toString;C.prototype.push=function(d,k){var m,u,t,p,C,B=this.strm,V=this.options.chunkSize,I=this.options.dictionary,z=!1;if(this.ended)return!1;k=k===~~k?k:!0===k?n.Z_FINISH:n.Z_NO_FLUSH;
"string"==typeof d?B.input=D.binstring2buf(d):"[object ArrayBuffer]"===f.call(d)?B.input=new Uint8Array(d):B.input=d;B.next_in=0;B.avail_in=B.input.length;do{if(0===B.avail_out&&(B.output=new J.Buf8(V),B.next_out=0,B.avail_out=V),m=G.inflate(B,n.Z_NO_FLUSH),m===n.Z_NEED_DICT&&I&&(C="string"==typeof I?D.string2buf(I):"[object ArrayBuffer]"===f.call(I)?new Uint8Array(I):I,m=G.inflateSetDictionary(this.strm,C)),m===n.Z_BUF_ERROR&&!0===z&&(m=n.Z_OK,z=!1),m!==n.Z_STREAM_END&&m!==n.Z_OK)return this.onEnd(m),
this.ended=!0,!1;B.next_out&&(0!==B.avail_out&&m!==n.Z_STREAM_END&&(0!==B.avail_in||k!==n.Z_FINISH&&k!==n.Z_SYNC_FLUSH)||("string"===this.options.to?(u=D.utf8border(B.output,B.next_out),t=B.next_out-u,p=D.buf2string(B.output,u),B.next_out=t,B.avail_out=V-t,t&&J.arraySet(B.output,B.output,u,t,0),this.onData(p)):this.onData(J.shrinkBuf(B.output,B.next_out))));0===B.avail_in&&0===B.avail_out&&(z=!0)}while((0<B.avail_in||0===B.avail_out)&&m!==n.Z_STREAM_END);return m===n.Z_STREAM_END&&(k=n.Z_FINISH),
k===n.Z_FINISH?(m=G.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===n.Z_OK):k!==n.Z_SYNC_FLUSH||(this.onEnd(n.Z_OK),B.avail_out=0,!0)};C.prototype.onData=function(d){this.chunks.push(d)};C.prototype.onEnd=function(d){d===n.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=J.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};p.Inflate=C;p.inflate=B;p.inflateRaw=function(d,f){return f=f||{},f.raw=!0,B(d,f)};p.ungzip=B},{"./utils/common":3,
"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(m,t,p){m="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;p.assign=function(m){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var p=t.shift();if(p){if("object"!=typeof p)throw new TypeError(p+"must be non-object");for(var n in p)p.hasOwnProperty(n)&&(m[n]=p[n])}}return m};p.shrinkBuf=function(m,t){return m.length===
t?m:m.subarray?m.subarray(0,t):(m.length=t,m)};var C={arraySet:function(m,t,p,n,d){if(t.subarray&&m.subarray)return void m.set(t.subarray(p,p+n),d);for(var k=0;k<n;k++)m[d+k]=t[p+k]},flattenChunks:function(m){var t,p;var n=p=0;for(t=m.length;n<t;n++)p+=m[n].length;var d=new Uint8Array(p);n=p=0;for(t=m.length;n<t;n++){var k=m[n];d.set(k,p);p+=k.length}return d}},B={arraySet:function(m,t,p,n,d){for(var k=0;k<n;k++)m[d+k]=t[p+k]},flattenChunks:function(m){return[].concat.apply([],m)}};p.setTyped=function(m){m?
(p.Buf8=Uint8Array,p.Buf16=Uint16Array,p.Buf32=Int32Array,p.assign(p,C)):(p.Buf8=Array,p.Buf16=Array,p.Buf32=Array,p.assign(p,B))};p.setTyped(m)},{}],4:[function(m,t,p){function C(n,d){if(65537>d&&(n.subarray&&J||!n.subarray&&G))return String.fromCharCode.apply(null,B.shrinkBuf(n,d));for(var k="",m=0;m<d;m++)k+=String.fromCharCode(n[m]);return k}var B=m("./common"),G=!0,J=!0;try{String.fromCharCode.apply(null,[0])}catch(n){G=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(n){J=!1}var D=
new B.Buf8(256);for(m=0;256>m;m++)D[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;D[254]=D[254]=1;p.string2buf=function(n){var d,k,m,f=n.length,t=0;for(k=0;k<f;k++){var p=n.charCodeAt(k);55296===(64512&p)&&k+1<f&&(d=n.charCodeAt(k+1),56320===(64512&d)&&(p=65536+(p-55296<<10)+(d-56320),k++));t+=128>p?1:2048>p?2:65536>p?3:4}var C=new B.Buf8(t);for(k=m=0;m<t;k++)p=n.charCodeAt(k),55296===(64512&p)&&k+1<f&&(d=n.charCodeAt(k+1),56320===(64512&d)&&(p=65536+(p-55296<<10)+(d-56320),k++)),128>p?C[m++]=
p:2048>p?(C[m++]=192|p>>>6,C[m++]=128|63&p):65536>p?(C[m++]=224|p>>>12,C[m++]=128|p>>>6&63,C[m++]=128|63&p):(C[m++]=240|p>>>18,C[m++]=128|p>>>12&63,C[m++]=128|p>>>6&63,C[m++]=128|63&p);return C};p.buf2binstring=function(m){return C(m,m.length)};p.binstring2buf=function(m){for(var d=new B.Buf8(m.length),k=0,n=d.length;k<n;k++)d[k]=m.charCodeAt(k);return d};p.buf2string=function(m,d){var k,n,f,t=d||m.length,p=Array(2*t);for(d=k=0;d<t;)if(n=m[d++],128>n)p[k++]=n;else if(f=D[n],4<f)p[k++]=65533,d+=f-
1;else{for(n&=2===f?31:3===f?15:7;1<f&&d<t;)n=n<<6|63&m[d++],f--;1<f?p[k++]=65533:65536>n?p[k++]=n:(n-=65536,p[k++]=55296|n>>10&1023,p[k++]=56320|1023&n)}return C(p,k)};p.utf8border=function(m,d){var k;d=d||m.length;d>m.length&&(d=m.length);for(k=d-1;0<=k&&128===(192&m[k]);)k--;return 0>k?d:0===k?d:k+D[m[k]]>d?k:d}},{"./common":3}],5:[function(m,t,p){t.exports=function(m,t,p,J){var C=65535&m|0;m=m>>>16&65535|0;for(var n;0!==p;){n=2E3<p?2E3:p;p-=n;do C=C+t[J++]|0,m=m+C|0;while(--n);C%=65521;m%=65521}return C|
m<<16|0}},{}],6:[function(m,t,p){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(m,t,p){var C=function(){for(var m,t=[],p=0;256>p;p++){m=p;
for(var C=0;8>C;C++)m=1&m?3988292384^m>>>1:m>>>1;t[p]=m}return t}();t.exports=function(m,t,p,D){p=D+p;for(m^=-1;D<p;D++)m=m>>>8^C[255&(m^t[D])];return m^-1}},{}],8:[function(m,t,p){function C(d,f){return d.msg=I[f],f}function B(d){for(var f=d.length;0<=--f;)d[f]=0}function G(d){var f=d.state,k=f.pending;k>d.avail_out&&(k=d.avail_out);0!==k&&(qa.arraySet(d.output,f.pending_buf,f.pending_out,k,d.next_out),d.next_out+=k,f.pending_out+=k,d.total_out+=k,d.avail_out-=k,f.pending-=k,0===f.pending&&(f.pending_out=
0))}function J(d,f){ta._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,f);d.block_start=d.strstart;G(d.strm)}function D(d,f){d.pending_buf[d.pending++]=f}function n(d,f){d.pending_buf[d.pending++]=f>>>8&255;d.pending_buf[d.pending++]=255&f}function d(d,f){var k,y,m=d.max_chain_length,n=d.strstart,q=d.prev_length,t=d.nice_match,p=d.strstart>d.w_size-N?d.strstart-(d.w_size-N):0,u=d.window,z=d.w_mask,x=d.prev,C=d.strstart+aa,G=u[n+q-1],D=u[n+q];d.prev_length>=d.good_match&&
(m>>=2);t>d.lookahead&&(t=d.lookahead);do if(k=f,u[k+q]===D&&u[k+q-1]===G&&u[k]===u[n]&&u[++k]===u[n+1]){n+=2;for(k++;u[++n]===u[++k]&&u[++n]===u[++k]&&u[++n]===u[++k]&&u[++n]===u[++k]&&u[++n]===u[++k]&&u[++n]===u[++k]&&u[++n]===u[++k]&&u[++n]===u[++k]&&n<C;);if(y=aa-(C-n),n=C-aa,y>q){if(d.match_start=f,q=y,y>=t)break;G=u[n+q-1];D=u[n+q]}}while((f=x[f&z])>p&&0!==--m);return q<=d.lookahead?q:d.lookahead}function k(d){var f,k,m=d.w_size;do{if(k=d.window_size-d.lookahead-d.strstart,d.strstart>=m+(m-
N)){qa.arraySet(d.window,d.window,m,m,0);d.match_start-=m;d.strstart-=m;d.block_start-=m;var y=f=d.hash_size;do{var n=d.head[--y];d.head[y]=n>=m?n-m:0}while(--f);y=f=m;do n=d.prev[--y],d.prev[y]=n>=m?n-m:0;while(--f);k+=m}if(0===d.strm.avail_in)break;y=d.strm;n=d.window;var q=d.strstart+d.lookahead,t=y.avail_in;if(f=(t>k&&(t=k),0===t?0:(y.avail_in-=t,qa.arraySet(n,y.input,y.next_in,t,q),1===y.state.wrap?y.adler=la(y.adler,n,t,q):2===y.state.wrap&&(y.adler=M(y.adler,n,t,q)),y.next_in+=t,y.total_in+=
t,t)),d.lookahead+=f,d.lookahead+d.insert>=W)for(k=d.strstart-d.insert,d.ins_h=d.window[k],d.ins_h=(d.ins_h<<d.hash_shift^d.window[k+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[k+W-1])&d.hash_mask,d.prev[k&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=k,k++,d.insert--,!(d.lookahead+d.insert<W)););}while(d.lookahead<N&&0!==d.strm.avail_in)}function u(f,m){for(var n,y;;){if(f.lookahead<N){if(k(f),f.lookahead<N&&m===z)return x;if(0===f.lookahead)break}if(n=0,f.lookahead>=W&&(f.ins_h=
(f.ins_h<<f.hash_shift^f.window[f.strstart+W-1])&f.hash_mask,n=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),0!==n&&f.strstart-n<=f.w_size-N&&(f.match_length=d(f,n)),f.match_length>=W)if(y=ta._tr_tally(f,f.strstart-f.match_start,f.match_length-W),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=W){f.match_length--;do f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+W-1])&f.hash_mask,n=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=
f.strstart;while(0!==--f.match_length);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else y=ta._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(y&&(J(f,!1),0===f.strm.avail_out))return x}return f.insert=f.strstart<W-1?f.strstart:W-1,m===O?(J(f,!0),0===f.strm.avail_out?va:Z):f.last_lit&&(J(f,!1),0===f.strm.avail_out)?x:pb}function f(f,m){for(var n,v,q;;){if(f.lookahead<N){if(k(f),
f.lookahead<N&&m===z)return x;if(0===f.lookahead)break}if(n=0,f.lookahead>=W&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+W-1])&f.hash_mask,n=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=W-1,0!==n&&f.prev_length<f.max_lazy_match&&f.strstart-n<=f.w_size-N&&(f.match_length=d(f,n),5>=f.match_length&&(f.strategy===ua||f.match_length===W&&4096<f.strstart-f.match_start)&&(f.match_length=W-1)),f.prev_length>=
W&&f.match_length<=f.prev_length){q=f.strstart+f.lookahead-W;v=ta._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-W);f.lookahead-=f.prev_length-1;f.prev_length-=2;do++f.strstart<=q&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+W-1])&f.hash_mask,n=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart);while(0!==--f.prev_length);if(f.match_available=0,f.match_length=W-1,f.strstart++,v&&(J(f,!1),0===f.strm.avail_out))return x}else if(f.match_available){if(v=ta._tr_tally(f,
0,f.window[f.strstart-1]),v&&J(f,!1),f.strstart++,f.lookahead--,0===f.strm.avail_out)return x}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(ta._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<W-1?f.strstart:W-1,m===O?(J(f,!0),0===f.strm.avail_out?va:Z):f.last_lit&&(J(f,!1),0===f.strm.avail_out)?x:pb}function ha(d,f,k,m,n){this.good_length=d;this.max_lazy=f;this.nice_length=k;this.max_chain=m;this.func=n}function V(){this.strm=null;this.status=
0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=Ga;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=
this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new qa.Buf16(2*wa);this.dyn_dtree=new qa.Buf16(2*(2*gb+1));this.bl_tree=new qa.Buf16(2*(2*q+1));B(this.dyn_ltree);B(this.dyn_dtree);B(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new qa.Buf16(Ra+1);this.heap=new qa.Buf16(2*Oa+1);B(this.heap);this.heap_max=this.heap_len=0;this.depth=new qa.Buf16(2*Oa+1);B(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=
this.last_lit=this.lit_bufsize=this.l_buf=0}function ka(d){var f;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=Za,f=d.state,f.pending=0,f.pending_out=0,0>f.wrap&&(f.wrap=-f.wrap),f.status=f.wrap?L:F,d.adler=2===f.wrap?0:1,f.last_flush=z,ta._tr_init(f),ya):C(d,S)}function ca(d){var f=ka(d);f===ya&&(d=d.state,d.window_size=2*d.w_size,B(d.head),d.max_lazy_match=ea[d.level].max_lazy,d.good_match=ea[d.level].good_length,d.nice_match=ea[d.level].nice_length,d.max_chain_length=ea[d.level].max_chain,
d.strstart=0,d.block_start=0,d.lookahead=0,d.insert=0,d.match_length=d.prev_length=W-1,d.match_available=0,d.ins_h=0);return f}function lb(d,f,k,m,n,q){if(!d)return S;var E=1;if(f===ma&&(f=6),0>m?(E=0,m=-m):15<m&&(E=2,m-=16),1>n||n>Va||k!==Ga||8>m||15<m||0>f||9<f||0>q||q>Sa)return C(d,S);8===m&&(m=9);var v=new V;return d.state=v,v.strm=d,v.wrap=E,v.gzhead=null,v.w_bits=m,v.w_size=1<<v.w_bits,v.w_mask=v.w_size-1,v.hash_bits=n+7,v.hash_size=1<<v.hash_bits,v.hash_mask=v.hash_size-1,v.hash_shift=~~((v.hash_bits+
W-1)/W),v.window=new qa.Buf8(2*v.w_size),v.head=new qa.Buf16(v.hash_size),v.prev=new qa.Buf16(v.w_size),v.lit_bufsize=1<<n+6,v.pending_buf_size=4*v.lit_bufsize,v.pending_buf=new qa.Buf8(v.pending_buf_size),v.d_buf=1*v.lit_bufsize,v.l_buf=3*v.lit_bufsize,v.level=f,v.strategy=q,v.method=k,ca(d)}var qa=m("../utils/common"),ta=m("./trees"),la=m("./adler32"),M=m("./crc32"),I=m("./messages"),z=0,O=4,ya=0,S=-2,ma=-1,ua=1,Sa=4,Za=2,Ga=8,Va=9,Oa=286,gb=30,q=19,wa=2*Oa+1,Ra=15,W=3,aa=258,N=aa+W+1,L=42,F=113,
x=1,pb=2,va=3,Z=4;var ea=[new ha(0,0,0,0,function(d,f){var m=65535;for(m>d.pending_buf_size-5&&(m=d.pending_buf_size-5);;){if(1>=d.lookahead){if(k(d),0===d.lookahead&&f===z)return x;if(0===d.lookahead)break}d.strstart+=d.lookahead;d.lookahead=0;var n=d.block_start+m;if((0===d.strstart||d.strstart>=n)&&(d.lookahead=d.strstart-n,d.strstart=n,J(d,!1),0===d.strm.avail_out)||d.strstart-d.block_start>=d.w_size-N&&(J(d,!1),0===d.strm.avail_out))return x}return d.insert=0,f===O?(J(d,!0),0===d.strm.avail_out?
va:Z):(d.strstart>d.block_start&&J(d,!1),x)}),new ha(4,4,8,4,u),new ha(4,5,16,8,u),new ha(4,6,32,32,u),new ha(4,4,16,16,f),new ha(8,16,32,32,f),new ha(8,16,128,128,f),new ha(8,32,128,256,f),new ha(32,128,258,1024,f),new ha(32,258,258,4096,f)];p.deflateInit=function(d,f){return lb(d,f,Ga,15,8,0)};p.deflateInit2=lb;p.deflateReset=ca;p.deflateResetKeep=ka;p.deflateSetHeader=function(d,f){return d&&d.state?2!==d.state.wrap?S:(d.state.gzhead=f,ya):S};p.deflate=function(d,f){var m,v;if(!d||!d.state||5<
f||0>f)return d?C(d,S):S;if(v=d.state,!d.output||!d.input&&0!==d.avail_in||666===v.status&&f!==O)return C(d,0===d.avail_out?-5:S);if(v.strm=d,m=v.last_flush,v.last_flush=f,v.status===L)if(2===v.wrap)d.adler=0,D(v,31),D(v,139),D(v,8),v.gzhead?(D(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),D(v,255&v.gzhead.time),D(v,v.gzhead.time>>8&255),D(v,v.gzhead.time>>16&255),D(v,v.gzhead.time>>24&255),D(v,9===v.level?2:2<=v.strategy||2>v.level?4:
0),D(v,255&v.gzhead.os),v.gzhead.extra&&v.gzhead.extra.length&&(D(v,255&v.gzhead.extra.length),D(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(d.adler=M(d.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=69):(D(v,0),D(v,0),D(v,0),D(v,0),D(v,0),D(v,9===v.level?2:2<=v.strategy||2>v.level?4:0),D(v,3),v.status=F);else{var q=Ga+(v.w_bits-8<<4)<<8;q|=(2<=v.strategy||2>v.level?0:6>v.level?1:6===v.level?2:3)<<6;0!==v.strstart&&(q|=32);v.status=F;n(v,q+(31-q%31));0!==v.strstart&&(n(v,d.adler>>>16),
n(v,65535&d.adler));d.adler=1}if(69===v.status)if(v.gzhead.extra){for(q=v.pending;v.gzindex<(65535&v.gzhead.extra.length)&&(v.pending!==v.pending_buf_size||(v.gzhead.hcrc&&v.pending>q&&(d.adler=M(d.adler,v.pending_buf,v.pending-q,q)),G(d),q=v.pending,v.pending!==v.pending_buf_size));)D(v,255&v.gzhead.extra[v.gzindex]),v.gzindex++;v.gzhead.hcrc&&v.pending>q&&(d.adler=M(d.adler,v.pending_buf,v.pending-q,q));v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=73)}else v.status=73;if(73===v.status)if(v.gzhead.name){q=
v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>q&&(d.adler=M(d.adler,v.pending_buf,v.pending-q,q)),G(d),q=v.pending,v.pending===v.pending_buf_size)){var t=1;break}t=v.gzindex<v.gzhead.name.length?255&v.gzhead.name.charCodeAt(v.gzindex++):0;D(v,t)}while(0!==t);v.gzhead.hcrc&&v.pending>q&&(d.adler=M(d.adler,v.pending_buf,v.pending-q,q));0===t&&(v.gzindex=0,v.status=91)}else v.status=91;if(91===v.status)if(v.gzhead.comment){q=v.pending;do{if(v.pending===v.pending_buf_size&&
(v.gzhead.hcrc&&v.pending>q&&(d.adler=M(d.adler,v.pending_buf,v.pending-q,q)),G(d),q=v.pending,v.pending===v.pending_buf_size)){t=1;break}t=v.gzindex<v.gzhead.comment.length?255&v.gzhead.comment.charCodeAt(v.gzindex++):0;D(v,t)}while(0!==t);v.gzhead.hcrc&&v.pending>q&&(d.adler=M(d.adler,v.pending_buf,v.pending-q,q));0===t&&(v.status=103)}else v.status=103;if(103===v.status&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&G(d),v.pending+2<=v.pending_buf_size&&(D(v,255&d.adler),D(v,d.adler>>8&255),
d.adler=0,v.status=F)):v.status=F),0!==v.pending){if(G(d),0===d.avail_out)return v.last_flush=-1,ya}else if(0===d.avail_in&&(f<<1)-(4<f?9:0)<=(m<<1)-(4<m?9:0)&&f!==O)return C(d,-5);if(666===v.status&&0!==d.avail_in)return C(d,-5);if(0!==d.avail_in||0!==v.lookahead||f!==z&&666!==v.status){if(2===v.strategy)a:{for(var p;;){if(0===v.lookahead&&(k(v),0===v.lookahead)){if(f===z){var u=x;break a}break}if(v.match_length=0,p=ta._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++,p&&(J(v,!1),0===
v.strm.avail_out)){u=x;break a}}u=(v.insert=0,f===O?(J(v,!0),0===v.strm.avail_out?va:Z):v.last_lit&&(J(v,!1),0===v.strm.avail_out)?x:pb)}else if(3===v.strategy)a:{var y,I;for(p=v.window;;){if(v.lookahead<=aa){if(k(v),v.lookahead<=aa&&f===z){u=x;break a}if(0===v.lookahead)break}if(v.match_length=0,v.lookahead>=W&&0<v.strstart&&(I=v.strstart-1,y=p[I],y===p[++I]&&y===p[++I]&&y===p[++I])){for(m=v.strstart+aa;y===p[++I]&&y===p[++I]&&y===p[++I]&&y===p[++I]&&y===p[++I]&&y===p[++I]&&y===p[++I]&&y===p[++I]&&
I<m;);v.match_length=aa-(m-I);v.match_length>v.lookahead&&(v.match_length=v.lookahead)}if(v.match_length>=W?(u=ta._tr_tally(v,1,v.match_length-W),v.lookahead-=v.match_length,v.strstart+=v.match_length,v.match_length=0):(u=ta._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++),u&&(J(v,!1),0===v.strm.avail_out)){u=x;break a}}u=(v.insert=0,f===O?(J(v,!0),0===v.strm.avail_out?va:Z):v.last_lit&&(J(v,!1),0===v.strm.avail_out)?x:pb)}else u=ea[v.level].func(v,f);if(u!==va&&u!==Z||(v.status=666),
u===x||u===va)return 0===d.avail_out&&(v.last_flush=-1),ya;if(u===pb&&(1===f?ta._tr_align(v):5!==f&&(ta._tr_stored_block(v,0,0,!1),3===f&&(B(v.head),0===v.lookahead&&(v.strstart=0,v.block_start=0,v.insert=0))),G(d),0===d.avail_out))return v.last_flush=-1,ya}return f!==O?ya:0>=v.wrap?1:(2===v.wrap?(D(v,255&d.adler),D(v,d.adler>>8&255),D(v,d.adler>>16&255),D(v,d.adler>>24&255),D(v,255&d.total_in),D(v,d.total_in>>8&255),D(v,d.total_in>>16&255),D(v,d.total_in>>24&255)):(n(v,d.adler>>>16),n(v,65535&d.adler)),
G(d),0<v.wrap&&(v.wrap=-v.wrap),0!==v.pending?ya:1)};p.deflateEnd=function(d){var f;return d&&d.state?(f=d.state.status,f!==L&&69!==f&&73!==f&&91!==f&&103!==f&&f!==F&&666!==f?C(d,S):(d.state=null,f===F?C(d,-3):ya)):S};p.deflateSetDictionary=function(d,f){var m,n,q;var t=f.length;if(!d||!d.state||(m=d.state,n=m.wrap,2===n||1===n&&m.status!==L||m.lookahead))return S;1===n&&(d.adler=la(d.adler,f,t,0));m.wrap=0;t>=m.w_size&&(0===n&&(B(m.head),m.strstart=0,m.block_start=0,m.insert=0),q=new qa.Buf8(m.w_size),
qa.arraySet(q,f,t-m.w_size,m.w_size,0),f=q,t=m.w_size);q=d.avail_in;var p=d.next_in;var u=d.input;d.avail_in=t;d.next_in=0;d.input=f;for(k(m);m.lookahead>=W;){f=m.strstart;t=m.lookahead-(W-1);do m.ins_h=(m.ins_h<<m.hash_shift^m.window[f+W-1])&m.hash_mask,m.prev[f&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=f,f++;while(--t);m.strstart=f;m.lookahead=W-1;k(m)}return m.strstart+=m.lookahead,m.block_start=m.strstart,m.insert=m.lookahead,m.lookahead=0,m.match_length=m.prev_length=W-1,m.match_available=0,
d.next_in=p,d.input=u,d.avail_in=q,m.wrap=n,ya};p.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(m,t,p){t.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],10:[function(m,t,p){t.exports=function(m,t){var p,C,D;var n=m.state;var d=m.next_in;var k=m.input;var u=d+(m.avail_in-5);var f=m.next_out;var B=m.output;
t=f-(t-m.avail_out);var V=f+(m.avail_out-257);var ka=n.dmax;var ca=n.wsize;var lb=n.whave;var qa=n.wnext;var ta=n.window;var la=n.hold;var M=n.bits;var I=n.lencode;var z=n.distcode;var O=(1<<n.lenbits)-1;var ya=(1<<n.distbits)-1;a:do{15>M&&(la+=k[d++]<<M,M+=8,la+=k[d++]<<M,M+=8);var S=I[la&O];b:for(;;){if(p=S>>>24,la>>>=p,M-=p,p=S>>>16&255,0===p)B[f++]=65535&S;else{if(!(16&p)){if(0===(64&p)){S=I[(65535&S)+(la&(1<<p)-1)];continue b}if(32&p){n.mode=12;break a}m.msg="invalid literal/length code";n.mode=
30;break a}var ma=65535&S;(p&=15)&&(M<p&&(la+=k[d++]<<M,M+=8),ma+=la&(1<<p)-1,la>>>=p,M-=p);15>M&&(la+=k[d++]<<M,M+=8,la+=k[d++]<<M,M+=8);S=z[la&ya];c:for(;;){if(p=S>>>24,la>>>=p,M-=p,p=S>>>16&255,!(16&p)){if(0===(64&p)){S=z[(65535&S)+(la&(1<<p)-1)];continue c}m.msg="invalid distance code";n.mode=30;break a}if(C=65535&S,p&=15,M<p&&(la+=k[d++]<<M,M+=8,M<p&&(la+=k[d++]<<M,M+=8)),C+=la&(1<<p)-1,C>ka){m.msg="invalid distance too far back";n.mode=30;break a}if(la>>>=p,M-=p,p=f-t,C>p){if(p=C-p,p>lb&&n.sane){m.msg=
"invalid distance too far back";n.mode=30;break a}if(S=0,D=ta,0===qa){if(S+=ca-p,p<ma){ma-=p;do B[f++]=ta[S++];while(--p);S=f-C;D=B}}else if(qa<p){if(S+=ca+qa-p,p-=qa,p<ma){ma-=p;do B[f++]=ta[S++];while(--p);if(S=0,qa<ma){p=qa;ma-=p;do B[f++]=ta[S++];while(--p);S=f-C;D=B}}}else if(S+=qa-p,p<ma){ma-=p;do B[f++]=ta[S++];while(--p);S=f-C;D=B}for(;2<ma;)B[f++]=D[S++],B[f++]=D[S++],B[f++]=D[S++],ma-=3;ma&&(B[f++]=D[S++],1<ma&&(B[f++]=D[S++]))}else{S=f-C;do B[f++]=B[S++],B[f++]=B[S++],B[f++]=B[S++],ma-=
3;while(2<ma);ma&&(B[f++]=B[S++],1<ma&&(B[f++]=B[S++]))}break}}break}}while(d<u&&f<V);ma=M>>3;d-=ma;M-=ma<<3;m.next_in=d;m.next_out=f;m.avail_in=d<u?5+(u-d):5-(d-u);m.avail_out=f<V?257+(V-f):257-(f-V);n.hold=la&(1<<M)-1;n.bits=M}},{}],11:[function(m,t,p){function C(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)}function B(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=
0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new f.Buf16(320);this.work=new f.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function G(d){var k;return d&&d.state?(k=d.state,d.total_in=d.total_out=k.total=0,d.msg="",k.wrap&&(d.adler=1&k.wrap),k.mode=ta,k.last=0,k.havedict=0,k.dmax=32768,k.head=null,k.hold=0,k.bits=0,
k.lencode=k.lendyn=new f.Buf32(la),k.distcode=k.distdyn=new f.Buf32(M),k.sane=1,k.back=-1,lb):qa}function J(d){var f;return d&&d.state?(f=d.state,f.wsize=0,f.whave=0,f.wnext=0,G(d)):qa}function D(d,f){var k,m;return d&&d.state?(m=d.state,0>f?(k=0,f=-f):(k=(f>>4)+1,48>f&&(f&=15)),f&&(8>f||15<f)?qa:(null!==m.window&&m.wbits!==f&&(m.window=null),m.wrap=k,m.wbits=f,J(d))):qa}function n(d,f){var k,m;return d?(m=new B,d.state=m,m.window=null,k=D(d,f),k!==lb&&(d.state=null),k):qa}function d(d,k,m,n){var p;
d=d.state;return null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new f.Buf8(d.wsize)),n>=d.wsize?(f.arraySet(d.window,k,m-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(p=d.wsize-d.wnext,p>n&&(p=n),f.arraySet(d.window,k,m-n,p,d.wnext),n-=p,n?(f.arraySet(d.window,k,m-n,n,0),d.wnext=n,d.whave=d.wsize):(d.wnext+=p,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=p))),0}var k,u,f=m("../utils/common"),ha=m("./adler32"),V=m("./crc32"),ka=m("./inffast"),ca=m("./inftrees"),lb=0,
qa=-2,ta=1,la=852,M=592,I=!0;p.inflateReset=J;p.inflateReset2=D;p.inflateResetKeep=G;p.inflateInit=function(d){return n(d,15)};p.inflateInit2=n;p.inflate=function(m,n){var p,t,z,B,D,G,J,O=0,M=new f.Buf8(4),la=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!m||!m.state||!m.output||!m.input&&0!==m.avail_in)return qa;var q=m.state;12===q.mode&&(q.mode=13);var wa=m.next_out;var Ra=m.output;var W=m.avail_out;var aa=m.next_in;var N=m.input;var L=m.avail_in;var F=q.hold;var x=q.bits;var pb=L;var va=
W;var Z=lb;a:for(;;)switch(q.mode){case ta:if(0===q.wrap){q.mode=13;break}for(;16>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(2&q.wrap&&35615===F){q.check=0;M[0]=255&F;M[1]=F>>>8&255;q.check=V(q.check,M,2,0);x=F=0;q.mode=2;break}if(q.flags=0,q.head&&(q.head.done=!1),!(1&q.wrap)||(((255&F)<<8)+(F>>8))%31){m.msg="incorrect header check";q.mode=30;break}if(8!==(15&F)){m.msg="unknown compression method";q.mode=30;break}if(F>>>=4,x-=4,G=(15&F)+8,0===q.wbits)q.wbits=G;else if(G>q.wbits){m.msg="invalid window size";
q.mode=30;break}q.dmax=1<<G;m.adler=q.check=1;q.mode=512&F?10:12;x=F=0;break;case 2:for(;16>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(q.flags=F,8!==(255&q.flags)){m.msg="unknown compression method";q.mode=30;break}if(57344&q.flags){m.msg="unknown header flags set";q.mode=30;break}q.head&&(q.head.text=F>>8&1);512&q.flags&&(M[0]=255&F,M[1]=F>>>8&255,q.check=V(q.check,M,2,0));x=F=0;q.mode=3;case 3:for(;32>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}q.head&&(q.head.time=F);512&q.flags&&(M[0]=255&
F,M[1]=F>>>8&255,M[2]=F>>>16&255,M[3]=F>>>24&255,q.check=V(q.check,M,4,0));x=F=0;q.mode=4;case 4:for(;16>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}q.head&&(q.head.xflags=255&F,q.head.os=F>>8);512&q.flags&&(M[0]=255&F,M[1]=F>>>8&255,q.check=V(q.check,M,2,0));x=F=0;q.mode=5;case 5:if(1024&q.flags){for(;16>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}q.length=F;q.head&&(q.head.extra_len=F);512&q.flags&&(M[0]=255&F,M[1]=F>>>8&255,q.check=V(q.check,M,2,0));x=F=0}else q.head&&(q.head.extra=null);q.mode=
6;case 6:if(1024&q.flags&&(p=q.length,p>L&&(p=L),p&&(q.head&&(G=q.head.extra_len-q.length,q.head.extra||(q.head.extra=Array(q.head.extra_len)),f.arraySet(q.head.extra,N,aa,p,G)),512&q.flags&&(q.check=V(q.check,N,p,aa)),L-=p,aa+=p,q.length-=p),q.length))break a;q.length=0;q.mode=7;case 7:if(2048&q.flags){if(0===L)break a;p=0;do G=N[aa+p++],q.head&&G&&65536>q.length&&(q.head.name+=String.fromCharCode(G));while(G&&p<L);if(512&q.flags&&(q.check=V(q.check,N,p,aa)),L-=p,aa+=p,G)break a}else q.head&&(q.head.name=
null);q.length=0;q.mode=8;case 8:if(4096&q.flags){if(0===L)break a;p=0;do G=N[aa+p++],q.head&&G&&65536>q.length&&(q.head.comment+=String.fromCharCode(G));while(G&&p<L);if(512&q.flags&&(q.check=V(q.check,N,p,aa)),L-=p,aa+=p,G)break a}else q.head&&(q.head.comment=null);q.mode=9;case 9:if(512&q.flags){for(;16>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(F!==(65535&q.check)){m.msg="header crc mismatch";q.mode=30;break}x=F=0}q.head&&(q.head.hcrc=q.flags>>9&1,q.head.done=!0);m.adler=q.check=0;q.mode=
12;break;case 10:for(;32>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}m.adler=q.check=C(F);x=F=0;q.mode=11;case 11:if(0===q.havedict)return m.next_out=wa,m.avail_out=W,m.next_in=aa,m.avail_in=L,q.hold=F,q.bits=x,2;m.adler=q.check=1;q.mode=12;case 12:if(5===n||6===n)break a;case 13:if(q.last){F>>>=7&x;x-=7&x;q.mode=27;break}for(;3>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}switch(q.last=1&F,F>>>=1,--x,3&F){case 0:q.mode=14;break;case 1:var ea=q;if(I){k=new f.Buf32(512);u=new f.Buf32(32);for(z=0;144>
z;)ea.lens[z++]=8;for(;256>z;)ea.lens[z++]=9;for(;280>z;)ea.lens[z++]=7;for(;288>z;)ea.lens[z++]=8;ca(1,ea.lens,0,288,k,0,ea.work,{bits:9});for(z=0;32>z;)ea.lens[z++]=5;ca(2,ea.lens,0,32,u,0,ea.work,{bits:5});I=!1}ea.lencode=k;ea.lenbits=9;ea.distcode=u;ea.distbits=5;if(q.mode=20,6===n){F>>>=2;x-=2;break a}break;case 2:q.mode=17;break;case 3:m.msg="invalid block type",q.mode=30}F>>>=2;x-=2;break;case 14:F>>>=7&x;for(x-=7&x;32>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if((65535&F)!==(F>>>16^65535)){m.msg=
"invalid stored block lengths";q.mode=30;break}if(q.length=65535&F,F=0,x=0,q.mode=15,6===n)break a;case 15:q.mode=16;case 16:if(p=q.length){if(p>L&&(p=L),p>W&&(p=W),0===p)break a;f.arraySet(Ra,N,aa,p,wa);L-=p;aa+=p;W-=p;wa+=p;q.length-=p;break}q.mode=12;break;case 17:for(;14>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(q.nlen=(31&F)+257,F>>>=5,x-=5,q.ndist=(31&F)+1,F>>>=5,x-=5,q.ncode=(15&F)+4,F>>>=4,x-=4,286<q.nlen||30<q.ndist){m.msg="too many length or distance symbols";q.mode=30;break}q.have=
0;q.mode=18;case 18:for(;q.have<q.ncode;){for(;3>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}q.lens[la[q.have++]]=7&F;F>>>=3;x-=3}for(;19>q.have;)q.lens[la[q.have++]]=0;if(q.lencode=q.lendyn,q.lenbits=7,J={bits:q.lenbits},Z=ca(0,q.lens,0,19,q.lencode,0,q.work,J),q.lenbits=J.bits,Z){m.msg="invalid code lengths set";q.mode=30;break}q.have=0;q.mode=19;case 19:for(;q.have<q.nlen+q.ndist;){for(;O=q.lencode[F&(1<<q.lenbits)-1],B=O>>>24,ea=65535&O,!(B<=x);){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(16>
ea)F>>>=B,x-=B,q.lens[q.have++]=ea;else{if(16===ea){for(z=B+2;x<z;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(F>>>=B,x-=B,0===q.have){m.msg="invalid bit length repeat";q.mode=30;break}G=q.lens[q.have-1];p=3+(3&F);F>>>=2;x-=2}else if(17===ea){for(z=B+3;x<z;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}F>>>=B;x-=B;G=0;p=3+(7&F);F>>>=3;x-=3}else{for(z=B+7;x<z;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}F>>>=B;x-=B;G=0;p=11+(127&F);F>>>=7;x-=7}if(q.have+p>q.nlen+q.ndist){m.msg="invalid bit length repeat";
q.mode=30;break}for(;p--;)q.lens[q.have++]=G}}if(30===q.mode)break;if(0===q.lens[256]){m.msg="invalid code -- missing end-of-block";q.mode=30;break}if(q.lenbits=9,J={bits:q.lenbits},Z=ca(1,q.lens,0,q.nlen,q.lencode,0,q.work,J),q.lenbits=J.bits,Z){m.msg="invalid literal/lengths set";q.mode=30;break}if(q.distbits=6,q.distcode=q.distdyn,J={bits:q.distbits},Z=ca(2,q.lens,q.nlen,q.ndist,q.distcode,0,q.work,J),q.distbits=J.bits,Z){m.msg="invalid distances set";q.mode=30;break}if(q.mode=20,6===n)break a;
case 20:q.mode=21;case 21:if(6<=L&&258<=W){m.next_out=wa;m.avail_out=W;m.next_in=aa;m.avail_in=L;q.hold=F;q.bits=x;ka(m,va);wa=m.next_out;Ra=m.output;W=m.avail_out;aa=m.next_in;N=m.input;L=m.avail_in;F=q.hold;x=q.bits;12===q.mode&&(q.back=-1);break}for(q.back=0;O=q.lencode[F&(1<<q.lenbits)-1],B=O>>>24,z=O>>>16&255,ea=65535&O,!(B<=x);){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(z&&0===(240&z)){var y=B;var Ha=z;for(D=ea;O=q.lencode[D+((F&(1<<y+Ha)-1)>>y)],B=O>>>24,z=O>>>16&255,ea=65535&O,!(y+B<=x);){if(0===
L)break a;L--;F+=N[aa++]<<x;x+=8}F>>>=y;x-=y;q.back+=y}if(F>>>=B,x-=B,q.back+=B,q.length=ea,0===z){q.mode=26;break}if(32&z){q.back=-1;q.mode=12;break}if(64&z){m.msg="invalid literal/length code";q.mode=30;break}q.extra=15&z;q.mode=22;case 22:if(q.extra){for(z=q.extra;x<z;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}q.length+=F&(1<<q.extra)-1;F>>>=q.extra;x-=q.extra;q.back+=q.extra}q.was=q.length;q.mode=23;case 23:for(;O=q.distcode[F&(1<<q.distbits)-1],B=O>>>24,z=O>>>16&255,ea=65535&O,!(B<=x);){if(0===
L)break a;L--;F+=N[aa++]<<x;x+=8}if(0===(240&z)){y=B;Ha=z;for(D=ea;O=q.distcode[D+((F&(1<<y+Ha)-1)>>y)],B=O>>>24,z=O>>>16&255,ea=65535&O,!(y+B<=x);){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}F>>>=y;x-=y;q.back+=y}if(F>>>=B,x-=B,q.back+=B,64&z){m.msg="invalid distance code";q.mode=30;break}q.offset=ea;q.extra=15&z;q.mode=24;case 24:if(q.extra){for(z=q.extra;x<z;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}q.offset+=F&(1<<q.extra)-1;F>>>=q.extra;x-=q.extra;q.back+=q.extra}if(q.offset>q.dmax){m.msg="invalid distance too far back";
q.mode=30;break}q.mode=25;case 25:if(0===W)break a;if(p=va-W,q.offset>p){if(p=q.offset-p,p>q.whave&&q.sane){m.msg="invalid distance too far back";q.mode=30;break}p>q.wnext?(p-=q.wnext,t=q.wsize-p):t=q.wnext-p;p>q.length&&(p=q.length);z=q.window}else z=Ra,t=wa-q.offset,p=q.length;p>W&&(p=W);W-=p;q.length-=p;do Ra[wa++]=z[t++];while(--p);0===q.length&&(q.mode=21);break;case 26:if(0===W)break a;Ra[wa++]=q.length;W--;q.mode=21;break;case 27:if(q.wrap){for(;32>x;){if(0===L)break a;L--;F|=N[aa++]<<x;x+=
8}if(va-=W,m.total_out+=va,q.total+=va,va&&(m.adler=q.check=q.flags?V(q.check,Ra,va,wa-va):ha(q.check,Ra,va,wa-va)),va=W,(q.flags?F:C(F))!==q.check){m.msg="incorrect data check";q.mode=30;break}x=F=0}q.mode=28;case 28:if(q.wrap&&q.flags){for(;32>x;){if(0===L)break a;L--;F+=N[aa++]<<x;x+=8}if(F!==(4294967295&q.total)){m.msg="incorrect length check";q.mode=30;break}x=F=0}q.mode=29;case 29:Z=1;break a;case 30:Z=-3;break a;case 31:return-4;default:return qa}return m.next_out=wa,m.avail_out=W,m.next_in=
aa,m.avail_in=L,q.hold=F,q.bits=x,(q.wsize||va!==m.avail_out&&30>q.mode&&(27>q.mode||4!==n))&&d(m,m.output,m.next_out,va-m.avail_out)?(q.mode=31,-4):(pb-=m.avail_in,va-=m.avail_out,m.total_in+=pb,m.total_out+=va,q.total+=va,q.wrap&&va&&(m.adler=q.check=q.flags?V(q.check,Ra,va,m.next_out-va):ha(q.check,Ra,va,m.next_out-va)),m.data_type=q.bits+(q.last?64:0)+(12===q.mode?128:0)+(20===q.mode||15===q.mode?256:0),(0===pb&&0===va||4===n)&&Z===lb&&(Z=-5),Z)};p.inflateEnd=function(d){if(!d||!d.state)return qa;
var f=d.state;return f.window&&(f.window=null),d.state=null,lb};p.inflateGetHeader=function(d,f){var k;return d&&d.state?(k=d.state,0===(2&k.wrap)?qa:(k.head=f,f.done=!1,lb)):qa};p.inflateSetDictionary=function(f,k){var m,n,p=k.length;return f&&f.state?(m=f.state,0!==m.wrap&&11!==m.mode?qa:11===m.mode&&(n=1,n=ha(n,k,p,0),n!==m.check)?-3:d(f,k,p,p)?(m.mode=31,-4):(m.havedict=1,lb)):qa};p.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,
"./inftrees":12}],12:[function(m,t,p){var C=m("../utils/common"),B=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],G=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(m,d,k,
p,f,t,V,ka){var n,u,ha,ta,la,M,I=ka.bits,z,O,ya,S,ma,ua=0,Sa,Za=null,Ga=0,Va=new C.Buf16(16);var Oa=new C.Buf16(16);var gb=null,q=0;for(z=0;15>=z;z++)Va[z]=0;for(O=0;O<p;O++)Va[d[k+O]]++;var wa=I;for(ya=15;1<=ya&&0===Va[ya];ya--);if(wa>ya&&(wa=ya),0===ya)return f[t++]=20971520,f[t++]=20971520,ka.bits=1,0;for(I=1;I<ya&&0===Va[I];I++);wa<I&&(wa=I);for(z=n=1;15>=z;z++)if(n<<=1,n-=Va[z],0>n)return-1;if(0<n&&(0===m||1!==ya))return-1;Oa[1]=0;for(z=1;15>z;z++)Oa[z+1]=Oa[z]+Va[z];for(O=0;O<p;O++)0!==d[k+
O]&&(V[Oa[d[k+O]]++]=O);if(0===m?(Za=gb=V,ta=19):1===m?(Za=B,Ga-=257,gb=G,q-=257,ta=256):(Za=J,gb=D,ta=-1),Sa=0,O=0,z=I,Oa=t,S=wa,ma=0,ha=-1,ua=1<<wa,p=ua-1,1===m&&852<ua||2===m&&592<ua)return 1;for(var Ra=0;;){Ra++;var W=z-ma;V[O]<ta?(la=0,M=V[O]):V[O]>ta?(la=gb[q+V[O]],M=Za[Ga+V[O]]):(la=96,M=0);n=1<<z-ma;I=u=1<<S;do u-=n,f[Oa+(Sa>>ma)+u]=W<<24|la<<16|M|0;while(0!==u);for(n=1<<z-1;Sa&n;)n>>=1;if(0!==n?(Sa&=n-1,Sa+=n):Sa=0,O++,0===--Va[z]){if(z===ya)break;z=d[k+V[O]]}if(z>wa&&(Sa&p)!==ha){0===ma&&
(ma=wa);Oa+=I;S=z-ma;for(n=1<<S;S+ma<ya&&(n-=Va[S+ma],!(0>=n));)S++,n<<=1;if(ua+=1<<S,1===m&&852<ua||2===m&&592<ua)return 1;ha=Sa&p;f[ha]=wa<<24|S<<16|Oa-t|0}}return 0!==Sa&&(f[Oa+Sa]=z-ma<<24|4194304),ka.bits=wa,0}},{"../utils/common":3}],13:[function(m,t,p){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(m,t,p){function C(d){for(var f=d.length;0<=
--f;)d[f]=0}function B(d,f,k,m,n){this.static_tree=d;this.extra_bits=f;this.extra_base=k;this.elems=m;this.max_length=n;this.has_stree=d&&d.length}function G(d,f){this.dyn_tree=d;this.max_code=0;this.stat_desc=f}function J(d,f){d.pending_buf[d.pending++]=255&f;d.pending_buf[d.pending++]=f>>>8&255}function D(d,f,k){d.bi_valid>Ga-k?(d.bi_buf|=f<<d.bi_valid&65535,J(d,d.bi_buf),d.bi_buf=f>>Ga-d.bi_valid,d.bi_valid+=k-Ga):(d.bi_buf|=f<<d.bi_valid&65535,d.bi_valid+=k)}function n(d,f,k){D(d,k[2*f],k[2*f+
1])}function d(d,f){var k=0;do k|=1&d,d>>>=1,k<<=1;while(0<--f);return k>>>1}function k(f,k,m){var n,p=Array(Za+1),q=0;for(n=1;n<=Za;n++)p[n]=q=q+m[n-1]<<1;for(m=0;m<=k;m++)n=f[2*m+1],0!==n&&(f[2*m]=d(p[n]++,n))}function u(d){var f;for(f=0;f<S;f++)d.dyn_ltree[2*f]=0;for(f=0;f<ma;f++)d.dyn_dtree[2*f]=0;for(f=0;f<ua;f++)d.bl_tree[2*f]=0;d.dyn_ltree[2*Va]=1;d.opt_len=d.static_len=0;d.last_lit=d.matches=0}function f(d){8<d.bi_valid?J(d,d.bi_buf):0<d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf);d.bi_buf=
0;d.bi_valid=0}function ha(d,f,k,m){var n=2*f,p=2*k;return d[n]<d[p]||d[n]===d[p]&&m[f]<=m[k]}function V(d,f,k){for(var m=d.heap[k],n=k<<1;n<=d.heap_len&&(n<d.heap_len&&ha(f,d.heap[n+1],d.heap[n],d.depth)&&n++,!ha(f,m,d.heap[n],d.depth));)d.heap[k]=d.heap[n],k=n,n<<=1;d.heap[k]=m}function ka(d,f,k){var m,p,q=0;if(0!==d.last_lit){do{var t=d.pending_buf[d.d_buf+2*q]<<8|d.pending_buf[d.d_buf+2*q+1];var v=d.pending_buf[d.l_buf+q];q++;0===t?n(d,v,f):(m=x[v],n(d,m+ya+1,f),p=wa[m],0!==p&&(v-=pb[m],D(d,v,
p)),t--,m=256>t?F[t]:F[256+(t>>>7)],n(d,m,k),p=Ra[m],0!==p&&(t-=va[m],D(d,t,p)))}while(q<d.last_lit)}n(d,Va,f)}function ca(d,f){var m,n=f.dyn_tree;var p=f.stat_desc.static_tree;var q=f.stat_desc.has_stree,t=f.stat_desc.elems,v=-1;d.heap_len=0;d.heap_max=Sa;for(m=0;m<t;m++)0!==n[2*m]?(d.heap[++d.heap_len]=v=m,d.depth[m]=0):n[2*m+1]=0;for(;2>d.heap_len;){var u=d.heap[++d.heap_len]=2>v?++v:0;n[2*u]=1;d.depth[u]=0;d.opt_len--;q&&(d.static_len-=p[2*u+1])}f.max_code=v;for(m=d.heap_len>>1;1<=m;m--)V(d,n,
m);u=t;do m=d.heap[1],d.heap[1]=d.heap[d.heap_len--],V(d,n,1),p=d.heap[1],d.heap[--d.heap_max]=m,d.heap[--d.heap_max]=p,n[2*u]=n[2*m]+n[2*p],d.depth[u]=(d.depth[m]>=d.depth[p]?d.depth[m]:d.depth[p])+1,n[2*m+1]=n[2*p+1]=u,d.heap[1]=u++,V(d,n,1);while(2<=d.heap_len);d.heap[--d.heap_max]=d.heap[1];var E,x;m=f.dyn_tree;u=f.max_code;t=f.stat_desc.static_tree;var y=f.stat_desc.has_stree,z=f.stat_desc.extra_bits,B=f.stat_desc.extra_base,C=f.stat_desc.max_length,D=0;for(q=0;q<=Za;q++)d.bl_count[q]=0;m[2*
d.heap[d.heap_max]+1]=0;for(f=d.heap_max+1;f<Sa;f++)p=d.heap[f],q=m[2*m[2*p+1]+1]+1,q>C&&(q=C,D++),m[2*p+1]=q,p>u||(d.bl_count[q]++,E=0,p>=B&&(E=z[p-B]),x=m[2*p],d.opt_len+=x*(q+E),y&&(d.static_len+=x*(t[2*p+1]+E)));if(0!==D){do{for(q=C-1;0===d.bl_count[q];)q--;d.bl_count[q]--;d.bl_count[q+1]+=2;d.bl_count[C]--;D-=2}while(0<D);for(q=C;0!==q;q--)for(p=d.bl_count[q];0!==p;)E=d.heap[--f],E>u||(m[2*E+1]!==q&&(d.opt_len+=(q-m[2*E+1])*m[2*E],m[2*E+1]=q),p--)}k(n,v,d.bl_count)}function lb(d,f,k){var m,n=
-1,p=f[1],t=0,v=7,u=4;0===p&&(v=138,u=3);f[2*(k+1)+1]=65535;for(m=0;m<=k;m++){var E=p;p=f[2*(m+1)+1];++t<v&&E===p||(t<u?d.bl_tree[2*E]+=t:0!==E?(E!==n&&d.bl_tree[2*E]++,d.bl_tree[2*Oa]++):10>=t?d.bl_tree[2*gb]++:d.bl_tree[2*q]++,t=0,n=E,0===p?(v=138,u=3):E===p?(v=6,u=3):(v=7,u=4))}}function qa(d,f,k){var m,p,t=-1,v=f[1],u=0,E=7,x=4;0===v&&(E=138,x=3);for(m=0;m<=k;m++)if(p=v,v=f[2*(m+1)+1],!(++u<E&&p===v)){if(u<x){do n(d,p,d.bl_tree);while(0!==--u)}else 0!==p?(p!==t&&(n(d,p,d.bl_tree),u--),n(d,Oa,
d.bl_tree),D(d,u-3,2)):10>=u?(n(d,gb,d.bl_tree),D(d,u-3,3)):(n(d,q,d.bl_tree),D(d,u-11,7));u=0;t=p;0===v?(E=138,x=3):p===v?(E=6,x=3):(E=7,x=4)}}function ta(d){var f,k=4093624447;for(f=0;31>=f;f++,k>>>=1)if(1&k&&0!==d.dyn_ltree[2*f])return I;if(0!==d.dyn_ltree[18]||0!==d.dyn_ltree[20]||0!==d.dyn_ltree[26])return z;for(f=32;f<ya;f++)if(0!==d.dyn_ltree[2*f])return z;return I}function la(d,k,m,n){D(d,(O<<1)+(n?1:0),3);f(d);J(d,m);J(d,~m);M.arraySet(d.pending_buf,d.window,k,m,d.pending);d.pending+=m}var M=
m("../utils/common"),I=0,z=1,O=0,ya=256,S=ya+1+29,ma=30,ua=19,Sa=2*S+1,Za=15,Ga=16,Va=256,Oa=16,gb=17,q=18,wa=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ra=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],aa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N=Array(2*(S+2));C(N);var L=Array(2*ma);C(L);var F=Array(512);C(F);var x=Array(256);C(x);var pb=Array(29);C(pb);var va=Array(ma);C(va);var Z,ea,y,Ha=!1;p._tr_init=function(f){if(!Ha){var m,
n,p,q=Array(Za+1);for(p=n=0;28>p;p++)for(pb[p]=n,m=0;m<1<<wa[p];m++)x[n++]=p;x[n-1]=p;for(p=n=0;16>p;p++)for(va[p]=n,m=0;m<1<<Ra[p];m++)F[n++]=p;for(n>>=7;p<ma;p++)for(va[p]=n<<7,m=0;m<1<<Ra[p]-7;m++)F[256+n++]=p;for(m=0;m<=Za;m++)q[m]=0;for(m=0;143>=m;)N[2*m+1]=8,m++,q[8]++;for(;255>=m;)N[2*m+1]=9,m++,q[9]++;for(;279>=m;)N[2*m+1]=7,m++,q[7]++;for(;287>=m;)N[2*m+1]=8,m++,q[8]++;k(N,S+1,q);for(m=0;m<ma;m++)L[2*m+1]=5,L[2*m]=d(m,5);Z=new B(N,wa,ya+1,S,Za);ea=new B(L,Ra,0,ma,Za);y=new B([],W,0,ua,7);
Ha=!0}f.l_desc=new G(f.dyn_ltree,Z);f.d_desc=new G(f.dyn_dtree,ea);f.bl_desc=new G(f.bl_tree,y);f.bi_buf=0;f.bi_valid=0;u(f)};p._tr_stored_block=la;p._tr_flush_block=function(d,k,m,n){var p=0;if(0<d.level){2===d.strm.data_type&&(d.strm.data_type=ta(d));ca(d,d.l_desc);ca(d,d.d_desc);lb(d,d.dyn_ltree,d.l_desc.max_code);lb(d,d.dyn_dtree,d.d_desc.max_code);ca(d,d.bl_desc);for(p=ua-1;3<=p&&0===d.bl_tree[2*aa[p]+1];p--);p=(d.opt_len+=3*(p+1)+14,p);var q=d.opt_len+3+7>>>3;var t=d.static_len+3+7>>>3;t<=q&&
(q=t)}else q=t=m+5;if(m+4<=q&&-1!==k)la(d,k,m,n);else if(4===d.strategy||t===q)D(d,2+(n?1:0),3),ka(d,N,L);else{D(d,4+(n?1:0),3);k=d.l_desc.max_code+1;m=d.d_desc.max_code+1;p+=1;D(d,k-257,5);D(d,m-1,5);D(d,p-4,4);for(q=0;q<p;q++)D(d,d.bl_tree[2*aa[q]+1],3);qa(d,d.dyn_ltree,k-1);qa(d,d.dyn_dtree,m-1);ka(d,d.dyn_ltree,d.dyn_dtree)}u(d);n&&f(d)};p._tr_tally=function(d,f,k){return d.pending_buf[d.d_buf+2*d.last_lit]=f>>>8&255,d.pending_buf[d.d_buf+2*d.last_lit+1]=255&f,d.pending_buf[d.l_buf+d.last_lit]=
255&k,d.last_lit++,0===f?d.dyn_ltree[2*k]++:(d.matches++,f--,d.dyn_ltree[2*(x[k]+ya+1)]++,d.dyn_dtree[2*(256>f?F[f]:F[256+(f>>>7)])]++),d.last_lit===d.lit_bufsize-1};p._tr_align=function(d){D(d,2,3);n(d,Va,N);16===d.bi_valid?(J(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}},{"../utils/common":3}],15:[function(m,t,p){t.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=
this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],"/":[function(m,t,p){p=m("./lib/utils/common").assign;var C=m("./lib/deflate"),B=m("./lib/inflate");m=m("./lib/zlib/constants");var G={};p(G,C,B,m);t.exports=G},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});
var saveAs=saveAs||function(H){if(!("undefined"===typeof H||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var m=H.document.createElementNS("http://www.w3.org/1999/xhtml","a"),t="download"in m,p=/constructor/i.test(H.HTMLElement)||H.safari,C=/CriOS\/[\d]+/.test(navigator.userAgent),B=function(d){(H.setImmediate||H.setTimeout)(function(){throw d;},0)},G=function(d){setTimeout(function(){"string"===typeof d?(H.URL||H.webkitURL||H).revokeObjectURL(d):d.remove()},4E4)},J=function(d){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?
new Blob([String.fromCharCode(65279),d],{type:d.type}):d},D=function(d,k,n){n||(d=J(d));var f=this,u="application/octet-stream"===d.type,D=function(){var d=["writestart","progress","write","writeend"];d=[].concat(d);for(var k=d.length;k--;){var m=f["on"+d[k]];if("function"===typeof m)try{m.call(f,f)}catch(ta){B(ta)}}};f.readyState=f.INIT;if(t){var ka=(H.URL||H.webkitURL||H).createObjectURL(d);setTimeout(function(){m.href=ka;m.download=k;var d=new MouseEvent("click");m.dispatchEvent(d);D();G(ka);f.readyState=
f.DONE})}else(function(){if((C||u&&p)&&H.FileReader){var k=new FileReader;k.onloadend=function(){var d=C?k.result:k.result.replace(/^data:[^;]*;/,"data:attachment/file;");H.open(d,"_blank")||(H.location.href=d);f.readyState=f.DONE;D()};k.readAsDataURL(d);f.readyState=f.INIT}else ka||(ka=(H.URL||H.webkitURL||H).createObjectURL(d)),u?H.location.href=ka:H.open(ka,"_blank")||(H.location.href=ka),f.readyState=f.DONE,D(),G(ka)})()},n=D.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(d,
k,m){k=k||d.name||"download";m||(d=J(d));return navigator.msSaveOrOpenBlob(d,k)};n.abort=function(){};n.readyState=n.INIT=0;n.WRITING=1;n.DONE=2;n.error=n.onwritestart=n.onprogress=n.onwrite=n.onabort=n.onerror=n.onwriteend=null;return function(d,k,m){return new D(d,k||d.name||"download",m)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});"function"==typeof define&&define.__amd&&(define.amd=define.__amd,delete define.__amd);
